(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerpolicy&&(a.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?a.credentials="include":o.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();function Ag(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ms={exports:{}},_s={},te={exports:{}},Ie={};var Jr=Symbol.for("react.element"),Dg=Symbol.for("react.portal"),Mg=Symbol.for("react.fragment"),Fg=Symbol.for("react.strict_mode"),Pg=Symbol.for("react.profiler"),Ng=Symbol.for("react.provider"),Bg=Symbol.for("react.context"),jg=Symbol.for("react.forward_ref"),Vg=Symbol.for("react.suspense"),Wg=Symbol.for("react.memo"),Ug=Symbol.for("react.lazy"),Ic=Symbol.iterator;function Gg(e){return e===null||typeof e!="object"?null:(e=Ic&&e[Ic]||e["@@iterator"],typeof e=="function"?e:null)}var Ih={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Oh=Object.assign,Lh={};function nr(e,t,n){this.props=e,this.context=t,this.refs=Lh,this.updater=n||Ih}nr.prototype.isReactComponent={};nr.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};nr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Rh(){}Rh.prototype=nr.prototype;function _l(e,t,n){this.props=e,this.context=t,this.refs=Lh,this.updater=n||Ih}var vl=_l.prototype=new Rh;vl.constructor=_l;Oh(vl,nr.prototype);vl.isPureReactComponent=!0;var Oc=Array.isArray,Ah=Object.prototype.hasOwnProperty,yl={current:null},Dh={key:!0,ref:!0,__self:!0,__source:!0};function Mh(e,t,n){var i,o={},a=null,d=null;if(t!=null)for(i in t.ref!==void 0&&(d=t.ref),t.key!==void 0&&(a=""+t.key),t)Ah.call(t,i)&&!Dh.hasOwnProperty(i)&&(o[i]=t[i]);var _=arguments.length-2;if(_===1)o.children=n;else if(1<_){for(var y=Array(_),w=0;w<_;w++)y[w]=arguments[w+2];o.children=y}if(e&&e.defaultProps)for(i in _=e.defaultProps,_)o[i]===void 0&&(o[i]=_[i]);return{$$typeof:Jr,type:e,key:a,ref:d,props:o,_owner:yl.current}}function Hg(e,t){return{$$typeof:Jr,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Sl(e){return typeof e=="object"&&e!==null&&e.$$typeof===Jr}function zg(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Lc=/\/+/g;function Ps(e,t){return typeof e=="object"&&e!==null&&e.key!=null?zg(""+e.key):t.toString(36)}function xo(e,t,n,i,o){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var d=!1;if(e===null)d=!0;else switch(a){case"string":case"number":d=!0;break;case"object":switch(e.$$typeof){case Jr:case Dg:d=!0}}if(d)return d=e,o=o(d),e=i===""?"."+Ps(d,0):i,Oc(o)?(n="",e!=null&&(n=e.replace(Lc,"$&/")+"/"),xo(o,t,n,"",function(w){return w})):o!=null&&(Sl(o)&&(o=Hg(o,n+(!o.key||d&&d.key===o.key?"":(""+o.key).replace(Lc,"$&/")+"/")+e)),t.push(o)),1;if(d=0,i=i===""?".":i+":",Oc(e))for(var _=0;_<e.length;_++){a=e[_];var y=i+Ps(a,_);d+=xo(a,t,n,y,o)}else if(y=Gg(e),typeof y=="function")for(e=y.call(e),_=0;!(a=e.next()).done;)a=a.value,y=i+Ps(a,_++),d+=xo(a,t,n,y,o);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return d}function no(e,t,n){if(e==null)return e;var i=[],o=0;return xo(e,i,"","",function(a){return t.call(n,a,o++)}),i}function Yg(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ft={current:null},bo={transition:null},Xg={ReactCurrentDispatcher:ft,ReactCurrentBatchConfig:bo,ReactCurrentOwner:yl};Ie.Children={map:no,forEach:function(e,t,n){no(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return no(e,function(){t++}),t},toArray:function(e){return no(e,function(t){return t})||[]},only:function(e){if(!Sl(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ie.Component=nr;Ie.Fragment=Mg;Ie.Profiler=Pg;Ie.PureComponent=_l;Ie.StrictMode=Fg;Ie.Suspense=Vg;Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xg;Ie.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=Oh({},e.props),o=e.key,a=e.ref,d=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,d=yl.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var _=e.type.defaultProps;for(y in t)Ah.call(t,y)&&!Dh.hasOwnProperty(y)&&(i[y]=t[y]===void 0&&_!==void 0?_[y]:t[y])}var y=arguments.length-2;if(y===1)i.children=n;else if(1<y){_=Array(y);for(var w=0;w<y;w++)_[w]=arguments[w+2];i.children=_}return{$$typeof:Jr,type:e.type,key:o,ref:a,props:i,_owner:d}};Ie.createContext=function(e){return e={$$typeof:Bg,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Ng,_context:e},e.Consumer=e};Ie.createElement=Mh;Ie.createFactory=function(e){var t=Mh.bind(null,e);return t.type=e,t};Ie.createRef=function(){return{current:null}};Ie.forwardRef=function(e){return{$$typeof:jg,render:e}};Ie.isValidElement=Sl;Ie.lazy=function(e){return{$$typeof:Ug,_payload:{_status:-1,_result:e},_init:Yg}};Ie.memo=function(e,t){return{$$typeof:Wg,type:e,compare:t===void 0?null:t}};Ie.startTransition=function(e){var t=bo.transition;bo.transition={};try{e()}finally{bo.transition=t}};Ie.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ie.useCallback=function(e,t){return ft.current.useCallback(e,t)};Ie.useContext=function(e){return ft.current.useContext(e)};Ie.useDebugValue=function(){};Ie.useDeferredValue=function(e){return ft.current.useDeferredValue(e)};Ie.useEffect=function(e,t){return ft.current.useEffect(e,t)};Ie.useId=function(){return ft.current.useId()};Ie.useImperativeHandle=function(e,t,n){return ft.current.useImperativeHandle(e,t,n)};Ie.useInsertionEffect=function(e,t){return ft.current.useInsertionEffect(e,t)};Ie.useLayoutEffect=function(e,t){return ft.current.useLayoutEffect(e,t)};Ie.useMemo=function(e,t){return ft.current.useMemo(e,t)};Ie.useReducer=function(e,t,n){return ft.current.useReducer(e,t,n)};Ie.useRef=function(e){return ft.current.useRef(e)};Ie.useState=function(e){return ft.current.useState(e)};Ie.useSyncExternalStore=function(e,t,n){return ft.current.useSyncExternalStore(e,t,n)};Ie.useTransition=function(){return ft.current.useTransition()};Ie.version="18.2.0";(function(e){e.exports=Ie})(te);const L=Ag(te.exports);var $g=te.exports,Zg=Symbol.for("react.element"),Kg=Symbol.for("react.fragment"),Jg=Object.prototype.hasOwnProperty,Qg=$g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qg={key:!0,ref:!0,__self:!0,__source:!0};function Fh(e,t,n){var i,o={},a=null,d=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(d=t.ref);for(i in t)Jg.call(t,i)&&!qg.hasOwnProperty(i)&&(o[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)o[i]===void 0&&(o[i]=t[i]);return{$$typeof:Zg,type:e,key:a,ref:d,props:o,_owner:Qg.current}}_s.Fragment=Kg;_s.jsx=Fh;_s.jsxs=Fh;(function(e){e.exports=_s})(ms);const Ph=ms.exports.Fragment,ae=ms.exports.jsx,Le=ms.exports.jsxs;var pa={},Nh={exports:{}},Lt={},Bh={exports:{}},jh={};(function(e){function t(u,m){var g=u.length;u.push(m);e:for(;0<g;){var p=g-1>>>1,v=u[p];if(0<o(v,m))u[p]=m,u[g]=v,g=p;else break e}}function n(u){return u.length===0?null:u[0]}function i(u){if(u.length===0)return null;var m=u[0],g=u.pop();if(g!==m){u[0]=g;e:for(var p=0,v=u.length,C=v>>>1;p<C;){var b=2*(p+1)-1,k=u[b],I=b+1,R=u[I];if(0>o(k,g))I<v&&0>o(R,k)?(u[p]=R,u[I]=g,p=I):(u[p]=k,u[b]=g,p=b);else if(I<v&&0>o(R,g))u[p]=R,u[I]=g,p=I;else break e}}return m}function o(u,m){var g=u.sortIndex-m.sortIndex;return g!==0?g:u.id-m.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var d=Date,_=d.now();e.unstable_now=function(){return d.now()-_}}var y=[],w=[],x=1,T=null,E=3,M=!1,F=!1,P=!1,B=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(u){for(var m=n(w);m!==null;){if(m.callback===null)i(w);else if(m.startTime<=u)i(w),m.sortIndex=m.expirationTime,t(y,m);else break;m=n(w)}}function Y(u){if(P=!1,A(u),!F)if(n(y)!==null)F=!0,r(ne);else{var m=n(w);m!==null&&s(Y,m.startTime-u)}}function ne(u,m){F=!1,P&&(P=!1,D(S),S=-1),M=!0;var g=E;try{for(A(m),T=n(y);T!==null&&(!(T.expirationTime>m)||u&&!Ce());){var p=T.callback;if(typeof p=="function"){T.callback=null,E=T.priorityLevel;var v=p(T.expirationTime<=m);m=e.unstable_now(),typeof v=="function"?T.callback=v:T===n(y)&&i(y),A(m)}else i(y);T=n(y)}if(T!==null)var C=!0;else{var b=n(w);b!==null&&s(Y,b.startTime-m),C=!1}return C}finally{T=null,E=g,M=!1}}var oe=!1,K=null,S=-1,ue=5,le=-1;function Ce(){return!(e.unstable_now()-le<ue)}function h(){if(K!==null){var u=e.unstable_now();le=u;var m=!0;try{m=K(!0,u)}finally{m?l():(oe=!1,K=null)}}else oe=!1}var l;if(typeof O=="function")l=function(){O(h)};else if(typeof MessageChannel<"u"){var c=new MessageChannel,f=c.port2;c.port1.onmessage=h,l=function(){f.postMessage(null)}}else l=function(){B(h,0)};function r(u){K=u,oe||(oe=!0,l())}function s(u,m){S=B(function(){u(e.unstable_now())},m)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(u){u.callback=null},e.unstable_continueExecution=function(){F||M||(F=!0,r(ne))},e.unstable_forceFrameRate=function(u){0>u||125<u?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ue=0<u?Math.floor(1e3/u):5},e.unstable_getCurrentPriorityLevel=function(){return E},e.unstable_getFirstCallbackNode=function(){return n(y)},e.unstable_next=function(u){switch(E){case 1:case 2:case 3:var m=3;break;default:m=E}var g=E;E=m;try{return u()}finally{E=g}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(u,m){switch(u){case 1:case 2:case 3:case 4:case 5:break;default:u=3}var g=E;E=u;try{return m()}finally{E=g}},e.unstable_scheduleCallback=function(u,m,g){var p=e.unstable_now();switch(typeof g=="object"&&g!==null?(g=g.delay,g=typeof g=="number"&&0<g?p+g:p):g=p,u){case 1:var v=-1;break;case 2:v=250;break;case 5:v=1073741823;break;case 4:v=1e4;break;default:v=5e3}return v=g+v,u={id:x++,callback:m,priorityLevel:u,startTime:g,expirationTime:v,sortIndex:-1},g>p?(u.sortIndex=g,t(w,u),n(y)===null&&u===n(w)&&(P?(D(S),S=-1):P=!0,s(Y,g-p))):(u.sortIndex=v,t(y,u),F||M||(F=!0,r(ne))),u},e.unstable_shouldYield=Ce,e.unstable_wrapCallback=function(u){var m=E;return function(){var g=E;E=m;try{return u.apply(this,arguments)}finally{E=g}}}})(jh);(function(e){e.exports=jh})(Bh);var Vh=te.exports,Ot=Bh.exports;function de(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Wh=new Set,Dr={};function fi(e,t){$i(e,t),$i(e+"Capture",t)}function $i(e,t){for(Dr[e]=t,e=0;e<t.length;e++)Wh.add(t[e])}var dn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ma=Object.prototype.hasOwnProperty,ep=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Rc={},Ac={};function tp(e){return ma.call(Ac,e)?!0:ma.call(Rc,e)?!1:ep.test(e)?Ac[e]=!0:(Rc[e]=!0,!1)}function np(e,t,n,i){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function ip(e,t,n,i){if(t===null||typeof t>"u"||np(e,t,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function gt(e,t,n,i,o,a,d){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=d}var rt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){rt[e]=new gt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];rt[t]=new gt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){rt[e]=new gt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){rt[e]=new gt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){rt[e]=new gt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){rt[e]=new gt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){rt[e]=new gt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){rt[e]=new gt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){rt[e]=new gt(e,5,!1,e.toLowerCase(),null,!1,!1)});var wl=/[\-:]([a-z])/g;function Cl(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(wl,Cl);rt[t]=new gt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(wl,Cl);rt[t]=new gt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(wl,Cl);rt[t]=new gt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){rt[e]=new gt(e,1,!1,e.toLowerCase(),null,!1,!1)});rt.xlinkHref=new gt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){rt[e]=new gt(e,1,!1,e.toLowerCase(),null,!0,!0)});function xl(e,t,n,i){var o=rt.hasOwnProperty(t)?rt[t]:null;(o!==null?o.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(ip(t,n,o,i)&&(n=null),i||o===null?tp(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,i=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,i?e.setAttributeNS(i,t,n):e.setAttribute(t,n))))}var _n=Vh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,io=Symbol.for("react.element"),Oi=Symbol.for("react.portal"),Li=Symbol.for("react.fragment"),bl=Symbol.for("react.strict_mode"),_a=Symbol.for("react.profiler"),Uh=Symbol.for("react.provider"),Gh=Symbol.for("react.context"),El=Symbol.for("react.forward_ref"),va=Symbol.for("react.suspense"),ya=Symbol.for("react.suspense_list"),Tl=Symbol.for("react.memo"),xn=Symbol.for("react.lazy"),Hh=Symbol.for("react.offscreen"),Dc=Symbol.iterator;function cr(e){return e===null||typeof e!="object"?null:(e=Dc&&e[Dc]||e["@@iterator"],typeof e=="function"?e:null)}var Ge=Object.assign,Ns;function Sr(e){if(Ns===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ns=t&&t[1]||""}return`
`+Ns+e}var Bs=!1;function js(e,t){if(!e||Bs)return"";Bs=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(w){var i=w}Reflect.construct(e,[],t)}else{try{t.call()}catch(w){i=w}e.call(t.prototype)}else{try{throw Error()}catch(w){i=w}e()}}catch(w){if(w&&i&&typeof w.stack=="string"){for(var o=w.stack.split(`
`),a=i.stack.split(`
`),d=o.length-1,_=a.length-1;1<=d&&0<=_&&o[d]!==a[_];)_--;for(;1<=d&&0<=_;d--,_--)if(o[d]!==a[_]){if(d!==1||_!==1)do if(d--,_--,0>_||o[d]!==a[_]){var y=`
`+o[d].replace(" at new "," at ");return e.displayName&&y.includes("<anonymous>")&&(y=y.replace("<anonymous>",e.displayName)),y}while(1<=d&&0<=_);break}}}finally{Bs=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Sr(e):""}function rp(e){switch(e.tag){case 5:return Sr(e.type);case 16:return Sr("Lazy");case 13:return Sr("Suspense");case 19:return Sr("SuspenseList");case 0:case 2:case 15:return e=js(e.type,!1),e;case 11:return e=js(e.type.render,!1),e;case 1:return e=js(e.type,!0),e;default:return""}}function Sa(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Li:return"Fragment";case Oi:return"Portal";case _a:return"Profiler";case bl:return"StrictMode";case va:return"Suspense";case ya:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Gh:return(e.displayName||"Context")+".Consumer";case Uh:return(e._context.displayName||"Context")+".Provider";case El:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Tl:return t=e.displayName||null,t!==null?t:Sa(e.type)||"Memo";case xn:t=e._payload,e=e._init;try{return Sa(e(t))}catch{}}return null}function op(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Sa(t);case 8:return t===bl?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function jn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function zh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function sp(e){var t=zh(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(d){i=""+d,a.call(this,d)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(d){i=""+d},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ro(e){e._valueTracker||(e._valueTracker=sp(e))}function Yh(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=zh(e)?e.checked?"true":"false":e.value),e=i,e!==n?(t.setValue(e),!0):!1}function No(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function wa(e,t){var n=t.checked;return Ge({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Mc(e,t){var n=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;n=jn(t.value!=null?t.value:n),e._wrapperState={initialChecked:i,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Xh(e,t){t=t.checked,t!=null&&xl(e,"checked",t,!1)}function Ca(e,t){Xh(e,t);var n=jn(t.value),i=t.type;if(n!=null)i==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?xa(e,t.type,n):t.hasOwnProperty("defaultValue")&&xa(e,t.type,jn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Fc(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function xa(e,t,n){(t!=="number"||No(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var wr=Array.isArray;function Ui(e,t,n,i){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&i&&(e[n].defaultSelected=!0)}else{for(n=""+jn(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,i&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function ba(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(de(91));return Ge({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Pc(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(de(92));if(wr(n)){if(1<n.length)throw Error(de(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:jn(n)}}function $h(e,t){var n=jn(t.value),i=jn(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),i!=null&&(e.defaultValue=""+i)}function Nc(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Zh(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ea(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Zh(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var oo,Kh=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,i,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,i,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(oo=oo||document.createElement("div"),oo.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=oo.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Mr(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var br={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ap=["Webkit","ms","Moz","O"];Object.keys(br).forEach(function(e){ap.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),br[t]=br[e]})});function Jh(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||br.hasOwnProperty(e)&&br[e]?(""+t).trim():t+"px"}function Qh(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var i=n.indexOf("--")===0,o=Jh(n,t[n],i);n==="float"&&(n="cssFloat"),i?e.setProperty(n,o):e[n]=o}}var lp=Ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ta(e,t){if(t){if(lp[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(de(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(de(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(de(61))}if(t.style!=null&&typeof t.style!="object")throw Error(de(62))}}function ka(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ia=null;function kl(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Oa=null,Gi=null,Hi=null;function Bc(e){if(e=eo(e)){if(typeof Oa!="function")throw Error(de(280));var t=e.stateNode;t&&(t=Cs(t),Oa(e.stateNode,e.type,t))}}function qh(e){Gi?Hi?Hi.push(e):Hi=[e]:Gi=e}function ed(){if(Gi){var e=Gi,t=Hi;if(Hi=Gi=null,Bc(e),t)for(e=0;e<t.length;e++)Bc(t[e])}}function td(e,t){return e(t)}function nd(){}var Vs=!1;function id(e,t,n){if(Vs)return e(t,n);Vs=!0;try{return td(e,t,n)}finally{Vs=!1,(Gi!==null||Hi!==null)&&(nd(),ed())}}function Fr(e,t){var n=e.stateNode;if(n===null)return null;var i=Cs(n);if(i===null)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(de(231,t,typeof n));return n}var La=!1;if(dn)try{var ur={};Object.defineProperty(ur,"passive",{get:function(){La=!0}}),window.addEventListener("test",ur,ur),window.removeEventListener("test",ur,ur)}catch{La=!1}function cp(e,t,n,i,o,a,d,_,y){var w=Array.prototype.slice.call(arguments,3);try{t.apply(n,w)}catch(x){this.onError(x)}}var Er=!1,Bo=null,jo=!1,Ra=null,up={onError:function(e){Er=!0,Bo=e}};function hp(e,t,n,i,o,a,d,_,y){Er=!1,Bo=null,cp.apply(up,arguments)}function dp(e,t,n,i,o,a,d,_,y){if(hp.apply(this,arguments),Er){if(Er){var w=Bo;Er=!1,Bo=null}else throw Error(de(198));jo||(jo=!0,Ra=w)}}function gi(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function rd(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function jc(e){if(gi(e)!==e)throw Error(de(188))}function fp(e){var t=e.alternate;if(!t){if(t=gi(e),t===null)throw Error(de(188));return t!==e?null:e}for(var n=e,i=t;;){var o=n.return;if(o===null)break;var a=o.alternate;if(a===null){if(i=o.return,i!==null){n=i;continue}break}if(o.child===a.child){for(a=o.child;a;){if(a===n)return jc(o),e;if(a===i)return jc(o),t;a=a.sibling}throw Error(de(188))}if(n.return!==i.return)n=o,i=a;else{for(var d=!1,_=o.child;_;){if(_===n){d=!0,n=o,i=a;break}if(_===i){d=!0,i=o,n=a;break}_=_.sibling}if(!d){for(_=a.child;_;){if(_===n){d=!0,n=a,i=o;break}if(_===i){d=!0,i=a,n=o;break}_=_.sibling}if(!d)throw Error(de(189))}}if(n.alternate!==i)throw Error(de(190))}if(n.tag!==3)throw Error(de(188));return n.stateNode.current===n?e:t}function od(e){return e=fp(e),e!==null?sd(e):null}function sd(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=sd(e);if(t!==null)return t;e=e.sibling}return null}var ad=Ot.unstable_scheduleCallback,Vc=Ot.unstable_cancelCallback,gp=Ot.unstable_shouldYield,pp=Ot.unstable_requestPaint,Ye=Ot.unstable_now,mp=Ot.unstable_getCurrentPriorityLevel,Il=Ot.unstable_ImmediatePriority,ld=Ot.unstable_UserBlockingPriority,Vo=Ot.unstable_NormalPriority,_p=Ot.unstable_LowPriority,cd=Ot.unstable_IdlePriority,vs=null,Jt=null;function vp(e){if(Jt&&typeof Jt.onCommitFiberRoot=="function")try{Jt.onCommitFiberRoot(vs,e,void 0,(e.current.flags&128)===128)}catch{}}var Ht=Math.clz32?Math.clz32:wp,yp=Math.log,Sp=Math.LN2;function wp(e){return e>>>=0,e===0?32:31-(yp(e)/Sp|0)|0}var so=64,ao=4194304;function Cr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Wo(e,t){var n=e.pendingLanes;if(n===0)return 0;var i=0,o=e.suspendedLanes,a=e.pingedLanes,d=n&268435455;if(d!==0){var _=d&~o;_!==0?i=Cr(_):(a&=d,a!==0&&(i=Cr(a)))}else d=n&~o,d!==0?i=Cr(d):a!==0&&(i=Cr(a));if(i===0)return 0;if(t!==0&&t!==i&&!(t&o)&&(o=i&-i,a=t&-t,o>=a||o===16&&(a&4194240)!==0))return t;if(i&4&&(i|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)n=31-Ht(t),o=1<<n,i|=e[n],t&=~o;return i}function Cp(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xp(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var d=31-Ht(a),_=1<<d,y=o[d];y===-1?(!(_&n)||_&i)&&(o[d]=Cp(_,t)):y<=t&&(e.expiredLanes|=_),a&=~_}}function Aa(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ud(){var e=so;return so<<=1,!(so&4194240)&&(so=64),e}function Ws(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Qr(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Ht(t),e[t]=n}function bp(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-Ht(n),a=1<<o;t[o]=0,i[o]=-1,e[o]=-1,n&=~a}}function Ol(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-Ht(n),o=1<<i;o&t|e[i]&t&&(e[i]|=t),n&=~o}}var De=0;function hd(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var dd,Ll,fd,gd,pd,Da=!1,lo=[],Ln=null,Rn=null,An=null,Pr=new Map,Nr=new Map,En=[],Ep="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wc(e,t){switch(e){case"focusin":case"focusout":Ln=null;break;case"dragenter":case"dragleave":Rn=null;break;case"mouseover":case"mouseout":An=null;break;case"pointerover":case"pointerout":Pr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nr.delete(t.pointerId)}}function hr(e,t,n,i,o,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:a,targetContainers:[o]},t!==null&&(t=eo(t),t!==null&&Ll(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function Tp(e,t,n,i,o){switch(t){case"focusin":return Ln=hr(Ln,e,t,n,i,o),!0;case"dragenter":return Rn=hr(Rn,e,t,n,i,o),!0;case"mouseover":return An=hr(An,e,t,n,i,o),!0;case"pointerover":var a=o.pointerId;return Pr.set(a,hr(Pr.get(a)||null,e,t,n,i,o)),!0;case"gotpointercapture":return a=o.pointerId,Nr.set(a,hr(Nr.get(a)||null,e,t,n,i,o)),!0}return!1}function md(e){var t=ei(e.target);if(t!==null){var n=gi(t);if(n!==null){if(t=n.tag,t===13){if(t=rd(n),t!==null){e.blockedOn=t,pd(e.priority,function(){fd(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Eo(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Ma(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var i=new n.constructor(n.type,n);Ia=i,n.target.dispatchEvent(i),Ia=null}else return t=eo(n),t!==null&&Ll(t),e.blockedOn=n,!1;t.shift()}return!0}function Uc(e,t,n){Eo(e)&&n.delete(t)}function kp(){Da=!1,Ln!==null&&Eo(Ln)&&(Ln=null),Rn!==null&&Eo(Rn)&&(Rn=null),An!==null&&Eo(An)&&(An=null),Pr.forEach(Uc),Nr.forEach(Uc)}function dr(e,t){e.blockedOn===t&&(e.blockedOn=null,Da||(Da=!0,Ot.unstable_scheduleCallback(Ot.unstable_NormalPriority,kp)))}function Br(e){function t(o){return dr(o,e)}if(0<lo.length){dr(lo[0],e);for(var n=1;n<lo.length;n++){var i=lo[n];i.blockedOn===e&&(i.blockedOn=null)}}for(Ln!==null&&dr(Ln,e),Rn!==null&&dr(Rn,e),An!==null&&dr(An,e),Pr.forEach(t),Nr.forEach(t),n=0;n<En.length;n++)i=En[n],i.blockedOn===e&&(i.blockedOn=null);for(;0<En.length&&(n=En[0],n.blockedOn===null);)md(n),n.blockedOn===null&&En.shift()}var zi=_n.ReactCurrentBatchConfig,Uo=!0;function Ip(e,t,n,i){var o=De,a=zi.transition;zi.transition=null;try{De=1,Rl(e,t,n,i)}finally{De=o,zi.transition=a}}function Op(e,t,n,i){var o=De,a=zi.transition;zi.transition=null;try{De=4,Rl(e,t,n,i)}finally{De=o,zi.transition=a}}function Rl(e,t,n,i){if(Uo){var o=Ma(e,t,n,i);if(o===null)Js(e,t,i,Go,n),Wc(e,i);else if(Tp(o,e,t,n,i))i.stopPropagation();else if(Wc(e,i),t&4&&-1<Ep.indexOf(e)){for(;o!==null;){var a=eo(o);if(a!==null&&dd(a),a=Ma(e,t,n,i),a===null&&Js(e,t,i,Go,n),a===o)break;o=a}o!==null&&i.stopPropagation()}else Js(e,t,i,null,n)}}var Go=null;function Ma(e,t,n,i){if(Go=null,e=kl(i),e=ei(e),e!==null)if(t=gi(e),t===null)e=null;else if(n=t.tag,n===13){if(e=rd(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Go=e,null}function _d(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mp()){case Il:return 1;case ld:return 4;case Vo:case _p:return 16;case cd:return 536870912;default:return 16}default:return 16}}var kn=null,Al=null,To=null;function vd(){if(To)return To;var e,t=Al,n=t.length,i,o="value"in kn?kn.value:kn.textContent,a=o.length;for(e=0;e<n&&t[e]===o[e];e++);var d=n-e;for(i=1;i<=d&&t[n-i]===o[a-i];i++);return To=o.slice(e,1<i?1-i:void 0)}function ko(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function co(){return!0}function Gc(){return!1}function Rt(e){function t(n,i,o,a,d){this._reactName=n,this._targetInst=o,this.type=i,this.nativeEvent=a,this.target=d,this.currentTarget=null;for(var _ in e)e.hasOwnProperty(_)&&(n=e[_],this[_]=n?n(a):a[_]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?co:Gc,this.isPropagationStopped=Gc,this}return Ge(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=co)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=co)},persist:function(){},isPersistent:co}),t}var ir={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Dl=Rt(ir),qr=Ge({},ir,{view:0,detail:0}),Lp=Rt(qr),Us,Gs,fr,ys=Ge({},qr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ml,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==fr&&(fr&&e.type==="mousemove"?(Us=e.screenX-fr.screenX,Gs=e.screenY-fr.screenY):Gs=Us=0,fr=e),Us)},movementY:function(e){return"movementY"in e?e.movementY:Gs}}),Hc=Rt(ys),Rp=Ge({},ys,{dataTransfer:0}),Ap=Rt(Rp),Dp=Ge({},qr,{relatedTarget:0}),Hs=Rt(Dp),Mp=Ge({},ir,{animationName:0,elapsedTime:0,pseudoElement:0}),Fp=Rt(Mp),Pp=Ge({},ir,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Np=Rt(Pp),Bp=Ge({},ir,{data:0}),zc=Rt(Bp),jp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wp={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Up(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Wp[e])?!!t[e]:!1}function Ml(){return Up}var Gp=Ge({},qr,{key:function(e){if(e.key){var t=jp[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ko(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Vp[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ml,charCode:function(e){return e.type==="keypress"?ko(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ko(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Hp=Rt(Gp),zp=Ge({},ys,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yc=Rt(zp),Yp=Ge({},qr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ml}),Xp=Rt(Yp),$p=Ge({},ir,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zp=Rt($p),Kp=Ge({},ys,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Jp=Rt(Kp),Qp=[9,13,27,32],Fl=dn&&"CompositionEvent"in window,Tr=null;dn&&"documentMode"in document&&(Tr=document.documentMode);var qp=dn&&"TextEvent"in window&&!Tr,yd=dn&&(!Fl||Tr&&8<Tr&&11>=Tr),Xc=String.fromCharCode(32),$c=!1;function Sd(e,t){switch(e){case"keyup":return Qp.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wd(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ri=!1;function em(e,t){switch(e){case"compositionend":return wd(t);case"keypress":return t.which!==32?null:($c=!0,Xc);case"textInput":return e=t.data,e===Xc&&$c?null:e;default:return null}}function tm(e,t){if(Ri)return e==="compositionend"||!Fl&&Sd(e,t)?(e=vd(),To=Al=kn=null,Ri=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return yd&&t.locale!=="ko"?null:t.data;default:return null}}var nm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!nm[e.type]:t==="textarea"}function Cd(e,t,n,i){qh(i),t=Ho(t,"onChange"),0<t.length&&(n=new Dl("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var kr=null,jr=null;function im(e){Dd(e,0)}function Ss(e){var t=Mi(e);if(Yh(t))return e}function rm(e,t){if(e==="change")return t}var xd=!1;if(dn){var zs;if(dn){var Ys="oninput"in document;if(!Ys){var Kc=document.createElement("div");Kc.setAttribute("oninput","return;"),Ys=typeof Kc.oninput=="function"}zs=Ys}else zs=!1;xd=zs&&(!document.documentMode||9<document.documentMode)}function Jc(){kr&&(kr.detachEvent("onpropertychange",bd),jr=kr=null)}function bd(e){if(e.propertyName==="value"&&Ss(jr)){var t=[];Cd(t,jr,e,kl(e)),id(im,t)}}function om(e,t,n){e==="focusin"?(Jc(),kr=t,jr=n,kr.attachEvent("onpropertychange",bd)):e==="focusout"&&Jc()}function sm(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ss(jr)}function am(e,t){if(e==="click")return Ss(t)}function lm(e,t){if(e==="input"||e==="change")return Ss(t)}function cm(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Yt=typeof Object.is=="function"?Object.is:cm;function Vr(e,t){if(Yt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var o=n[i];if(!ma.call(t,o)||!Yt(e[o],t[o]))return!1}return!0}function Qc(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function qc(e,t){var n=Qc(e);e=0;for(var i;n;){if(n.nodeType===3){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Qc(n)}}function Ed(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ed(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Td(){for(var e=window,t=No();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=No(e.document)}return t}function Pl(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function um(e){var t=Td(),n=e.focusedElem,i=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Ed(n.ownerDocument.documentElement,n)){if(i!==null&&Pl(n)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,a=Math.min(i.start,o);i=i.end===void 0?a:Math.min(i.end,o),!e.extend&&a>i&&(o=i,i=a,a=o),o=qc(n,a);var d=qc(n,i);o&&d&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==d.node||e.focusOffset!==d.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),a>i?(e.addRange(t),e.extend(d.node,d.offset)):(t.setEnd(d.node,d.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var hm=dn&&"documentMode"in document&&11>=document.documentMode,Ai=null,Fa=null,Ir=null,Pa=!1;function eu(e,t,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Pa||Ai==null||Ai!==No(i)||(i=Ai,"selectionStart"in i&&Pl(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Ir&&Vr(Ir,i)||(Ir=i,i=Ho(Fa,"onSelect"),0<i.length&&(t=new Dl("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=Ai)))}function uo(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Di={animationend:uo("Animation","AnimationEnd"),animationiteration:uo("Animation","AnimationIteration"),animationstart:uo("Animation","AnimationStart"),transitionend:uo("Transition","TransitionEnd")},Xs={},kd={};dn&&(kd=document.createElement("div").style,"AnimationEvent"in window||(delete Di.animationend.animation,delete Di.animationiteration.animation,delete Di.animationstart.animation),"TransitionEvent"in window||delete Di.transitionend.transition);function ws(e){if(Xs[e])return Xs[e];if(!Di[e])return e;var t=Di[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in kd)return Xs[e]=t[n];return e}var Id=ws("animationend"),Od=ws("animationiteration"),Ld=ws("animationstart"),Rd=ws("transitionend"),Ad=new Map,tu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Un(e,t){Ad.set(e,t),fi(t,[e])}for(var $s=0;$s<tu.length;$s++){var Zs=tu[$s],dm=Zs.toLowerCase(),fm=Zs[0].toUpperCase()+Zs.slice(1);Un(dm,"on"+fm)}Un(Id,"onAnimationEnd");Un(Od,"onAnimationIteration");Un(Ld,"onAnimationStart");Un("dblclick","onDoubleClick");Un("focusin","onFocus");Un("focusout","onBlur");Un(Rd,"onTransitionEnd");$i("onMouseEnter",["mouseout","mouseover"]);$i("onMouseLeave",["mouseout","mouseover"]);$i("onPointerEnter",["pointerout","pointerover"]);$i("onPointerLeave",["pointerout","pointerover"]);fi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fi("onBeforeInput",["compositionend","keypress","textInput","paste"]);fi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var xr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gm=new Set("cancel close invalid load scroll toggle".split(" ").concat(xr));function nu(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,dp(i,t,void 0,e),e.currentTarget=null}function Dd(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var i=e[n],o=i.event;i=i.listeners;e:{var a=void 0;if(t)for(var d=i.length-1;0<=d;d--){var _=i[d],y=_.instance,w=_.currentTarget;if(_=_.listener,y!==a&&o.isPropagationStopped())break e;nu(o,_,w),a=y}else for(d=0;d<i.length;d++){if(_=i[d],y=_.instance,w=_.currentTarget,_=_.listener,y!==a&&o.isPropagationStopped())break e;nu(o,_,w),a=y}}}if(jo)throw e=Ra,jo=!1,Ra=null,e}function Ne(e,t){var n=t[Wa];n===void 0&&(n=t[Wa]=new Set);var i=e+"__bubble";n.has(i)||(Md(t,e,2,!1),n.add(i))}function Ks(e,t,n){var i=0;t&&(i|=4),Md(n,e,i,t)}var ho="_reactListening"+Math.random().toString(36).slice(2);function Wr(e){if(!e[ho]){e[ho]=!0,Wh.forEach(function(n){n!=="selectionchange"&&(gm.has(n)||Ks(n,!1,e),Ks(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ho]||(t[ho]=!0,Ks("selectionchange",!1,t))}}function Md(e,t,n,i){switch(_d(t)){case 1:var o=Ip;break;case 4:o=Op;break;default:o=Rl}n=o.bind(null,t,n,e),o=void 0,!La||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),i?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Js(e,t,n,i,o){var a=i;if(!(t&1)&&!(t&2)&&i!==null)e:for(;;){if(i===null)return;var d=i.tag;if(d===3||d===4){var _=i.stateNode.containerInfo;if(_===o||_.nodeType===8&&_.parentNode===o)break;if(d===4)for(d=i.return;d!==null;){var y=d.tag;if((y===3||y===4)&&(y=d.stateNode.containerInfo,y===o||y.nodeType===8&&y.parentNode===o))return;d=d.return}for(;_!==null;){if(d=ei(_),d===null)return;if(y=d.tag,y===5||y===6){i=a=d;continue e}_=_.parentNode}}i=i.return}id(function(){var w=a,x=kl(n),T=[];e:{var E=Ad.get(e);if(E!==void 0){var M=Dl,F=e;switch(e){case"keypress":if(ko(n)===0)break e;case"keydown":case"keyup":M=Hp;break;case"focusin":F="focus",M=Hs;break;case"focusout":F="blur",M=Hs;break;case"beforeblur":case"afterblur":M=Hs;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":M=Hc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":M=Ap;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":M=Xp;break;case Id:case Od:case Ld:M=Fp;break;case Rd:M=Zp;break;case"scroll":M=Lp;break;case"wheel":M=Jp;break;case"copy":case"cut":case"paste":M=Np;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":M=Yc}var P=(t&4)!==0,B=!P&&e==="scroll",D=P?E!==null?E+"Capture":null:E;P=[];for(var O=w,A;O!==null;){A=O;var Y=A.stateNode;if(A.tag===5&&Y!==null&&(A=Y,D!==null&&(Y=Fr(O,D),Y!=null&&P.push(Ur(O,Y,A)))),B)break;O=O.return}0<P.length&&(E=new M(E,F,null,n,x),T.push({event:E,listeners:P}))}}if(!(t&7)){e:{if(E=e==="mouseover"||e==="pointerover",M=e==="mouseout"||e==="pointerout",E&&n!==Ia&&(F=n.relatedTarget||n.fromElement)&&(ei(F)||F[fn]))break e;if((M||E)&&(E=x.window===x?x:(E=x.ownerDocument)?E.defaultView||E.parentWindow:window,M?(F=n.relatedTarget||n.toElement,M=w,F=F?ei(F):null,F!==null&&(B=gi(F),F!==B||F.tag!==5&&F.tag!==6)&&(F=null)):(M=null,F=w),M!==F)){if(P=Hc,Y="onMouseLeave",D="onMouseEnter",O="mouse",(e==="pointerout"||e==="pointerover")&&(P=Yc,Y="onPointerLeave",D="onPointerEnter",O="pointer"),B=M==null?E:Mi(M),A=F==null?E:Mi(F),E=new P(Y,O+"leave",M,n,x),E.target=B,E.relatedTarget=A,Y=null,ei(x)===w&&(P=new P(D,O+"enter",F,n,x),P.target=A,P.relatedTarget=B,Y=P),B=Y,M&&F)t:{for(P=M,D=F,O=0,A=P;A;A=Ii(A))O++;for(A=0,Y=D;Y;Y=Ii(Y))A++;for(;0<O-A;)P=Ii(P),O--;for(;0<A-O;)D=Ii(D),A--;for(;O--;){if(P===D||D!==null&&P===D.alternate)break t;P=Ii(P),D=Ii(D)}P=null}else P=null;M!==null&&iu(T,E,M,P,!1),F!==null&&B!==null&&iu(T,B,F,P,!0)}}e:{if(E=w?Mi(w):window,M=E.nodeName&&E.nodeName.toLowerCase(),M==="select"||M==="input"&&E.type==="file")var ne=rm;else if(Zc(E))if(xd)ne=lm;else{ne=sm;var oe=om}else(M=E.nodeName)&&M.toLowerCase()==="input"&&(E.type==="checkbox"||E.type==="radio")&&(ne=am);if(ne&&(ne=ne(e,w))){Cd(T,ne,n,x);break e}oe&&oe(e,E,w),e==="focusout"&&(oe=E._wrapperState)&&oe.controlled&&E.type==="number"&&xa(E,"number",E.value)}switch(oe=w?Mi(w):window,e){case"focusin":(Zc(oe)||oe.contentEditable==="true")&&(Ai=oe,Fa=w,Ir=null);break;case"focusout":Ir=Fa=Ai=null;break;case"mousedown":Pa=!0;break;case"contextmenu":case"mouseup":case"dragend":Pa=!1,eu(T,n,x);break;case"selectionchange":if(hm)break;case"keydown":case"keyup":eu(T,n,x)}var K;if(Fl)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Ri?Sd(e,n)&&(S="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(S="onCompositionStart");S&&(yd&&n.locale!=="ko"&&(Ri||S!=="onCompositionStart"?S==="onCompositionEnd"&&Ri&&(K=vd()):(kn=x,Al="value"in kn?kn.value:kn.textContent,Ri=!0)),oe=Ho(w,S),0<oe.length&&(S=new zc(S,e,null,n,x),T.push({event:S,listeners:oe}),K?S.data=K:(K=wd(n),K!==null&&(S.data=K)))),(K=qp?em(e,n):tm(e,n))&&(w=Ho(w,"onBeforeInput"),0<w.length&&(x=new zc("onBeforeInput","beforeinput",null,n,x),T.push({event:x,listeners:w}),x.data=K))}Dd(T,t)})}function Ur(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ho(e,t){for(var n=t+"Capture",i=[];e!==null;){var o=e,a=o.stateNode;o.tag===5&&a!==null&&(o=a,a=Fr(e,n),a!=null&&i.unshift(Ur(e,a,o)),a=Fr(e,t),a!=null&&i.push(Ur(e,a,o))),e=e.return}return i}function Ii(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function iu(e,t,n,i,o){for(var a=t._reactName,d=[];n!==null&&n!==i;){var _=n,y=_.alternate,w=_.stateNode;if(y!==null&&y===i)break;_.tag===5&&w!==null&&(_=w,o?(y=Fr(n,a),y!=null&&d.unshift(Ur(n,y,_))):o||(y=Fr(n,a),y!=null&&d.push(Ur(n,y,_)))),n=n.return}d.length!==0&&e.push({event:t,listeners:d})}var pm=/\r\n?/g,mm=/\u0000|\uFFFD/g;function ru(e){return(typeof e=="string"?e:""+e).replace(pm,`
`).replace(mm,"")}function fo(e,t,n){if(t=ru(t),ru(e)!==t&&n)throw Error(de(425))}function zo(){}var Na=null,Ba=null;function ja(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Va=typeof setTimeout=="function"?setTimeout:void 0,_m=typeof clearTimeout=="function"?clearTimeout:void 0,ou=typeof Promise=="function"?Promise:void 0,vm=typeof queueMicrotask=="function"?queueMicrotask:typeof ou<"u"?function(e){return ou.resolve(null).then(e).catch(ym)}:Va;function ym(e){setTimeout(function(){throw e})}function Qs(e,t){var n=t,i=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(i===0){e.removeChild(o),Br(t);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=o}while(n);Br(t)}function Dn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function su(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var rr=Math.random().toString(36).slice(2),Zt="__reactFiber$"+rr,Gr="__reactProps$"+rr,fn="__reactContainer$"+rr,Wa="__reactEvents$"+rr,Sm="__reactListeners$"+rr,wm="__reactHandles$"+rr;function ei(e){var t=e[Zt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fn]||n[Zt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=su(e);e!==null;){if(n=e[Zt])return n;e=su(e)}return t}e=n,n=e.parentNode}return null}function eo(e){return e=e[Zt]||e[fn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Mi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(de(33))}function Cs(e){return e[Gr]||null}var Ua=[],Fi=-1;function Gn(e){return{current:e}}function je(e){0>Fi||(e.current=Ua[Fi],Ua[Fi]=null,Fi--)}function Fe(e,t){Fi++,Ua[Fi]=e.current,e.current=t}var Vn={},ct=Gn(Vn),vt=Gn(!1),li=Vn;function Zi(e,t){var n=e.type.contextTypes;if(!n)return Vn;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var o={},a;for(a in n)o[a]=t[a];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function yt(e){return e=e.childContextTypes,e!=null}function Yo(){je(vt),je(ct)}function au(e,t,n){if(ct.current!==Vn)throw Error(de(168));Fe(ct,t),Fe(vt,n)}function Fd(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var o in i)if(!(o in t))throw Error(de(108,op(e)||"Unknown",o));return Ge({},n,i)}function Xo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vn,li=ct.current,Fe(ct,e),Fe(vt,vt.current),!0}function lu(e,t,n){var i=e.stateNode;if(!i)throw Error(de(169));n?(e=Fd(e,t,li),i.__reactInternalMemoizedMergedChildContext=e,je(vt),je(ct),Fe(ct,e)):je(vt),Fe(vt,n)}var sn=null,xs=!1,qs=!1;function Pd(e){sn===null?sn=[e]:sn.push(e)}function Cm(e){xs=!0,Pd(e)}function Hn(){if(!qs&&sn!==null){qs=!0;var e=0,t=De;try{var n=sn;for(De=1;e<n.length;e++){var i=n[e];do i=i(!0);while(i!==null)}sn=null,xs=!1}catch(o){throw sn!==null&&(sn=sn.slice(e+1)),ad(Il,Hn),o}finally{De=t,qs=!1}}return null}var Pi=[],Ni=0,$o=null,Zo=0,At=[],Dt=0,ci=null,cn=1,un="";function Qn(e,t){Pi[Ni++]=Zo,Pi[Ni++]=$o,$o=e,Zo=t}function Nd(e,t,n){At[Dt++]=cn,At[Dt++]=un,At[Dt++]=ci,ci=e;var i=cn;e=un;var o=32-Ht(i)-1;i&=~(1<<o),n+=1;var a=32-Ht(t)+o;if(30<a){var d=o-o%5;a=(i&(1<<d)-1).toString(32),i>>=d,o-=d,cn=1<<32-Ht(t)+o|n<<o|i,un=a+e}else cn=1<<a|n<<o|i,un=e}function Nl(e){e.return!==null&&(Qn(e,1),Nd(e,1,0))}function Bl(e){for(;e===$o;)$o=Pi[--Ni],Pi[Ni]=null,Zo=Pi[--Ni],Pi[Ni]=null;for(;e===ci;)ci=At[--Dt],At[Dt]=null,un=At[--Dt],At[Dt]=null,cn=At[--Dt],At[Dt]=null}var It=null,kt=null,Ve=!1,Ut=null;function Bd(e,t){var n=Mt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function cu(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,It=e,kt=Dn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,It=e,kt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ci!==null?{id:cn,overflow:un}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Mt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,It=e,kt=null,!0):!1;default:return!1}}function Ga(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ha(e){if(Ve){var t=kt;if(t){var n=t;if(!cu(e,t)){if(Ga(e))throw Error(de(418));t=Dn(n.nextSibling);var i=It;t&&cu(e,t)?Bd(i,n):(e.flags=e.flags&-4097|2,Ve=!1,It=e)}}else{if(Ga(e))throw Error(de(418));e.flags=e.flags&-4097|2,Ve=!1,It=e}}}function uu(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;It=e}function go(e){if(e!==It)return!1;if(!Ve)return uu(e),Ve=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ja(e.type,e.memoizedProps)),t&&(t=kt)){if(Ga(e))throw jd(),Error(de(418));for(;t;)Bd(e,t),t=Dn(t.nextSibling)}if(uu(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(de(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){kt=Dn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}kt=null}}else kt=It?Dn(e.stateNode.nextSibling):null;return!0}function jd(){for(var e=kt;e;)e=Dn(e.nextSibling)}function Ki(){kt=It=null,Ve=!1}function jl(e){Ut===null?Ut=[e]:Ut.push(e)}var xm=_n.ReactCurrentBatchConfig;function Vt(e,t){if(e&&e.defaultProps){t=Ge({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}var Ko=Gn(null),Jo=null,Bi=null,Vl=null;function Wl(){Vl=Bi=Jo=null}function Ul(e){var t=Ko.current;je(Ko),e._currentValue=t}function za(e,t,n){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function Yi(e,t){Jo=e,Vl=Bi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(_t=!0),e.firstContext=null)}function Pt(e){var t=e._currentValue;if(Vl!==e)if(e={context:e,memoizedValue:t,next:null},Bi===null){if(Jo===null)throw Error(de(308));Bi=e,Jo.dependencies={lanes:0,firstContext:e}}else Bi=Bi.next=e;return t}var ti=null;function Gl(e){ti===null?ti=[e]:ti.push(e)}function Vd(e,t,n,i){var o=t.interleaved;return o===null?(n.next=n,Gl(t)):(n.next=o.next,o.next=n),t.interleaved=n,gn(e,i)}function gn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var bn=!1;function Hl(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Wd(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function hn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Mn(e,t,n){var i=e.updateQueue;if(i===null)return null;if(i=i.shared,Re&2){var o=i.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),i.pending=t,gn(e,n)}return o=i.interleaved,o===null?(t.next=t,Gl(i)):(t.next=o.next,o.next=t),i.interleaved=t,gn(e,n)}function Io(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,Ol(e,n)}}function hu(e,t){var n=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var o=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var d={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?o=a=d:a=a.next=d,n=n.next}while(n!==null);a===null?o=a=t:a=a.next=t}else o=a=t;n={baseState:i.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:i.shared,effects:i.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Qo(e,t,n,i){var o=e.updateQueue;bn=!1;var a=o.firstBaseUpdate,d=o.lastBaseUpdate,_=o.shared.pending;if(_!==null){o.shared.pending=null;var y=_,w=y.next;y.next=null,d===null?a=w:d.next=w,d=y;var x=e.alternate;x!==null&&(x=x.updateQueue,_=x.lastBaseUpdate,_!==d&&(_===null?x.firstBaseUpdate=w:_.next=w,x.lastBaseUpdate=y))}if(a!==null){var T=o.baseState;d=0,x=w=y=null,_=a;do{var E=_.lane,M=_.eventTime;if((i&E)===E){x!==null&&(x=x.next={eventTime:M,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});e:{var F=e,P=_;switch(E=t,M=n,P.tag){case 1:if(F=P.payload,typeof F=="function"){T=F.call(M,T,E);break e}T=F;break e;case 3:F.flags=F.flags&-65537|128;case 0:if(F=P.payload,E=typeof F=="function"?F.call(M,T,E):F,E==null)break e;T=Ge({},T,E);break e;case 2:bn=!0}}_.callback!==null&&_.lane!==0&&(e.flags|=64,E=o.effects,E===null?o.effects=[_]:E.push(_))}else M={eventTime:M,lane:E,tag:_.tag,payload:_.payload,callback:_.callback,next:null},x===null?(w=x=M,y=T):x=x.next=M,d|=E;if(_=_.next,_===null){if(_=o.shared.pending,_===null)break;E=_,_=E.next,E.next=null,o.lastBaseUpdate=E,o.shared.pending=null}}while(1);if(x===null&&(y=T),o.baseState=y,o.firstBaseUpdate=w,o.lastBaseUpdate=x,t=o.shared.interleaved,t!==null){o=t;do d|=o.lane,o=o.next;while(o!==t)}else a===null&&(o.shared.lanes=0);hi|=d,e.lanes=d,e.memoizedState=T}}function du(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],o=i.callback;if(o!==null){if(i.callback=null,i=n,typeof o!="function")throw Error(de(191,o));o.call(i)}}}var Ud=new Vh.Component().refs;function Ya(e,t,n,i){t=e.memoizedState,n=n(i,t),n=n==null?t:Ge({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var bs={isMounted:function(e){return(e=e._reactInternals)?gi(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var i=dt(),o=Pn(e),a=hn(i,o);a.payload=t,n!=null&&(a.callback=n),t=Mn(e,a,o),t!==null&&(zt(t,e,o,i),Io(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=dt(),o=Pn(e),a=hn(i,o);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=Mn(e,a,o),t!==null&&(zt(t,e,o,i),Io(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=dt(),i=Pn(e),o=hn(n,i);o.tag=2,t!=null&&(o.callback=t),t=Mn(e,o,i),t!==null&&(zt(t,e,i,n),Io(t,e,i))}};function fu(e,t,n,i,o,a,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,a,d):t.prototype&&t.prototype.isPureReactComponent?!Vr(n,i)||!Vr(o,a):!0}function Gd(e,t,n){var i=!1,o=Vn,a=t.contextType;return typeof a=="object"&&a!==null?a=Pt(a):(o=yt(t)?li:ct.current,i=t.contextTypes,a=(i=i!=null)?Zi(e,o):Vn),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=bs,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=a),t}function gu(e,t,n,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&bs.enqueueReplaceState(t,t.state,null)}function Xa(e,t,n,i){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs=Ud,Hl(e);var a=t.contextType;typeof a=="object"&&a!==null?o.context=Pt(a):(a=yt(t)?li:ct.current,o.context=Zi(e,a)),o.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Ya(e,t,a,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&bs.enqueueReplaceState(o,o.state,null),Qo(e,n,o,i),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function gr(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(de(309));var i=n.stateNode}if(!i)throw Error(de(147,e));var o=i,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(d){var _=o.refs;_===Ud&&(_=o.refs={}),d===null?delete _[a]:_[a]=d},t._stringRef=a,t)}if(typeof e!="string")throw Error(de(284));if(!n._owner)throw Error(de(290,e))}return e}function po(e,t){throw e=Object.prototype.toString.call(t),Error(de(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function pu(e){var t=e._init;return t(e._payload)}function Hd(e){function t(D,O){if(e){var A=D.deletions;A===null?(D.deletions=[O],D.flags|=16):A.push(O)}}function n(D,O){if(!e)return null;for(;O!==null;)t(D,O),O=O.sibling;return null}function i(D,O){for(D=new Map;O!==null;)O.key!==null?D.set(O.key,O):D.set(O.index,O),O=O.sibling;return D}function o(D,O){return D=Nn(D,O),D.index=0,D.sibling=null,D}function a(D,O,A){return D.index=A,e?(A=D.alternate,A!==null?(A=A.index,A<O?(D.flags|=2,O):A):(D.flags|=2,O)):(D.flags|=1048576,O)}function d(D){return e&&D.alternate===null&&(D.flags|=2),D}function _(D,O,A,Y){return O===null||O.tag!==6?(O=sa(A,D.mode,Y),O.return=D,O):(O=o(O,A),O.return=D,O)}function y(D,O,A,Y){var ne=A.type;return ne===Li?x(D,O,A.props.children,Y,A.key):O!==null&&(O.elementType===ne||typeof ne=="object"&&ne!==null&&ne.$$typeof===xn&&pu(ne)===O.type)?(Y=o(O,A.props),Y.ref=gr(D,O,A),Y.return=D,Y):(Y=Mo(A.type,A.key,A.props,null,D.mode,Y),Y.ref=gr(D,O,A),Y.return=D,Y)}function w(D,O,A,Y){return O===null||O.tag!==4||O.stateNode.containerInfo!==A.containerInfo||O.stateNode.implementation!==A.implementation?(O=aa(A,D.mode,Y),O.return=D,O):(O=o(O,A.children||[]),O.return=D,O)}function x(D,O,A,Y,ne){return O===null||O.tag!==7?(O=oi(A,D.mode,Y,ne),O.return=D,O):(O=o(O,A),O.return=D,O)}function T(D,O,A){if(typeof O=="string"&&O!==""||typeof O=="number")return O=sa(""+O,D.mode,A),O.return=D,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case io:return A=Mo(O.type,O.key,O.props,null,D.mode,A),A.ref=gr(D,null,O),A.return=D,A;case Oi:return O=aa(O,D.mode,A),O.return=D,O;case xn:var Y=O._init;return T(D,Y(O._payload),A)}if(wr(O)||cr(O))return O=oi(O,D.mode,A,null),O.return=D,O;po(D,O)}return null}function E(D,O,A,Y){var ne=O!==null?O.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return ne!==null?null:_(D,O,""+A,Y);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case io:return A.key===ne?y(D,O,A,Y):null;case Oi:return A.key===ne?w(D,O,A,Y):null;case xn:return ne=A._init,E(D,O,ne(A._payload),Y)}if(wr(A)||cr(A))return ne!==null?null:x(D,O,A,Y,null);po(D,A)}return null}function M(D,O,A,Y,ne){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return D=D.get(A)||null,_(O,D,""+Y,ne);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case io:return D=D.get(Y.key===null?A:Y.key)||null,y(O,D,Y,ne);case Oi:return D=D.get(Y.key===null?A:Y.key)||null,w(O,D,Y,ne);case xn:var oe=Y._init;return M(D,O,A,oe(Y._payload),ne)}if(wr(Y)||cr(Y))return D=D.get(A)||null,x(O,D,Y,ne,null);po(O,Y)}return null}function F(D,O,A,Y){for(var ne=null,oe=null,K=O,S=O=0,ue=null;K!==null&&S<A.length;S++){K.index>S?(ue=K,K=null):ue=K.sibling;var le=E(D,K,A[S],Y);if(le===null){K===null&&(K=ue);break}e&&K&&le.alternate===null&&t(D,K),O=a(le,O,S),oe===null?ne=le:oe.sibling=le,oe=le,K=ue}if(S===A.length)return n(D,K),Ve&&Qn(D,S),ne;if(K===null){for(;S<A.length;S++)K=T(D,A[S],Y),K!==null&&(O=a(K,O,S),oe===null?ne=K:oe.sibling=K,oe=K);return Ve&&Qn(D,S),ne}for(K=i(D,K);S<A.length;S++)ue=M(K,D,S,A[S],Y),ue!==null&&(e&&ue.alternate!==null&&K.delete(ue.key===null?S:ue.key),O=a(ue,O,S),oe===null?ne=ue:oe.sibling=ue,oe=ue);return e&&K.forEach(function(Ce){return t(D,Ce)}),Ve&&Qn(D,S),ne}function P(D,O,A,Y){var ne=cr(A);if(typeof ne!="function")throw Error(de(150));if(A=ne.call(A),A==null)throw Error(de(151));for(var oe=ne=null,K=O,S=O=0,ue=null,le=A.next();K!==null&&!le.done;S++,le=A.next()){K.index>S?(ue=K,K=null):ue=K.sibling;var Ce=E(D,K,le.value,Y);if(Ce===null){K===null&&(K=ue);break}e&&K&&Ce.alternate===null&&t(D,K),O=a(Ce,O,S),oe===null?ne=Ce:oe.sibling=Ce,oe=Ce,K=ue}if(le.done)return n(D,K),Ve&&Qn(D,S),ne;if(K===null){for(;!le.done;S++,le=A.next())le=T(D,le.value,Y),le!==null&&(O=a(le,O,S),oe===null?ne=le:oe.sibling=le,oe=le);return Ve&&Qn(D,S),ne}for(K=i(D,K);!le.done;S++,le=A.next())le=M(K,D,S,le.value,Y),le!==null&&(e&&le.alternate!==null&&K.delete(le.key===null?S:le.key),O=a(le,O,S),oe===null?ne=le:oe.sibling=le,oe=le);return e&&K.forEach(function(h){return t(D,h)}),Ve&&Qn(D,S),ne}function B(D,O,A,Y){if(typeof A=="object"&&A!==null&&A.type===Li&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case io:e:{for(var ne=A.key,oe=O;oe!==null;){if(oe.key===ne){if(ne=A.type,ne===Li){if(oe.tag===7){n(D,oe.sibling),O=o(oe,A.props.children),O.return=D,D=O;break e}}else if(oe.elementType===ne||typeof ne=="object"&&ne!==null&&ne.$$typeof===xn&&pu(ne)===oe.type){n(D,oe.sibling),O=o(oe,A.props),O.ref=gr(D,oe,A),O.return=D,D=O;break e}n(D,oe);break}else t(D,oe);oe=oe.sibling}A.type===Li?(O=oi(A.props.children,D.mode,Y,A.key),O.return=D,D=O):(Y=Mo(A.type,A.key,A.props,null,D.mode,Y),Y.ref=gr(D,O,A),Y.return=D,D=Y)}return d(D);case Oi:e:{for(oe=A.key;O!==null;){if(O.key===oe)if(O.tag===4&&O.stateNode.containerInfo===A.containerInfo&&O.stateNode.implementation===A.implementation){n(D,O.sibling),O=o(O,A.children||[]),O.return=D,D=O;break e}else{n(D,O);break}else t(D,O);O=O.sibling}O=aa(A,D.mode,Y),O.return=D,D=O}return d(D);case xn:return oe=A._init,B(D,O,oe(A._payload),Y)}if(wr(A))return F(D,O,A,Y);if(cr(A))return P(D,O,A,Y);po(D,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,O!==null&&O.tag===6?(n(D,O.sibling),O=o(O,A),O.return=D,D=O):(n(D,O),O=sa(A,D.mode,Y),O.return=D,D=O),d(D)):n(D,O)}return B}var Ji=Hd(!0),zd=Hd(!1),to={},Qt=Gn(to),Hr=Gn(to),zr=Gn(to);function ni(e){if(e===to)throw Error(de(174));return e}function zl(e,t){switch(Fe(zr,t),Fe(Hr,e),Fe(Qt,to),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ea(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ea(t,e)}je(Qt),Fe(Qt,t)}function Qi(){je(Qt),je(Hr),je(zr)}function Yd(e){ni(zr.current);var t=ni(Qt.current),n=Ea(t,e.type);t!==n&&(Fe(Hr,e),Fe(Qt,n))}function Yl(e){Hr.current===e&&(je(Qt),je(Hr))}var We=Gn(0);function qo(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ea=[];function Xl(){for(var e=0;e<ea.length;e++)ea[e]._workInProgressVersionPrimary=null;ea.length=0}var Oo=_n.ReactCurrentDispatcher,ta=_n.ReactCurrentBatchConfig,ui=0,Ue=null,Ze=null,qe=null,es=!1,Or=!1,Yr=0,bm=0;function ot(){throw Error(de(321))}function $l(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Yt(e[n],t[n]))return!1;return!0}function Zl(e,t,n,i,o,a){if(ui=a,Ue=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Oo.current=e===null||e.memoizedState===null?Im:Om,e=n(i,o),Or){a=0;do{if(Or=!1,Yr=0,25<=a)throw Error(de(301));a+=1,qe=Ze=null,t.updateQueue=null,Oo.current=Lm,e=n(i,o)}while(Or)}if(Oo.current=ts,t=Ze!==null&&Ze.next!==null,ui=0,qe=Ze=Ue=null,es=!1,t)throw Error(de(300));return e}function Kl(){var e=Yr!==0;return Yr=0,e}function $t(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qe===null?Ue.memoizedState=qe=e:qe=qe.next=e,qe}function Nt(){if(Ze===null){var e=Ue.alternate;e=e!==null?e.memoizedState:null}else e=Ze.next;var t=qe===null?Ue.memoizedState:qe.next;if(t!==null)qe=t,Ze=e;else{if(e===null)throw Error(de(310));Ze=e,e={memoizedState:Ze.memoizedState,baseState:Ze.baseState,baseQueue:Ze.baseQueue,queue:Ze.queue,next:null},qe===null?Ue.memoizedState=qe=e:qe=qe.next=e}return qe}function Xr(e,t){return typeof t=="function"?t(e):t}function na(e){var t=Nt(),n=t.queue;if(n===null)throw Error(de(311));n.lastRenderedReducer=e;var i=Ze,o=i.baseQueue,a=n.pending;if(a!==null){if(o!==null){var d=o.next;o.next=a.next,a.next=d}i.baseQueue=o=a,n.pending=null}if(o!==null){a=o.next,i=i.baseState;var _=d=null,y=null,w=a;do{var x=w.lane;if((ui&x)===x)y!==null&&(y=y.next={lane:0,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null}),i=w.hasEagerState?w.eagerState:e(i,w.action);else{var T={lane:x,action:w.action,hasEagerState:w.hasEagerState,eagerState:w.eagerState,next:null};y===null?(_=y=T,d=i):y=y.next=T,Ue.lanes|=x,hi|=x}w=w.next}while(w!==null&&w!==a);y===null?d=i:y.next=_,Yt(i,t.memoizedState)||(_t=!0),t.memoizedState=i,t.baseState=d,t.baseQueue=y,n.lastRenderedState=i}if(e=n.interleaved,e!==null){o=e;do a=o.lane,Ue.lanes|=a,hi|=a,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ia(e){var t=Nt(),n=t.queue;if(n===null)throw Error(de(311));n.lastRenderedReducer=e;var i=n.dispatch,o=n.pending,a=t.memoizedState;if(o!==null){n.pending=null;var d=o=o.next;do a=e(a,d.action),d=d.next;while(d!==o);Yt(a,t.memoizedState)||(_t=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,i]}function Xd(){}function $d(e,t){var n=Ue,i=Nt(),o=t(),a=!Yt(i.memoizedState,o);if(a&&(i.memoizedState=o,_t=!0),i=i.queue,Jl(Jd.bind(null,n,i,e),[e]),i.getSnapshot!==t||a||qe!==null&&qe.memoizedState.tag&1){if(n.flags|=2048,$r(9,Kd.bind(null,n,i,o,t),void 0,null),et===null)throw Error(de(349));ui&30||Zd(n,t,o)}return o}function Zd(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ue.updateQueue,t===null?(t={lastEffect:null,stores:null},Ue.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Kd(e,t,n,i){t.value=n,t.getSnapshot=i,Qd(t)&&qd(e)}function Jd(e,t,n){return n(function(){Qd(t)&&qd(e)})}function Qd(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Yt(e,n)}catch{return!0}}function qd(e){var t=gn(e,1);t!==null&&zt(t,e,1,-1)}function mu(e){var t=$t();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xr,lastRenderedState:e},t.queue=e,e=e.dispatch=km.bind(null,Ue,e),[t.memoizedState,e]}function $r(e,t,n,i){return e={tag:e,create:t,destroy:n,deps:i,next:null},t=Ue.updateQueue,t===null?(t={lastEffect:null,stores:null},Ue.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e)),e}function ef(){return Nt().memoizedState}function Lo(e,t,n,i){var o=$t();Ue.flags|=e,o.memoizedState=$r(1|t,n,void 0,i===void 0?null:i)}function Es(e,t,n,i){var o=Nt();i=i===void 0?null:i;var a=void 0;if(Ze!==null){var d=Ze.memoizedState;if(a=d.destroy,i!==null&&$l(i,d.deps)){o.memoizedState=$r(t,n,a,i);return}}Ue.flags|=e,o.memoizedState=$r(1|t,n,a,i)}function _u(e,t){return Lo(8390656,8,e,t)}function Jl(e,t){return Es(2048,8,e,t)}function tf(e,t){return Es(4,2,e,t)}function nf(e,t){return Es(4,4,e,t)}function rf(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function of(e,t,n){return n=n!=null?n.concat([e]):null,Es(4,4,rf.bind(null,t,e),n)}function Ql(){}function sf(e,t){var n=Nt();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&$l(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function af(e,t){var n=Nt();t=t===void 0?null:t;var i=n.memoizedState;return i!==null&&t!==null&&$l(t,i[1])?i[0]:(e=e(),n.memoizedState=[e,t],e)}function lf(e,t,n){return ui&21?(Yt(n,t)||(n=ud(),Ue.lanes|=n,hi|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,_t=!0),e.memoizedState=n)}function Em(e,t){var n=De;De=n!==0&&4>n?n:4,e(!0);var i=ta.transition;ta.transition={};try{e(!1),t()}finally{De=n,ta.transition=i}}function cf(){return Nt().memoizedState}function Tm(e,t,n){var i=Pn(e);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},uf(e))hf(t,n);else if(n=Vd(e,t,n,i),n!==null){var o=dt();zt(n,e,i,o),df(n,t,i)}}function km(e,t,n){var i=Pn(e),o={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(uf(e))hf(t,o);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var d=t.lastRenderedState,_=a(d,n);if(o.hasEagerState=!0,o.eagerState=_,Yt(_,d)){var y=t.interleaved;y===null?(o.next=o,Gl(t)):(o.next=y.next,y.next=o),t.interleaved=o;return}}catch{}finally{}n=Vd(e,t,o,i),n!==null&&(o=dt(),zt(n,e,i,o),df(n,t,i))}}function uf(e){var t=e.alternate;return e===Ue||t!==null&&t===Ue}function hf(e,t){Or=es=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function df(e,t,n){if(n&4194240){var i=t.lanes;i&=e.pendingLanes,n|=i,t.lanes=n,Ol(e,n)}}var ts={readContext:Pt,useCallback:ot,useContext:ot,useEffect:ot,useImperativeHandle:ot,useInsertionEffect:ot,useLayoutEffect:ot,useMemo:ot,useReducer:ot,useRef:ot,useState:ot,useDebugValue:ot,useDeferredValue:ot,useTransition:ot,useMutableSource:ot,useSyncExternalStore:ot,useId:ot,unstable_isNewReconciler:!1},Im={readContext:Pt,useCallback:function(e,t){return $t().memoizedState=[e,t===void 0?null:t],e},useContext:Pt,useEffect:_u,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Lo(4194308,4,rf.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Lo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Lo(4,2,e,t)},useMemo:function(e,t){var n=$t();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var i=$t();return t=n!==void 0?n(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=Tm.bind(null,Ue,e),[i.memoizedState,e]},useRef:function(e){var t=$t();return e={current:e},t.memoizedState=e},useState:mu,useDebugValue:Ql,useDeferredValue:function(e){return $t().memoizedState=e},useTransition:function(){var e=mu(!1),t=e[0];return e=Em.bind(null,e[1]),$t().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=Ue,o=$t();if(Ve){if(n===void 0)throw Error(de(407));n=n()}else{if(n=t(),et===null)throw Error(de(349));ui&30||Zd(i,t,n)}o.memoizedState=n;var a={value:n,getSnapshot:t};return o.queue=a,_u(Jd.bind(null,i,a,e),[e]),i.flags|=2048,$r(9,Kd.bind(null,i,a,n,t),void 0,null),n},useId:function(){var e=$t(),t=et.identifierPrefix;if(Ve){var n=un,i=cn;n=(i&~(1<<32-Ht(i)-1)).toString(32)+n,t=":"+t+"R"+n,n=Yr++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=bm++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Om={readContext:Pt,useCallback:sf,useContext:Pt,useEffect:Jl,useImperativeHandle:of,useInsertionEffect:tf,useLayoutEffect:nf,useMemo:af,useReducer:na,useRef:ef,useState:function(){return na(Xr)},useDebugValue:Ql,useDeferredValue:function(e){var t=Nt();return lf(t,Ze.memoizedState,e)},useTransition:function(){var e=na(Xr)[0],t=Nt().memoizedState;return[e,t]},useMutableSource:Xd,useSyncExternalStore:$d,useId:cf,unstable_isNewReconciler:!1},Lm={readContext:Pt,useCallback:sf,useContext:Pt,useEffect:Jl,useImperativeHandle:of,useInsertionEffect:tf,useLayoutEffect:nf,useMemo:af,useReducer:ia,useRef:ef,useState:function(){return ia(Xr)},useDebugValue:Ql,useDeferredValue:function(e){var t=Nt();return Ze===null?t.memoizedState=e:lf(t,Ze.memoizedState,e)},useTransition:function(){var e=ia(Xr)[0],t=Nt().memoizedState;return[e,t]},useMutableSource:Xd,useSyncExternalStore:$d,useId:cf,unstable_isNewReconciler:!1};function qi(e,t){try{var n="",i=t;do n+=rp(i),i=i.return;while(i);var o=n}catch(a){o=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:o,digest:null}}function ra(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function $a(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Rm=typeof WeakMap=="function"?WeakMap:Map;function ff(e,t,n){n=hn(-1,n),n.tag=3,n.payload={element:null};var i=t.value;return n.callback=function(){is||(is=!0,rl=i),$a(e,t)},n}function gf(e,t,n){n=hn(-1,n),n.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var o=t.value;n.payload=function(){return i(o)},n.callback=function(){$a(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){$a(e,t),typeof i!="function"&&(Fn===null?Fn=new Set([this]):Fn.add(this));var d=t.stack;this.componentDidCatch(t.value,{componentStack:d!==null?d:""})}),n}function vu(e,t,n){var i=e.pingCache;if(i===null){i=e.pingCache=new Rm;var o=new Set;i.set(t,o)}else o=i.get(t),o===void 0&&(o=new Set,i.set(t,o));o.has(n)||(o.add(n),e=zm.bind(null,e,t,n),t.then(e,e))}function yu(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Su(e,t,n,i,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=hn(-1,1),t.tag=2,Mn(n,t,1))),n.lanes|=1),e)}var Am=_n.ReactCurrentOwner,_t=!1;function ht(e,t,n,i){t.child=e===null?zd(t,null,n,i):Ji(t,e.child,n,i)}function wu(e,t,n,i,o){n=n.render;var a=t.ref;return Yi(t,o),i=Zl(e,t,n,i,a,o),n=Kl(),e!==null&&!_t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,pn(e,t,o)):(Ve&&n&&Nl(t),t.flags|=1,ht(e,t,i,o),t.child)}function Cu(e,t,n,i,o){if(e===null){var a=n.type;return typeof a=="function"&&!sc(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,pf(e,t,a,i,o)):(e=Mo(n.type,null,i,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&o)){var d=a.memoizedProps;if(n=n.compare,n=n!==null?n:Vr,n(d,i)&&e.ref===t.ref)return pn(e,t,o)}return t.flags|=1,e=Nn(a,i),e.ref=t.ref,e.return=t,t.child=e}function pf(e,t,n,i,o){if(e!==null){var a=e.memoizedProps;if(Vr(a,i)&&e.ref===t.ref)if(_t=!1,t.pendingProps=i=a,(e.lanes&o)!==0)e.flags&131072&&(_t=!0);else return t.lanes=e.lanes,pn(e,t,o)}return Za(e,t,n,i,o)}function mf(e,t,n){var i=t.pendingProps,o=i.children,a=e!==null?e.memoizedState:null;if(i.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fe(Vi,xt),xt|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Fe(Vi,xt),xt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=a!==null?a.baseLanes:n,Fe(Vi,xt),xt|=i}else a!==null?(i=a.baseLanes|n,t.memoizedState=null):i=n,Fe(Vi,xt),xt|=i;return ht(e,t,o,n),t.child}function _f(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Za(e,t,n,i,o){var a=yt(n)?li:ct.current;return a=Zi(t,a),Yi(t,o),n=Zl(e,t,n,i,a,o),i=Kl(),e!==null&&!_t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,pn(e,t,o)):(Ve&&i&&Nl(t),t.flags|=1,ht(e,t,n,o),t.child)}function xu(e,t,n,i,o){if(yt(n)){var a=!0;Xo(t)}else a=!1;if(Yi(t,o),t.stateNode===null)Ro(e,t),Gd(t,n,i),Xa(t,n,i,o),i=!0;else if(e===null){var d=t.stateNode,_=t.memoizedProps;d.props=_;var y=d.context,w=n.contextType;typeof w=="object"&&w!==null?w=Pt(w):(w=yt(n)?li:ct.current,w=Zi(t,w));var x=n.getDerivedStateFromProps,T=typeof x=="function"||typeof d.getSnapshotBeforeUpdate=="function";T||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(_!==i||y!==w)&&gu(t,d,i,w),bn=!1;var E=t.memoizedState;d.state=E,Qo(t,i,d,o),y=t.memoizedState,_!==i||E!==y||vt.current||bn?(typeof x=="function"&&(Ya(t,n,x,i),y=t.memoizedState),(_=bn||fu(t,n,_,i,E,y,w))?(T||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount()),typeof d.componentDidMount=="function"&&(t.flags|=4194308)):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=y),d.props=i,d.state=y,d.context=w,i=_):(typeof d.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{d=t.stateNode,Wd(e,t),_=t.memoizedProps,w=t.type===t.elementType?_:Vt(t.type,_),d.props=w,T=t.pendingProps,E=d.context,y=n.contextType,typeof y=="object"&&y!==null?y=Pt(y):(y=yt(n)?li:ct.current,y=Zi(t,y));var M=n.getDerivedStateFromProps;(x=typeof M=="function"||typeof d.getSnapshotBeforeUpdate=="function")||typeof d.UNSAFE_componentWillReceiveProps!="function"&&typeof d.componentWillReceiveProps!="function"||(_!==T||E!==y)&&gu(t,d,i,y),bn=!1,E=t.memoizedState,d.state=E,Qo(t,i,d,o);var F=t.memoizedState;_!==T||E!==F||vt.current||bn?(typeof M=="function"&&(Ya(t,n,M,i),F=t.memoizedState),(w=bn||fu(t,n,w,i,E,F,y)||!1)?(x||typeof d.UNSAFE_componentWillUpdate!="function"&&typeof d.componentWillUpdate!="function"||(typeof d.componentWillUpdate=="function"&&d.componentWillUpdate(i,F,y),typeof d.UNSAFE_componentWillUpdate=="function"&&d.UNSAFE_componentWillUpdate(i,F,y)),typeof d.componentDidUpdate=="function"&&(t.flags|=4),typeof d.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof d.componentDidUpdate!="function"||_===e.memoizedProps&&E===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&E===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=F),d.props=i,d.state=F,d.context=y,i=w):(typeof d.componentDidUpdate!="function"||_===e.memoizedProps&&E===e.memoizedState||(t.flags|=4),typeof d.getSnapshotBeforeUpdate!="function"||_===e.memoizedProps&&E===e.memoizedState||(t.flags|=1024),i=!1)}return Ka(e,t,n,i,a,o)}function Ka(e,t,n,i,o,a){_f(e,t);var d=(t.flags&128)!==0;if(!i&&!d)return o&&lu(t,n,!1),pn(e,t,a);i=t.stateNode,Am.current=t;var _=d&&typeof n.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&d?(t.child=Ji(t,e.child,null,a),t.child=Ji(t,null,_,a)):ht(e,t,_,a),t.memoizedState=i.state,o&&lu(t,n,!0),t.child}function vf(e){var t=e.stateNode;t.pendingContext?au(e,t.pendingContext,t.pendingContext!==t.context):t.context&&au(e,t.context,!1),zl(e,t.containerInfo)}function bu(e,t,n,i,o){return Ki(),jl(o),t.flags|=256,ht(e,t,n,i),t.child}var Ja={dehydrated:null,treeContext:null,retryLane:0};function Qa(e){return{baseLanes:e,cachePool:null,transitions:null}}function yf(e,t,n){var i=t.pendingProps,o=We.current,a=!1,d=(t.flags&128)!==0,_;if((_=d)||(_=e!==null&&e.memoizedState===null?!1:(o&2)!==0),_?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Fe(We,o&1),e===null)return Ha(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(d=i.children,e=i.fallback,a?(i=t.mode,a=t.child,d={mode:"hidden",children:d},!(i&1)&&a!==null?(a.childLanes=0,a.pendingProps=d):a=Is(d,i,0,null),e=oi(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Qa(n),t.memoizedState=Ja,e):ql(t,d));if(o=e.memoizedState,o!==null&&(_=o.dehydrated,_!==null))return Dm(e,t,d,i,_,o,n);if(a){a=i.fallback,d=t.mode,o=e.child,_=o.sibling;var y={mode:"hidden",children:i.children};return!(d&1)&&t.child!==o?(i=t.child,i.childLanes=0,i.pendingProps=y,t.deletions=null):(i=Nn(o,y),i.subtreeFlags=o.subtreeFlags&14680064),_!==null?a=Nn(_,a):(a=oi(a,d,n,null),a.flags|=2),a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,d=e.child.memoizedState,d=d===null?Qa(n):{baseLanes:d.baseLanes|n,cachePool:null,transitions:d.transitions},a.memoizedState=d,a.childLanes=e.childLanes&~n,t.memoizedState=Ja,i}return a=e.child,e=a.sibling,i=Nn(a,{mode:"visible",children:i.children}),!(t.mode&1)&&(i.lanes=n),i.return=t,i.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function ql(e,t){return t=Is({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function mo(e,t,n,i){return i!==null&&jl(i),Ji(t,e.child,null,n),e=ql(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Dm(e,t,n,i,o,a,d){if(n)return t.flags&256?(t.flags&=-257,i=ra(Error(de(422))),mo(e,t,d,i)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=i.fallback,o=t.mode,i=Is({mode:"visible",children:i.children},o,0,null),a=oi(a,o,d,null),a.flags|=2,i.return=t,a.return=t,i.sibling=a,t.child=i,t.mode&1&&Ji(t,e.child,null,d),t.child.memoizedState=Qa(d),t.memoizedState=Ja,a);if(!(t.mode&1))return mo(e,t,d,null);if(o.data==="$!"){if(i=o.nextSibling&&o.nextSibling.dataset,i)var _=i.dgst;return i=_,a=Error(de(419)),i=ra(a,i,void 0),mo(e,t,d,i)}if(_=(d&e.childLanes)!==0,_t||_){if(i=et,i!==null){switch(d&-d){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(i.suspendedLanes|d)?0:o,o!==0&&o!==a.retryLane&&(a.retryLane=o,gn(e,o),zt(i,e,o,-1))}return oc(),i=ra(Error(de(421))),mo(e,t,d,i)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=Ym.bind(null,e),o._reactRetry=t,null):(e=a.treeContext,kt=Dn(o.nextSibling),It=t,Ve=!0,Ut=null,e!==null&&(At[Dt++]=cn,At[Dt++]=un,At[Dt++]=ci,cn=e.id,un=e.overflow,ci=t),t=ql(t,i.children),t.flags|=4096,t)}function Eu(e,t,n){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),za(e.return,t,n)}function oa(e,t,n,i,o){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=n,a.tailMode=o)}function Sf(e,t,n){var i=t.pendingProps,o=i.revealOrder,a=i.tail;if(ht(e,t,i.children,n),i=We.current,i&2)i=i&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Eu(e,n,t);else if(e.tag===19)Eu(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if(Fe(We,i),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&qo(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),oa(t,!1,o,n,a);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&qo(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}oa(t,!0,n,null,a);break;case"together":oa(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ro(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function pn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),hi|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(de(153));if(t.child!==null){for(e=t.child,n=Nn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Nn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Mm(e,t,n){switch(t.tag){case 3:vf(t),Ki();break;case 5:Yd(t);break;case 1:yt(t.type)&&Xo(t);break;case 4:zl(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,o=t.memoizedProps.value;Fe(Ko,i._currentValue),i._currentValue=o;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?(Fe(We,We.current&1),t.flags|=128,null):n&t.child.childLanes?yf(e,t,n):(Fe(We,We.current&1),e=pn(e,t,n),e!==null?e.sibling:null);Fe(We,We.current&1);break;case 19:if(i=(n&t.childLanes)!==0,e.flags&128){if(i)return Sf(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Fe(We,We.current),i)break;return null;case 22:case 23:return t.lanes=0,mf(e,t,n)}return pn(e,t,n)}var wf,qa,Cf,xf;wf=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};qa=function(){};Cf=function(e,t,n,i){var o=e.memoizedProps;if(o!==i){e=t.stateNode,ni(Qt.current);var a=null;switch(n){case"input":o=wa(e,o),i=wa(e,i),a=[];break;case"select":o=Ge({},o,{value:void 0}),i=Ge({},i,{value:void 0}),a=[];break;case"textarea":o=ba(e,o),i=ba(e,i),a=[];break;default:typeof o.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=zo)}Ta(n,i);var d;n=null;for(w in o)if(!i.hasOwnProperty(w)&&o.hasOwnProperty(w)&&o[w]!=null)if(w==="style"){var _=o[w];for(d in _)_.hasOwnProperty(d)&&(n||(n={}),n[d]="")}else w!=="dangerouslySetInnerHTML"&&w!=="children"&&w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(Dr.hasOwnProperty(w)?a||(a=[]):(a=a||[]).push(w,null));for(w in i){var y=i[w];if(_=o!=null?o[w]:void 0,i.hasOwnProperty(w)&&y!==_&&(y!=null||_!=null))if(w==="style")if(_){for(d in _)!_.hasOwnProperty(d)||y&&y.hasOwnProperty(d)||(n||(n={}),n[d]="");for(d in y)y.hasOwnProperty(d)&&_[d]!==y[d]&&(n||(n={}),n[d]=y[d])}else n||(a||(a=[]),a.push(w,n)),n=y;else w==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,_=_?_.__html:void 0,y!=null&&_!==y&&(a=a||[]).push(w,y)):w==="children"?typeof y!="string"&&typeof y!="number"||(a=a||[]).push(w,""+y):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&(Dr.hasOwnProperty(w)?(y!=null&&w==="onScroll"&&Ne("scroll",e),a||_===y||(a=[])):(a=a||[]).push(w,y))}n&&(a=a||[]).push("style",n);var w=a;(t.updateQueue=w)&&(t.flags|=4)}};xf=function(e,t,n,i){n!==i&&(t.flags|=4)};function pr(e,t){if(!Ve)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function st(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,i=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags&14680064,i|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,i|=o.subtreeFlags,i|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function Fm(e,t,n){var i=t.pendingProps;switch(Bl(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return st(t),null;case 1:return yt(t.type)&&Yo(),st(t),null;case 3:return i=t.stateNode,Qi(),je(vt),je(ct),Xl(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(go(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ut!==null&&(al(Ut),Ut=null))),qa(e,t),st(t),null;case 5:Yl(t);var o=ni(zr.current);if(n=t.type,e!==null&&t.stateNode!=null)Cf(e,t,n,i,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(de(166));return st(t),null}if(e=ni(Qt.current),go(t)){i=t.stateNode,n=t.type;var a=t.memoizedProps;switch(i[Zt]=t,i[Gr]=a,e=(t.mode&1)!==0,n){case"dialog":Ne("cancel",i),Ne("close",i);break;case"iframe":case"object":case"embed":Ne("load",i);break;case"video":case"audio":for(o=0;o<xr.length;o++)Ne(xr[o],i);break;case"source":Ne("error",i);break;case"img":case"image":case"link":Ne("error",i),Ne("load",i);break;case"details":Ne("toggle",i);break;case"input":Mc(i,a),Ne("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!a.multiple},Ne("invalid",i);break;case"textarea":Pc(i,a),Ne("invalid",i)}Ta(n,a),o=null;for(var d in a)if(a.hasOwnProperty(d)){var _=a[d];d==="children"?typeof _=="string"?i.textContent!==_&&(a.suppressHydrationWarning!==!0&&fo(i.textContent,_,e),o=["children",_]):typeof _=="number"&&i.textContent!==""+_&&(a.suppressHydrationWarning!==!0&&fo(i.textContent,_,e),o=["children",""+_]):Dr.hasOwnProperty(d)&&_!=null&&d==="onScroll"&&Ne("scroll",i)}switch(n){case"input":ro(i),Fc(i,a,!0);break;case"textarea":ro(i),Nc(i);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(i.onclick=zo)}i=o,t.updateQueue=i,i!==null&&(t.flags|=4)}else{d=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Zh(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=d.createElement("div"),e.innerHTML="<script></script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=d.createElement(n,{is:i.is}):(e=d.createElement(n),n==="select"&&(d=e,i.multiple?d.multiple=!0:i.size&&(d.size=i.size))):e=d.createElementNS(e,n),e[Zt]=t,e[Gr]=i,wf(e,t,!1,!1),t.stateNode=e;e:{switch(d=ka(n,i),n){case"dialog":Ne("cancel",e),Ne("close",e),o=i;break;case"iframe":case"object":case"embed":Ne("load",e),o=i;break;case"video":case"audio":for(o=0;o<xr.length;o++)Ne(xr[o],e);o=i;break;case"source":Ne("error",e),o=i;break;case"img":case"image":case"link":Ne("error",e),Ne("load",e),o=i;break;case"details":Ne("toggle",e),o=i;break;case"input":Mc(e,i),o=wa(e,i),Ne("invalid",e);break;case"option":o=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},o=Ge({},i,{value:void 0}),Ne("invalid",e);break;case"textarea":Pc(e,i),o=ba(e,i),Ne("invalid",e);break;default:o=i}Ta(n,o),_=o;for(a in _)if(_.hasOwnProperty(a)){var y=_[a];a==="style"?Qh(e,y):a==="dangerouslySetInnerHTML"?(y=y?y.__html:void 0,y!=null&&Kh(e,y)):a==="children"?typeof y=="string"?(n!=="textarea"||y!=="")&&Mr(e,y):typeof y=="number"&&Mr(e,""+y):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Dr.hasOwnProperty(a)?y!=null&&a==="onScroll"&&Ne("scroll",e):y!=null&&xl(e,a,y,d))}switch(n){case"input":ro(e),Fc(e,i,!1);break;case"textarea":ro(e),Nc(e);break;case"option":i.value!=null&&e.setAttribute("value",""+jn(i.value));break;case"select":e.multiple=!!i.multiple,a=i.value,a!=null?Ui(e,!!i.multiple,a,!1):i.defaultValue!=null&&Ui(e,!!i.multiple,i.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=zo)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return st(t),null;case 6:if(e&&t.stateNode!=null)xf(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(de(166));if(n=ni(zr.current),ni(Qt.current),go(t)){if(i=t.stateNode,n=t.memoizedProps,i[Zt]=t,(a=i.nodeValue!==n)&&(e=It,e!==null))switch(e.tag){case 3:fo(i.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&fo(i.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[Zt]=t,t.stateNode=i}return st(t),null;case 13:if(je(We),i=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ve&&kt!==null&&t.mode&1&&!(t.flags&128))jd(),Ki(),t.flags|=98560,a=!1;else if(a=go(t),i!==null&&i.dehydrated!==null){if(e===null){if(!a)throw Error(de(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(de(317));a[Zt]=t}else Ki(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;st(t),a=!1}else Ut!==null&&(al(Ut),Ut=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(i=i!==null,i!==(e!==null&&e.memoizedState!==null)&&i&&(t.child.flags|=8192,t.mode&1&&(e===null||We.current&1?Je===0&&(Je=3):oc())),t.updateQueue!==null&&(t.flags|=4),st(t),null);case 4:return Qi(),qa(e,t),e===null&&Wr(t.stateNode.containerInfo),st(t),null;case 10:return Ul(t.type._context),st(t),null;case 17:return yt(t.type)&&Yo(),st(t),null;case 19:if(je(We),a=t.memoizedState,a===null)return st(t),null;if(i=(t.flags&128)!==0,d=a.rendering,d===null)if(i)pr(a,!1);else{if(Je!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(d=qo(e),d!==null){for(t.flags|=128,pr(a,!1),i=d.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;n!==null;)a=n,e=i,a.flags&=14680066,d=a.alternate,d===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=d.childLanes,a.lanes=d.lanes,a.child=d.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=d.memoizedProps,a.memoizedState=d.memoizedState,a.updateQueue=d.updateQueue,a.type=d.type,e=d.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Fe(We,We.current&1|2),t.child}e=e.sibling}a.tail!==null&&Ye()>er&&(t.flags|=128,i=!0,pr(a,!1),t.lanes=4194304)}else{if(!i)if(e=qo(d),e!==null){if(t.flags|=128,i=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),pr(a,!0),a.tail===null&&a.tailMode==="hidden"&&!d.alternate&&!Ve)return st(t),null}else 2*Ye()-a.renderingStartTime>er&&n!==1073741824&&(t.flags|=128,i=!0,pr(a,!1),t.lanes=4194304);a.isBackwards?(d.sibling=t.child,t.child=d):(n=a.last,n!==null?n.sibling=d:t.child=d,a.last=d)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ye(),t.sibling=null,n=We.current,Fe(We,i?n&1|2:n&1),t):(st(t),null);case 22:case 23:return rc(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&t.mode&1?xt&1073741824&&(st(t),t.subtreeFlags&6&&(t.flags|=8192)):st(t),null;case 24:return null;case 25:return null}throw Error(de(156,t.tag))}function Pm(e,t){switch(Bl(t),t.tag){case 1:return yt(t.type)&&Yo(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Qi(),je(vt),je(ct),Xl(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Yl(t),null;case 13:if(je(We),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(de(340));Ki()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return je(We),null;case 4:return Qi(),null;case 10:return Ul(t.type._context),null;case 22:case 23:return rc(),null;case 24:return null;default:return null}}var _o=!1,lt=!1,Nm=typeof WeakSet=="function"?WeakSet:Set,Se=null;function ji(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){ze(e,t,i)}else n.current=null}function el(e,t,n){try{n()}catch(i){ze(e,t,i)}}var Tu=!1;function Bm(e,t){if(Na=Uo,e=Td(),Pl(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var o=i.anchorOffset,a=i.focusNode;i=i.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var d=0,_=-1,y=-1,w=0,x=0,T=e,E=null;t:for(;;){for(var M;T!==n||o!==0&&T.nodeType!==3||(_=d+o),T!==a||i!==0&&T.nodeType!==3||(y=d+i),T.nodeType===3&&(d+=T.nodeValue.length),(M=T.firstChild)!==null;)E=T,T=M;for(;;){if(T===e)break t;if(E===n&&++w===o&&(_=d),E===a&&++x===i&&(y=d),(M=T.nextSibling)!==null)break;T=E,E=T.parentNode}T=M}n=_===-1||y===-1?null:{start:_,end:y}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ba={focusedElem:e,selectionRange:n},Uo=!1,Se=t;Se!==null;)if(t=Se,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Se=e;else for(;Se!==null;){t=Se;try{var F=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(F!==null){var P=F.memoizedProps,B=F.memoizedState,D=t.stateNode,O=D.getSnapshotBeforeUpdate(t.elementType===t.type?P:Vt(t.type,P),B);D.__reactInternalSnapshotBeforeUpdate=O}break;case 3:var A=t.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(de(163))}}catch(Y){ze(t,t.return,Y)}if(e=t.sibling,e!==null){e.return=t.return,Se=e;break}Se=t.return}return F=Tu,Tu=!1,F}function Lr(e,t,n){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var o=i=i.next;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,a!==void 0&&el(t,n,a)}o=o.next}while(o!==i)}}function Ts(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var i=n.create;n.destroy=i()}n=n.next}while(n!==t)}}function tl(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function bf(e){var t=e.alternate;t!==null&&(e.alternate=null,bf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Zt],delete t[Gr],delete t[Wa],delete t[Sm],delete t[wm])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ef(e){return e.tag===5||e.tag===3||e.tag===4}function ku(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ef(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function nl(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=zo));else if(i!==4&&(e=e.child,e!==null))for(nl(e,t,n),e=e.sibling;e!==null;)nl(e,t,n),e=e.sibling}function il(e,t,n){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(il(e,t,n),e=e.sibling;e!==null;)il(e,t,n),e=e.sibling}var nt=null,Wt=!1;function Cn(e,t,n){for(n=n.child;n!==null;)Tf(e,t,n),n=n.sibling}function Tf(e,t,n){if(Jt&&typeof Jt.onCommitFiberUnmount=="function")try{Jt.onCommitFiberUnmount(vs,n)}catch{}switch(n.tag){case 5:lt||ji(n,t);case 6:var i=nt,o=Wt;nt=null,Cn(e,t,n),nt=i,Wt=o,nt!==null&&(Wt?(e=nt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):nt.removeChild(n.stateNode));break;case 18:nt!==null&&(Wt?(e=nt,n=n.stateNode,e.nodeType===8?Qs(e.parentNode,n):e.nodeType===1&&Qs(e,n),Br(e)):Qs(nt,n.stateNode));break;case 4:i=nt,o=Wt,nt=n.stateNode.containerInfo,Wt=!0,Cn(e,t,n),nt=i,Wt=o;break;case 0:case 11:case 14:case 15:if(!lt&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){o=i=i.next;do{var a=o,d=a.destroy;a=a.tag,d!==void 0&&(a&2||a&4)&&el(n,t,d),o=o.next}while(o!==i)}Cn(e,t,n);break;case 1:if(!lt&&(ji(n,t),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(_){ze(n,t,_)}Cn(e,t,n);break;case 21:Cn(e,t,n);break;case 22:n.mode&1?(lt=(i=lt)||n.memoizedState!==null,Cn(e,t,n),lt=i):Cn(e,t,n);break;default:Cn(e,t,n)}}function Iu(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Nm),t.forEach(function(i){var o=Xm.bind(null,e,i);n.has(i)||(n.add(i),i.then(o,o))})}}function jt(e,t){var n=t.deletions;if(n!==null)for(var i=0;i<n.length;i++){var o=n[i];try{var a=e,d=t,_=d;e:for(;_!==null;){switch(_.tag){case 5:nt=_.stateNode,Wt=!1;break e;case 3:nt=_.stateNode.containerInfo,Wt=!0;break e;case 4:nt=_.stateNode.containerInfo,Wt=!0;break e}_=_.return}if(nt===null)throw Error(de(160));Tf(a,d,o),nt=null,Wt=!1;var y=o.alternate;y!==null&&(y.return=null),o.return=null}catch(w){ze(o,t,w)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)kf(t,e),t=t.sibling}function kf(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(jt(t,e),Xt(e),i&4){try{Lr(3,e,e.return),Ts(3,e)}catch(P){ze(e,e.return,P)}try{Lr(5,e,e.return)}catch(P){ze(e,e.return,P)}}break;case 1:jt(t,e),Xt(e),i&512&&n!==null&&ji(n,n.return);break;case 5:if(jt(t,e),Xt(e),i&512&&n!==null&&ji(n,n.return),e.flags&32){var o=e.stateNode;try{Mr(o,"")}catch(P){ze(e,e.return,P)}}if(i&4&&(o=e.stateNode,o!=null)){var a=e.memoizedProps,d=n!==null?n.memoizedProps:a,_=e.type,y=e.updateQueue;if(e.updateQueue=null,y!==null)try{_==="input"&&a.type==="radio"&&a.name!=null&&Xh(o,a),ka(_,d);var w=ka(_,a);for(d=0;d<y.length;d+=2){var x=y[d],T=y[d+1];x==="style"?Qh(o,T):x==="dangerouslySetInnerHTML"?Kh(o,T):x==="children"?Mr(o,T):xl(o,x,T,w)}switch(_){case"input":Ca(o,a);break;case"textarea":$h(o,a);break;case"select":var E=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!a.multiple;var M=a.value;M!=null?Ui(o,!!a.multiple,M,!1):E!==!!a.multiple&&(a.defaultValue!=null?Ui(o,!!a.multiple,a.defaultValue,!0):Ui(o,!!a.multiple,a.multiple?[]:"",!1))}o[Gr]=a}catch(P){ze(e,e.return,P)}}break;case 6:if(jt(t,e),Xt(e),i&4){if(e.stateNode===null)throw Error(de(162));o=e.stateNode,a=e.memoizedProps;try{o.nodeValue=a}catch(P){ze(e,e.return,P)}}break;case 3:if(jt(t,e),Xt(e),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Br(t.containerInfo)}catch(P){ze(e,e.return,P)}break;case 4:jt(t,e),Xt(e);break;case 13:jt(t,e),Xt(e),o=e.child,o.flags&8192&&(a=o.memoizedState!==null,o.stateNode.isHidden=a,!a||o.alternate!==null&&o.alternate.memoizedState!==null||(nc=Ye())),i&4&&Iu(e);break;case 22:if(x=n!==null&&n.memoizedState!==null,e.mode&1?(lt=(w=lt)||x,jt(t,e),lt=w):jt(t,e),Xt(e),i&8192){if(w=e.memoizedState!==null,(e.stateNode.isHidden=w)&&!x&&e.mode&1)for(Se=e,x=e.child;x!==null;){for(T=Se=x;Se!==null;){switch(E=Se,M=E.child,E.tag){case 0:case 11:case 14:case 15:Lr(4,E,E.return);break;case 1:ji(E,E.return);var F=E.stateNode;if(typeof F.componentWillUnmount=="function"){i=E,n=E.return;try{t=i,F.props=t.memoizedProps,F.state=t.memoizedState,F.componentWillUnmount()}catch(P){ze(i,n,P)}}break;case 5:ji(E,E.return);break;case 22:if(E.memoizedState!==null){Lu(T);continue}}M!==null?(M.return=E,Se=M):Lu(T)}x=x.sibling}e:for(x=null,T=e;;){if(T.tag===5){if(x===null){x=T;try{o=T.stateNode,w?(a=o.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(_=T.stateNode,y=T.memoizedProps.style,d=y!=null&&y.hasOwnProperty("display")?y.display:null,_.style.display=Jh("display",d))}catch(P){ze(e,e.return,P)}}}else if(T.tag===6){if(x===null)try{T.stateNode.nodeValue=w?"":T.memoizedProps}catch(P){ze(e,e.return,P)}}else if((T.tag!==22&&T.tag!==23||T.memoizedState===null||T===e)&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===e)break e;for(;T.sibling===null;){if(T.return===null||T.return===e)break e;x===T&&(x=null),T=T.return}x===T&&(x=null),T.sibling.return=T.return,T=T.sibling}}break;case 19:jt(t,e),Xt(e),i&4&&Iu(e);break;case 21:break;default:jt(t,e),Xt(e)}}function Xt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Ef(n)){var i=n;break e}n=n.return}throw Error(de(160))}switch(i.tag){case 5:var o=i.stateNode;i.flags&32&&(Mr(o,""),i.flags&=-33);var a=ku(e);il(e,a,o);break;case 3:case 4:var d=i.stateNode.containerInfo,_=ku(e);nl(e,_,d);break;default:throw Error(de(161))}}catch(y){ze(e,e.return,y)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function jm(e,t,n){Se=e,If(e)}function If(e,t,n){for(var i=(e.mode&1)!==0;Se!==null;){var o=Se,a=o.child;if(o.tag===22&&i){var d=o.memoizedState!==null||_o;if(!d){var _=o.alternate,y=_!==null&&_.memoizedState!==null||lt;_=_o;var w=lt;if(_o=d,(lt=y)&&!w)for(Se=o;Se!==null;)d=Se,y=d.child,d.tag===22&&d.memoizedState!==null?Ru(o):y!==null?(y.return=d,Se=y):Ru(o);for(;a!==null;)Se=a,If(a),a=a.sibling;Se=o,_o=_,lt=w}Ou(e)}else o.subtreeFlags&8772&&a!==null?(a.return=o,Se=a):Ou(e)}}function Ou(e){for(;Se!==null;){var t=Se;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:lt||Ts(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!lt)if(n===null)i.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:Vt(t.type,n.memoizedProps);i.componentDidUpdate(o,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&du(t,a,i);break;case 3:var d=t.updateQueue;if(d!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}du(t,d,n)}break;case 5:var _=t.stateNode;if(n===null&&t.flags&4){n=_;var y=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":y.autoFocus&&n.focus();break;case"img":y.src&&(n.src=y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var w=t.alternate;if(w!==null){var x=w.memoizedState;if(x!==null){var T=x.dehydrated;T!==null&&Br(T)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(de(163))}lt||t.flags&512&&tl(t)}catch(E){ze(t,t.return,E)}}if(t===e){Se=null;break}if(n=t.sibling,n!==null){n.return=t.return,Se=n;break}Se=t.return}}function Lu(e){for(;Se!==null;){var t=Se;if(t===e){Se=null;break}var n=t.sibling;if(n!==null){n.return=t.return,Se=n;break}Se=t.return}}function Ru(e){for(;Se!==null;){var t=Se;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ts(4,t)}catch(y){ze(t,n,y)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var o=t.return;try{i.componentDidMount()}catch(y){ze(t,o,y)}}var a=t.return;try{tl(t)}catch(y){ze(t,a,y)}break;case 5:var d=t.return;try{tl(t)}catch(y){ze(t,d,y)}}}catch(y){ze(t,t.return,y)}if(t===e){Se=null;break}var _=t.sibling;if(_!==null){_.return=t.return,Se=_;break}Se=t.return}}var Vm=Math.ceil,ns=_n.ReactCurrentDispatcher,ec=_n.ReactCurrentOwner,Ft=_n.ReactCurrentBatchConfig,Re=0,et=null,$e=null,it=0,xt=0,Vi=Gn(0),Je=0,Zr=null,hi=0,ks=0,tc=0,Rr=null,mt=null,nc=0,er=1/0,rn=null,is=!1,rl=null,Fn=null,vo=!1,In=null,rs=0,Ar=0,ol=null,Ao=-1,Do=0;function dt(){return Re&6?Ye():Ao!==-1?Ao:Ao=Ye()}function Pn(e){return e.mode&1?Re&2&&it!==0?it&-it:xm.transition!==null?(Do===0&&(Do=ud()),Do):(e=De,e!==0||(e=window.event,e=e===void 0?16:_d(e.type)),e):1}function zt(e,t,n,i){if(50<Ar)throw Ar=0,ol=null,Error(de(185));Qr(e,n,i),(!(Re&2)||e!==et)&&(e===et&&(!(Re&2)&&(ks|=n),Je===4&&Tn(e,it)),St(e,i),n===1&&Re===0&&!(t.mode&1)&&(er=Ye()+500,xs&&Hn()))}function St(e,t){var n=e.callbackNode;xp(e,t);var i=Wo(e,e===et?it:0);if(i===0)n!==null&&Vc(n),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(n!=null&&Vc(n),t===1)e.tag===0?Cm(Au.bind(null,e)):Pd(Au.bind(null,e)),vm(function(){!(Re&6)&&Hn()}),n=null;else{switch(hd(i)){case 1:n=Il;break;case 4:n=ld;break;case 16:n=Vo;break;case 536870912:n=cd;break;default:n=Vo}n=Pf(n,Of.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Of(e,t){if(Ao=-1,Do=0,Re&6)throw Error(de(327));var n=e.callbackNode;if(Xi()&&e.callbackNode!==n)return null;var i=Wo(e,e===et?it:0);if(i===0)return null;if(i&30||i&e.expiredLanes||t)t=os(e,i);else{t=i;var o=Re;Re|=2;var a=Rf();(et!==e||it!==t)&&(rn=null,er=Ye()+500,ri(e,t));do try{Gm();break}catch(_){Lf(e,_)}while(1);Wl(),ns.current=a,Re=o,$e!==null?t=0:(et=null,it=0,t=Je)}if(t!==0){if(t===2&&(o=Aa(e),o!==0&&(i=o,t=sl(e,o))),t===1)throw n=Zr,ri(e,0),Tn(e,i),St(e,Ye()),n;if(t===6)Tn(e,i);else{if(o=e.current.alternate,!(i&30)&&!Wm(o)&&(t=os(e,i),t===2&&(a=Aa(e),a!==0&&(i=a,t=sl(e,a))),t===1))throw n=Zr,ri(e,0),Tn(e,i),St(e,Ye()),n;switch(e.finishedWork=o,e.finishedLanes=i,t){case 0:case 1:throw Error(de(345));case 2:qn(e,mt,rn);break;case 3:if(Tn(e,i),(i&130023424)===i&&(t=nc+500-Ye(),10<t)){if(Wo(e,0)!==0)break;if(o=e.suspendedLanes,(o&i)!==i){dt(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Va(qn.bind(null,e,mt,rn),t);break}qn(e,mt,rn);break;case 4:if(Tn(e,i),(i&4194240)===i)break;for(t=e.eventTimes,o=-1;0<i;){var d=31-Ht(i);a=1<<d,d=t[d],d>o&&(o=d),i&=~a}if(i=o,i=Ye()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Vm(i/1960))-i,10<i){e.timeoutHandle=Va(qn.bind(null,e,mt,rn),i);break}qn(e,mt,rn);break;case 5:qn(e,mt,rn);break;default:throw Error(de(329))}}}return St(e,Ye()),e.callbackNode===n?Of.bind(null,e):null}function sl(e,t){var n=Rr;return e.current.memoizedState.isDehydrated&&(ri(e,t).flags|=256),e=os(e,t),e!==2&&(t=mt,mt=n,t!==null&&al(t)),e}function al(e){mt===null?mt=e:mt.push.apply(mt,e)}function Wm(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var o=n[i],a=o.getSnapshot;o=o.value;try{if(!Yt(a(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Tn(e,t){for(t&=~tc,t&=~ks,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ht(t),i=1<<n;e[n]=-1,t&=~i}}function Au(e){if(Re&6)throw Error(de(327));Xi();var t=Wo(e,0);if(!(t&1))return St(e,Ye()),null;var n=os(e,t);if(e.tag!==0&&n===2){var i=Aa(e);i!==0&&(t=i,n=sl(e,i))}if(n===1)throw n=Zr,ri(e,0),Tn(e,t),St(e,Ye()),n;if(n===6)throw Error(de(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,qn(e,mt,rn),St(e,Ye()),null}function ic(e,t){var n=Re;Re|=1;try{return e(t)}finally{Re=n,Re===0&&(er=Ye()+500,xs&&Hn())}}function di(e){In!==null&&In.tag===0&&!(Re&6)&&Xi();var t=Re;Re|=1;var n=Ft.transition,i=De;try{if(Ft.transition=null,De=1,e)return e()}finally{De=i,Ft.transition=n,Re=t,!(Re&6)&&Hn()}}function rc(){xt=Vi.current,je(Vi)}function ri(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,_m(n)),$e!==null)for(n=$e.return;n!==null;){var i=n;switch(Bl(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Yo();break;case 3:Qi(),je(vt),je(ct),Xl();break;case 5:Yl(i);break;case 4:Qi();break;case 13:je(We);break;case 19:je(We);break;case 10:Ul(i.type._context);break;case 22:case 23:rc()}n=n.return}if(et=e,$e=e=Nn(e.current,null),it=xt=t,Je=0,Zr=null,tc=ks=hi=0,mt=Rr=null,ti!==null){for(t=0;t<ti.length;t++)if(n=ti[t],i=n.interleaved,i!==null){n.interleaved=null;var o=i.next,a=n.pending;if(a!==null){var d=a.next;a.next=o,i.next=d}n.pending=i}ti=null}return e}function Lf(e,t){do{var n=$e;try{if(Wl(),Oo.current=ts,es){for(var i=Ue.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}es=!1}if(ui=0,qe=Ze=Ue=null,Or=!1,Yr=0,ec.current=null,n===null||n.return===null){Je=1,Zr=t,$e=null;break}e:{var a=e,d=n.return,_=n,y=t;if(t=it,_.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){var w=y,x=_,T=x.tag;if(!(x.mode&1)&&(T===0||T===11||T===15)){var E=x.alternate;E?(x.updateQueue=E.updateQueue,x.memoizedState=E.memoizedState,x.lanes=E.lanes):(x.updateQueue=null,x.memoizedState=null)}var M=yu(d);if(M!==null){M.flags&=-257,Su(M,d,_,a,t),M.mode&1&&vu(a,w,t),t=M,y=w;var F=t.updateQueue;if(F===null){var P=new Set;P.add(y),t.updateQueue=P}else F.add(y);break e}else{if(!(t&1)){vu(a,w,t),oc();break e}y=Error(de(426))}}else if(Ve&&_.mode&1){var B=yu(d);if(B!==null){!(B.flags&65536)&&(B.flags|=256),Su(B,d,_,a,t),jl(qi(y,_));break e}}a=y=qi(y,_),Je!==4&&(Je=2),Rr===null?Rr=[a]:Rr.push(a),a=d;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var D=ff(a,y,t);hu(a,D);break e;case 1:_=y;var O=a.type,A=a.stateNode;if(!(a.flags&128)&&(typeof O.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Fn===null||!Fn.has(A)))){a.flags|=65536,t&=-t,a.lanes|=t;var Y=gf(a,_,t);hu(a,Y);break e}}a=a.return}while(a!==null)}Df(n)}catch(ne){t=ne,$e===n&&n!==null&&($e=n=n.return);continue}break}while(1)}function Rf(){var e=ns.current;return ns.current=ts,e===null?ts:e}function oc(){(Je===0||Je===3||Je===2)&&(Je=4),et===null||!(hi&268435455)&&!(ks&268435455)||Tn(et,it)}function os(e,t){var n=Re;Re|=2;var i=Rf();(et!==e||it!==t)&&(rn=null,ri(e,t));do try{Um();break}catch(o){Lf(e,o)}while(1);if(Wl(),Re=n,ns.current=i,$e!==null)throw Error(de(261));return et=null,it=0,Je}function Um(){for(;$e!==null;)Af($e)}function Gm(){for(;$e!==null&&!gp();)Af($e)}function Af(e){var t=Ff(e.alternate,e,xt);e.memoizedProps=e.pendingProps,t===null?Df(e):$e=t,ec.current=null}function Df(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Pm(n,t),n!==null){n.flags&=32767,$e=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Je=6,$e=null;return}}else if(n=Fm(n,t,xt),n!==null){$e=n;return}if(t=t.sibling,t!==null){$e=t;return}$e=t=e}while(t!==null);Je===0&&(Je=5)}function qn(e,t,n){var i=De,o=Ft.transition;try{Ft.transition=null,De=1,Hm(e,t,n,i)}finally{Ft.transition=o,De=i}return null}function Hm(e,t,n,i){do Xi();while(In!==null);if(Re&6)throw Error(de(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(de(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(bp(e,a),e===et&&($e=et=null,it=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||vo||(vo=!0,Pf(Vo,function(){return Xi(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Ft.transition,Ft.transition=null;var d=De;De=1;var _=Re;Re|=4,ec.current=null,Bm(e,n),kf(n,e),um(Ba),Uo=!!Na,Ba=Na=null,e.current=n,jm(n),pp(),Re=_,De=d,Ft.transition=a}else e.current=n;if(vo&&(vo=!1,In=e,rs=o),a=e.pendingLanes,a===0&&(Fn=null),vp(n.stateNode),St(e,Ye()),t!==null)for(i=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],i(o.value,{componentStack:o.stack,digest:o.digest});if(is)throw is=!1,e=rl,rl=null,e;return rs&1&&e.tag!==0&&Xi(),a=e.pendingLanes,a&1?e===ol?Ar++:(Ar=0,ol=e):Ar=0,Hn(),null}function Xi(){if(In!==null){var e=hd(rs),t=Ft.transition,n=De;try{if(Ft.transition=null,De=16>e?16:e,In===null)var i=!1;else{if(e=In,In=null,rs=0,Re&6)throw Error(de(331));var o=Re;for(Re|=4,Se=e.current;Se!==null;){var a=Se,d=a.child;if(Se.flags&16){var _=a.deletions;if(_!==null){for(var y=0;y<_.length;y++){var w=_[y];for(Se=w;Se!==null;){var x=Se;switch(x.tag){case 0:case 11:case 15:Lr(8,x,a)}var T=x.child;if(T!==null)T.return=x,Se=T;else for(;Se!==null;){x=Se;var E=x.sibling,M=x.return;if(bf(x),x===w){Se=null;break}if(E!==null){E.return=M,Se=E;break}Se=M}}}var F=a.alternate;if(F!==null){var P=F.child;if(P!==null){F.child=null;do{var B=P.sibling;P.sibling=null,P=B}while(P!==null)}}Se=a}}if(a.subtreeFlags&2064&&d!==null)d.return=a,Se=d;else e:for(;Se!==null;){if(a=Se,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Lr(9,a,a.return)}var D=a.sibling;if(D!==null){D.return=a.return,Se=D;break e}Se=a.return}}var O=e.current;for(Se=O;Se!==null;){d=Se;var A=d.child;if(d.subtreeFlags&2064&&A!==null)A.return=d,Se=A;else e:for(d=O;Se!==null;){if(_=Se,_.flags&2048)try{switch(_.tag){case 0:case 11:case 15:Ts(9,_)}}catch(ne){ze(_,_.return,ne)}if(_===d){Se=null;break e}var Y=_.sibling;if(Y!==null){Y.return=_.return,Se=Y;break e}Se=_.return}}if(Re=o,Hn(),Jt&&typeof Jt.onPostCommitFiberRoot=="function")try{Jt.onPostCommitFiberRoot(vs,e)}catch{}i=!0}return i}finally{De=n,Ft.transition=t}}return!1}function Du(e,t,n){t=qi(n,t),t=ff(e,t,1),e=Mn(e,t,1),t=dt(),e!==null&&(Qr(e,1,t),St(e,t))}function ze(e,t,n){if(e.tag===3)Du(e,e,n);else for(;t!==null;){if(t.tag===3){Du(t,e,n);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Fn===null||!Fn.has(i))){e=qi(n,e),e=gf(t,e,1),t=Mn(t,e,1),e=dt(),t!==null&&(Qr(t,1,e),St(t,e));break}}t=t.return}}function zm(e,t,n){var i=e.pingCache;i!==null&&i.delete(t),t=dt(),e.pingedLanes|=e.suspendedLanes&n,et===e&&(it&n)===n&&(Je===4||Je===3&&(it&130023424)===it&&500>Ye()-nc?ri(e,0):tc|=n),St(e,t)}function Mf(e,t){t===0&&(e.mode&1?(t=ao,ao<<=1,!(ao&130023424)&&(ao=4194304)):t=1);var n=dt();e=gn(e,t),e!==null&&(Qr(e,t,n),St(e,n))}function Ym(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Mf(e,n)}function Xm(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(de(314))}i!==null&&i.delete(t),Mf(e,n)}var Ff;Ff=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||vt.current)_t=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return _t=!1,Mm(e,t,n);_t=!!(e.flags&131072)}else _t=!1,Ve&&t.flags&1048576&&Nd(t,Zo,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Ro(e,t),e=t.pendingProps;var o=Zi(t,ct.current);Yi(t,n),o=Zl(null,t,i,e,o,n);var a=Kl();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,yt(i)?(a=!0,Xo(t)):a=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Hl(t),o.updater=bs,t.stateNode=o,o._reactInternals=t,Xa(t,i,e,n),t=Ka(null,t,i,!0,a,n)):(t.tag=0,Ve&&a&&Nl(t),ht(null,t,o,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Ro(e,t),e=t.pendingProps,o=i._init,i=o(i._payload),t.type=i,o=t.tag=Zm(i),e=Vt(i,e),o){case 0:t=Za(null,t,i,e,n);break e;case 1:t=xu(null,t,i,e,n);break e;case 11:t=wu(null,t,i,e,n);break e;case 14:t=Cu(null,t,i,Vt(i.type,e),n);break e}throw Error(de(306,i,""))}return t;case 0:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:Vt(i,o),Za(e,t,i,o,n);case 1:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:Vt(i,o),xu(e,t,i,o,n);case 3:e:{if(vf(t),e===null)throw Error(de(387));i=t.pendingProps,a=t.memoizedState,o=a.element,Wd(e,t),Qo(t,i,null,n);var d=t.memoizedState;if(i=d.element,a.isDehydrated)if(a={element:i,isDehydrated:!1,cache:d.cache,pendingSuspenseBoundaries:d.pendingSuspenseBoundaries,transitions:d.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){o=qi(Error(de(423)),t),t=bu(e,t,i,n,o);break e}else if(i!==o){o=qi(Error(de(424)),t),t=bu(e,t,i,n,o);break e}else for(kt=Dn(t.stateNode.containerInfo.firstChild),It=t,Ve=!0,Ut=null,n=zd(t,null,i,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ki(),i===o){t=pn(e,t,n);break e}ht(e,t,i,n)}t=t.child}return t;case 5:return Yd(t),e===null&&Ha(t),i=t.type,o=t.pendingProps,a=e!==null?e.memoizedProps:null,d=o.children,ja(i,o)?d=null:a!==null&&ja(i,a)&&(t.flags|=32),_f(e,t),ht(e,t,d,n),t.child;case 6:return e===null&&Ha(t),null;case 13:return yf(e,t,n);case 4:return zl(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=Ji(t,null,i,n):ht(e,t,i,n),t.child;case 11:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:Vt(i,o),wu(e,t,i,o,n);case 7:return ht(e,t,t.pendingProps,n),t.child;case 8:return ht(e,t,t.pendingProps.children,n),t.child;case 12:return ht(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,o=t.pendingProps,a=t.memoizedProps,d=o.value,Fe(Ko,i._currentValue),i._currentValue=d,a!==null)if(Yt(a.value,d)){if(a.children===o.children&&!vt.current){t=pn(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var _=a.dependencies;if(_!==null){d=a.child;for(var y=_.firstContext;y!==null;){if(y.context===i){if(a.tag===1){y=hn(-1,n&-n),y.tag=2;var w=a.updateQueue;if(w!==null){w=w.shared;var x=w.pending;x===null?y.next=y:(y.next=x.next,x.next=y),w.pending=y}}a.lanes|=n,y=a.alternate,y!==null&&(y.lanes|=n),za(a.return,n,t),_.lanes|=n;break}y=y.next}}else if(a.tag===10)d=a.type===t.type?null:a.child;else if(a.tag===18){if(d=a.return,d===null)throw Error(de(341));d.lanes|=n,_=d.alternate,_!==null&&(_.lanes|=n),za(d,n,t),d=a.sibling}else d=a.child;if(d!==null)d.return=a;else for(d=a;d!==null;){if(d===t){d=null;break}if(a=d.sibling,a!==null){a.return=d.return,d=a;break}d=d.return}a=d}ht(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,i=t.pendingProps.children,Yi(t,n),o=Pt(o),i=i(o),t.flags|=1,ht(e,t,i,n),t.child;case 14:return i=t.type,o=Vt(i,t.pendingProps),o=Vt(i.type,o),Cu(e,t,i,o,n);case 15:return pf(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,o=t.pendingProps,o=t.elementType===i?o:Vt(i,o),Ro(e,t),t.tag=1,yt(i)?(e=!0,Xo(t)):e=!1,Yi(t,n),Gd(t,i,o),Xa(t,i,o,n),Ka(null,t,i,!0,e,n);case 19:return Sf(e,t,n);case 22:return mf(e,t,n)}throw Error(de(156,t.tag))};function Pf(e,t){return ad(e,t)}function $m(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mt(e,t,n,i){return new $m(e,t,n,i)}function sc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zm(e){if(typeof e=="function")return sc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===El)return 11;if(e===Tl)return 14}return 2}function Nn(e,t){var n=e.alternate;return n===null?(n=Mt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Mo(e,t,n,i,o,a){var d=2;if(i=e,typeof e=="function")sc(e)&&(d=1);else if(typeof e=="string")d=5;else e:switch(e){case Li:return oi(n.children,o,a,t);case bl:d=8,o|=8;break;case _a:return e=Mt(12,n,t,o|2),e.elementType=_a,e.lanes=a,e;case va:return e=Mt(13,n,t,o),e.elementType=va,e.lanes=a,e;case ya:return e=Mt(19,n,t,o),e.elementType=ya,e.lanes=a,e;case Hh:return Is(n,o,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Uh:d=10;break e;case Gh:d=9;break e;case El:d=11;break e;case Tl:d=14;break e;case xn:d=16,i=null;break e}throw Error(de(130,e==null?e:typeof e,""))}return t=Mt(d,n,t,o),t.elementType=e,t.type=i,t.lanes=a,t}function oi(e,t,n,i){return e=Mt(7,e,i,t),e.lanes=n,e}function Is(e,t,n,i){return e=Mt(22,e,i,t),e.elementType=Hh,e.lanes=n,e.stateNode={isHidden:!1},e}function sa(e,t,n){return e=Mt(6,e,null,t),e.lanes=n,e}function aa(e,t,n){return t=Mt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Km(e,t,n,i,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ws(0),this.expirationTimes=Ws(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ws(0),this.identifierPrefix=i,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function ac(e,t,n,i,o,a,d,_,y){return e=new Km(e,t,n,_,y),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Mt(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hl(a),e}function Jm(e,t,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Oi,key:i==null?null:""+i,children:e,containerInfo:t,implementation:n}}function Nf(e){if(!e)return Vn;e=e._reactInternals;e:{if(gi(e)!==e||e.tag!==1)throw Error(de(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(yt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(de(171))}if(e.tag===1){var n=e.type;if(yt(n))return Fd(e,n,t)}return t}function Bf(e,t,n,i,o,a,d,_,y){return e=ac(n,i,!0,e,o,a,d,_,y),e.context=Nf(null),n=e.current,i=dt(),o=Pn(n),a=hn(i,o),a.callback=t??null,Mn(n,a,o),e.current.lanes=o,Qr(e,o,i),St(e,i),e}function Os(e,t,n,i){var o=t.current,a=dt(),d=Pn(o);return n=Nf(n),t.context===null?t.context=n:t.pendingContext=n,t=hn(a,d),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),e=Mn(o,t,d),e!==null&&(zt(e,o,d,a),Io(e,o,d)),d}function ss(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Mu(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function lc(e,t){Mu(e,t),(e=e.alternate)&&Mu(e,t)}function Qm(){return null}var jf=typeof reportError=="function"?reportError:function(e){console.error(e)};function cc(e){this._internalRoot=e}Ls.prototype.render=cc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(de(409));Os(e,t,null,null)};Ls.prototype.unmount=cc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;di(function(){Os(null,e,null,null)}),t[fn]=null}};function Ls(e){this._internalRoot=e}Ls.prototype.unstable_scheduleHydration=function(e){if(e){var t=gd();e={blockedOn:null,target:e,priority:t};for(var n=0;n<En.length&&t!==0&&t<En[n].priority;n++);En.splice(n,0,e),n===0&&md(e)}};function uc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Rs(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Fu(){}function qm(e,t,n,i,o){if(o){if(typeof i=="function"){var a=i;i=function(){var w=ss(d);a.call(w)}}var d=Bf(t,i,e,0,null,!1,!1,"",Fu);return e._reactRootContainer=d,e[fn]=d.current,Wr(e.nodeType===8?e.parentNode:e),di(),d}for(;o=e.lastChild;)e.removeChild(o);if(typeof i=="function"){var _=i;i=function(){var w=ss(y);_.call(w)}}var y=ac(e,0,!1,null,null,!1,!1,"",Fu);return e._reactRootContainer=y,e[fn]=y.current,Wr(e.nodeType===8?e.parentNode:e),di(function(){Os(t,y,n,i)}),y}function As(e,t,n,i,o){var a=n._reactRootContainer;if(a){var d=a;if(typeof o=="function"){var _=o;o=function(){var y=ss(d);_.call(y)}}Os(t,d,e,o)}else d=qm(n,t,e,o,i);return ss(d)}dd=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Cr(t.pendingLanes);n!==0&&(Ol(t,n|1),St(t,Ye()),!(Re&6)&&(er=Ye()+500,Hn()))}break;case 13:di(function(){var i=gn(e,1);if(i!==null){var o=dt();zt(i,e,1,o)}}),lc(e,1)}};Ll=function(e){if(e.tag===13){var t=gn(e,134217728);if(t!==null){var n=dt();zt(t,e,134217728,n)}lc(e,134217728)}};fd=function(e){if(e.tag===13){var t=Pn(e),n=gn(e,t);if(n!==null){var i=dt();zt(n,e,t,i)}lc(e,t)}};gd=function(){return De};pd=function(e,t){var n=De;try{return De=e,t()}finally{De=n}};Oa=function(e,t,n){switch(t){case"input":if(Ca(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var o=Cs(i);if(!o)throw Error(de(90));Yh(i),Ca(i,o)}}}break;case"textarea":$h(e,n);break;case"select":t=n.value,t!=null&&Ui(e,!!n.multiple,t,!1)}};td=ic;nd=di;var e_={usingClientEntryPoint:!1,Events:[eo,Mi,Cs,qh,ed,ic]},mr={findFiberByHostInstance:ei,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},t_={bundleType:mr.bundleType,version:mr.version,rendererPackageName:mr.rendererPackageName,rendererConfig:mr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_n.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=od(e),e===null?null:e.stateNode},findFiberByHostInstance:mr.findFiberByHostInstance||Qm,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yo.isDisabled&&yo.supportsFiber)try{vs=yo.inject(t_),Jt=yo}catch{}}Lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=e_;Lt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!uc(t))throw Error(de(200));return Jm(e,t,null,n)};Lt.createRoot=function(e,t){if(!uc(e))throw Error(de(299));var n=!1,i="",o=jf;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=ac(e,1,!1,null,null,n,!1,i,o),e[fn]=t.current,Wr(e.nodeType===8?e.parentNode:e),new cc(t)};Lt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(de(188)):(e=Object.keys(e).join(","),Error(de(268,e)));return e=od(t),e=e===null?null:e.stateNode,e};Lt.flushSync=function(e){return di(e)};Lt.hydrate=function(e,t,n){if(!Rs(t))throw Error(de(200));return As(null,e,t,!0,n)};Lt.hydrateRoot=function(e,t,n){if(!uc(e))throw Error(de(405));var i=n!=null&&n.hydratedSources||null,o=!1,a="",d=jf;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(d=n.onRecoverableError)),t=Bf(t,null,e,1,n??null,o,!1,a,d),e[fn]=t.current,Wr(e),i)for(e=0;e<i.length;e++)n=i[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new Ls(t)};Lt.render=function(e,t,n){if(!Rs(t))throw Error(de(200));return As(null,e,t,!1,n)};Lt.unmountComponentAtNode=function(e){if(!Rs(e))throw Error(de(40));return e._reactRootContainer?(di(function(){As(null,null,e,!1,function(){e._reactRootContainer=null,e[fn]=null})}),!0):!1};Lt.unstable_batchedUpdates=ic;Lt.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!Rs(n))throw Error(de(200));if(e==null||e._reactInternals===void 0)throw Error(de(38));return As(e,t,n,!1,i)};Lt.version="18.2.0-next-9e3b772b8-20220608";(function(e){function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(n){console.error(n)}}t(),e.exports=Lt})(Nh);var Pu=Nh.exports;pa.createRoot=Pu.createRoot,pa.hydrateRoot=Pu.hydrateRoot;const n_=(e,t)=>t.some(n=>e instanceof n);let Nu,Bu;function i_(){return Nu||(Nu=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function r_(){return Bu||(Bu=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Vf=new WeakMap,ll=new WeakMap,Wf=new WeakMap,la=new WeakMap,hc=new WeakMap;function o_(e){const t=new Promise((n,i)=>{const o=()=>{e.removeEventListener("success",a),e.removeEventListener("error",d)},a=()=>{n(Bn(e.result)),o()},d=()=>{i(e.error),o()};e.addEventListener("success",a),e.addEventListener("error",d)});return t.then(n=>{n instanceof IDBCursor&&Vf.set(n,e)}).catch(()=>{}),hc.set(t,e),t}function s_(e){if(ll.has(e))return;const t=new Promise((n,i)=>{const o=()=>{e.removeEventListener("complete",a),e.removeEventListener("error",d),e.removeEventListener("abort",d)},a=()=>{n(),o()},d=()=>{i(e.error||new DOMException("AbortError","AbortError")),o()};e.addEventListener("complete",a),e.addEventListener("error",d),e.addEventListener("abort",d)});ll.set(e,t)}let cl={get(e,t,n){if(e instanceof IDBTransaction){if(t==="done")return ll.get(e);if(t==="objectStoreNames")return e.objectStoreNames||Wf.get(e);if(t==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Bn(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in e}};function a_(e){cl=e(cl)}function l_(e){return e===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...n){const i=e.call(ca(this),t,...n);return Wf.set(i,t.sort?t.sort():[t]),Bn(i)}:r_().includes(e)?function(...t){return e.apply(ca(this),t),Bn(Vf.get(this))}:function(...t){return Bn(e.apply(ca(this),t))}}function c_(e){return typeof e=="function"?l_(e):(e instanceof IDBTransaction&&s_(e),n_(e,i_())?new Proxy(e,cl):e)}function Bn(e){if(e instanceof IDBRequest)return o_(e);if(la.has(e))return la.get(e);const t=c_(e);return t!==e&&(la.set(e,t),hc.set(t,e)),t}const ca=e=>hc.get(e);function u_(e,t,{blocked:n,upgrade:i,blocking:o,terminated:a}={}){const d=indexedDB.open(e,t),_=Bn(d);return i&&d.addEventListener("upgradeneeded",y=>{i(Bn(d.result),y.oldVersion,y.newVersion,Bn(d.transaction),y)}),n&&d.addEventListener("blocked",y=>n(y.oldVersion,y.newVersion,y)),_.then(y=>{a&&y.addEventListener("close",()=>a()),o&&y.addEventListener("versionchange",w=>o(w.oldVersion,w.newVersion,w))}).catch(()=>{}),_}const h_=["get","getKey","getAll","getAllKeys","count"],d_=["put","add","delete","clear"],ua=new Map;function ju(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t=="string"))return;if(ua.get(t))return ua.get(t);const n=t.replace(/FromIndex$/,""),i=t!==n,o=d_.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(o||h_.includes(n)))return;const a=async function(d,..._){const y=this.transaction(d,o?"readwrite":"readonly");let w=y.store;return i&&(w=w.index(_.shift())),(await Promise.all([w[n](..._),o&&y.done]))[0]};return ua.set(t,a),a}a_(e=>({...e,get:(t,n,i)=>ju(t,n)||e.get(t,n,i),has:(t,n)=>!!ju(t,n)||e.has(t,n)}));const dc=u_("BarcodeDB-v2",1,{upgrade(e){e.createObjectStore("taggedList")}}),Vu=async(e,t)=>(await dc).put("taggedList",t,e),f_=async e=>(await dc).delete("taggedList",e),Uf=te.exports.createContext(),g_=({children:e})=>{const[t,n]=te.exports.useState({barcodeValue:"",showScanner:!1}),[i,o]=te.exports.useState({barcodeValue:"",showScanner:!1}),[a,d]=te.exports.useState({inputValue:"",barcodeValue:""}),_={roomID:t,assetID:i,tagID:a,setRoomID:n,setAssetID:o,setTagID:d};return ae(Uf.Provider,{value:_,children:e})};function p_(e,t,n,i){e.prototype._pos=[0,0,0],e.prototype._orientation=[0,0,-1,0,1,0],e.prototype.stereo=function(a){var d=this;if(!d.ctx||!d.ctx.listener)return d;for(var _=d._howls.length-1;_>=0;_--)d._howls[_].stereo(a);return d},e.prototype.pos=function(a,d,_){var y=this;if(!y.ctx||!y.ctx.listener)return y;if(d=typeof d!="number"?y._pos[1]:d,_=typeof _!="number"?y._pos[2]:_,typeof a=="number")y._pos=[a,d,_],typeof y.ctx.listener.positionX<"u"?(y.ctx.listener.positionX.setTargetAtTime(y._pos[0],t.ctx.currentTime,.1),y.ctx.listener.positionY.setTargetAtTime(y._pos[1],t.ctx.currentTime,.1),y.ctx.listener.positionZ.setTargetAtTime(y._pos[2],t.ctx.currentTime,.1)):y.ctx.listener.setPosition(y._pos[0],y._pos[1],y._pos[2]);else return y._pos;return y},e.prototype.orientation=function(a,d,_,y,w,x){var T=this;if(!T.ctx||!T.ctx.listener)return T;var E=T._orientation;if(d=typeof d!="number"?E[1]:d,_=typeof _!="number"?E[2]:_,y=typeof y!="number"?E[3]:y,w=typeof w!="number"?E[4]:w,x=typeof x!="number"?E[5]:x,typeof a=="number")T._orientation=[a,d,_,y,w,x],typeof T.ctx.listener.forwardX<"u"?(T.ctx.listener.forwardX.setTargetAtTime(a,t.ctx.currentTime,.1),T.ctx.listener.forwardY.setTargetAtTime(d,t.ctx.currentTime,.1),T.ctx.listener.forwardZ.setTargetAtTime(_,t.ctx.currentTime,.1),T.ctx.listener.upX.setTargetAtTime(y,t.ctx.currentTime,.1),T.ctx.listener.upY.setTargetAtTime(w,t.ctx.currentTime,.1),T.ctx.listener.upZ.setTargetAtTime(x,t.ctx.currentTime,.1)):T.ctx.listener.setOrientation(a,d,_,y,w,x);else return E;return T},n.prototype.init=function(a){return function(d){var _=this;return _._orientation=d.orientation||[1,0,0],_._stereo=d.stereo||null,_._pos=d.pos||null,_._pannerAttr={coneInnerAngle:typeof d.coneInnerAngle<"u"?d.coneInnerAngle:360,coneOuterAngle:typeof d.coneOuterAngle<"u"?d.coneOuterAngle:360,coneOuterGain:typeof d.coneOuterGain<"u"?d.coneOuterGain:0,distanceModel:typeof d.distanceModel<"u"?d.distanceModel:"inverse",maxDistance:typeof d.maxDistance<"u"?d.maxDistance:1e4,panningModel:typeof d.panningModel<"u"?d.panningModel:"HRTF",refDistance:typeof d.refDistance<"u"?d.refDistance:1,rolloffFactor:typeof d.rolloffFactor<"u"?d.rolloffFactor:1},_._onstereo=d.onstereo?[{fn:d.onstereo}]:[],_._onpos=d.onpos?[{fn:d.onpos}]:[],_._onorientation=d.onorientation?[{fn:d.onorientation}]:[],a.call(this,d)}}(n.prototype.init),n.prototype.stereo=function(a,d){var _=this;if(!_._webAudio)return _;if(_._state!=="loaded")return _._queue.push({event:"stereo",action:function(){_.stereo(a,d)}}),_;var y=typeof t.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof d>"u")if(typeof a=="number")_._stereo=a,_._pos=[a,0,0];else return _._stereo;for(var w=_._getSoundIds(d),x=0;x<w.length;x++){var T=_._soundById(w[x]);if(T)if(typeof a=="number")T._stereo=a,T._pos=[a,0,0],T._node&&(T._pannerAttr.panningModel="equalpower",(!T._panner||!T._panner.pan)&&o(T,y),y==="spatial"?typeof T._panner.positionX<"u"?(T._panner.positionX.setValueAtTime(a,t.ctx.currentTime),T._panner.positionY.setValueAtTime(0,t.ctx.currentTime),T._panner.positionZ.setValueAtTime(0,t.ctx.currentTime)):T._panner.setPosition(a,0,0):T._panner.pan.setValueAtTime(a,t.ctx.currentTime)),_._emit("stereo",T._id);else return T._stereo}return _},n.prototype.pos=function(a,d,_,y){var w=this;if(!w._webAudio)return w;if(w._state!=="loaded")return w._queue.push({event:"pos",action:function(){w.pos(a,d,_,y)}}),w;if(d=typeof d!="number"?0:d,_=typeof _!="number"?-.5:_,typeof y>"u")if(typeof a=="number")w._pos=[a,d,_];else return w._pos;for(var x=w._getSoundIds(y),T=0;T<x.length;T++){var E=w._soundById(x[T]);if(E)if(typeof a=="number")E._pos=[a,d,_],E._node&&((!E._panner||E._panner.pan)&&o(E,"spatial"),typeof E._panner.positionX<"u"?(E._panner.positionX.setValueAtTime(a,t.ctx.currentTime),E._panner.positionY.setValueAtTime(d,t.ctx.currentTime),E._panner.positionZ.setValueAtTime(_,t.ctx.currentTime)):E._panner.setPosition(a,d,_)),w._emit("pos",E._id);else return E._pos}return w},n.prototype.orientation=function(a,d,_,y){var w=this;if(!w._webAudio)return w;if(w._state!=="loaded")return w._queue.push({event:"orientation",action:function(){w.orientation(a,d,_,y)}}),w;if(d=typeof d!="number"?w._orientation[1]:d,_=typeof _!="number"?w._orientation[2]:_,typeof y>"u")if(typeof a=="number")w._orientation=[a,d,_];else return w._orientation;for(var x=w._getSoundIds(y),T=0;T<x.length;T++){var E=w._soundById(x[T]);if(E)if(typeof a=="number")E._orientation=[a,d,_],E._node&&(E._panner||(E._pos||(E._pos=w._pos||[0,0,-.5]),o(E,"spatial")),typeof E._panner.orientationX<"u"?(E._panner.orientationX.setValueAtTime(a,t.ctx.currentTime),E._panner.orientationY.setValueAtTime(d,t.ctx.currentTime),E._panner.orientationZ.setValueAtTime(_,t.ctx.currentTime)):E._panner.setOrientation(a,d,_)),w._emit("orientation",E._id);else return E._orientation}return w},n.prototype.pannerAttr=function(){var a=this,d=arguments,_,y,w;if(!a._webAudio)return a;if(d.length===0)return a._pannerAttr;if(d.length===1)if(typeof d[0]=="object")_=d[0],typeof y>"u"&&(_.pannerAttr||(_.pannerAttr={coneInnerAngle:_.coneInnerAngle,coneOuterAngle:_.coneOuterAngle,coneOuterGain:_.coneOuterGain,distanceModel:_.distanceModel,maxDistance:_.maxDistance,refDistance:_.refDistance,rolloffFactor:_.rolloffFactor,panningModel:_.panningModel}),a._pannerAttr={coneInnerAngle:typeof _.pannerAttr.coneInnerAngle<"u"?_.pannerAttr.coneInnerAngle:a._coneInnerAngle,coneOuterAngle:typeof _.pannerAttr.coneOuterAngle<"u"?_.pannerAttr.coneOuterAngle:a._coneOuterAngle,coneOuterGain:typeof _.pannerAttr.coneOuterGain<"u"?_.pannerAttr.coneOuterGain:a._coneOuterGain,distanceModel:typeof _.pannerAttr.distanceModel<"u"?_.pannerAttr.distanceModel:a._distanceModel,maxDistance:typeof _.pannerAttr.maxDistance<"u"?_.pannerAttr.maxDistance:a._maxDistance,refDistance:typeof _.pannerAttr.refDistance<"u"?_.pannerAttr.refDistance:a._refDistance,rolloffFactor:typeof _.pannerAttr.rolloffFactor<"u"?_.pannerAttr.rolloffFactor:a._rolloffFactor,panningModel:typeof _.pannerAttr.panningModel<"u"?_.pannerAttr.panningModel:a._panningModel});else return w=a._soundById(parseInt(d[0],10)),w?w._pannerAttr:a._pannerAttr;else d.length===2&&(_=d[0],y=parseInt(d[1],10));for(var x=a._getSoundIds(y),T=0;T<x.length;T++)if(w=a._soundById(x[T]),w){var E=w._pannerAttr;E={coneInnerAngle:typeof _.coneInnerAngle<"u"?_.coneInnerAngle:E.coneInnerAngle,coneOuterAngle:typeof _.coneOuterAngle<"u"?_.coneOuterAngle:E.coneOuterAngle,coneOuterGain:typeof _.coneOuterGain<"u"?_.coneOuterGain:E.coneOuterGain,distanceModel:typeof _.distanceModel<"u"?_.distanceModel:E.distanceModel,maxDistance:typeof _.maxDistance<"u"?_.maxDistance:E.maxDistance,refDistance:typeof _.refDistance<"u"?_.refDistance:E.refDistance,rolloffFactor:typeof _.rolloffFactor<"u"?_.rolloffFactor:E.rolloffFactor,panningModel:typeof _.panningModel<"u"?_.panningModel:E.panningModel};var M=w._panner;M||(w._pos||(w._pos=a._pos||[0,0,-.5]),o(w,"spatial"),M=w._panner),M.coneInnerAngle=E.coneInnerAngle,M.coneOuterAngle=E.coneOuterAngle,M.coneOuterGain=E.coneOuterGain,M.distanceModel=E.distanceModel,M.maxDistance=E.maxDistance,M.refDistance=E.refDistance,M.rolloffFactor=E.rolloffFactor,M.panningModel=E.panningModel}return a},i.prototype.init=function(a){return function(){var d=this,_=d._parent;d._orientation=_._orientation,d._stereo=_._stereo,d._pos=_._pos,d._pannerAttr=_._pannerAttr,a.call(this),d._stereo?_.stereo(d._stereo):d._pos&&_.pos(d._pos[0],d._pos[1],d._pos[2],d._id)}}(i.prototype.init),i.prototype.reset=function(a){return function(){var d=this,_=d._parent;return d._orientation=_._orientation,d._stereo=_._stereo,d._pos=_._pos,d._pannerAttr=_._pannerAttr,d._stereo?_.stereo(d._stereo):d._pos?_.pos(d._pos[0],d._pos[1],d._pos[2],d._id):d._panner&&(d._panner.disconnect(0),d._panner=void 0,_._refreshBuffer(d)),a.call(this)}}(i.prototype.reset);var o=function(a,d){d=d||"spatial",d==="spatial"?(a._panner=t.ctx.createPanner(),a._panner.coneInnerAngle=a._pannerAttr.coneInnerAngle,a._panner.coneOuterAngle=a._pannerAttr.coneOuterAngle,a._panner.coneOuterGain=a._pannerAttr.coneOuterGain,a._panner.distanceModel=a._pannerAttr.distanceModel,a._panner.maxDistance=a._pannerAttr.maxDistance,a._panner.refDistance=a._pannerAttr.refDistance,a._panner.rolloffFactor=a._pannerAttr.rolloffFactor,a._panner.panningModel=a._pannerAttr.panningModel,typeof a._panner.positionX<"u"?(a._panner.positionX.setValueAtTime(a._pos[0],t.ctx.currentTime),a._panner.positionY.setValueAtTime(a._pos[1],t.ctx.currentTime),a._panner.positionZ.setValueAtTime(a._pos[2],t.ctx.currentTime)):a._panner.setPosition(a._pos[0],a._pos[1],a._pos[2]),typeof a._panner.orientationX<"u"?(a._panner.orientationX.setValueAtTime(a._orientation[0],t.ctx.currentTime),a._panner.orientationY.setValueAtTime(a._orientation[1],t.ctx.currentTime),a._panner.orientationZ.setValueAtTime(a._orientation[2],t.ctx.currentTime)):a._panner.setOrientation(a._orientation[0],a._orientation[1],a._orientation[2])):(a._panner=t.ctx.createStereoPanner(),a._panner.pan.setValueAtTime(a._stereo,t.ctx.currentTime)),a._panner.connect(a._node),a._paused||a._parent.pause(a._id,!0).play(a._id,!0)}}var fc=function(){this.init()};fc.prototype={init:function(){var e=this||ce;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator=typeof window<"u"&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||ce;if(e=parseFloat(e),t.ctx||Fo(),typeof e<"u"&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,ce.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var i=t._howls[n]._getSoundIds(),o=0;o<i.length;o++){var a=t._howls[n]._soundById(i[o]);a&&a._node&&(a._node.volume=a._volume*e)}return t}return t._volume},mute:function(e){var t=this||ce;t.ctx||Fo(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,ce.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var i=t._howls[n]._getSoundIds(),o=0;o<i.length;o++){var a=t._howls[n]._soundById(i[o]);a&&a._node&&(a._node.muted=e?!0:a._muted)}return t},stop:function(){for(var e=this||ce,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||ce,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&typeof e.ctx.close<"u"&&(e.ctx.close(),e.ctx=null,Fo()),e},codecs:function(e){return(this||ce)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||ce;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if(typeof Audio<"u")try{var t=new Audio;typeof t.oncanplaythrough>"u"&&(e._canPlayEvent="canplay")}catch{e.noAudio=!0}else e.noAudio=!0;try{var t=new Audio;t.muted&&(e.noAudio=!0)}catch{}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||ce,t=null;try{t=typeof Audio<"u"?new Audio:null}catch{return e}if(!t||typeof t.canPlayType!="function")return e;var n=t.canPlayType("audio/mpeg;").replace(/^no$/,""),i=e._navigator?e._navigator.userAgent:"",o=i.match(/OPR\/([0-6].)/g),a=o&&parseInt(o[0].split("/")[1],10)<33,d=i.indexOf("Safari")!==-1&&i.indexOf("Chrome")===-1,_=i.match(/Version\/(.*?) /),y=d&&_&&parseInt(_[1],10)<15;return e._codecs={mp3:!!(!a&&(n||t.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!n,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!y&&t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!y&&t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||ce;if(!(e._audioUnlocked||!e.ctx)){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&e.ctx.sampleRate!==44100&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(n){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var i=new Audio;i._unlocked=!0,e._releaseHtml5Audio(i)}catch{e.noAudio=!0;break}for(var o=0;o<e._howls.length;o++)if(!e._howls[o]._webAudio)for(var a=e._howls[o]._getSoundIds(),d=0;d<a.length;d++){var _=e._howls[o]._soundById(a[d]);_&&_._node&&!_._node._unlocked&&(_._node._unlocked=!0,_._node.load())}e._autoResume();var y=e.ctx.createBufferSource();y.buffer=e._scratchBuffer,y.connect(e.ctx.destination),typeof y.start>"u"?y.noteOn(0):y.start(0),typeof e.ctx.resume=="function"&&e.ctx.resume(),y.onended=function(){y.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("keydown",t,!0);for(var w=0;w<e._howls.length;w++)e._howls[w]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),document.addEventListener("keydown",t,!0),e}},_obtainHtml5Audio:function(){var e=this||ce;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=new Audio().play();return t&&typeof Promise<"u"&&(t instanceof Promise||typeof t.then=="function")&&t.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var t=this||ce;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(!(!e.autoSuspend||!e.ctx||typeof e.ctx.suspend>"u"||!ce.usingWebAudio)){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio){for(var n=0;n<e._howls[t]._sounds.length;n++)if(!e._howls[t]._sounds[n]._paused)return e}return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var i=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(i,i)}},3e4),e}},_autoResume:function(){var e=this;if(!(!e.ctx||typeof e.ctx.resume>"u"||!ce.usingWebAudio))return e.state==="running"&&e.ctx.state!=="interrupted"&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):e.state==="suspended"||e.state==="running"&&e.ctx.state==="interrupted"?(e.ctx.resume().then(function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):e.state==="suspending"&&(e._resumeAfterSuspend=!0),e}};var ce=new fc,as=function(e){var t=this;if(!e.src||e.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}t.init(e)};as.prototype={init:function(e){var t=this;return ce.ctx||Fo(),t._autoplay=e.autoplay||!1,t._format=typeof e.format!="string"?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload=typeof e.preload=="boolean"||e.preload==="metadata"?e.preload:!0,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src=typeof e.src!="string"?e.src:[e.src],t._volume=e.volume!==void 0?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:e.xhr&&e.xhr.withCredentials?e.xhr.withCredentials:!1},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=ce.usingWebAudio&&!t._html5,typeof ce.ctx<"u"&&ce.ctx&&ce.autoUnlock&&ce._unlockAudio(),ce._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&t._preload!=="none"&&t.load(),t},load:function(){var e=this,t=null;if(ce.noAudio){e._emit("loaderror",null,"No audio support.");return}typeof e._src=="string"&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var i,o;if(e._format&&e._format[n])i=e._format[n];else{if(o=e._src[n],typeof o!="string"){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}i=/^data:audio\/([^;,]+);/i.exec(o),i||(i=/\.([^.]+)$/.exec(o.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(i||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),i&&ce.codecs(i)){t=e._src[n];break}}if(!t){e._emit("loaderror",null,"No codec support for selected audio sources.");return}return e._src=t,e._state="loading",window.location.protocol==="https:"&&t.slice(0,5)==="http:"&&(e._html5=!0,e._webAudio=!1),new ls(e),e._webAudio&&m_(e),e},play:function(e,t){var n=this,i=null;if(typeof e=="number")i=e,e=null;else{if(typeof e=="string"&&n._state==="loaded"&&!n._sprite[e])return null;if(typeof e>"u"&&(e="__default",!n._playLock)){for(var o=0,a=0;a<n._sounds.length;a++)n._sounds[a]._paused&&!n._sounds[a]._ended&&(o++,i=n._sounds[a]._id);o===1?e=null:i=null}}var d=i?n._soundById(i):n._inactiveSound();if(!d)return null;if(i&&!e&&(e=d._sprite||"__default"),n._state!=="loaded"){d._sprite=e,d._ended=!1;var _=d._id;return n._queue.push({event:"play",action:function(){n.play(_)}}),_}if(i&&!d._paused)return t||n._loadQueue("play"),d._id;n._webAudio&&ce._autoResume();var y=Math.max(0,d._seek>0?d._seek:n._sprite[e][0]/1e3),w=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-y),x=w*1e3/Math.abs(d._rate),T=n._sprite[e][0]/1e3,E=(n._sprite[e][0]+n._sprite[e][1])/1e3;d._sprite=e,d._ended=!1;var M=function(){d._paused=!1,d._seek=y,d._start=T,d._stop=E,d._loop=!!(d._loop||n._sprite[e][2])};if(y>=E){n._ended(d);return}var F=d._node;if(n._webAudio){var P=function(){n._playLock=!1,M(),n._refreshBuffer(d);var A=d._muted||n._muted?0:d._volume;F.gain.setValueAtTime(A,ce.ctx.currentTime),d._playStart=ce.ctx.currentTime,typeof F.bufferSource.start>"u"?d._loop?F.bufferSource.noteGrainOn(0,y,86400):F.bufferSource.noteGrainOn(0,y,w):d._loop?F.bufferSource.start(0,y,86400):F.bufferSource.start(0,y,w),x!==1/0&&(n._endTimers[d._id]=setTimeout(n._ended.bind(n,d),x)),t||setTimeout(function(){n._emit("play",d._id),n._loadQueue()},0)};ce.state==="running"&&ce.ctx.state!=="interrupted"?P():(n._playLock=!0,n.once("resume",P),n._clearTimer(d._id))}else{var B=function(){F.currentTime=y,F.muted=d._muted||n._muted||ce._muted||F.muted,F.volume=d._volume*ce.volume(),F.playbackRate=d._rate;try{var A=F.play();if(A&&typeof Promise<"u"&&(A instanceof Promise||typeof A.then=="function")?(n._playLock=!0,M(),A.then(function(){n._playLock=!1,F._unlocked=!0,t?n._loadQueue():n._emit("play",d._id)}).catch(function(){n._playLock=!1,n._emit("playerror",d._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),d._ended=!0,d._paused=!0})):t||(n._playLock=!1,M(),n._emit("play",d._id)),F.playbackRate=d._rate,F.paused){n._emit("playerror",d._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}e!=="__default"||d._loop?n._endTimers[d._id]=setTimeout(n._ended.bind(n,d),x):(n._endTimers[d._id]=function(){n._ended(d),F.removeEventListener("ended",n._endTimers[d._id],!1)},F.addEventListener("ended",n._endTimers[d._id],!1))}catch(Y){n._emit("playerror",d._id,Y)}};F.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(F.src=n._src,F.load());var D=window&&window.ejecta||!F.readyState&&ce._navigator.isCocoonJS;if(F.readyState>=3||D)B();else{n._playLock=!0,n._state="loading";var O=function(){n._state="loaded",B(),F.removeEventListener(ce._canPlayEvent,O,!1)};F.addEventListener(ce._canPlayEvent,O,!1),n._clearTimer(d._id)}}return d._id},pause:function(e){var t=this;if(t._state!=="loaded"||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),i=0;i<n.length;i++){t._clearTimer(n[i]);var o=t._soundById(n[i]);if(o&&!o._paused&&(o._seek=t.seek(n[i]),o._rateSeek=0,o._paused=!0,t._stopFade(n[i]),o._node))if(t._webAudio){if(!o._node.bufferSource)continue;typeof o._node.bufferSource.stop>"u"?o._node.bufferSource.noteOff(0):o._node.bufferSource.stop(0),t._cleanBuffer(o._node)}else(!isNaN(o._node.duration)||o._node.duration===1/0)&&o._node.pause();arguments[1]||t._emit("pause",o?o._id:null)}return t},stop:function(e,t){var n=this;if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var i=n._getSoundIds(e),o=0;o<i.length;o++){n._clearTimer(i[o]);var a=n._soundById(i[o]);a&&(a._seek=a._start||0,a._rateSeek=0,a._paused=!0,a._ended=!0,n._stopFade(i[o]),a._node&&(n._webAudio?a._node.bufferSource&&(typeof a._node.bufferSource.stop>"u"?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),n._cleanBuffer(a._node)):(!isNaN(a._node.duration)||a._node.duration===1/0)&&(a._node.currentTime=a._start||0,a._node.pause(),a._node.duration===1/0&&n._clearSound(a._node))),t||n._emit("stop",a._id))}return n},mute:function(e,t){var n=this;if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(e,t)}}),n;if(typeof t>"u")if(typeof e=="boolean")n._muted=e;else return n._muted;for(var i=n._getSoundIds(t),o=0;o<i.length;o++){var a=n._soundById(i[o]);a&&(a._muted=e,a._interval&&n._stopFade(a._id),n._webAudio&&a._node?a._node.gain.setValueAtTime(e?0:a._volume,ce.ctx.currentTime):a._node&&(a._node.muted=ce._muted?!0:e),n._emit("mute",a._id))}return n},volume:function(){var e=this,t=arguments,n,i;if(t.length===0)return e._volume;if(t.length===1||t.length===2&&typeof t[1]>"u"){var o=e._getSoundIds(),a=o.indexOf(t[0]);a>=0?i=parseInt(t[0],10):n=parseFloat(t[0])}else t.length>=2&&(n=parseFloat(t[0]),i=parseInt(t[1],10));var d;if(typeof n<"u"&&n>=0&&n<=1){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"volume",action:function(){e.volume.apply(e,t)}}),e;typeof i>"u"&&(e._volume=n),i=e._getSoundIds(i);for(var _=0;_<i.length;_++)d=e._soundById(i[_]),d&&(d._volume=n,t[2]||e._stopFade(i[_]),e._webAudio&&d._node&&!d._muted?d._node.gain.setValueAtTime(n,ce.ctx.currentTime):d._node&&!d._muted&&(d._node.volume=n*ce.volume()),e._emit("volume",d._id))}else return d=i?e._soundById(i):e._sounds[0],d?d._volume:0;return e},fade:function(e,t,n,i){var o=this;if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"fade",action:function(){o.fade(e,t,n,i)}}),o;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),n=parseFloat(n),o.volume(e,i);for(var a=o._getSoundIds(i),d=0;d<a.length;d++){var _=o._soundById(a[d]);if(_){if(i||o._stopFade(a[d]),o._webAudio&&!_._muted){var y=ce.ctx.currentTime,w=y+n/1e3;_._volume=e,_._node.gain.setValueAtTime(e,y),_._node.gain.linearRampToValueAtTime(t,w)}o._startFadeInterval(_,e,t,n,a[d],typeof i>"u")}}return o},_startFadeInterval:function(e,t,n,i,o,a){var d=this,_=t,y=n-t,w=Math.abs(y/.01),x=Math.max(4,w>0?i/w:i),T=Date.now();e._fadeTo=n,e._interval=setInterval(function(){var E=(Date.now()-T)/i;T=Date.now(),_+=y*E,_=Math.round(_*100)/100,y<0?_=Math.max(n,_):_=Math.min(n,_),d._webAudio?e._volume=_:d.volume(_,e._id,!0),a&&(d._volume=_),(n<t&&_<=n||n>t&&_>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,d.volume(n,e._id),d._emit("fade",e._id))},x)},_stopFade:function(e){var t=this,n=t._soundById(e);return n&&n._interval&&(t._webAudio&&n._node.gain.cancelScheduledValues(ce.ctx.currentTime),clearInterval(n._interval),n._interval=null,t.volume(n._fadeTo,e),n._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e=this,t=arguments,n,i,o;if(t.length===0)return e._loop;if(t.length===1)if(typeof t[0]=="boolean")n=t[0],e._loop=n;else return o=e._soundById(parseInt(t[0],10)),o?o._loop:!1;else t.length===2&&(n=t[0],i=parseInt(t[1],10));for(var a=e._getSoundIds(i),d=0;d<a.length;d++)o=e._soundById(a[d]),o&&(o._loop=n,e._webAudio&&o._node&&o._node.bufferSource&&(o._node.bufferSource.loop=n,n&&(o._node.bufferSource.loopStart=o._start||0,o._node.bufferSource.loopEnd=o._stop,e.playing(a[d])&&(e.pause(a[d],!0),e.play(a[d],!0)))));return e},rate:function(){var e=this,t=arguments,n,i;if(t.length===0)i=e._sounds[0]._id;else if(t.length===1){var o=e._getSoundIds(),a=o.indexOf(t[0]);a>=0?i=parseInt(t[0],10):n=parseFloat(t[0])}else t.length===2&&(n=parseFloat(t[0]),i=parseInt(t[1],10));var d;if(typeof n=="number"){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"rate",action:function(){e.rate.apply(e,t)}}),e;typeof i>"u"&&(e._rate=n),i=e._getSoundIds(i);for(var _=0;_<i.length;_++)if(d=e._soundById(i[_]),d){e.playing(i[_])&&(d._rateSeek=e.seek(i[_]),d._playStart=e._webAudio?ce.ctx.currentTime:d._playStart),d._rate=n,e._webAudio&&d._node&&d._node.bufferSource?d._node.bufferSource.playbackRate.setValueAtTime(n,ce.ctx.currentTime):d._node&&(d._node.playbackRate=n);var y=e.seek(i[_]),w=(e._sprite[d._sprite][0]+e._sprite[d._sprite][1])/1e3-y,x=w*1e3/Math.abs(d._rate);(e._endTimers[i[_]]||!d._paused)&&(e._clearTimer(i[_]),e._endTimers[i[_]]=setTimeout(e._ended.bind(e,d),x)),e._emit("rate",d._id)}}else return d=e._soundById(i),d?d._rate:e._rate;return e},seek:function(){var e=this,t=arguments,n,i;if(t.length===0)e._sounds.length&&(i=e._sounds[0]._id);else if(t.length===1){var o=e._getSoundIds(),a=o.indexOf(t[0]);a>=0?i=parseInt(t[0],10):e._sounds.length&&(i=e._sounds[0]._id,n=parseFloat(t[0]))}else t.length===2&&(n=parseFloat(t[0]),i=parseInt(t[1],10));if(typeof i>"u")return 0;if(typeof n=="number"&&(e._state!=="loaded"||e._playLock))return e._queue.push({event:"seek",action:function(){e.seek.apply(e,t)}}),e;var d=e._soundById(i);if(d)if(typeof n=="number"&&n>=0){var _=e.playing(i);_&&e.pause(i,!0),d._seek=n,d._ended=!1,e._clearTimer(i),!e._webAudio&&d._node&&!isNaN(d._node.duration)&&(d._node.currentTime=n);var y=function(){_&&e.play(i,!0),e._emit("seek",i)};if(_&&!e._webAudio){var w=function(){e._playLock?setTimeout(w,0):y()};setTimeout(w,0)}else y()}else if(e._webAudio){var x=e.playing(i)?ce.ctx.currentTime-d._playStart:0,T=d._rateSeek?d._rateSeek-d._seek:0;return d._seek+(T+x*Math.abs(d._rate))}else return d._node.currentTime;return e},playing:function(e){var t=this;if(typeof e=="number"){var n=t._soundById(e);return n?!n._paused:!1}for(var i=0;i<t._sounds.length;i++)if(!t._sounds[i]._paused)return!0;return!1},duration:function(e){var t=this,n=t._duration,i=t._soundById(e);return i&&(n=t._sprite[i._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,n=0;n<t.length;n++)t[n]._paused||e.stop(t[n]._id),e._webAudio||(e._clearSound(t[n]._node),t[n]._node.removeEventListener("error",t[n]._errorFn,!1),t[n]._node.removeEventListener(ce._canPlayEvent,t[n]._loadFn,!1),t[n]._node.removeEventListener("ended",t[n]._endFn,!1),ce._releaseHtml5Audio(t[n]._node)),delete t[n]._node,e._clearTimer(t[n]._id);var i=ce._howls.indexOf(e);i>=0&&ce._howls.splice(i,1);var o=!0;for(n=0;n<ce._howls.length;n++)if(ce._howls[n]._src===e._src||e._src.indexOf(ce._howls[n]._src)>=0){o=!1;break}return si&&o&&delete si[e._src],ce.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,n,i){var o=this,a=o["_on"+e];return typeof t=="function"&&a.push(i?{id:n,fn:t,once:i}:{id:n,fn:t}),o},off:function(e,t,n){var i=this,o=i["_on"+e],a=0;if(typeof t=="number"&&(n=t,t=null),t||n)for(a=0;a<o.length;a++){var d=n===o[a].id;if(t===o[a].fn&&d||!t&&d){o.splice(a,1);break}}else if(e)i["_on"+e]=[];else{var _=Object.keys(i);for(a=0;a<_.length;a++)_[a].indexOf("_on")===0&&Array.isArray(i[_[a]])&&(i[_[a]]=[])}return i},once:function(e,t,n){var i=this;return i.on(e,t,n,1),i},_emit:function(e,t,n){for(var i=this,o=i["_on"+e],a=o.length-1;a>=0;a--)(!o[a].id||o[a].id===t||e==="load")&&(setTimeout(function(d){d.call(this,t,n)}.bind(i,o[a].fn),0),o[a].once&&i.off(e,o[a].fn,o[a].id));return i._loadQueue(e),i},_loadQueue:function(e){var t=this;if(t._queue.length>0){var n=t._queue[0];n.event===e&&(t._queue.shift(),t._loadQueue()),e||n.action()}return t},_ended:function(e){var t=this,n=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var i=!!(e._loop||t._sprite[n][2]);if(t._emit("end",e._id),!t._webAudio&&i&&t.stop(e._id,!0).play(e._id),t._webAudio&&i){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=ce.ctx.currentTime;var o=(e._stop-e._start)*1e3/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),o)}return t._webAudio&&!i&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),ce._autoSuspend()),!t._webAudio&&!i&&t.stop(e._id,!0),t},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if(typeof t._endTimers[e]!="function")clearTimeout(t._endTimers[e]);else{var n=t._soundById(e);n&&n._node&&n._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,n=0;n<t._sounds.length;n++)if(e===t._sounds[n]._id)return t._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new ls(e)},_drain:function(){var e=this,t=e._pool,n=0,i=0;if(!(e._sounds.length<t)){for(i=0;i<e._sounds.length;i++)e._sounds[i]._ended&&n++;for(i=e._sounds.length-1;i>=0;i--){if(n<=t)return;e._sounds[i]._ended&&(e._webAudio&&e._sounds[i]._node&&e._sounds[i]._node.disconnect(0),e._sounds.splice(i,1),n--)}}},_getSoundIds:function(e){var t=this;if(typeof e>"u"){for(var n=[],i=0;i<t._sounds.length;i++)n.push(t._sounds[i]._id);return n}else return[e]},_refreshBuffer:function(e){var t=this;return e._node.bufferSource=ce.ctx.createBufferSource(),e._node.bufferSource.buffer=si[t._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,ce.ctx.currentTime),t},_cleanBuffer:function(e){var t=this,n=ce._navigator&&ce._navigator.vendor.indexOf("Apple")>=0;if(!e.bufferSource)return t;if(ce._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),n))try{e.bufferSource.buffer=ce._scratchBuffer}catch{}return e.bufferSource=null,t},_clearSound:function(e){var t=/MSIE |Trident\//.test(ce._navigator&&ce._navigator.userAgent);t||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var ls=function(e){this._parent=e,this.init()};ls.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++ce._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,n=ce._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=typeof ce.ctx.createGain>"u"?ce.ctx.createGainNode():ce.ctx.createGain(),e._node.gain.setValueAtTime(n,ce.ctx.currentTime),e._node.paused=!0,e._node.connect(ce.masterGain)):ce.noAudio||(e._node=ce._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(ce._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=t._src,e._node.preload=t._preload===!0?"auto":t._preload,e._node.volume=n*ce.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++ce._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(e._node.duration*10)/10,Object.keys(t._sprite).length===0&&(t._sprite={__default:[0,t._duration*1e3]}),t._state!=="loaded"&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(ce._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(e._node.duration*10)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=t._duration*1e3),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var si={},m_=function(e){var t=e._src;if(si[t]){e._duration=si[t].duration,Gf(e);return}if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),i=new Uint8Array(n.length),o=0;o<n.length;++o)i[o]=n.charCodeAt(o);Wu(i.buffer,e)}else{var a=new XMLHttpRequest;a.open(e._xhr.method,t,!0),a.withCredentials=e._xhr.withCredentials,a.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(d){a.setRequestHeader(d,e._xhr.headers[d])}),a.onload=function(){var d=(a.status+"")[0];if(d!=="0"&&d!=="2"&&d!=="3"){e._emit("loaderror",null,"Failed loading audio file with status: "+a.status+".");return}Wu(a.response,e)},a.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete si[t],e.load())},__(a)}},__=function(e){try{e.send()}catch{e.onerror()}},Wu=function(e,t){var n=function(){t._emit("loaderror",null,"Decoding audio data failed.")},i=function(o){o&&t._sounds.length>0?(si[t._src]=o,Gf(t,o)):n()};typeof Promise<"u"&&ce.ctx.decodeAudioData.length===1?ce.ctx.decodeAudioData(e).then(i).catch(n):ce.ctx.decodeAudioData(e,i,n)},Gf=function(e,t){t&&!e._duration&&(e._duration=t.duration),Object.keys(e._sprite).length===0&&(e._sprite={__default:[0,e._duration*1e3]}),e._state!=="loaded"&&(e._state="loaded",e._emit("load"),e._loadQueue())},Fo=function(){if(ce.usingWebAudio){try{typeof AudioContext<"u"?ce.ctx=new AudioContext:typeof webkitAudioContext<"u"?ce.ctx=new webkitAudioContext:ce.usingWebAudio=!1}catch{ce.usingWebAudio=!1}ce.ctx||(ce.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(ce._navigator&&ce._navigator.platform),t=ce._navigator&&ce._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=t?parseInt(t[1],10):null;if(e&&n&&n<9){var i=/safari/.test(ce._navigator&&ce._navigator.userAgent.toLowerCase());ce._navigator&&!i&&(ce.usingWebAudio=!1)}ce.usingWebAudio&&(ce.masterGain=typeof ce.ctx.createGain>"u"?ce.ctx.createGainNode():ce.ctx.createGain(),ce.masterGain.gain.setValueAtTime(ce._muted?0:ce._volume,ce.ctx.currentTime),ce.masterGain.connect(ce.ctx.destination)),ce._setup()}};p_(fc,ce,as,ls);const zn=typeof self>"u",Uu=zn?{}:self;let _r,an,So,cs,at;if(typeof navigator<"u"&&(_r=navigator,an=_r.userAgent,So=_r.platform,cs=_r.mediaDevices),!zn){const e={Edge:{search:"Edg",verSearch:"Edg"},OPR:null,Chrome:null,Safari:{str:_r.vendor,search:"Apple",verSearch:["Version","iPhone OS","CPU OS"]},Firefox:null,Explorer:{search:"MSIE",verSearch:"MSIE"}},t={HarmonyOS:null,Android:null,iPhone:null,iPad:null,Windows:{str:So,search:"Win"},Mac:{str:So},Linux:{str:So}};let n="unknownBrowser",i=0,o="unknownOS";for(let a in e){const d=e[a]||{};let _=d.str||an,y=d.search||a,w=d.verStr||an,x=d.verSearch||a;if(x instanceof Array||(x=[x]),_.indexOf(y)!=-1){n=a;for(let T of x){let E=w.indexOf(T);if(E!=-1){i=parseFloat(w.substring(E+T.length+1));break}}break}}for(let a in t){const d=t[a]||{};let _=d.str||an,y=d.search||a;if(_.indexOf(y)!=-1){o=a;break}}o=="Linux"&&an.indexOf("Windows NT")!=-1&&(o="HarmonyOS"),at={browser:n,version:i,OS:o}}zn&&(at={browser:"ssr",version:0,OS:"ssr"});const v_=typeof WebAssembly<"u"&&an&&!(/Safari/.test(an)&&!/Chrome/.test(an)&&/\(.+\s11_2_([2-6]).*\)/.test(an)),y_=!(typeof Worker>"u"),Hf=!(!cs||!cs.getUserMedia),S_=async()=>{let e=!1;if(Hf)try{(await cs.getUserMedia({video:!0})).getTracks().forEach(t=>{t.stop()}),e=!0}catch{}return e};at.browser==="Chrome"&&at.version>66||at.browser==="Safari"&&at.version>13||at.browser==="OPR"&&at.version>43||at.browser==="Edge"&&at.version;const w_=(()=>{if(!zn&&document.currentScript){let e=document.currentScript.src,t=e.indexOf("?");if(t!=-1)e=e.substring(0,t);else{let n=e.indexOf("#");n!=-1&&(e=e.substring(0,n))}return e.substring(0,e.lastIndexOf("/")+1)}return"./"})(),vr=" is not allowed to change after `createInstance` or `loadWasm` is called.",C_=!zn&&document.currentScript&&(document.currentScript.getAttribute("data-license")||document.currentScript.getAttribute("data-productKeys")||document.currentScript.getAttribute("data-licenseKey")||document.currentScript.getAttribute("data-handshakeCode")||document.currentScript.getAttribute("data-organizationID"))||"",x_=!zn&&document.currentScript&&document.currentScript.getAttribute("data-sessionPassword")||"",Gu=e=>{if(e==null)e=[];else{e=e instanceof Array?[...e]:[e];for(let t=0;t<e.length;++t){if(!zn){let n=document.createElement("a");n.href=e[t],e[t]=n.href}e[t].endsWith("/")||(e[t]+="/")}}return e};var Be,us,ul,bt,tr;(function(e){e[e.IPF_Binary=0]="IPF_Binary",e[e.IPF_BinaryInverted=1]="IPF_BinaryInverted",e[e.IPF_GrayScaled=2]="IPF_GrayScaled",e[e.IPF_NV21=3]="IPF_NV21",e[e.IPF_RGB_565=4]="IPF_RGB_565",e[e.IPF_RGB_555=5]="IPF_RGB_555",e[e.IPF_RGB_888=6]="IPF_RGB_888",e[e.IPF_ARGB_8888=7]="IPF_ARGB_8888",e[e.IPF_RGB_161616=8]="IPF_RGB_161616",e[e.IPF_ARGB_16161616=9]="IPF_ARGB_16161616",e[e.IPF_ABGR_8888=10]="IPF_ABGR_8888",e[e.IPF_ABGR_16161616=11]="IPF_ABGR_16161616",e[e.IPF_BGR_888=12]="IPF_BGR_888"})(Be||(Be={})),function(e){e[e.DBR_SYSTEM_EXCEPTION=1]="DBR_SYSTEM_EXCEPTION",e[e.DBR_SUCCESS=0]="DBR_SUCCESS",e[e.DBR_UNKNOWN=-1e4]="DBR_UNKNOWN",e[e.DBR_NO_MEMORY=-10001]="DBR_NO_MEMORY",e[e.DBR_NULL_REFERENCE=-10002]="DBR_NULL_REFERENCE",e[e.DBR_LICENSE_INVALID=-10003]="DBR_LICENSE_INVALID",e[e.DBR_LICENSE_EXPIRED=-10004]="DBR_LICENSE_EXPIRED",e[e.DBR_FILE_NOT_FOUND=-10005]="DBR_FILE_NOT_FOUND",e[e.DBR_FILETYPE_NOT_SUPPORTED=-10006]="DBR_FILETYPE_NOT_SUPPORTED",e[e.DBR_BPP_NOT_SUPPORTED=-10007]="DBR_BPP_NOT_SUPPORTED",e[e.DBR_INDEX_INVALID=-10008]="DBR_INDEX_INVALID",e[e.DBR_BARCODE_FORMAT_INVALID=-10009]="DBR_BARCODE_FORMAT_INVALID",e[e.DBR_CUSTOM_REGION_INVALID=-10010]="DBR_CUSTOM_REGION_INVALID",e[e.DBR_MAX_BARCODE_NUMBER_INVALID=-10011]="DBR_MAX_BARCODE_NUMBER_INVALID",e[e.DBR_IMAGE_READ_FAILED=-10012]="DBR_IMAGE_READ_FAILED",e[e.DBR_TIFF_READ_FAILED=-10013]="DBR_TIFF_READ_FAILED",e[e.DBR_QR_LICENSE_INVALID=-10016]="DBR_QR_LICENSE_INVALID",e[e.DBR_1D_LICENSE_INVALID=-10017]="DBR_1D_LICENSE_INVALID",e[e.DBR_DIB_BUFFER_INVALID=-10018]="DBR_DIB_BUFFER_INVALID",e[e.DBR_PDF417_LICENSE_INVALID=-10019]="DBR_PDF417_LICENSE_INVALID",e[e.DBR_DATAMATRIX_LICENSE_INVALID=-10020]="DBR_DATAMATRIX_LICENSE_INVALID",e[e.DBR_PDF_READ_FAILED=-10021]="DBR_PDF_READ_FAILED",e[e.DBR_PDF_DLL_MISSING=-10022]="DBR_PDF_DLL_MISSING",e[e.DBR_PAGE_NUMBER_INVALID=-10023]="DBR_PAGE_NUMBER_INVALID",e[e.DBR_CUSTOM_SIZE_INVALID=-10024]="DBR_CUSTOM_SIZE_INVALID",e[e.DBR_CUSTOM_MODULESIZE_INVALID=-10025]="DBR_CUSTOM_MODULESIZE_INVALID",e[e.DBR_RECOGNITION_TIMEOUT=-10026]="DBR_RECOGNITION_TIMEOUT",e[e.DBR_JSON_PARSE_FAILED=-10030]="DBR_JSON_PARSE_FAILED",e[e.DBR_JSON_TYPE_INVALID=-10031]="DBR_JSON_TYPE_INVALID",e[e.DBR_JSON_KEY_INVALID=-10032]="DBR_JSON_KEY_INVALID",e[e.DBR_JSON_VALUE_INVALID=-10033]="DBR_JSON_VALUE_INVALID",e[e.DBR_JSON_NAME_KEY_MISSING=-10034]="DBR_JSON_NAME_KEY_MISSING",e[e.DBR_JSON_NAME_VALUE_DUPLICATED=-10035]="DBR_JSON_NAME_VALUE_DUPLICATED",e[e.DBR_TEMPLATE_NAME_INVALID=-10036]="DBR_TEMPLATE_NAME_INVALID",e[e.DBR_JSON_NAME_REFERENCE_INVALID=-10037]="DBR_JSON_NAME_REFERENCE_INVALID",e[e.DBR_PARAMETER_VALUE_INVALID=-10038]="DBR_PARAMETER_VALUE_INVALID",e[e.DBR_DOMAIN_NOT_MATCHED=-10039]="DBR_DOMAIN_NOT_MATCHED",e[e.DBR_RESERVEDINFO_NOT_MATCHED=-10040]="DBR_RESERVEDINFO_NOT_MATCHED",e[e.DBR_AZTEC_LICENSE_INVALID=-10041]="DBR_AZTEC_LICENSE_INVALID",e[e.DBR_LICENSE_DLL_MISSING=-10042]="DBR_LICENSE_DLL_MISSING",e[e.DBR_LICENSEKEY_NOT_MATCHED=-10043]="DBR_LICENSEKEY_NOT_MATCHED",e[e.DBR_REQUESTED_FAILED=-10044]="DBR_REQUESTED_FAILED",e[e.DBR_LICENSE_INIT_FAILED=-10045]="DBR_LICENSE_INIT_FAILED",e[e.DBR_PATCHCODE_LICENSE_INVALID=-10046]="DBR_PATCHCODE_LICENSE_INVALID",e[e.DBR_POSTALCODE_LICENSE_INVALID=-10047]="DBR_POSTALCODE_LICENSE_INVALID",e[e.DBR_DPM_LICENSE_INVALID=-10048]="DBR_DPM_LICENSE_INVALID",e[e.DBR_FRAME_DECODING_THREAD_EXISTS=-10049]="DBR_FRAME_DECODING_THREAD_EXISTS",e[e.DBR_STOP_DECODING_THREAD_FAILED=-10050]="DBR_STOP_DECODING_THREAD_FAILED",e[e.DBR_SET_MODE_ARGUMENT_ERROR=-10051]="DBR_SET_MODE_ARGUMENT_ERROR",e[e.DBR_LICENSE_CONTENT_INVALID=-10052]="DBR_LICENSE_CONTENT_INVALID",e[e.DBR_LICENSE_KEY_INVALID=-10053]="DBR_LICENSE_KEY_INVALID",e[e.DBR_LICENSE_DEVICE_RUNS_OUT=-10054]="DBR_LICENSE_DEVICE_RUNS_OUT",e[e.DBR_GET_MODE_ARGUMENT_ERROR=-10055]="DBR_GET_MODE_ARGUMENT_ERROR",e[e.DBR_IRT_LICENSE_INVALID=-10056]="DBR_IRT_LICENSE_INVALID",e[e.DBR_MAXICODE_LICENSE_INVALID=-10057]="DBR_MAXICODE_LICENSE_INVALID",e[e.DBR_GS1_DATABAR_LICENSE_INVALID=-10058]="DBR_GS1_DATABAR_LICENSE_INVALID",e[e.DBR_GS1_COMPOSITE_LICENSE_INVALID=-10059]="DBR_GS1_COMPOSITE_LICENSE_INVALID",e[e.DBR_PANORAMA_LICENSE_INVALID=-10060]="DBR_PANORAMA_LICENSE_INVALID",e[e.DBR_DOTCODE_LICENSE_INVALID=-10061]="DBR_DOTCODE_LICENSE_INVALID",e[e.DBR_PHARMACODE_LICENSE_INVALID=-10062]="DBR_PHARMACODE_LICENSE_INVALID",e[e.DBR_IMAGE_ORIENTATION_INVALID=-10063]="DBR_IMAGE_ORIENTATION_INVALID",e[e.DMERR_NO_LICENSE=-2e4]="DMERR_NO_LICENSE",e[e.DMERR_LICENSE_SYNC_FAILED=-20003]="DMERR_LICENSE_SYNC_FAILED",e[e.DMERR_TRIAL_LICENSE=-20010]="DMERR_TRIAL_LICENSE",e[e.DMERR_FAILED_TO_REACH_LTS=-20200]="DMERR_FAILED_TO_REACH_LTS"}(us||(us={})),function(e){e[e.IMRDT_IMAGE=1]="IMRDT_IMAGE",e[e.IMRDT_CONTOUR=2]="IMRDT_CONTOUR",e[e.IMRDT_LINESEGMENT=4]="IMRDT_LINESEGMENT",e[e.IMRDT_LOCALIZATIONRESULT=8]="IMRDT_LOCALIZATIONRESULT",e[e.IMRDT_REGIONOFINTEREST=16]="IMRDT_REGIONOFINTEREST",e[e.IMRDT_QUADRILATERAL=32]="IMRDT_QUADRILATERAL"}(ul||(ul={})),function(e){e[e.BF_ALL=-29360129]="BF_ALL",e[e.BF_ONED=3147775]="BF_ONED",e[e.BF_GS1_DATABAR=260096]="BF_GS1_DATABAR",e[e.BF_CODE_39=1]="BF_CODE_39",e[e.BF_CODE_128=2]="BF_CODE_128",e[e.BF_CODE_93=4]="BF_CODE_93",e[e.BF_CODABAR=8]="BF_CODABAR",e[e.BF_ITF=16]="BF_ITF",e[e.BF_EAN_13=32]="BF_EAN_13",e[e.BF_EAN_8=64]="BF_EAN_8",e[e.BF_UPC_A=128]="BF_UPC_A",e[e.BF_UPC_E=256]="BF_UPC_E",e[e.BF_INDUSTRIAL_25=512]="BF_INDUSTRIAL_25",e[e.BF_CODE_39_EXTENDED=1024]="BF_CODE_39_EXTENDED",e[e.BF_GS1_DATABAR_OMNIDIRECTIONAL=2048]="BF_GS1_DATABAR_OMNIDIRECTIONAL",e[e.BF_GS1_DATABAR_TRUNCATED=4096]="BF_GS1_DATABAR_TRUNCATED",e[e.BF_GS1_DATABAR_STACKED=8192]="BF_GS1_DATABAR_STACKED",e[e.BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL=16384]="BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL",e[e.BF_GS1_DATABAR_EXPANDED=32768]="BF_GS1_DATABAR_EXPANDED",e[e.BF_GS1_DATABAR_EXPANDED_STACKED=65536]="BF_GS1_DATABAR_EXPANDED_STACKED",e[e.BF_GS1_DATABAR_LIMITED=131072]="BF_GS1_DATABAR_LIMITED",e[e.BF_PATCHCODE=262144]="BF_PATCHCODE",e[e.BF_PDF417=33554432]="BF_PDF417",e[e.BF_QR_CODE=67108864]="BF_QR_CODE",e[e.BF_DATAMATRIX=134217728]="BF_DATAMATRIX",e[e.BF_AZTEC=268435456]="BF_AZTEC",e[e.BF_MAXICODE=536870912]="BF_MAXICODE",e[e.BF_MICRO_QR=1073741824]="BF_MICRO_QR",e[e.BF_MICRO_PDF417=524288]="BF_MICRO_PDF417",e[e.BF_GS1_COMPOSITE=-2147483648]="BF_GS1_COMPOSITE",e[e.BF_MSI_CODE=1048576]="BF_MSI_CODE",e[e.BF_CODE_11=2097152]="BF_CODE_11",e[e.BF_NULL=0]="BF_NULL"}(bt||(bt={})),function(e){e[e.IRT_NO_RESULT=0]="IRT_NO_RESULT",e[e.IRT_ORIGINAL_IMAGE=1]="IRT_ORIGINAL_IMAGE",e[e.IRT_COLOUR_CLUSTERED_IMAGE=2]="IRT_COLOUR_CLUSTERED_IMAGE",e[e.IRT_COLOUR_CONVERTED_GRAYSCALE_IMAGE=4]="IRT_COLOUR_CONVERTED_GRAYSCALE_IMAGE",e[e.IRT_TRANSFORMED_GRAYSCALE_IMAGE=8]="IRT_TRANSFORMED_GRAYSCALE_IMAGE",e[e.IRT_PREDETECTED_REGION=16]="IRT_PREDETECTED_REGION",e[e.IRT_PREPROCESSED_IMAGE=32]="IRT_PREPROCESSED_IMAGE",e[e.IRT_BINARIZED_IMAGE=64]="IRT_BINARIZED_IMAGE",e[e.IRT_TEXT_ZONE=128]="IRT_TEXT_ZONE",e[e.IRT_CONTOUR=256]="IRT_CONTOUR",e[e.IRT_LINE_SEGMENT=512]="IRT_LINE_SEGMENT",e[e.IRT_FORM=1024]="IRT_FORM",e[e.IRT_SEGMENTATION_BLOCK=2048]="IRT_SEGMENTATION_BLOCK",e[e.IRT_TYPED_BARCODE_ZONE=4096]="IRT_TYPED_BARCODE_ZONE",e[e.IRT_PREDETECTED_QUADRILATERAL=8192]="IRT_PREDETECTED_QUADRILATERAL"}(tr||(tr={}));const Hu=e=>e&&typeof e=="object"&&typeof e.then=="function";class zf extends Promise{constructor(t){let n,i;super((o,a)=>{n=o,i=a}),this._s="pending",this.resolve=o=>{this.isPending&&(Hu(o)?this.task=o:(this._s="fulfilled",n(o)))},this.reject=o=>{this.isPending&&(this._s="rejected",i(o))},this.task=t}get status(){return this._s}get isPending(){return this._s==="pending"}get isFulfilled(){return this._s==="fulfilled"}get isRejected(){return this._s==="rejected"}get task(){return this._task}set task(t){let n;this._task=t,Hu(t)?n=t:typeof t=="function"&&(n=new Promise(t)),n&&(async()=>{try{const i=await n;t===this._task&&this.resolve(i)}catch(i){t===this._task&&this.reject(i)}})()}get isEmpty(){return this._task==null}}const ha=["iPhone","iPad","Android","HarmonyOS"].includes(at.OS)?2048:4096;class W{constructor(){this._instanceID=void 0,this._ifSaveOriginalImageInACanvas=!1,this.oriCanvas=null,this.oriCanvasData=null,this.canvas=null,this.bFilterRegionInJs=!1,this._region=null,this._timeStartDecode=null,this._timeEnterInnerDBR=null,this._timeGetMessage=null,this.decodeRecords={},this.bDestroyed=!1,this._lastErrorCode=0,this._lastErrorString="",this._lastInnerDecodeDuration=0,this.intervalTime=0,this._intervalGetVideoFrame=0,this.array_getFrameTimeCost=[],this.array_decodeFrameTimeCost=[],this._indexCurrentDecodingFrame=0,this._arrPolygons=[],this._bPauseScan=!1,this._intervalDetectVideoPause=1e3,this._soundSource="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAABQAAAkAAgICAgICAgICAgICAgICAgICAgKCgoKCgoKCgoKCgoKCgoKCgoKCgwMDAwMDAwMDAwMDAwMDAwMDAwMDg4ODg4ODg4ODg4ODg4ODg4ODg4P//////////////////////////AAAAAExhdmM1OC41NAAAAAAAAAAAAAAAACQEUQAAAAAAAAJAk0uXRQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAANQAbGeUEQAAHZYZ3fASqD4P5TKBgocg+Bw/8+CAYBA4XB9/4EBAEP4nB9+UOf/6gfUCAIKyjgQ/Kf//wfswAAAwQA/+MYxAYOqrbdkZGQAMA7DJLCsQxNOij///////////+tv///3RWiZGBEhsf/FO/+LoCSFs1dFVS/g8f/4Mhv0nhqAieHleLy/+MYxAYOOrbMAY2gABf/////////////////usPJ66R0wI4boY9/8jQYg//g2SPx1M0N3Z0kVJLIs///Uw4aMyvHJJYmPBYG/+MYxAgPMALBucAQAoGgaBoFQVBUFQWDv6gZBUFQVBUGgaBr5YSgqCoKhIGg7+IQVBUFQVBoGga//SsFSoKnf/iVTEFNRTMu/+MYxAYAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",this.bPlaySoundOnSuccessfulRead=!1,this.bVibrateOnSuccessfulRead=!1,this.vibrateDuration=300,this.captureAndDecodeInParallel=!0,this.autoSuggestTip=!1,this.suggestTipFrameArray=[],this.suggestTipFrameLimit=[5,3],this.noIntermediateResultsCount=0,this.noIntermediateResultsTipLimit=100,this.tinyBarcodeTipModuleSizeLimit=3,this.hugeBarcodeTipLimit=.9,this.autoZoomInFrameArray=[],this.autoZoomInFrameLimit=[5,3],this.autoZoomInStepRate=1/3,this.autoZoomInMaxStep=1.5,this.autoZoomInMaxTimes=5,this.autoZoomInMinStep=Math.pow(10,1/this.autoZoomInMaxTimes),this.autoZoomInIdealModuleSize=6,this.autoZoomOutFrameCount=0,this.autoZoomOutFrameLimit=3,this.autoZoomOutStepRate=1/3,this.autoZoomOutMinValue=1,this.autoZoomOutMinStep=2,this.autoZoomOutStepRate_2=.05,this.autoZoomOutMinValue_2=2,this.frameArrayInIdealZoom=[],this.frameLimitInIdealZoom=[5,3],this.enableZoomOutInIdealZoom=!1,this.nextActionInIdealZoom="focus",this.autoFocusFrameArray=[],this.autoFocusFrameLimit=[5,3],this.autoZoomIdealArea=[0,.05],this.autoZoomTargetBorder=.9,this.autoZoomDetectionArea=.5,this.autoZoom=!1,this.autoFocus=!1,this._resultHighlightingDuration=-1,this._dce=null,this._imgSource=null,this._maxCvsSideLength=ha,this._promiseStartScan=null,this.beepSound=new as({src:[this._soundSource],onplayerror:(t,n)=>{console.warn(`Sound '${t}' playback failure: ${n}`)}})}static get version(){return this._version}static get license(){return this._license}static set license(t){((n,i)=>{const o=n;if(!o._pLoad.isEmpty)throw new Error("`license`"+vr);o._license=i})(W,t)}static get productKeys(){return this._license}static set productKeys(t){W.license=t}static get handshakeCode(){return this._license}static set handshakeCode(t){W.license=t}static get organizationID(){return this._license}static set organizationID(t){W.license=t}static set sessionPassword(t){((n,i)=>{const o=n;if(!o._pLoad.isEmpty)throw new Error("`sessionPassword`"+vr);o._sessionPassword=i})(W,t)}static get sessionPassword(){return this._sessionPassword}static async detectEnvironment(){return await(async()=>({wasm:v_,worker:y_,getUserMedia:Hf,camera:await S_(),browser:at.browser,version:at.version,OS:at.OS}))()}static get engineResourcePath(){return this._engineResourcePath}static set engineResourcePath(t){if(!this._pLoad.isEmpty)throw new Error("`engineResourcePath` is not allowed to change after `createInstance` or `loadWasm` is called.");W._engineResourcePath=(n=>{if(n==null&&(n="./"),!zn){let i=document.createElement("a");i.href=n,n=i.href}return n.endsWith("/")||(n+="/"),n})(t)}static get licenseServer(){return this._licenseServer}static set licenseServer(t){((n,i)=>{const o=n;if(!o._pLoad.isEmpty)throw new Error("`licenseServer`"+vr);o._licenseServer=Gu(i)})(W,t)}static get deviceFriendlyName(){return this._deviceFriendlyName}static set deviceFriendlyName(t){((n,i)=>{const o=n;if(!o._pLoad.isEmpty)throw new Error("`deviceFriendlyName`"+vr);o._deviceFriendlyName=i||""})(W,t)}static get _bUseFullFeature(){return this.__bUseFullFeature}static set _bUseFullFeature(t){if(!this._pLoad.isEmpty)throw new Error("`_bUseFullFeature` is not allowed to change after `createInstance` or `loadWasm` is called.");W.__bUseFullFeature=t}static isImageSource(t){return!(!t||typeof t!="object"||Array.isArray(t))&&"getImage"in t}static isDSImage(t){return!(!t||typeof t!="object"||Array.isArray(t))&&"data"in t&&"width"in t&&"height"in t&&"pixelFormat"in t}static isDCEFrame(t){return!(!t||typeof t!="object"||Array.isArray(t))&&"data"in t&&"region"in t&&"sx"in t&&"sy"in t&&"width"in t&&"height"in t&&("colorMode"in t||"pixelFormat"in t)&&"timeSpent"in t&&"timeStamp"in t&&"isCropped"in t&&"toCanvas"in t&&"_sWidth"in t&&"_sHeight"in t&&"_bUseWebGL"in t}get ifSaveOriginalImageInACanvas(){return this._ifSaveOriginalImageInACanvas}set ifSaveOriginalImageInACanvas(t){this._ifSaveOriginalImageInACanvas=t}getOriginalImageInACanvas(){return!this.oriCanvas&&this.oriCanvasData?this.oriCanvasData.toCanvas():this.oriCanvas}set region(t){this._region=t,this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}get region(){return this._region}static isWasmLoaded(){return this._pLoad.isFulfilled}isContextDestroyed(){return this.bDestroyed}static get lastErrorCode(){return this._lastErrorCode}static get lastErrorString(){return this._lastErrorString}get lastErrorCode(){return this._lastErrorCode}get lastErrorString(){return this._lastErrorString}static get defaultUIElementURL(){var t;return(t=W._defaultUIElementURL)===null||t===void 0?void 0:t.replace("@engineResourcePath/",W.engineResourcePath)}static set defaultUIElementURL(t){W._defaultUIElementURL=t}static _fireHTTPSWarnning(){W.onWarning&&location&&location.protocol!=="https:"&&setTimeout(()=>{W.onWarning&&W.onWarning({id:2,message:"Not connected via SSL (HTTPS), the SDK may not work correctly."})},0)}get soundSource(){return this._soundSource}set soundSource(t){this._soundSource=t,this.beepSound=new as({src:[this._soundSource],onplayerror:(n,i)=>{console.warn(`Sound '${n}' playback failure: ${i}`)}})}get whenToPlaySoundforSuccessfulRead(){return this.bPlaySoundOnSuccessfulRead===!0?"frame":this.bPlaySoundOnSuccessfulRead?this.bPlaySoundOnSuccessfulRead:"never"}set whenToPlaySoundforSuccessfulRead(t){this.bPlaySoundOnSuccessfulRead=t!=="never"&&t}get whenToVibrateforSuccessfulRead(){return this.bVibrateOnSuccessfulRead===!0?"frame":this.bVibrateOnSuccessfulRead?this.bVibrateOnSuccessfulRead:"never"}set whenToVibrateforSuccessfulRead(t){this.bVibrateOnSuccessfulRead=t!=="never"&&t}set dce(t){this._dce=t}get dce(){return!this._dce||this._dce.isDisposed||this._dce.disposed?null:this._dce}set maxCvsSideLength(t){this._maxCvsSideLength=t,this._dceControler&&this._dceControler.setDisiredValue(this,"maxCvsSideLength",t)}get maxCvsSideLength(){return this._maxCvsSideLength}async _registerDCEControler(){if(!this.dce)return;W._onLog&&W._onLog("_registerDCEControler()");const t=this.dce;this._dceControler=t._createControler();const n=this._dceControler;n.register(this),n.setDisiredValue(this,"refreshInterval",200),n.setDisiredValue(this,"maxCvsSideLength",this._maxCvsSideLength),this._styleIdBeforeVerification=this.dce.createDrawingStyle({fillStyle:"rgba(248,252,0,0.2)",strokeStyle:"transparent",paintMode:"strokeAndFill"});try{}catch(a){a.name==="ReferenceError"&&window&&(window.ResizeObserver=void 0)}const i=t.getUIElement(),o=this.dce.constructor;if(o._defaultUIElementURL==="@engineResourcePath/dce.ui.html")try{i?i===n._innerSetUI&&(await t.setUIElement(`${o.engineResourcePath}dce.ui.html`),n._innerSetUI=t.getUIElement()):(await t.setUIElement(`${o.engineResourcePath}dbr.ui.html`),n._innerSetUI=t.getUIElement())}catch{await t.setUIElement(o.defaultUIElementURL)}else i||await t.setUIElement(o.defaultUIElementURL);this.callbackCameraChange=()=>{this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0},this.callbackResolutionChange=()=>{this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0},this.callbackCameraClose=()=>{this.stopScanning(!0),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0,this._bPauseScan=!1},this.callbackSingleFrameAcquired=async a=>{this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null);let d=await this._decode_DCEFrame(a,{bCopyData:!1}),_=null;if(d&&d.length){const{sx:y,sy:w,width:x,height:T,_sWidth:E,_sHeight:M}=a;_=d.map(F=>({localizationResult:JSON.parse(JSON.stringify(F.localizationResult))})),W.recalculateResultLocation(_,y,w,E,M,x,T)}if(this._drawResults(_,d),await this.clearMapDecodeRecord(),this.onImageRead&&this.dce.isOpen()&&!this._bPauseScan){let y=this._cloneDecodeResults(d);this.onImageRead(y)}if(this.onUniqueRead&&this.dce.isOpen()&&!this._bPauseScan)for(let y of d)this.onUniqueRead(y.barcodeText,this._cloneDecodeResults(y))},t.on("cameraChange",this.callbackCameraChange),t.on("resolutionChange",this.callbackResolutionChange),t.on("cameraClose",this.callbackCameraClose),t.on("singleFrameAcquired",this.callbackSingleFrameAcquired)}_logoutDCEControler(){this.dce&&this._dceControler&&(W._onLog&&W._onLog("_logoutDCEControler()"),this._dceControler.logout(this),this.dce.off("cameraChange",this.callbackCameraChange),this.dce.off("resolutionChange",this.callbackResolutionChange),this.dce.off("cameraClose",this.callbackCameraClose),this.dce.off("singleFrameAcquired",this.callbackSingleFrameAcquired),this._dceControler=null,this.dce=null)}async setImageSource(t,n){if(t==null)return this._imgSource=null,this._logoutDCEControler(),void(this._drawingItemNamespace=null);if(t&&t.isCameraEnhancer)this.dce=t,await this._registerDCEControler(),this._imgSource=null;else{if(!W.isImageSource(t))throw new Error("Invalid value.");this._logoutDCEControler(),this._imgSource=t}n&&n.resultsHighlightBaseShapes&&(this._drawingItemNamespace=n.resultsHighlightBaseShapes)}static async loadWasm(){if(this._pLoad.isEmpty){let{lt:t,l:n,ls:i,sp:o,rmk:a}=(d=>{const _=d;if(_._pLoad.isEmpty){let y,w,x=_._license||"",T=JSON.parse(JSON.stringify(_._licenseServer)),E=_._sessionPassword,M=0;if(x.startsWith("t")||x.startsWith("f"))M=0;else if(x.length===0||x.startsWith("P")||x.startsWith("L")||x.startsWith("Y")||x.startsWith("A"))M=1;else{M=2;const F=x.indexOf(":");if(F!=-1&&(x=x.substring(F+1)),x.startsWith("DLS2")){let P;try{let B=x.substring(4);B=atob(B),P=JSON.parse(B)}catch{throw new Error("Format Error: The license string you specified is invalid, please check to make sure it is correct.")}if(x=P.handshakeCode?P.handshakeCode:P.organizationID?P.organizationID:"",typeof x=="number"&&(x=JSON.stringify(x)),T.length===0){let B=[];P.mainServerURL&&(B[0]=P.mainServerURL),P.standbyServerURL&&(B[1]=P.standbyServerURL),T=Gu(B)}!E&&P.sessionPassword&&(E=P.sessionPassword),y=P.remark}(x==="200001"||x.startsWith("200001-"))&&(T&&T.length||(x="")),x||(M=1)}if(M&&(Uu.crypto||(w="Please upgrade your browser to support online key."),Uu.crypto.subtle||(w="Require https to use online key in this browser.")),w){if(M!==1)throw new Error(w);M=0,console.warn(w),_._lastErrorCode=-1,_._lastErrorString=w}return M===1&&(x="",console.warn("Applying for a public trial license ...")),{lt:M,l:x,ls:T,sp:E,rmk:y}}throw new Error("Can't preprocess license again"+vr)})(W);this._pLoad.task=async(d,_)=>{let y=W.engineResourcePath+W._workerName;W.engineResourcePath.startsWith(location.origin)||(y=await fetch(y).then(w=>w.blob()).then(w=>URL.createObjectURL(w))),W._dbrWorker=new Worker(y),W._dbrWorker.onerror=w=>{let x=new Error(w.message);_(x)},W._dbrWorker.onmessage=async w=>{let x=w.data?w.data:w;switch(x.type){case"log":W._onLog&&W._onLog(x.message);break;case"load":{x.message&&(x.message=x.message.replace("(https://www.dynamsoft.com/purchase-center/)","(https://www.dynamsoft.com/store/dynamsoft-barcode-reader/#javascript)"));let T,E=!1;t===1&&(E=!0,x.message||(x.message="Using a temporary license. [Register for a 30-day trial license >>>](https://www.dynamsoft.com/customer/license/trialLicense?product=dbr&deploymenttype=browser)")),x.success?(W._dbrWorker.onerror=null,W._version=x.version+"(JS "+W._jsVersion+"."+W._jsEditVersion+")",W._onLog&&W._onLog("load dbr worker success"),x.message&&console.warn(x.message)):(T=new Error(x.message),T.stack=x.stack+`
`+T.stack,T.ltsErrorCode=x.ltsErrorCode,E||x.ltsErrorCode==111&&x.message.toLowerCase().indexOf("trial license")!=-1&&(E=!0)),E&&W.showDialog(x.success?"warn":"error",x.message),x.success?d():_(T);break}case"task":{let T=x.id,E=x.body;try{W._taskCallbackMap.get(T)(E),W._taskCallbackMap.delete(T)}catch(M){throw W._taskCallbackMap.delete(T),M}break}default:W._onLog&&W._onLog(w)}},W._dbrWorker.postMessage({type:"loadWasm",engineResourcePath:W.engineResourcePath,bUseFullFeature:W._bUseFullFeature,bd:W._bWasmDebug,v:W._jsVersion,brtk:!!t,bptk:t===1,l:n,dm:location.origin.startsWith("http")?location.origin:"https://localhost",os:at,cv:W.authCacheVersion,fn:W.deviceFriendlyName,ls:i,sp:o,rmk:a})}}await this._pLoad}static async showDialog(t,n){await(async(i,o,a)=>{if(!i._bNeverShowDialog)try{let d=await fetch(i.engineResourcePath+"dls.license.dialog.html");if(!d.ok)throw Error("Get license dialog fail. Network Error: "+d.statusText);let _=await d.text();if(!_.trim().startsWith("<"))throw Error("Get license dialog fail. Can't get valid HTMLElement.");let y=document.createElement("div");y.innerHTML=_;let w=[];for(let O=0;O<y.childElementCount;++O){let A=y.children[O];A instanceof HTMLStyleElement&&(w.push(A),document.head.append(A))}let x=y.childElementCount==1?y.children[0]:y;x.remove();let T,E,M,F,P,B=[x],D=x.children;for(let O of D)B.push(O);for(let O=0;O<B.length;++O)for(let A of B[O].children)B.push(A);for(let O of B)if(!T&&O.classList.contains("dls-license-mask"))T=O,O.addEventListener("click",A=>{if(O==A.target){x.remove();for(let Y of w)Y.remove()}});else if(!E&&O.classList.contains("dls-license-icon-close"))E=O,O.addEventListener("click",()=>{x.remove();for(let A of w)A.remove()});else if(!M&&O.classList.contains("dls-license-icon-error"))M=O,o!="error"&&O.remove();else if(!F&&O.classList.contains("dls-license-icon-warn"))F=O,o!="warn"&&O.remove();else if(!P&&O.classList.contains("dls-license-msg-content")){P=O;let A=a;for(;A;){let Y=A.indexOf("["),ne=A.indexOf("]",Y),oe=A.indexOf("(",ne),K=A.indexOf(")",oe);if(Y==-1||ne==-1||oe==-1||K==-1){O.appendChild(new Text(A));break}Y>0&&O.appendChild(new Text(A.substring(0,Y)));let S=document.createElement("a"),ue=A.substring(Y+1,ne);S.innerText=ue;let le=A.substring(oe+1,K);S.setAttribute("href",le),S.setAttribute("target","_blank"),O.appendChild(S),A=A.substring(K+1)}}document.body.appendChild(x)}catch(d){i._onLog&&i._onLog(d.message||d)}})(this,t,n)}static async createInstanceInWorker(t=!1){return await W.loadWasm(),await new Promise((n,i)=>{let o=W._nextTaskID++;W._taskCallbackMap.set(o,a=>{if(a.success)return n(a.instanceID);{let d=new Error(a.message);return d.stack=a.stack+`
`+d.stack,i(d)}}),W._dbrWorker.postMessage({type:"createInstance",id:o,bScanner:t})})}static async createInstance(){const t=new W;return t._instanceID=await W.createInstanceInWorker(),W._fireHTTPSWarnning(),t}async clearMapDecodeRecord(){return await new Promise((t,n)=>{let i=W._nextTaskID++;W._taskCallbackMap.set(i,o=>{if(o.success)return t();{let a=new Error(o.message);return a.stack=o.stack+`
`+a.stack,n(a)}}),W._dbrWorker.postMessage({type:"clearMapDecodeRecord",id:i,instanceID:this._instanceID})})}async decode(t){W._onLog&&W._onLog("decode(source: any)"),W._onLog&&(this._timeStartDecode=Date.now());{let n={};return!this.region||this.region instanceof Array||(n.region=JSON.parse(JSON.stringify(this.region))),t instanceof Blob?await this._decode_Blob(t,n):t instanceof ArrayBuffer?await this._decode_ArrayBuffer(t,n):t instanceof Uint8Array||t instanceof Uint8ClampedArray?await this._decode_Uint8Array(t,n):t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?await this._decode_Image(t,n):t instanceof HTMLCanvasElement?await this._decode_Canvas(t,n):t instanceof HTMLVideoElement?await this._decode_Video(t,n):typeof t=="string"?t.substring(0,11)=="data:image/"?await this._decode_Base64(t,n):await this._decode_Url(t,n):W.isDCEFrame(t)?(n.bCopyData=!0,await this._decode_DCEFrame(t,n)):W.isDSImage(t)?(n.bCopyData=!0,await this._decode_DSImage(t,n)):await Promise.reject(TypeError("'_decode(source, config)': Type of 'source' should be 'Blob', 'ArrayBuffer', 'Uint8Array', 'HTMLImageElement', 'HTMLCanvasElement', 'HTMLVideoElement', 'String(base64 with image mime)' or 'String(url)'."))}}async decodeBase64String(t){let n={};return!this.region||this.region instanceof Array||(n.region=JSON.parse(JSON.stringify(this.region))),this._decode_Base64(t,n)}async decodeUrl(t){let n={};return!this.region||this.region instanceof Array||(n.region=JSON.parse(JSON.stringify(this.region))),this._decode_Url(t,n)}async _decodeBuffer_Uint8Array(t,n,i,o,a,d,_){return await new Promise((y,w)=>{let x=W._nextTaskID++;W._taskCallbackMap.set(x,T=>{if(T.success){let E,M=W._onLog?Date.now():0;W._onLog&&W._onLog("worker return result: "+M),this._lastInnerDecodeDuration=T.duration;try{E=this._handleRetJsonString(T.decodeReturn)}catch(F){return w(F)}if(W._onLog){let F=Date.now();W._onLog("DBR getting message from worker timestamp: "+M),W._onLog("From DBR staring decoding to entering worker costs: "+(this._timeEnterInnerDBR-this._timeStartDecode)),W._onLog("From DBR entering worker to returning message from worker costs: "+(M-this._timeEnterInnerDBR)),W._onLog("Handling results from DBR worker costs: "+(F-M)),W._onLog("Total decoding image costs: "+(F-this._timeStartDecode))}return y(E)}{let E=new Error(T.message);return E.stack=T.stack+`
`+E.stack,w(E)}}),this._timeEnterInnerDBR=Date.now(),W._onLog&&W._onLog("Sending buffer to worker timestamp:"+this._timeEnterInnerDBR),W._dbrWorker.postMessage({type:"decodeBuffer",id:x,instanceID:this._instanceID,body:{buffer:t,width:n,height:i,stride:o,format:a,orientation:d,config:_}},[t.buffer]),W._onLog&&_&&_.timeStamp&&W._onLog("Delay of decoding image: "+(this._timeEnterInnerDBR-_.timeStamp))})}async _decodeBuffer_Blob(t,n,i,o,a,d,_){W._onLog&&W._onLog("_decodeBuffer_Blob(buffer,width,height,stride,format)");const y=t.arrayBuffer?await t.arrayBuffer():await new Promise((w,x)=>{let T=new FileReader;T.readAsArrayBuffer(t),T.onload=()=>{w(T.result)},T.onerror=()=>{x(T.error)}});return await this._decodeBuffer_Uint8Array(new Uint8Array(y),n,i,o,a,d,_)}async decodeBuffer(t,n,i,o,a,d,_){let y;return W._onLog&&W._onLog("decodeBuffer(buffer,width,height,stride,format)"),W._onLog&&(this._timeStartDecode=Date.now()),t instanceof Uint8Array||t instanceof Uint8ClampedArray?y=await this._decodeBuffer_Uint8Array(t,n,i,o,a,d,_):t instanceof ArrayBuffer?y=await this._decodeBuffer_Uint8Array(new Uint8Array(t),n,i,o,a,d,_):t instanceof Blob&&(y=await this._decodeBuffer_Blob(t,n,i,o,a,d,_)),y}async _decodeFileInMemory_Uint8Array(t){return await new Promise((n,i)=>{let o=W._nextTaskID++;W._taskCallbackMap.set(o,a=>{if(a.success){let d;this._lastInnerDecodeDuration=a.duration;try{d=this._handleRetJsonString(a.decodeReturn)}catch(_){return i(_)}return n(d)}{let d=new Error(a.message);return d.stack=a.stack+`
`+d.stack,i(d)}}),W._dbrWorker.postMessage({type:"decodeFileInMemory",id:o,instanceID:this._instanceID,body:{bytes:t}})})}async getRuntimeSettings(){return await new Promise((t,n)=>{let i=W._nextTaskID++;W._taskCallbackMap.set(i,o=>{if(o.success){let a=JSON.parse(o.results);return this.userDefinedRegion!=null&&(a.region=JSON.parse(JSON.stringify(this.userDefinedRegion))),t(a)}{let a=new Error(o.message);return a.stack=o.stack+`
`+a.stack,n(a)}}),W._dbrWorker.postMessage({type:"getRuntimeSettings",id:i,instanceID:this._instanceID})})}async updateRuntimeSettings(t){let n;if(typeof t=="string")if(t=="speed"){let i=await this.getRuntimeSettings();await this.resetRuntimeSettings(),n=await this.getRuntimeSettings(),n.barcodeFormatIds=i.barcodeFormatIds,n.barcodeFormatIds_2=i.barcodeFormatIds_2,n.region=i.region,n.deblurLevel=3,n.expectedBarcodesCount=0,n.localizationModes=[2,0,0,0,0,0,0,0]}else if(t=="balance"){let i=await this.getRuntimeSettings();await this.resetRuntimeSettings(),n=await this.getRuntimeSettings(),n.barcodeFormatIds=i.barcodeFormatIds,n.barcodeFormatIds_2=i.barcodeFormatIds_2,n.region=i.region,n.deblurLevel=5,n.expectedBarcodesCount=512,n.localizationModes=[2,16,0,0,0,0,0,0]}else if(t=="coverage"){let i=await this.getRuntimeSettings();await this.resetRuntimeSettings(),n=await this.getRuntimeSettings(),n.barcodeFormatIds=i.barcodeFormatIds,n.barcodeFormatIds_2=i.barcodeFormatIds_2,n.region=i.region}else if(t=="dense"){let i=await this.getRuntimeSettings();await this.resetRuntimeSettings(),this.maxCvsSideLength=4096,n=await this.getRuntimeSettings(),n.barcodeFormatIds=i.barcodeFormatIds,n.barcodeFormatIds_2=i.barcodeFormatIds_2,n.region=i.region,n.deblurLevel=9,n.expectedBarcodesCount=0,n.localizationModes=[2,8,0,0,0,0,0,0]}else if(t=="distance"){let i=await this.getRuntimeSettings();await this.resetRuntimeSettings(),this.maxCvsSideLength=4096,n=await this.getRuntimeSettings(),n.barcodeFormatIds=i.barcodeFormatIds,n.barcodeFormatIds_2=i.barcodeFormatIds_2,n.region=i.region,n.deblurLevel=3,n.expectedBarcodesCount=0,n.localizationModes=[2,8,0,0,0,0,0,0]}else n=JSON.parse(t);else{if(typeof t!="object")throw TypeError("'UpdateRuntimeSettings(settings)': Type of 'settings' should be 'string' or 'PlainObject'.");if(n=JSON.parse(JSON.stringify(t)),n.region instanceof Array){let i=n.region;[i.regionLeft,i.regionTop,i.regionLeft,i.regionBottom,i.regionMeasuredByPercentage].some(o=>o!==void 0)&&(n.region={regionLeft:i.regionLeft||0,regionTop:i.regionTop||0,regionRight:i.regionRight||0,regionBottom:i.regionBottom||0,regionMeasuredByPercentage:i.regionMeasuredByPercentage||0})}}if(!W._bUseFullFeature){if(n.barcodeFormatIds&~(bt.BF_ONED|bt.BF_QR_CODE|bt.BF_PDF417|bt.BF_DATAMATRIX)||n.barcodeFormatIds_2!=0)throw Error("Some of the specified barcode formats are not supported in the compact version. Please try the full-featured version.");if(n.intermediateResultTypes!=0)throw Error("Intermediate results is not supported in the compact version. Please try the full-featured version.")}if(this.bFilterRegionInJs){let i=n.region;if(i instanceof Array)throw Error("The `region` of type `Array` is only allowed in `BarcodeScanner`.");this.userDefinedRegion=JSON.parse(JSON.stringify(i)),(i.regionLeft||i.regionTop||i.regionRight||i.regionBottom||i.regionMeasuredByPercentage)&&(i.regionLeft||i.regionTop||i.regionRight!=100||i.regionBottom!=100||!i.regionMeasuredByPercentage)?this.region=i:this.region=null,n.region={regionLeft:0,regionTop:0,regionRight:0,regionBottom:0,regionMeasuredByPercentage:0}}else this.userDefinedRegion=null,this.region=null;return(this.autoZoom||this.autoFocus)&&(n.intermediateResultTypes|=tr.IRT_TYPED_BARCODE_ZONE),await new Promise((i,o)=>{let a=W._nextTaskID++;W._taskCallbackMap.set(a,d=>{if(d.success){try{this._handleRetJsonString(d.updateReturn)}catch(_){o(_)}return i()}{let _=new Error(d.message);return _.stack=d.stack+`
`+_.stack,o(_)}}),W._dbrWorker.postMessage({type:"updateRuntimeSettings",id:a,instanceID:this._instanceID,body:{settings:JSON.stringify(n)}})})}async resetRuntimeSettings(){return this.userDefinedRegion=null,this.region=null,this.maxCvsSideLength=ha,await new Promise((t,n)=>{let i=W._nextTaskID++;W._taskCallbackMap.set(i,o=>{if(o.success)return t();{let a=new Error(o.message);return a.stack=o.stack+`
`+a.stack,n(a)}}),W._dbrWorker.postMessage({type:"resetRuntimeSettings",id:i,instanceID:this._instanceID})})}async _resetRuntimeSettingsToCppDefault(){return this.userDefinedRegion=null,this.region=null,this.maxCvsSideLength=ha,await new Promise((t,n)=>{let i=W._nextTaskID++;W._taskCallbackMap.set(i,o=>{if(o.success)return t();{let a=new Error(o.message);return a.stack=o.stack+`
`+a.stack,n(a)}}),W._dbrWorker.postMessage({type:"resetRuntimeSettingsToCppDefault",id:i,instanceID:this._instanceID})})}async outputRuntimeSettingsToString(){if(!W._bUseFullFeature)throw Error("outputRuntimeSettingsToString() is not supported in the compact version. Please try the full-featured version.");return await new Promise((t,n)=>{let i=W._nextTaskID++;W._taskCallbackMap.set(i,o=>{if(o.success)return t(o.results);{let a=new Error(o.message);return a.stack=o.stack+`
`+a.stack,n(a)}}),W._dbrWorker.postMessage({type:"outputRuntimeSettingsToString",id:i,instanceID:this._instanceID})})}async initRuntimeSettingsWithString(t){if(!W._bUseFullFeature)throw Error("initRuntimeSettingsWithString() is not supported in the compact version. Please try the full-featured version.");if(typeof t=="string")t=t;else{if(typeof t!="object")throw TypeError("'initRuntimeSettingstWithString(settings)': Type of 'settings' should be 'string' or 'PlainObject'.");t=JSON.stringify(t)}return await new Promise((n,i)=>{let o=W._nextTaskID++;W._taskCallbackMap.set(o,a=>{if(a.success){try{this._handleRetJsonString(a.initReturn)}catch(d){i(d)}return n()}{let d=new Error(a.message);return d.stack=a.stack+`
`+d.stack,i(d)}}),W._dbrWorker.postMessage({type:"initRuntimeSettingsWithString",id:o,instanceID:this._instanceID,body:{settings:t}})})}async _decode_Blob(t,n){W._onLog&&W._onLog("_decode_Blob(blob: Blob)");let i=null,o=null;if(typeof createImageBitmap<"u")try{i=await createImageBitmap(t)}catch{}i||(o=await function(d){return new Promise((_,y)=>{let w=URL.createObjectURL(d),x=new Image;x.dbrObjUrl=w,x.src=w,x.onload=()=>{_(x)},x.onerror=T=>{y(new Error("Can't convert blob to image : "+(T instanceof Event?T.type:T)))}})}(t));let a=await this._decode_Image(i||o,n);return i&&i.close(),a}async _decode_ArrayBuffer(t,n){return await this._decode_Blob(new Blob([t]),n)}async _decode_Uint8Array(t,n){return await this._decode_Blob(new Blob([t]),n)}async _decode_Image(t,n){W._onLog&&W._onLog("_decode_Image(image: HTMLImageElement|ImageBitmap)"),n=n||{};let i,o,a=t instanceof HTMLImageElement?t.naturalWidth:t.width,d=t instanceof HTMLImageElement?t.naturalHeight:t.height,_=Math.max(a,d);if(_>this._maxCvsSideLength){let x=this._maxCvsSideLength/_;i=Math.round(a*x),o=Math.round(d*x)}else i=a,o=d;this.canvas||(this.canvas=document.createElement("canvas"));const y=this.canvas;y.width===i&&y.height===o||(y.width=i,y.height=o),y.ctx2d||(y.ctx2d=y.getContext("2d",{willReadFrequently:!0})),y.ctx2d.drawImage(t,0,0,a,d,0,0,i,o),t.dbrObjUrl&&URL.revokeObjectURL(t.dbrObjUrl);let w=await this._decode_Canvas(y,n);if(this.ifSaveOriginalImageInACanvas){const x=document.createElement("canvas");x.width=t.width,x.height=t.height,x.getContext("2d").drawImage(t,0,0),this.oriCanvas=x,this.oriCanvasData=null}return W.recalculateResultLocation(w,0,0,a,d,i,o),w}async _decode_Canvas(t,n){if(W._onLog&&W._onLog("_decode_Canvas(canvas:HTMLCanvasElement)"),t.crossOrigin&&t.crossOrigin!="anonymous")throw"cors";if(t.width===0||t.height===0)throw Error("The width or height of the 'canvas' is 0.");this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=t,this.oriCanvasData=null);let i=(t.ctx2d||t.getContext("2d",{willReadFrequently:!0})).getImageData(0,0,t.width,t.height).data;return await this._decodeBuffer_Uint8Array(i,t.width,t.height,4*t.width,Be.IPF_ABGR_8888,0,n)}async _decode_Video(t,n){if(W._onLog&&W._onLog("_decode_Video(video)"),!(t instanceof HTMLVideoElement))throw TypeError("'_decode_Video(video [, config] )': Type of 'video' should be 'HTMLVideoElement'.");if(t.crossOrigin&&t.crossOrigin!="anonymous")throw"cors";n=n||{};let i,o,a=t.videoWidth,d=t.videoHeight,_=Math.max(a,d);if(_>this._maxCvsSideLength){let x=this._maxCvsSideLength/_;i=Math.round(a*x),o=Math.round(d*x)}else i=a,o=d;this.canvas||(this.canvas=document.createElement("canvas"));const y=this.canvas;y.width===i&&y.height===o||(y.width=i,y.height=o),y.ctx2d||(y.ctx2d=y.getContext("2d",{willReadFrequently:!0})),y.ctx2d.drawImage(t,0,0,a,d,0,0,i,o);let w=await this._decode_Canvas(y,n);if(this.ifSaveOriginalImageInACanvas){const x=document.createElement("canvas");x.width=t.videoWidth,x.height=t.videoHeight,x.getContext("2d").drawImage(t,0,0),this.oriCanvas=x,this.oriCanvasData=null}return W.recalculateResultLocation(w,0,0,a,d,i,o),w}async _decode_DCEFrame(t,n){if(W._onLog&&W._onLog("_decode_DCEFrame(dceFrame)"),!W.isDCEFrame(t))return[];let i=[];this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:t.width,height:t.height,colorMode:t.colorMode,pixelFormat:t.pixelFormat,data:new Uint8Array(t.data),toCanvas:t.toCanvas});const{width:o,height:a,colorMode:d,pixelFormat:_,stride:y,timeStamp:w}=t;let x;x=n&&n.bCopyData?new Uint8Array(t.data):t.data;let T=null;if(n?(T=JSON.parse(JSON.stringify(n)),T.timeStamp=w):T={timeStamp:w},_&&y)if(_==="grey")i=await this._decodeBuffer_Uint8Array(x,o,a,y,Be.IPF_GrayScaled,0,T);else if(_==="rgba")i=await this._decodeBuffer_Uint8Array(x,o,a,y,Be.IPF_ABGR_8888,0,T);else{if(_!=="bgra")throw new Error(`Pixel format '${_}' is not supported to decode.`);i=await this._decodeBuffer_Uint8Array(x,o,a,y,Be.IPF_ARGB_8888,0,T)}else if(d==="grey")i=await this._decodeBuffer_Uint8Array(x,o,a,o,Be.IPF_GrayScaled,0,T);else if(d==="rgba")i=await this._decodeBuffer_Uint8Array(x,o,a,4*o,Be.IPF_ABGR_8888,0,T);else{if(d!=="bgra")throw new Error(`Color mode '${d}' is not supported to decode.`);i=await this._decodeBuffer_Uint8Array(x,o,a,4*o,Be.IPF_ARGB_8888,0,T)}return i}async _decode_DSImage(t,n){if(W._onLog&&W._onLog("_decode_DSImage(dsImage)"),!W.isDSImage(t))return null;this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:t.width,height:t.height,pixelFormat:t.pixelFormat.toLowerCase(),data:new Uint8Array(t.data),toCanvas:function(){const w=document.createElement("canvas");let x;switch(w.width=this.width,w.height=this.height,this.pixelFormat){case"grey":x=new Uint8ClampedArray(this.width*this.height*4);for(let E=0;E<x.length;E+=4)x[E]=this.data[E/4],x[E+1]=this.data[E/4],x[E+2]=this.data[E/4],x[E+3]=255;break;case"rgb":x=new Uint8ClampedArray(this.width*this.height*4);for(let E=0;E<x.length;E+=4)x[E]=this.data[E],x[E+1]=this.data[E+1],x[E+2]=this.data[E+2],x[E+3]=255;break;case"bgr":x=new Uint8ClampedArray(this.width*this.height*4);for(let E=0;E<x.length;E+=4)x[E]=this.data[E],x[E+1]=this.data[E+1],x[E+2]=this.data[E+2],x[E+3]=255;break;case"rgba":case"bgra":x=new Uint8ClampedArray(this.data);break;default:throw new Error("The content of 2D Canvas is currently limited to the sRGB color space.")}const T=new ImageData(x,this.width,this.height);return w.getContext("2d").putImageData(T,0,0),w}});const{width:i,height:o}=t;let a,d,_,y=t.pixelFormat.toLowerCase();switch(a=n&&n.bCopyData?new Uint8Array(t.data):t.data,y){case"grey":_=Be.IPF_GrayScaled,d=i;break;case"rgb":_=Be.IPF_BGR_888,d=3*i;break;case"bgr":_=Be.IPF_RGB_888,d=3*i;break;case"rgba":_=Be.IPF_ABGR_8888,d=4*i;break;case"bgra":_=Be.IPF_ARGB_8888,d=4*i;break;default:throw new Error("The pixel format is not supported to decode.")}return await this._decodeBuffer_Uint8Array(a,i,o,d,_,0,n)}async _decode_Base64(t,n){if(W._onLog&&W._onLog("_decode_Base64(base64Str)"),typeof t!="string")return Promise.reject("'_decode_Base64(base64Str, config)': Type of 'base64Str' should be 'string'.");t.substring(0,11)=="data:image/"&&(t=t.substring(t.indexOf(",")+1));{let i=atob(t),o=i.length,a=new Uint8Array(o);for(;o--;)a[o]=i.charCodeAt(o);return await this._decode_Blob(new Blob([a]),n)}}async _decode_Url(t,n){if(W._onLog&&W._onLog("_decode_Url(url)"),typeof t!="string")throw TypeError("'_decode_Url(url, config)': Type of 'url' should be 'string'.");t=t;{let i=await new Promise((o,a)=>{let d=new XMLHttpRequest;d.open("GET",t,!0),d.responseType="blob",d.send(),d.onloadend=async()=>{o(d.response)},d.onerror=()=>{a(new Error("Network Error: "+d.statusText))}});return await this._decode_Blob(i,n)}}async _decode_FilePath(t,n){throw W._onLog&&W._onLog("_decode_FilePath(path)"),Error("'_decode_FilePath(path, config)': The method is only supported in node environment.")}static recalculateResultLocation(t,n,i,o,a,d,_){if(t.length>0)for(let y of t){let w=y.localizationResult;w.resultCoordinateType==2&&(w.x1*=.01*d,w.x2*=.01*d,w.x3*=.01*d,w.x4*=.01*d,w.y1*=.01*_,w.y2*=.01*_,w.y3*=.01*_,w.y4*=.01*_);let x=d/o,T=_/a;w.x1=w.x1/x+n,w.x2=w.x2/x+n,w.x3=w.x3/x+n,w.x4=w.x4/x+n,w.y1=w.y1/T+i,w.y2=w.y2/T+i,w.y3=w.y3/T+i,w.y4=w.y4/T+i,w.resultCoordinateType==2&&(w.x1*=100/o,w.x2*=100/o,w.x3*=100/o,w.x4*=100/o,w.y1*=100/a,w.y2*=100/a,w.y3*=100/a,w.y4*=100/a),w.x1=Math.round(w.x1),w.x2=Math.round(w.x2),w.x3=Math.round(w.x3),w.x4=Math.round(w.x4),w.y1=Math.round(w.y1),w.y2=Math.round(w.y2),w.y3=Math.round(w.y3),w.y4=Math.round(w.y4)}}static BarcodeReaderException(t,n){let i,o=us.DBR_UNKNOWN;return typeof t=="number"?(o=t,i=new Error(n)):i=new Error(t),i.code=o,i}_handleRetJsonString(t){let n=us;if(t.textResults){for(let i=0;i<t.textResults.length;i++){let o=t.textResults[i];try{let a=o.barcodeText,d="";for(let _=0;_<a.length;_++)d+=String.fromCharCode(a[_]);try{o.barcodeText=decodeURIComponent(escape(d))}catch{o.barcodeText=d}}catch{o.barcodeText=""}if(o.exception!=null){W._setWarnnedEx.has(o.exception)||(W._setWarnnedEx.add(o.exception),console.warn(o.exception));let a={};o.exception.split(";").forEach(d=>{let _=d.indexOf(":");a[d.substring(0,_)]=d.substring(_+1)}),o.exception=a}}return t.decodeRecords?this.decodeRecords=t.decodeRecords:this.decodeRecords={},this._lastErrorCode=t.exception,this._lastErrorString=t.description,t.exception&&!W._setWarnnedEx.has(t.description)&&(W._setWarnnedEx.add(t.description),console.warn(t.description)),t.textResults}if(t.exception==n.DBR_SUCCESS)return t.data;throw W.BarcodeReaderException(t.exception,t.description)}async setModeArgument(t,n,i,o){return await new Promise((a,d)=>{let _=W._nextTaskID++;W._taskCallbackMap.set(_,y=>{if(y.success){try{this._handleRetJsonString(y.setReturn)}catch(w){return d(w)}return a()}{let w=new Error(y.message);return w.stack=y.stack+`
`+w.stack,d(w)}}),W._dbrWorker.postMessage({type:"setModeArgument",id:_,instanceID:this._instanceID,body:{modeName:t,index:n,argumentName:i,argumentValue:o}})})}async getModeArgument(t,n,i){return await new Promise((o,a)=>{let d=W._nextTaskID++;W._taskCallbackMap.set(d,_=>{if(_.success){let y;try{y=this._handleRetJsonString(_.getReturn)}catch(w){return a(w)}return o(y)}{let y=new Error(_.message);return y.stack=_.stack+`
`+y.stack,a(y)}}),W._dbrWorker.postMessage({type:"getModeArgument",id:d,instanceID:this._instanceID,body:{modeName:t,index:n,argumentName:i}})})}async getIntermediateResults(){return await new Promise((t,n)=>{let i=W._nextTaskID++;W._taskCallbackMap.set(i,o=>{if(o.success)return t(o.results);{let a=new Error(o.message);return a.stack=o.stack+`
`+a.stack,n(a)}}),W._dbrWorker.postMessage({type:"getIntermediateResults",id:i,instanceID:this._instanceID})})}async getIntermediateCanvas(){let t=await this.getIntermediateResults(),n=[];for(let i of t)if(i.dataType==ul.IMRDT_IMAGE)for(let o of i.results){const a=o.bytes;let d;switch(W._onLog&&W._onLog(" "+a.length+" "+a.byteLength+" "+o.width+" "+o.height+" "+o.stride+" "+o.format),o.format){case Be.IPF_ABGR_8888:d=new Uint8ClampedArray(a);break;case Be.IPF_RGB_888:{const w=a.length/3;d=new Uint8ClampedArray(4*w);for(let x=0;x<w;++x)d[4*x]=a[3*x+2],d[4*x+1]=a[3*x+1],d[4*x+2]=a[3*x],d[4*x+3]=255;break}case Be.IPF_GrayScaled:{const w=a.length;d=new Uint8ClampedArray(4*w);for(let x=0;x<w;x++)d[4*x]=d[4*x+1]=d[4*x+2]=a[x],d[4*x+3]=255;break}case Be.IPF_Binary:case Be.IPF_BinaryInverted:{const w=a.length,x=o.width,T=o.height,E=o.stride;d=new Uint8ClampedArray(x*T*4);for(let M=0;M<w;M++){let F=a[M],P=M%E*8,B=Math.floor(M/E);for(let D=0;D<8;D++){let O=P+D,A=4*(B*x+O);if(O>=x)break;d[A]=d[A+1]=d[A+2]=(128&F)/128*255,d[A+3]=255,F<<=1}}break}default:console.warn("unknow intermediate image",o)}if(!d)continue;let _=new ImageData(d,o.width,o.height),y=document.createElement("canvas");y.width=o.width,y.height=o.height,y.getContext("2d").putImageData(_,0,0),n.push(y)}return n}async getScanSettings(){return await new Promise((t,n)=>{let i=W._nextTaskID++;W._taskCallbackMap.set(i,o=>{if(o.success){let a=o.results;return a.intervalTime=this.intervalTime,a.whenToPlaySoundforSuccessfulRead=this.whenToPlaySoundforSuccessfulRead,a.soundOnSuccessfullRead=this.soundSource,a.whenToVibrateforSuccessfulRead=this.whenToVibrateforSuccessfulRead,a.vibrateDuration=this.vibrateDuration,a.captureAndDecodeInParallel=this.captureAndDecodeInParallel,a.autoZoom=this.autoZoom,a.autoFocus=this.autoFocus,a.autoSuggestTip=this.autoSuggestTip,t(a)}{let a=new Error(o.message);return a.stack+=`
`+o.stack,n(a)}}),W._dbrWorker.postMessage({type:"getScanSettings",id:i,instanceID:this._instanceID})})}async updateScanSettings(t){if(!t)return;const n=JSON.parse(JSON.stringify(t));if(n.autoZoom||n.autoFocus||n.autoSuggestTip){if(!W._bUseFullFeature)throw new Error("'autoZoom', 'autoFocus' and 'autoSuggestTip' are not supported in the compact version. Please try the full-featured version.");const i=await this.getRuntimeSettings();i.intermediateResultTypes|=tr.IRT_TYPED_BARCODE_ZONE,await this.updateRuntimeSettings(i)}return n.hasOwnProperty("intervalTime")&&(this.intervalTime=Math.max(n.intervalTime,0),delete n.intervalTime),n.hasOwnProperty("whenToPlaySoundforSuccessfulRead")&&(this.whenToPlaySoundforSuccessfulRead=n.whenToPlaySoundforSuccessfulRead,delete n.whenToPlaySoundforSuccessfulRead),n.hasOwnProperty("soundOnSuccessfullRead")&&(this.soundSource=n.soundOnSuccessfullRead,delete n.soundOnSuccessfullRead),n.hasOwnProperty("whenToVibrateforSuccessfulRead")&&(this.whenToVibrateforSuccessfulRead=n.whenToVibrateforSuccessfulRead,delete n.whenToVibrateforSuccessfulRead),n.hasOwnProperty("vibrateDuration")&&(this.vibrateDuration=n.vibrateDuration,delete n.vibrateDuration),n.hasOwnProperty("captureAndDecodeInParallel")&&(this.captureAndDecodeInParallel=n.captureAndDecodeInParallel,delete n.captureAndDecodeInParallel),n.hasOwnProperty("autoZoom")&&(this.autoZoom&&this.autoZoom!=n.autoZoom&&this.dce&&this.dce.setZoom({factor:1}).catch(()=>{}),this.autoZoom=n.autoZoom,delete n.autoZoom),n.hasOwnProperty("autoFocus")&&(this.autoFocus=n.autoFocus,this.dce&&this.dce.setFocus({mode:"continuous"}).catch(()=>{}),delete n.autoFocus),n.hasOwnProperty("autoSuggestTip")&&(this.autoSuggestTip=n.autoSuggestTip,delete n.autoFocus),await new Promise((i,o)=>{let a=W._nextTaskID++;W._taskCallbackMap.set(a,d=>{if(d.success)return i();{let _=new Error(d.message);return _.stack+=`
`+d.stack,o(_)}}),W._dbrWorker.postMessage({type:"updateScanSettings",id:a,instanceID:this._instanceID,body:{settings:n}})})}_cloneDecodeResults(t){if(t instanceof Array){let n=[];for(let i of t)n.push(this._cloneDecodeResults(i));return n}{let n=t;return JSON.parse(JSON.stringify(n,(o,a)=>o=="oriVideoCanvas"||o=="searchRegionCanvas"?void 0:a))}}async _loopReadVideo(){if(this.bDestroyed)return this.dce&&this._dceControler&&this._dceControler.setDisiredAction(this,"stopFetchingLoop"),this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),void this._drawResults(null);if(this.dce&&!this.dce.isOpen())return this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null),void await this.clearMapDecodeRecord();if(!this.dce&&!this._imgSource||this._bPauseScan)return W._onLog&&W._onLog("Scan is paused, or imageSource is not set. Ask in 1s."),await this.clearMapDecodeRecord(),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},this._intervalDetectVideoPause));W._onLog&&W._onLog("======= once read ======="),W._onLog&&(this._timeStartDecode=Date.now());let t=null,n=null;if(this.dce)t=this._getVideoFrame();else if(this._imgSource&&(n=await this._imgSource.getImage(),!W.isDSImage(n)))throw new Error("Invalid DSImage.");if(!t&&!n)return W._onLog&&W._onLog("Get invalid frame."),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0));(async()=>{let i=[];if(t){i=await this._decode_DCEFrame(t,{bScanner:!0,bCopyData:!1});let o=null;if(i&&i.length){const{sx:a,sy:d,width:_,height:y,_sWidth:w,_sHeight:x}=t;o=i.map(T=>({resultState:T.resultState,localizationResult:JSON.parse(JSON.stringify(T.localizationResult))})),W.recalculateResultLocation(o,a,d,w,x,_,y)}this._resultHighlightingDuration==0?this._drawResults(null):this._drawResults(o,i),this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._resultHighlightingDuration>0&&(this._clearResultsCanvasTimeoutId=setTimeout(()=>{this.bDestroyed||this._drawResults(null)},this._resultHighlightingDuration))}else n&&(i=await this._decode_DSImage(n,{bScanner:!0,bCopyData:!1}));return i})().then(i=>{if(W._onLog&&W._onLog(i),this.dce&&this.captureAndDecodeInParallel){let o=this.array_decodeFrameTimeCost,a=this.array_getFrameTimeCost;const d=()=>{let _=0;if(a&&a.length){let y=Math.min(...o),w=Math.max(...a);y&&w&&(_=y-w)}else _=0;return _>0?_:0};(()=>{for(;o.length>=5;)o.shift();o.push(this._lastInnerDecodeDuration)})(),this._intervalGetVideoFrame=d()+this.intervalTime}if((this.dce&&this.dce.isOpen()||this._imgSource)&&!this._bPauseScan){if(this.bPlaySoundOnSuccessfulRead&&i.length){let o=!1;this.bPlaySoundOnSuccessfulRead===!0||this.bPlaySoundOnSuccessfulRead==="frame"?o=i.some(a=>a.resultState>=0):this.bPlaySoundOnSuccessfulRead==="unique"&&(o=i.some(a=>a.resultState==0)),o&&this.beepSound&&(this.beepSound.stop(),this.beepSound.play())}if(navigator.vibrate&&this.bVibrateOnSuccessfulRead&&i.length){let o=!1;if(this.bVibrateOnSuccessfulRead===!0||this.bVibrateOnSuccessfulRead==="frame"?o=i.some(a=>a.resultState>=0):this.bVibrateOnSuccessfulRead==="unique"&&(o=i.some(a=>a.resultState==0)),o)try{navigator.vibrate(this.vibrateDuration)}catch(a){console.warn("Vibration not allowed. User interaction required: "+(a.message||a))}}if(this.onImageRead){i=i.filter(a=>a.resultState>=0);const o=this._cloneDecodeResults(i);this.onImageRead(o)}if(this.onUniqueRead){i=i.filter(a=>a.resultState==0);const o=this._cloneDecodeResults(i);for(let a of o)this.onUniqueRead(a.barcodeText,a)}}this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this.intervalTime?this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},this.intervalTime):this._loopReadVideo()}).catch(i=>{this.dce&&this._dceControler&&this._dceControler.setDisiredAction(this,"stopFetchingLoop"),W._onLog&&W._onLog(i.message||i),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this.dce&&(this.dce.startFetchingLoop(),this._dceControler&&this._dceControler.clearUserDisiredAction({user:this,actionName:"stopFetchingLoop"})),this._loopReadVideo()},Math.max(this.intervalTime,1e3)),i.message=="platform error"||console.warn(i.message)})}_getVideoFrame(){if(!this.dce)return null;let t;if(this.captureAndDecodeInParallel){if(W._onLog&&W._onLog("Get frame in parallel."),this._dceControler&&this._dceControler.setDisiredValue(this,"loopInterval",this._intervalGetVideoFrame),!this.dce.numberOfFramesInBuffer)return this._dceControler&&this._dceControler.setDisiredValue(this,"loopInterval",0),null;t=this.dce.getFrameFromBuffer(),(i=>{if(!i)return;let o=i.timeSpent,a=this.array_getFrameTimeCost;for(;a.length>=5;)a.shift();a.push(o)})(t)}else W._onLog&&W._onLog("Get frame in serial."),this._dceControler&&this._dceControler.setDisiredAction(this,"stopFetchingLoop"),t=this.dce.getFrame();return t}_drawResults(t,n){if(!this.dce||this.dce.disposed||this._bPauseScan||!this._drawingItemNamespace||!this._drawingItemNamespace.DT_Polygon)return;if(!this._dbrDrawingLayer){if(!this.dce.isOpen()||!(this.dce.singleFrameMode||this.dce.video&&this.dce._videoTrack))return;this._dbrDrawingLayer=this.dce.getDrawingLayer(3)}const i=this._dbrDrawingLayer;t||(t=[]);let o=this._arrPolygons;for(let a=0;a<t.length;a++){let d,_=t[a].localizationResult;o[a]?(d=o[a],i.hasDrawingItem(d)||i.addDrawingItem(d),d.set("vertices",[{x:_.x1,y:_.y1},{x:_.x2,y:_.y2},{x:_.x3,y:_.y3},{x:_.x4,y:_.y4}]),(d.set||d.setAttribute).call(d,"vertices",[{x:_.x1,y:_.y1},{x:_.x2,y:_.y2},{x:_.x3,y:_.y3},{x:_.x4,y:_.y4}])):(d=new this._drawingItemNamespace.DT_Polygon([{x:_.x1,y:_.y1},{x:_.x2,y:_.y2},{x:_.x3,y:_.y3},{x:_.x4,y:_.y4}]),i.addDrawingItem(d),o[a]=d),t[a].resultState===-1?(d.styleId=this._styleIdBeforeVerification,d._mapStyle.set("default",this.dce.getDrawingStyle(this._styleIdBeforeVerification)),d._mapStyle.set("selected",this.dce.getDrawingStyle(this._styleIdBeforeVerification))):(d.styleId=null,d._mapStyle.set("default",this.dce.getDrawingStyle(3)),d._mapStyle.set("selected",this.dce.getDrawingStyle(7))),n&&n[a]?d.addNote({name:"Barcode_Result",content:n[a]},!0):d.addNote({name:"Barcode_Result",content:t[a]},!0)}for(let a=t.length;a<o.length;a++)o[a].deleteNote("Barcode_Result"),i.removeDrawingItem(o[a]);i.renderAll()}async startScanning(t){if(!this.dce&&!this._imgSource)throw new Error("'imageSource' is not set. call 'setImageSource()' before 'startScanning()'.");if(this._promiseStartScan&&this._promiseStartScan.isPending)return this._promiseStartScan;this._promiseStartScan=new zf;let n=null;if(this.dce){if(this.dce.isOpen())if(t&&this.dce.appendAndShowUI(),this.dce.playCallbackInfo)n=JSON.parse(JSON.stringify(this.dce.playCallbackInfo));else{const i=this.dce.getSelectedCamera();n={width:this.dce.video.videoWidth,height:this.dce.video.videoHeight,deviceId:i&&i.deviceId}}else if(n=await this.dce.open(t),!this._promiseStartScan)return null;this._dceControler&&(this._dceControler.clearUserDisiredAction({user:this,actionName:"close"}),this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!0),this.dce.ifShowScanRegionLaser&&this.dce.showScanRegionLaser())}return this._bPauseScan=!1,this.dce&&this.dce.singleFrameMode||(this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this.dce&&(this.dce.startFetchingLoop(),this._dceControler&&this._dceControler.clearUserDisiredAction({user:this,actionName:"stopFetchingLoop"})),this._loopReadVideo()},0)),this._promiseStartScan.resolve(n),n}stopScanning(t){this.dce&&(this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null),this._dceControler&&(this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!1),this.dce.ifShowScanRegionLaser||this.dce.hideScanRegionLaser(),this._dceControler.setDisiredAction(this,"close",[t]))),this._bPauseScan=!0,this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0,this._promiseStartScan=null}pauseScanning(t){if(this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),t&&t.keepResultsHighlighted||this._drawResults(null),this._bPauseScan=!0,this.dce){if(this.dce.singleFrameMode)throw new Error("'pauseScanning()' is unavailable when property 'singleFrameMode' of the 'CameraEnhancer' instance is true.");this._dceControler&&(this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!1),this.dce.ifShowScanRegionLaser||this.dce.hideScanRegionLaser(),this._dceControler.setDisiredAction(this,"stopFetchingLoop"))}}resumeScanning(){if(this._bPauseScan=!1,this.dce){if(this.dce.singleFrameMode)throw new Error("'resumeScanning()' is unavailable when property 'singleFrameMode' of the 'CameraEnhancer' instance is true.");this.dce.startFetchingLoop(),this._dceControler&&(this._dceControler.clearUserDisiredAction({user:this,actionName:"stopFetchingLoop"}),this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!0),this.dce.ifShowScanRegionLaser&&this.dce.showScanRegionLaser())}}destroyContext(){if(W._onLog&&W._onLog("destroyContext()"),this.bDestroyed)return;this.bDestroyed=!0,(this.dce||this._promiseStartScan)&&this.stopScanning(),this.setImageSource(null);let t=W._nextTaskID++;W._taskCallbackMap.set(t,n=>{if(!n.success){let i=new Error(n.message);throw i.stack=n.stack+`
`+i.stack,i}}),W._dbrWorker.postMessage({type:"destroyContext",id:t,instanceID:this._instanceID})}}W._jsVersion="9.6.21",W._jsEditVersion="20230803",W._version=`loading...(JS ${W._jsVersion}.${W._jsEditVersion})`,W._license=C_,W._sessionPassword=x_,W.browserInfo=at,W._workerName=`dbr-${W._jsVersion}.browser.worker.js`,W._engineResourcePath=w_,W._licenseServer=[],W._deviceFriendlyName="",W._isShowRelDecodeTimeInResults=!1,W._bWasmDebug=!1,W._bNeverShowDialog=!1,W.__bUseFullFeature=!0,W._nextTaskID=0,W._taskCallbackMap=new Map,W._pLoad=new zf,W._lastErrorCode=0,W._lastErrorString="",W._setWarnnedEx=new Set,W._defaultUIElementURL="@engineResourcePath/dbr.ui.html";var b_={653:(e,t,n)=>{var i,o,a,d,_,y,w,x,T,E,M,F,P,B,D,O,A,Y,ne,oe,K,S=S||{version:"5.2.1"};if(t.fabric=S,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?S.document=document:S.document=document.implementation.createHTMLDocument(""),S.window=window;else{var ue=new(n(192)).JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;S.document=ue.document,S.jsdomImplForWrapper=n(898).implForWrapper,S.nodeCanvas=n(245).Canvas,S.window=ue,DOMParser=S.window.DOMParser}function le(h,l){var c=h.canvas,f=l.targetCanvas,r=f.getContext("2d");r.translate(0,f.height),r.scale(1,-1);var s=c.height-f.height;r.drawImage(c,0,s,f.width,f.height,0,0,f.width,f.height)}function Ce(h,l){var c=l.targetCanvas.getContext("2d"),f=l.destinationWidth,r=l.destinationHeight,s=f*r*4,u=new Uint8Array(this.imageBuffer,0,s),m=new Uint8ClampedArray(this.imageBuffer,0,s);h.readPixels(0,0,f,r,h.RGBA,h.UNSIGNED_BYTE,u);var g=new ImageData(m,f,r);c.putImageData(g,0,0)}S.isTouchSupported="ontouchstart"in S.window||"ontouchstart"in S.document||S.window&&S.window.navigator&&S.window.navigator.maxTouchPoints>0,S.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",S.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],S.DPI=96,S.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",S.commaWsp="(?:\\s+,?\\s*|,\\s*)",S.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,S.reNonWord=/[ \n\.,;!\?\-]/,S.fontPaths={},S.iMatrix=[1,0,0,1,0,0],S.svgNS="http://www.w3.org/2000/svg",S.perfLimitSizeTotal=2097152,S.maxCacheSideLimit=4096,S.minCacheSideLimit=256,S.charWidthsCache={},S.textureSize=2048,S.disableStyleCopyPaste=!1,S.enableGLFiltering=!0,S.devicePixelRatio=S.window.devicePixelRatio||S.window.webkitDevicePixelRatio||S.window.mozDevicePixelRatio||1,S.browserShadowBlurConstant=1,S.arcToSegmentsCache={},S.boundsOfCurveCache={},S.cachesBoundsOfCurve=!0,S.forceGLPutImageData=!1,S.initFilterBackend=function(){return S.enableGLFiltering&&S.isWebglSupported&&S.isWebglSupported(S.textureSize)?(console.log("max texture size: "+S.maxTextureSize),new S.WebglFilterBackend({tileSize:S.textureSize})):S.Canvas2dFilterBackend?new S.Canvas2dFilterBackend:void 0},typeof document<"u"&&typeof window<"u"&&(window.fabric=S),function(){function h(c,f){if(this.__eventListeners[c]){var r=this.__eventListeners[c];f?r[r.indexOf(f)]=!1:S.util.array.fill(r,!1)}}function l(c,f){var r=function(){f.apply(this,arguments),this.off(c,r)}.bind(this);this.on(c,r)}S.Observable={fire:function(c,f){if(!this.__eventListeners)return this;var r=this.__eventListeners[c];if(!r)return this;for(var s=0,u=r.length;s<u;s++)r[s]&&r[s].call(this,f||{});return this.__eventListeners[c]=r.filter(function(m){return m!==!1}),this},on:function(c,f){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var r in c)this.on(r,c[r]);else this.__eventListeners[c]||(this.__eventListeners[c]=[]),this.__eventListeners[c].push(f);return this},once:function(c,f){if(arguments.length===1)for(var r in c)l.call(this,r,c[r]);else l.call(this,c,f);return this},off:function(c,f){if(!this.__eventListeners)return this;if(arguments.length===0)for(c in this.__eventListeners)h.call(this,c);else if(arguments.length===1&&typeof arguments[0]=="object")for(var r in c)h.call(this,r,c[r]);else h.call(this,c,f);return this}}}(),S.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var h=0,l=arguments.length;h<l;h++)this._onObjectAdded(arguments[h]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(h,l,c){var f=this._objects;return c?f[l]=h:f.splice(l,0,h),this._onObjectAdded&&this._onObjectAdded(h),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var h,l=this._objects,c=!1,f=0,r=arguments.length;f<r;f++)(h=l.indexOf(arguments[f]))!==-1&&(c=!0,l.splice(h,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[f]));return this.renderOnAddRemove&&c&&this.requestRenderAll(),this},forEachObject:function(h,l){for(var c=this.getObjects(),f=0,r=c.length;f<r;f++)h.call(l,c[f],f,c);return this},getObjects:function(h){return h===void 0?this._objects.concat():this._objects.filter(function(l){return l.type===h})},item:function(h){return this._objects[h]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(h,l){return this._objects.indexOf(h)>-1||!!l&&this._objects.some(function(c){return typeof c.contains=="function"&&c.contains(h,!0)})},complexity:function(){return this._objects.reduce(function(h,l){return h+(l.complexity?l.complexity():0)},0)}},S.CommonMethods={_setOptions:function(h){for(var l in h)this.set(l,h[l])},_initGradient:function(h,l){!h||!h.colorStops||h instanceof S.Gradient||this.set(l,new S.Gradient(h))},_initPattern:function(h,l,c){!h||!h.source||h instanceof S.Pattern?c&&c():this.set(l,new S.Pattern(h,c))},_setObject:function(h){for(var l in h)this._set(l,h[l])},set:function(h,l){return typeof h=="object"?this._setObject(h):this._set(h,l),this},_set:function(h,l){this[h]=l},toggle:function(h){var l=this.get(h);return typeof l=="boolean"&&this.set(h,!l),this},get:function(h){return this[h]}},i=t,o=Math.sqrt,a=Math.atan2,d=Math.pow,_=Math.PI/180,y=Math.PI/2,S.util={cos:function(h){if(h===0)return 1;switch(h<0&&(h=-h),h/y){case 1:case 3:return 0;case 2:return-1}return Math.cos(h)},sin:function(h){if(h===0)return 0;var l=1;switch(h<0&&(l=-1),h/y){case 1:return l;case 2:return 0;case 3:return-l}return Math.sin(h)},removeFromArray:function(h,l){var c=h.indexOf(l);return c!==-1&&h.splice(c,1),h},getRandomInt:function(h,l){return Math.floor(Math.random()*(l-h+1))+h},degreesToRadians:function(h){return h*_},radiansToDegrees:function(h){return h/_},rotatePoint:function(h,l,c){var f=new S.Point(h.x-l.x,h.y-l.y),r=S.util.rotateVector(f,c);return new S.Point(r.x,r.y).addEquals(l)},rotateVector:function(h,l){var c=S.util.sin(l),f=S.util.cos(l);return{x:h.x*f-h.y*c,y:h.x*c+h.y*f}},createVector:function(h,l){return new S.Point(l.x-h.x,l.y-h.y)},calcAngleBetweenVectors:function(h,l){return Math.acos((h.x*l.x+h.y*l.y)/(Math.hypot(h.x,h.y)*Math.hypot(l.x,l.y)))},getHatVector:function(h){return new S.Point(h.x,h.y).multiply(1/Math.hypot(h.x,h.y))},getBisector:function(h,l,c){var f=S.util.createVector(h,l),r=S.util.createVector(h,c),s=S.util.calcAngleBetweenVectors(f,r),u=s*(S.util.calcAngleBetweenVectors(S.util.rotateVector(f,s),r)===0?1:-1)/2;return{vector:S.util.getHatVector(S.util.rotateVector(f,u)),angle:s}},projectStrokeOnPoints:function(h,l,c){var f=[],r=l.strokeWidth/2,s=l.strokeUniform?new S.Point(1/l.scaleX,1/l.scaleY):new S.Point(1,1),u=function(m){var g=r/Math.hypot(m.x,m.y);return new S.Point(m.x*g*s.x,m.y*g*s.y)};return h.length<=1||h.forEach(function(m,g){var p,v,C=new S.Point(m.x,m.y);g===0?(v=h[g+1],p=c?u(S.util.createVector(v,C)).addEquals(C):h[h.length-1]):g===h.length-1?(p=h[g-1],v=c?u(S.util.createVector(p,C)).addEquals(C):h[0]):(p=h[g-1],v=h[g+1]);var b,k,I=S.util.getBisector(C,p,v),R=I.vector,N=I.angle;if(l.strokeLineJoin==="miter"&&(b=-r/Math.sin(N/2),k=new S.Point(R.x*b*s.x,R.y*b*s.y),Math.hypot(k.x,k.y)/r<=l.strokeMiterLimit))return f.push(C.add(k)),void f.push(C.subtract(k));b=-r*Math.SQRT2,k=new S.Point(R.x*b*s.x,R.y*b*s.y),f.push(C.add(k)),f.push(C.subtract(k))}),f},transformPoint:function(h,l,c){return c?new S.Point(l[0]*h.x+l[2]*h.y,l[1]*h.x+l[3]*h.y):new S.Point(l[0]*h.x+l[2]*h.y+l[4],l[1]*h.x+l[3]*h.y+l[5])},makeBoundingBoxFromPoints:function(h,l){if(l)for(var c=0;c<h.length;c++)h[c]=S.util.transformPoint(h[c],l);var f=[h[0].x,h[1].x,h[2].x,h[3].x],r=S.util.array.min(f),s=S.util.array.max(f)-r,u=[h[0].y,h[1].y,h[2].y,h[3].y],m=S.util.array.min(u);return{left:r,top:m,width:s,height:S.util.array.max(u)-m}},invertTransform:function(h){var l=1/(h[0]*h[3]-h[1]*h[2]),c=[l*h[3],-l*h[1],-l*h[2],l*h[0]],f=S.util.transformPoint({x:h[4],y:h[5]},c,!0);return c[4]=-f.x,c[5]=-f.y,c},toFixed:function(h,l){return parseFloat(Number(h).toFixed(l))},parseUnit:function(h,l){var c=/\D{0,2}$/.exec(h),f=parseFloat(h);switch(l||(l=S.Text.DEFAULT_SVG_FONT_SIZE),c[0]){case"mm":return f*S.DPI/25.4;case"cm":return f*S.DPI/2.54;case"in":return f*S.DPI;case"pt":return f*S.DPI/72;case"pc":return f*S.DPI/72*12;case"em":return f*l;default:return f}},falseFunction:function(){return!1},getKlass:function(h,l){return h=S.util.string.camelize(h.charAt(0).toUpperCase()+h.slice(1)),S.util.resolveNamespace(l)[h]},getSvgAttributes:function(h){var l=["instantiated_by_use","style","id","class"];switch(h){case"linearGradient":l=l.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":l=l.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":l=l.concat(["offset","stop-color","stop-opacity"])}return l},resolveNamespace:function(h){if(!h)return S;var l,c=h.split("."),f=c.length,r=i||S.window;for(l=0;l<f;++l)r=r[c[l]];return r},loadImage:function(h,l,c,f){if(h){var r=S.util.createImage(),s=function(){l&&l.call(c,r,!1),r=r.onload=r.onerror=null};r.onload=s,r.onerror=function(){S.log("Error loading "+r.src),l&&l.call(c,null,!0),r=r.onload=r.onerror=null},h.indexOf("data")!==0&&f!=null&&(r.crossOrigin=f),h.substring(0,14)==="data:image/svg"&&(r.onload=null,S.util.loadImageInDom(r,s)),r.src=h}else l&&l.call(c,h)},loadImageInDom:function(h,l){var c=S.document.createElement("div");c.style.width=c.style.height="1px",c.style.left=c.style.top="-100%",c.style.position="absolute",c.appendChild(h),S.document.querySelector("body").appendChild(c),h.onload=function(){l(),c.parentNode.removeChild(c),c=null}},enlivenObjects:function(h,l,c,f){var r=[],s=0,u=(h=h||[]).length;function m(){++s===u&&l&&l(r.filter(function(g){return g}))}u?h.forEach(function(g,p){g&&g.type?S.util.getKlass(g.type,c).fromObject(g,function(v,C){C||(r[p]=v),f&&f(g,v,C),m()}):m()}):l&&l(r)},enlivenObjectEnlivables:function(h,l,c){var f=S.Object.ENLIVEN_PROPS.filter(function(r){return!!h[r]});S.util.enlivenObjects(f.map(function(r){return h[r]}),function(r){var s={};f.forEach(function(u,m){s[u]=r[m],l&&(l[u]=r[m])}),c&&c(s)})},enlivenPatterns:function(h,l){function c(){++r===s&&l&&l(f)}var f=[],r=0,s=(h=h||[]).length;s?h.forEach(function(u,m){u&&u.source?new S.Pattern(u,function(g){f[m]=g,c()}):(f[m]=u,c())}):l&&l(f)},groupSVGElements:function(h,l,c){var f;return h&&h.length===1?h[0]:(l&&(l.width&&l.height?l.centerPoint={x:l.width/2,y:l.height/2}:(delete l.width,delete l.height)),f=new S.Group(h,l),c!==void 0&&(f.sourcePath=c),f)},populateWithProperties:function(h,l,c){if(c&&Array.isArray(c))for(var f=0,r=c.length;f<r;f++)c[f]in h&&(l[c[f]]=h[c[f]])},createCanvasElement:function(){return S.document.createElement("canvas")},copyCanvasElement:function(h){var l=S.util.createCanvasElement();return l.width=h.width,l.height=h.height,l.getContext("2d").drawImage(h,0,0),l},toDataURL:function(h,l,c){return h.toDataURL("image/"+l,c)},createImage:function(){return S.document.createElement("img")},multiplyTransformMatrices:function(h,l,c){return[h[0]*l[0]+h[2]*l[1],h[1]*l[0]+h[3]*l[1],h[0]*l[2]+h[2]*l[3],h[1]*l[2]+h[3]*l[3],c?0:h[0]*l[4]+h[2]*l[5]+h[4],c?0:h[1]*l[4]+h[3]*l[5]+h[5]]},qrDecompose:function(h){var l=a(h[1],h[0]),c=d(h[0],2)+d(h[1],2),f=o(c),r=(h[0]*h[3]-h[2]*h[1])/f,s=a(h[0]*h[2]+h[1]*h[3],c);return{angle:l/_,scaleX:f,scaleY:r,skewX:s/_,skewY:0,translateX:h[4],translateY:h[5]}},calcRotateMatrix:function(h){if(!h.angle)return S.iMatrix.concat();var l=S.util.degreesToRadians(h.angle),c=S.util.cos(l),f=S.util.sin(l);return[c,f,-f,c,0,0]},calcDimensionsMatrix:function(h){var l=h.scaleX===void 0?1:h.scaleX,c=h.scaleY===void 0?1:h.scaleY,f=[h.flipX?-l:l,0,0,h.flipY?-c:c,0,0],r=S.util.multiplyTransformMatrices,s=S.util.degreesToRadians;return h.skewX&&(f=r(f,[1,0,Math.tan(s(h.skewX)),1],!0)),h.skewY&&(f=r(f,[1,Math.tan(s(h.skewY)),0,1],!0)),f},composeMatrix:function(h){var l=[1,0,0,1,h.translateX||0,h.translateY||0],c=S.util.multiplyTransformMatrices;return h.angle&&(l=c(l,S.util.calcRotateMatrix(h))),(h.scaleX!==1||h.scaleY!==1||h.skewX||h.skewY||h.flipX||h.flipY)&&(l=c(l,S.util.calcDimensionsMatrix(h))),l},resetObjectTransform:function(h){h.scaleX=1,h.scaleY=1,h.skewX=0,h.skewY=0,h.flipX=!1,h.flipY=!1,h.rotate(0)},saveObjectTransform:function(h){return{scaleX:h.scaleX,scaleY:h.scaleY,skewX:h.skewX,skewY:h.skewY,angle:h.angle,left:h.left,flipX:h.flipX,flipY:h.flipY,top:h.top}},isTransparent:function(h,l,c,f){f>0&&(l>f?l-=f:l=0,c>f?c-=f:c=0);var r,s=!0,u=h.getImageData(l,c,2*f||1,2*f||1),m=u.data.length;for(r=3;r<m&&(s=u.data[r]<=0)!=0;r+=4);return u=null,s},parsePreserveAspectRatioAttribute:function(h){var l,c="meet",f=h.split(" ");return f&&f.length&&((c=f.pop())!=="meet"&&c!=="slice"?(l=c,c="meet"):f.length&&(l=f.pop())),{meetOrSlice:c,alignX:l!=="none"?l.slice(1,4):"none",alignY:l!=="none"?l.slice(5,8):"none"}},clearFabricFontCache:function(h){(h=(h||"").toLowerCase())?S.charWidthsCache[h]&&delete S.charWidthsCache[h]:S.charWidthsCache={}},limitDimsByArea:function(h,l){var c=Math.sqrt(l*h),f=Math.floor(l/c);return{x:Math.floor(c),y:f}},capValue:function(h,l,c){return Math.max(h,Math.min(l,c))},findScaleToFit:function(h,l){return Math.min(l.width/h.width,l.height/h.height)},findScaleToCover:function(h,l){return Math.max(l.width/h.width,l.height/h.height)},matrixToSVG:function(h){return"matrix("+h.map(function(l){return S.util.toFixed(l,S.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(h,l){var c=S.util.invertTransform(l),f=S.util.multiplyTransformMatrices(c,h.calcOwnMatrix());S.util.applyTransformToObject(h,f)},addTransformToObject:function(h,l){S.util.applyTransformToObject(h,S.util.multiplyTransformMatrices(l,h.calcOwnMatrix()))},applyTransformToObject:function(h,l){var c=S.util.qrDecompose(l),f=new S.Point(c.translateX,c.translateY);h.flipX=!1,h.flipY=!1,h.set("scaleX",c.scaleX),h.set("scaleY",c.scaleY),h.skewX=c.skewX,h.skewY=c.skewY,h.angle=c.angle,h.setPositionByOrigin(f,"center","center")},sizeAfterTransform:function(h,l,c){var f=h/2,r=l/2,s=[{x:-f,y:-r},{x:f,y:-r},{x:-f,y:r},{x:f,y:r}],u=S.util.calcDimensionsMatrix(c),m=S.util.makeBoundingBoxFromPoints(s,u);return{x:m.width,y:m.height}},mergeClipPaths:function(h,l){var c=h,f=l;c.inverted&&!f.inverted&&(c=l,f=h),S.util.applyTransformToObject(f,S.util.multiplyTransformMatrices(S.util.invertTransform(c.calcTransformMatrix()),f.calcTransformMatrix()));var r=c.inverted&&f.inverted;return r&&(c.inverted=f.inverted=!1),new S.Group([c],{clipPath:f,inverted:r})}},function(){var h=Array.prototype.join,l={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},c={m:"l",M:"L"};function f(k,I,R,N,H,z,q,J,$,V,j){var X=S.util.cos(k),Q=S.util.sin(k),ie=S.util.cos(I),G=S.util.sin(I),U=R*H*ie-N*z*G+q,Z=N*H*ie+R*z*G+J;return["C",V+$*(-R*H*Q-N*z*X),j+$*(-N*H*Q+R*z*X),U+$*(R*H*G+N*z*ie),Z+$*(N*H*G-R*z*ie),U,Z]}function r(k,I,R,N){var H=Math.atan2(I,k),z=Math.atan2(N,R);return z>=H?z-H:2*Math.PI-(H-z)}function s(k,I,R){for(var N=R[1],H=R[2],z=R[3],q=R[4],J=R[5],$=function(X,Q,ie,G,U,Z,re){var ee=Math.PI,se=re*ee/180,_e=S.util.sin(se),ge=S.util.cos(se),he=0,fe=0,pe=-ge*X*.5-_e*Q*.5,me=-ge*Q*.5+_e*X*.5,ye=(ie=Math.abs(ie))*ie,ve=(G=Math.abs(G))*G,be=me*me,Oe=pe*pe,pt=ye*ve-ye*be-ve*Oe,Bt=0;if(pt<0){var tn=Math.sqrt(1-pt/(ye*ve));ie*=tn,G*=tn}else Bt=(U===Z?-1:1)*Math.sqrt(pt/(ye*be+ve*Oe));var Me=Bt*ie*me/G,ut=-Bt*G*pe/ie,Xn=ge*Me-_e*ut+.5*X,vn=_e*Me+ge*ut+.5*Q,nn=r(1,0,(pe-Me)/ie,(me-ut)/G),yn=r((pe-Me)/ie,(me-ut)/G,(-pe-Me)/ie,(-me-ut)/G);Z===0&&yn>0?yn-=2*ee:Z===1&&yn<0&&(yn+=2*ee);for(var $n=Math.ceil(Math.abs(yn/ee*2)),Zn=[],Kn=yn/$n,or=8/3*Math.sin(Kn/4)*Math.sin(Kn/4)/Math.sin(Kn/2),sr=nn+Kn,Sn=0;Sn<$n;Sn++)Zn[Sn]=f(nn,sr,ge,_e,ie,G,Xn,vn,or,he,fe),he=Zn[Sn][5],fe=Zn[Sn][6],nn=sr,sr+=Kn;return Zn}(R[6]-k,R[7]-I,N,H,q,J,z),V=0,j=$.length;V<j;V++)$[V][1]+=k,$[V][2]+=I,$[V][3]+=k,$[V][4]+=I,$[V][5]+=k,$[V][6]+=I;return $}function u(k,I,R,N){return Math.sqrt((R-k)*(R-k)+(N-I)*(N-I))}function m(k,I,R,N,H,z,q,J){return function($){var V,j=(V=$)*V*V,X=function(G){return 3*G*G*(1-G)}($),Q=function(G){return 3*G*(1-G)*(1-G)}($),ie=function(G){return(1-G)*(1-G)*(1-G)}($);return{x:q*j+H*X+R*Q+k*ie,y:J*j+z*X+N*Q+I*ie}}}function g(k,I,R,N,H,z,q,J){return function($){var V=1-$,j=3*V*V*(R-k)+6*V*$*(H-R)+3*$*$*(q-H),X=3*V*V*(N-I)+6*V*$*(z-N)+3*$*$*(J-z);return Math.atan2(X,j)}}function p(k,I,R,N,H,z){return function(q){var J,$=(J=q)*J,V=function(X){return 2*X*(1-X)}(q),j=function(X){return(1-X)*(1-X)}(q);return{x:H*$+R*V+k*j,y:z*$+N*V+I*j}}}function v(k,I,R,N,H,z){return function(q){var J=1-q,$=2*J*(R-k)+2*q*(H-R),V=2*J*(N-I)+2*q*(z-N);return Math.atan2(V,$)}}function C(k,I,R){var N,H,z={x:I,y:R},q=0;for(H=1;H<=100;H+=1)N=k(H/100),q+=u(z.x,z.y,N.x,N.y),z=N;return q}function b(k){for(var I,R,N,H,z=0,q=k.length,J=0,$=0,V=0,j=0,X=[],Q=0;Q<q;Q++){switch(N={x:J,y:$,command:(I=k[Q])[0]},I[0]){case"M":N.length=0,V=J=I[1],j=$=I[2];break;case"L":N.length=u(J,$,I[1],I[2]),J=I[1],$=I[2];break;case"C":R=m(J,$,I[1],I[2],I[3],I[4],I[5],I[6]),H=g(J,$,I[1],I[2],I[3],I[4],I[5],I[6]),N.iterator=R,N.angleFinder=H,N.length=C(R,J,$),J=I[5],$=I[6];break;case"Q":R=p(J,$,I[1],I[2],I[3],I[4]),H=v(J,$,I[1],I[2],I[3],I[4]),N.iterator=R,N.angleFinder=H,N.length=C(R,J,$),J=I[3],$=I[4];break;case"Z":case"z":N.destX=V,N.destY=j,N.length=u(J,$,V,j),J=V,$=j}z+=N.length,X.push(N)}return X.push({length:z,x:J,y:$}),X}S.util.joinPath=function(k){return k.map(function(I){return I.join(" ")}).join(" ")},S.util.parsePath=function(k){var I,R,N,H,z,q=[],J=[],$=S.rePathCommand,V="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",j="("+V+")"+S.commaWsp,X="([01])"+S.commaWsp+"?",Q=new RegExp(j+"?"+j+"?"+j+X+X+j+"?("+V+")","g");if(!k||!k.match)return q;for(var ie,G=0,U=(z=k.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)).length;G<U;G++){H=(I=z[G]).slice(1).trim(),J.length=0;var Z=I.charAt(0);if(ie=[Z],Z.toLowerCase()==="a")for(var re;re=Q.exec(H);)for(var ee=1;ee<re.length;ee++)J.push(re[ee]);else for(;N=$.exec(H);)J.push(N[0]);ee=0;for(var se=J.length;ee<se;ee++)R=parseFloat(J[ee]),isNaN(R)||ie.push(R);var _e=l[Z.toLowerCase()],ge=c[Z]||Z;if(ie.length-1>_e)for(var he=1,fe=ie.length;he<fe;he+=_e)q.push([Z].concat(ie.slice(he,he+_e))),Z=ge;else q.push(ie)}return q},S.util.makePathSimpler=function(k){var I,R,N,H,z,q,J=0,$=0,V=k.length,j=0,X=0,Q=[];for(R=0;R<V;++R){switch(N=!1,(I=k[R].slice(0))[0]){case"l":I[0]="L",I[1]+=J,I[2]+=$;case"L":J=I[1],$=I[2];break;case"h":I[1]+=J;case"H":I[0]="L",I[2]=$,J=I[1];break;case"v":I[1]+=$;case"V":I[0]="L",$=I[1],I[1]=J,I[2]=$;break;case"m":I[0]="M",I[1]+=J,I[2]+=$;case"M":J=I[1],$=I[2],j=I[1],X=I[2];break;case"c":I[0]="C",I[1]+=J,I[2]+=$,I[3]+=J,I[4]+=$,I[5]+=J,I[6]+=$;case"C":z=I[3],q=I[4],J=I[5],$=I[6];break;case"s":I[0]="S",I[1]+=J,I[2]+=$,I[3]+=J,I[4]+=$;case"S":H==="C"?(z=2*J-z,q=2*$-q):(z=J,q=$),J=I[3],$=I[4],I[0]="C",I[5]=I[3],I[6]=I[4],I[3]=I[1],I[4]=I[2],I[1]=z,I[2]=q,z=I[3],q=I[4];break;case"q":I[0]="Q",I[1]+=J,I[2]+=$,I[3]+=J,I[4]+=$;case"Q":z=I[1],q=I[2],J=I[3],$=I[4];break;case"t":I[0]="T",I[1]+=J,I[2]+=$;case"T":H==="Q"?(z=2*J-z,q=2*$-q):(z=J,q=$),I[0]="Q",J=I[1],$=I[2],I[1]=z,I[2]=q,I[3]=J,I[4]=$;break;case"a":I[0]="A",I[6]+=J,I[7]+=$;case"A":N=!0,Q=Q.concat(s(J,$,I)),J=I[6],$=I[7];break;case"z":case"Z":J=j,$=X}N||Q.push(I),H=I[0]}return Q},S.util.getSmoothPathFromPoints=function(k,I){var R,N=[],H=new S.Point(k[0].x,k[0].y),z=new S.Point(k[1].x,k[1].y),q=k.length,J=1,$=0,V=q>2;for(I=I||0,V&&(J=k[2].x<z.x?-1:k[2].x===z.x?0:1,$=k[2].y<z.y?-1:k[2].y===z.y?0:1),N.push(["M",H.x-J*I,H.y-$*I]),R=1;R<q;R++){if(!H.eq(z)){var j=H.midPointFrom(z);N.push(["Q",H.x,H.y,j.x,j.y])}H=k[R],R+1<k.length&&(z=k[R+1])}return V&&(J=H.x>k[R-2].x?1:H.x===k[R-2].x?0:-1,$=H.y>k[R-2].y?1:H.y===k[R-2].y?0:-1),N.push(["L",H.x+J*I,H.y+$*I]),N},S.util.getPathSegmentsInfo=b,S.util.getBoundsOfCurve=function(k,I,R,N,H,z,q,J){var $;if(S.cachesBoundsOfCurve&&($=h.call(arguments),S.boundsOfCurveCache[$]))return S.boundsOfCurveCache[$];var V,j,X,Q,ie,G,U,Z,re=Math.sqrt,ee=Math.min,se=Math.max,_e=Math.abs,ge=[],he=[[],[]];j=6*k-12*R+6*H,V=-3*k+9*R-9*H+3*q,X=3*R-3*k;for(var fe=0;fe<2;++fe)if(fe>0&&(j=6*I-12*N+6*z,V=-3*I+9*N-9*z+3*J,X=3*N-3*I),_e(V)<1e-12){if(_e(j)<1e-12)continue;0<(Q=-X/j)&&Q<1&&ge.push(Q)}else(U=j*j-4*X*V)<0||(0<(ie=(-j+(Z=re(U)))/(2*V))&&ie<1&&ge.push(ie),0<(G=(-j-Z)/(2*V))&&G<1&&ge.push(G));for(var pe,me,ye,ve=ge.length,be=ve;ve--;)pe=(ye=1-(Q=ge[ve]))*ye*ye*k+3*ye*ye*Q*R+3*ye*Q*Q*H+Q*Q*Q*q,he[0][ve]=pe,me=ye*ye*ye*I+3*ye*ye*Q*N+3*ye*Q*Q*z+Q*Q*Q*J,he[1][ve]=me;he[0][be]=k,he[1][be]=I,he[0][be+1]=q,he[1][be+1]=J;var Oe=[{x:ee.apply(null,he[0]),y:ee.apply(null,he[1])},{x:se.apply(null,he[0]),y:se.apply(null,he[1])}];return S.cachesBoundsOfCurve&&(S.boundsOfCurveCache[$]=Oe),Oe},S.util.getPointOnPath=function(k,I,R){R||(R=b(k));for(var N=0;I-R[N].length>0&&N<R.length-2;)I-=R[N].length,N++;var H,z=R[N],q=I/z.length,J=z.command,$=k[N];switch(J){case"M":return{x:z.x,y:z.y,angle:0};case"Z":case"z":return(H=new S.Point(z.x,z.y).lerp(new S.Point(z.destX,z.destY),q)).angle=Math.atan2(z.destY-z.y,z.destX-z.x),H;case"L":return(H=new S.Point(z.x,z.y).lerp(new S.Point($[1],$[2]),q)).angle=Math.atan2($[2]-z.y,$[1]-z.x),H;case"C":case"Q":return function(V,j){for(var X,Q,ie,G=0,U=0,Z=V.iterator,re={x:V.x,y:V.y},ee=.01,se=V.angleFinder;U<j&&ee>1e-4;)X=Z(G),ie=G,(Q=u(re.x,re.y,X.x,X.y))+U>j?(G-=ee,ee/=2):(re=X,G+=ee,U+=Q);return X.angle=se(ie),X}(z,I)}},S.util.transformPath=function(k,I,R){return R&&(I=S.util.multiplyTransformMatrices(I,[1,0,0,1,-R.x,-R.y])),k.map(function(N){for(var H=N.slice(0),z={},q=1;q<N.length-1;q+=2)z.x=N[q],z.y=N[q+1],z=S.util.transformPoint(z,I),H[q]=z.x,H[q+1]=z.y;return H})}}(),function(){var h=Array.prototype.slice;function l(c,f,r){if(c&&c.length!==0){var s=c.length-1,u=f?c[s][f]:c[s];if(f)for(;s--;)r(c[s][f],u)&&(u=c[s][f]);else for(;s--;)r(c[s],u)&&(u=c[s]);return u}}S.util.array={fill:function(c,f){for(var r=c.length;r--;)c[r]=f;return c},invoke:function(c,f){for(var r=h.call(arguments,2),s=[],u=0,m=c.length;u<m;u++)s[u]=r.length?c[u][f].apply(c[u],r):c[u][f].call(c[u]);return s},min:function(c,f){return l(c,f,function(r,s){return r<s})},max:function(c,f){return l(c,f,function(r,s){return r>=s})}}}(),function(){function h(l,c,f){if(f)if(!S.isLikelyNode&&c instanceof Element)l=c;else if(c instanceof Array){l=[];for(var r=0,s=c.length;r<s;r++)l[r]=h({},c[r],f)}else if(c&&typeof c=="object")for(var u in c)u==="canvas"||u==="group"?l[u]=null:c.hasOwnProperty(u)&&(l[u]=h({},c[u],f));else l=c;else for(var u in c)l[u]=c[u];return l}S.util.object={extend:h,clone:function(l,c){return h({},l,c)}},S.util.object.extend(S.util,S.Observable)}(),function(){function h(l,c){var f=l.charCodeAt(c);if(isNaN(f))return"";if(f<55296||f>57343)return l.charAt(c);if(55296<=f&&f<=56319){if(l.length<=c+1)throw"High surrogate without following low surrogate";var r=l.charCodeAt(c+1);if(56320>r||r>57343)throw"High surrogate without following low surrogate";return l.charAt(c)+l.charAt(c+1)}if(c===0)throw"Low surrogate without preceding high surrogate";var s=l.charCodeAt(c-1);if(55296>s||s>56319)throw"Low surrogate without preceding high surrogate";return!1}S.util.string={camelize:function(l){return l.replace(/-+(.)?/g,function(c,f){return f?f.toUpperCase():""})},capitalize:function(l,c){return l.charAt(0).toUpperCase()+(c?l.slice(1):l.slice(1).toLowerCase())},escapeXml:function(l){return l.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(l){var c,f=0,r=[];for(f=0;f<l.length;f++)(c=h(l,f))!==!1&&r.push(c);return r}}}(),function(){var h=Array.prototype.slice,l=function(){},c=function(){for(var u in{toString:1})if(u==="toString")return!1;return!0}(),f=function(u,m,g){for(var p in m)p in u.prototype&&typeof u.prototype[p]=="function"&&(m[p]+"").indexOf("callSuper")>-1?u.prototype[p]=function(v){return function(){var C=this.constructor.superclass;this.constructor.superclass=g;var b=m[v].apply(this,arguments);if(this.constructor.superclass=C,v!=="initialize")return b}}(p):u.prototype[p]=m[p],c&&(m.toString!==Object.prototype.toString&&(u.prototype.toString=m.toString),m.valueOf!==Object.prototype.valueOf&&(u.prototype.valueOf=m.valueOf))};function r(){}function s(u){for(var m=null,g=this;g.constructor.superclass;){var p=g.constructor.superclass.prototype[u];if(g[u]!==p){m=p;break}g=g.constructor.superclass.prototype}return m?arguments.length>1?m.apply(this,h.call(arguments,1)):m.call(this):console.log("tried to callSuper "+u+", method not found in prototype chain",this)}S.util.createClass=function(){var u=null,m=h.call(arguments,0);function g(){this.initialize.apply(this,arguments)}typeof m[0]=="function"&&(u=m.shift()),g.superclass=u,g.subclasses=[],u&&(r.prototype=u.prototype,g.prototype=new r,u.subclasses.push(g));for(var p=0,v=m.length;p<v;p++)f(g,m[p],u);return g.prototype.initialize||(g.prototype.initialize=l),g.prototype.constructor=g,g.prototype.callSuper=s,g}}(),w=!!S.document.createElement("div").attachEvent,x=["touchstart","touchmove","touchend"],S.util.addListener=function(h,l,c,f){h&&h.addEventListener(l,c,!w&&f)},S.util.removeListener=function(h,l,c,f){h&&h.removeEventListener(l,c,!w&&f)},S.util.getPointer=function(h){var l=h.target,c=S.util.getScrollLeftTop(l),f=function(r){var s=r.changedTouches;return s&&s[0]?s[0]:r}(h);return{x:f.clientX+c.left,y:f.clientY+c.top}},S.util.isTouchEvent=function(h){return x.indexOf(h.type)>-1||h.pointerType==="touch"},E=typeof(T=S.document.createElement("div")).style.opacity=="string",M=typeof T.style.filter=="string",F=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,P=function(h){return h},E?P=function(h,l){return h.style.opacity=l,h}:M&&(P=function(h,l){var c=h.style;return h.currentStyle&&!h.currentStyle.hasLayout&&(c.zoom=1),F.test(c.filter)?(l=l>=.9999?"":"alpha(opacity="+100*l+")",c.filter=c.filter.replace(F,l)):c.filter+=" alpha(opacity="+100*l+")",h}),S.util.setStyle=function(h,l){var c=h.style;if(!c)return h;if(typeof l=="string")return h.style.cssText+=";"+l,l.indexOf("opacity")>-1?P(h,l.match(/opacity:\s*(\d?\.?\d*)/)[1]):h;for(var f in l)f==="opacity"?P(h,l[f]):c[f==="float"||f==="cssFloat"?c.styleFloat===void 0?"cssFloat":"styleFloat":f]=l[f];return h},function(){var h,l,c,f,r=Array.prototype.slice,s=function(g){return r.call(g,0)};try{h=s(S.document.childNodes)instanceof Array}catch{}function u(g,p){var v=S.document.createElement(g);for(var C in p)C==="class"?v.className=p[C]:C==="for"?v.htmlFor=p[C]:v.setAttribute(C,p[C]);return v}function m(g){for(var p=0,v=0,C=S.document.documentElement,b=S.document.body||{scrollLeft:0,scrollTop:0};g&&(g.parentNode||g.host)&&((g=g.parentNode||g.host)===S.document?(p=b.scrollLeft||C.scrollLeft||0,v=b.scrollTop||C.scrollTop||0):(p+=g.scrollLeft||0,v+=g.scrollTop||0),g.nodeType!==1||g.style.position!=="fixed"););return{left:p,top:v}}h||(s=function(g){for(var p=new Array(g.length),v=g.length;v--;)p[v]=g[v];return p}),l=S.document.defaultView&&S.document.defaultView.getComputedStyle?function(g,p){var v=S.document.defaultView.getComputedStyle(g,null);return v?v[p]:void 0}:function(g,p){var v=g.style[p];return!v&&g.currentStyle&&(v=g.currentStyle[p]),v},c=S.document.documentElement.style,f="userSelect"in c?"userSelect":"MozUserSelect"in c?"MozUserSelect":"WebkitUserSelect"in c?"WebkitUserSelect":"KhtmlUserSelect"in c?"KhtmlUserSelect":"",S.util.makeElementUnselectable=function(g){return g.onselectstart!==void 0&&(g.onselectstart=S.util.falseFunction),f?g.style[f]="none":typeof g.unselectable=="string"&&(g.unselectable="on"),g},S.util.makeElementSelectable=function(g){return g.onselectstart!==void 0&&(g.onselectstart=null),f?g.style[f]="":typeof g.unselectable=="string"&&(g.unselectable=""),g},S.util.setImageSmoothing=function(g,p){g.imageSmoothingEnabled=g.imageSmoothingEnabled||g.webkitImageSmoothingEnabled||g.mozImageSmoothingEnabled||g.msImageSmoothingEnabled||g.oImageSmoothingEnabled,g.imageSmoothingEnabled=p},S.util.getById=function(g){return typeof g=="string"?S.document.getElementById(g):g},S.util.toArray=s,S.util.addClass=function(g,p){g&&(" "+g.className+" ").indexOf(" "+p+" ")===-1&&(g.className+=(g.className?" ":"")+p)},S.util.makeElement=u,S.util.wrapElement=function(g,p,v){return typeof p=="string"&&(p=u(p,v)),g.parentNode&&g.parentNode.replaceChild(p,g),p.appendChild(g),p},S.util.getScrollLeftTop=m,S.util.getElementOffset=function(g){var p,v,C=g&&g.ownerDocument,b={left:0,top:0},k={left:0,top:0},I={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!C)return k;for(var R in I)k[I[R]]+=parseInt(l(g,R),10)||0;return p=C.documentElement,g.getBoundingClientRect!==void 0&&(b=g.getBoundingClientRect()),v=m(g),{left:b.left+v.left-(p.clientLeft||0)+k.left,top:b.top+v.top-(p.clientTop||0)+k.top}},S.util.getNodeCanvas=function(g){var p=S.jsdomImplForWrapper(g);return p._canvas||p._image},S.util.cleanUpJsdomNode=function(g){if(S.isLikelyNode){var p=S.jsdomImplForWrapper(g);p&&(p._image=null,p._canvas=null,p._currentSrc=null,p._attributes=null,p._classList=null)}}}(),function(){function h(){}S.util.request=function(l,c){c||(c={});var f=c.method?c.method.toUpperCase():"GET",r=c.onComplete||function(){},s=new S.window.XMLHttpRequest,u=c.body||c.parameters;return s.onreadystatechange=function(){s.readyState===4&&(r(s),s.onreadystatechange=h)},f==="GET"&&(u=null,typeof c.parameters=="string"&&(l=function(m,g){return m+(/\?/.test(m)?"&":"?")+g}(l,c.parameters))),s.open(f,l,!0),f!=="POST"&&f!=="PUT"||s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(u),s}}(),S.log=console.log,S.warn=console.warn,function(){var h=S.util.object.extend,l=S.util.object.clone,c=[];function f(){return!1}function r(g,p,v,C){return-v*Math.cos(g/C*(Math.PI/2))+v+p}S.util.object.extend(c,{cancelAll:function(){var g=this.splice(0);return g.forEach(function(p){p.cancel()}),g},cancelByCanvas:function(g){if(!g)return[];var p=this.filter(function(v){return typeof v.target=="object"&&v.target.canvas===g});return p.forEach(function(v){v.cancel()}),p},cancelByTarget:function(g){var p=this.findAnimationsByTarget(g);return p.forEach(function(v){v.cancel()}),p},findAnimationIndex:function(g){return this.indexOf(this.findAnimation(g))},findAnimation:function(g){return this.find(function(p){return p.cancel===g})},findAnimationsByTarget:function(g){return g?this.filter(function(p){return p.target===g}):[]}});var s=S.window.requestAnimationFrame||S.window.webkitRequestAnimationFrame||S.window.mozRequestAnimationFrame||S.window.oRequestAnimationFrame||S.window.msRequestAnimationFrame||function(g){return S.window.setTimeout(g,1e3/60)},u=S.window.cancelAnimationFrame||S.window.clearTimeout;function m(){return s.apply(S.window,arguments)}S.util.animate=function(g){g||(g={});var p,v=!1,C=function(){var b=S.runningAnimations.indexOf(p);return b>-1&&S.runningAnimations.splice(b,1)[0]};return p=h(l(g),{cancel:function(){return v=!0,C()},currentValue:"startValue"in g?g.startValue:0,completionRate:0,durationRate:0}),S.runningAnimations.push(p),m(function(b){var k,I=b||+new Date,R=g.duration||500,N=I+R,H=g.onChange||f,z=g.abort||f,q=g.onComplete||f,J=g.easing||r,$="startValue"in g&&g.startValue.length>0,V="startValue"in g?g.startValue:0,j="endValue"in g?g.endValue:100,X=g.byValue||($?V.map(function(Q,ie){return j[ie]-V[ie]}):j-V);g.onStart&&g.onStart(),function Q(ie){var G=(k=ie||+new Date)>N?R:k-I,U=G/R,Z=$?V.map(function(ee,se){return J(G,V[se],X[se],R)}):J(G,V,X,R),re=Math.abs($?(Z[0]-V[0])/X[0]:(Z-V)/X);if(p.currentValue=$?Z.slice():Z,p.completionRate=re,p.durationRate=U,!v){if(!z(Z,re,U))return k>N?(p.currentValue=$?j.slice():j,p.completionRate=1,p.durationRate=1,H($?j.slice():j,1,1),q(j,1,1),void C()):(H(Z,re,U),void m(Q));C()}}(I)}),p.cancel},S.util.requestAnimFrame=m,S.util.cancelAnimFrame=function(){return u.apply(S.window,arguments)},S.runningAnimations=c}(),function(){function h(l,c,f){var r="rgba("+parseInt(l[0]+f*(c[0]-l[0]),10)+","+parseInt(l[1]+f*(c[1]-l[1]),10)+","+parseInt(l[2]+f*(c[2]-l[2]),10);return(r+=","+(l&&c?parseFloat(l[3]+f*(c[3]-l[3])):1))+")"}S.util.animateColor=function(l,c,f,r){var s=new S.Color(l).getSource(),u=new S.Color(c).getSource(),m=r.onComplete,g=r.onChange;return r=r||{},S.util.animate(S.util.object.extend(r,{duration:f||500,startValue:s,endValue:u,byValue:u,easing:function(p,v,C,b){return h(v,C,r.colorEasing?r.colorEasing(p,b):1-Math.cos(p/b*(Math.PI/2)))},onComplete:function(p,v,C){if(m)return m(h(u,u,0),v,C)},onChange:function(p,v,C){if(g){if(Array.isArray(p))return g(h(p,p,0),v,C);g(p,v,C)}}}))}}(),function(){function h(r,s,u,m){return r<Math.abs(s)?(r=s,m=u/4):m=s===0&&r===0?u/(2*Math.PI)*Math.asin(1):u/(2*Math.PI)*Math.asin(s/r),{a:r,c:s,p:u,s:m}}function l(r,s,u){return r.a*Math.pow(2,10*(s-=1))*Math.sin((s*u-r.s)*(2*Math.PI)/r.p)}function c(r,s,u,m){return u-f(m-r,0,u,m)+s}function f(r,s,u,m){return(r/=m)<1/2.75?u*(7.5625*r*r)+s:r<2/2.75?u*(7.5625*(r-=1.5/2.75)*r+.75)+s:r<2.5/2.75?u*(7.5625*(r-=2.25/2.75)*r+.9375)+s:u*(7.5625*(r-=2.625/2.75)*r+.984375)+s}S.util.ease={easeInQuad:function(r,s,u,m){return u*(r/=m)*r+s},easeOutQuad:function(r,s,u,m){return-u*(r/=m)*(r-2)+s},easeInOutQuad:function(r,s,u,m){return(r/=m/2)<1?u/2*r*r+s:-u/2*(--r*(r-2)-1)+s},easeInCubic:function(r,s,u,m){return u*(r/=m)*r*r+s},easeOutCubic:function(r,s,u,m){return u*((r=r/m-1)*r*r+1)+s},easeInOutCubic:function(r,s,u,m){return(r/=m/2)<1?u/2*r*r*r+s:u/2*((r-=2)*r*r+2)+s},easeInQuart:function(r,s,u,m){return u*(r/=m)*r*r*r+s},easeOutQuart:function(r,s,u,m){return-u*((r=r/m-1)*r*r*r-1)+s},easeInOutQuart:function(r,s,u,m){return(r/=m/2)<1?u/2*r*r*r*r+s:-u/2*((r-=2)*r*r*r-2)+s},easeInQuint:function(r,s,u,m){return u*(r/=m)*r*r*r*r+s},easeOutQuint:function(r,s,u,m){return u*((r=r/m-1)*r*r*r*r+1)+s},easeInOutQuint:function(r,s,u,m){return(r/=m/2)<1?u/2*r*r*r*r*r+s:u/2*((r-=2)*r*r*r*r+2)+s},easeInSine:function(r,s,u,m){return-u*Math.cos(r/m*(Math.PI/2))+u+s},easeOutSine:function(r,s,u,m){return u*Math.sin(r/m*(Math.PI/2))+s},easeInOutSine:function(r,s,u,m){return-u/2*(Math.cos(Math.PI*r/m)-1)+s},easeInExpo:function(r,s,u,m){return r===0?s:u*Math.pow(2,10*(r/m-1))+s},easeOutExpo:function(r,s,u,m){return r===m?s+u:u*(1-Math.pow(2,-10*r/m))+s},easeInOutExpo:function(r,s,u,m){return r===0?s:r===m?s+u:(r/=m/2)<1?u/2*Math.pow(2,10*(r-1))+s:u/2*(2-Math.pow(2,-10*--r))+s},easeInCirc:function(r,s,u,m){return-u*(Math.sqrt(1-(r/=m)*r)-1)+s},easeOutCirc:function(r,s,u,m){return u*Math.sqrt(1-(r=r/m-1)*r)+s},easeInOutCirc:function(r,s,u,m){return(r/=m/2)<1?-u/2*(Math.sqrt(1-r*r)-1)+s:u/2*(Math.sqrt(1-(r-=2)*r)+1)+s},easeInElastic:function(r,s,u,m){var g=0;return r===0?s:(r/=m)==1?s+u:(g||(g=.3*m),-l(h(u,u,g,1.70158),r,m)+s)},easeOutElastic:function(r,s,u,m){var g=0;if(r===0)return s;if((r/=m)==1)return s+u;g||(g=.3*m);var p=h(u,u,g,1.70158);return p.a*Math.pow(2,-10*r)*Math.sin((r*m-p.s)*(2*Math.PI)/p.p)+p.c+s},easeInOutElastic:function(r,s,u,m){var g=0;if(r===0)return s;if((r/=m/2)==2)return s+u;g||(g=m*(.3*1.5));var p=h(u,u,g,1.70158);return r<1?-.5*l(p,r,m)+s:p.a*Math.pow(2,-10*(r-=1))*Math.sin((r*m-p.s)*(2*Math.PI)/p.p)*.5+p.c+s},easeInBack:function(r,s,u,m,g){return g===void 0&&(g=1.70158),u*(r/=m)*r*((g+1)*r-g)+s},easeOutBack:function(r,s,u,m,g){return g===void 0&&(g=1.70158),u*((r=r/m-1)*r*((g+1)*r+g)+1)+s},easeInOutBack:function(r,s,u,m,g){return g===void 0&&(g=1.70158),(r/=m/2)<1?u/2*(r*r*((1+(g*=1.525))*r-g))+s:u/2*((r-=2)*r*((1+(g*=1.525))*r+g)+2)+s},easeInBounce:c,easeOutBounce:f,easeInOutBounce:function(r,s,u,m){return r<m/2?.5*c(2*r,0,u,m)+s:.5*f(2*r-m,0,u,m)+.5*u+s}}}(),function(h){var l=h.fabric||(h.fabric={}),c=l.util.object.extend,f=l.util.object.clone,r=l.util.toFixed,s=l.util.parseUnit,u=l.util.multiplyTransformMatrices,m={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},g={stroke:"strokeOpacity",fill:"fillOpacity"},p="font-size",v="clip-path";function C(V){return V in m?m[V]:V}function b(V,j,X,Q){var ie,G=Array.isArray(j);if(V!=="fill"&&V!=="stroke"||j!=="none"){if(V==="strokeUniform")return j==="non-scaling-stroke";if(V==="strokeDashArray")j=j==="none"?null:j.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(V==="transformMatrix")j=X&&X.transformMatrix?u(X.transformMatrix,l.parseTransformAttribute(j)):l.parseTransformAttribute(j);else if(V==="visible")j=j!=="none"&&j!=="hidden",X&&X.visible===!1&&(j=!1);else if(V==="opacity")j=parseFloat(j),X&&X.opacity!==void 0&&(j*=X.opacity);else if(V==="textAnchor")j=j==="start"?"left":j==="end"?"right":"center";else if(V==="charSpacing")ie=s(j,Q)/Q*1e3;else if(V==="paintFirst"){var U=j.indexOf("fill"),Z=j.indexOf("stroke");j="fill",(U>-1&&Z>-1&&Z<U||U===-1&&Z>-1)&&(j="stroke")}else{if(V==="href"||V==="xlink:href"||V==="font")return j;if(V==="imageSmoothing")return j==="optimizeQuality";ie=G?j.map(s):s(j,Q)}}else j="";return!G&&isNaN(ie)?j:ie}function k(V){return new RegExp("^("+V.join("|")+")\\b","i")}function I(V,j){var X,Q,ie,G,U=[];for(ie=0,G=j.length;ie<G;ie++)X=j[ie],Q=V.getElementsByTagName(X),U=U.concat(Array.prototype.slice.call(Q));return U}function R(V,j){var X,Q=!0;return(X=N(V,j.pop()))&&j.length&&(Q=function(ie,G){for(var U,Z=!0;ie.parentNode&&ie.parentNode.nodeType===1&&G.length;)Z&&(U=G.pop()),Z=N(ie=ie.parentNode,U);return G.length===0}(V,j)),X&&Q&&j.length===0}function N(V,j){var X,Q,ie=V.nodeName,G=V.getAttribute("class"),U=V.getAttribute("id");if(X=new RegExp("^"+ie,"i"),j=j.replace(X,""),U&&j.length&&(X=new RegExp("#"+U+"(?![a-zA-Z\\-]+)","i"),j=j.replace(X,"")),G&&j.length)for(Q=(G=G.split(" ")).length;Q--;)X=new RegExp("\\."+G[Q]+"(?![a-zA-Z\\-]+)","i"),j=j.replace(X,"");return j.length===0}function H(V,j){var X;if(V.getElementById&&(X=V.getElementById(j)),X)return X;var Q,ie,G,U=V.getElementsByTagName("*");for(ie=0,G=U.length;ie<G;ie++)if(j===(Q=U[ie]).getAttribute("id"))return Q}l.svgValidTagNamesRegEx=k(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),l.svgViewBoxElementsRegEx=k(["symbol","image","marker","pattern","view","svg"]),l.svgInvalidAncestorsRegEx=k(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),l.svgValidParentsRegEx=k(["symbol","g","a","svg","clipPath","defs"]),l.cssRules={},l.gradientDefs={},l.clipPaths={},l.parseTransformAttribute=function(){function V(Z,re,ee){Z[ee]=Math.tan(l.util.degreesToRadians(re[0]))}var j=l.iMatrix,X=l.reNum,Q=l.commaWsp,ie="(?:(?:(matrix)\\s*\\(\\s*("+X+")"+Q+"("+X+")"+Q+"("+X+")"+Q+"("+X+")"+Q+"("+X+")"+Q+"("+X+")\\s*\\))|(?:(translate)\\s*\\(\\s*("+X+")(?:"+Q+"("+X+"))?\\s*\\))|(?:(scale)\\s*\\(\\s*("+X+")(?:"+Q+"("+X+"))?\\s*\\))|(?:(rotate)\\s*\\(\\s*("+X+")(?:"+Q+"("+X+")"+Q+"("+X+"))?\\s*\\))|(?:(skewX)\\s*\\(\\s*("+X+")\\s*\\))|(?:(skewY)\\s*\\(\\s*("+X+")\\s*\\)))",G=new RegExp("^\\s*(?:(?:"+ie+"(?:"+Q+"*"+ie+")*)?)\\s*$"),U=new RegExp(ie,"g");return function(Z){var re=j.concat(),ee=[];if(!Z||Z&&!G.test(Z))return re;Z.replace(U,function(_e){var ge=new RegExp(ie).exec(_e).filter(function(pe){return!!pe}),he=ge[1],fe=ge.slice(2).map(parseFloat);switch(he){case"translate":(function(pe,me){pe[4]=me[0],me.length===2&&(pe[5]=me[1])})(re,fe);break;case"rotate":fe[0]=l.util.degreesToRadians(fe[0]),function(pe,me){var ye=l.util.cos(me[0]),ve=l.util.sin(me[0]),be=0,Oe=0;me.length===3&&(be=me[1],Oe=me[2]),pe[0]=ye,pe[1]=ve,pe[2]=-ve,pe[3]=ye,pe[4]=be-(ye*be-ve*Oe),pe[5]=Oe-(ve*be+ye*Oe)}(re,fe);break;case"scale":(function(pe,me){var ye=me[0],ve=me.length===2?me[1]:me[0];pe[0]=ye,pe[3]=ve})(re,fe);break;case"skewX":V(re,fe,2);break;case"skewY":V(re,fe,1);break;case"matrix":re=fe}ee.push(re.concat()),re=j.concat()});for(var se=ee[0];ee.length>1;)ee.shift(),se=l.util.multiplyTransformMatrices(se,ee[0]);return se}}();var z=new RegExp("^\\s*("+l.reNum+"+)\\s*,?\\s*("+l.reNum+"+)\\s*,?\\s*("+l.reNum+"+)\\s*,?\\s*("+l.reNum+"+)\\s*$");function q(V){if(!l.svgViewBoxElementsRegEx.test(V.nodeName))return{};var j,X,Q,ie,G,U,Z=V.getAttribute("viewBox"),re=1,ee=1,se=V.getAttribute("width"),_e=V.getAttribute("height"),ge=V.getAttribute("x")||0,he=V.getAttribute("y")||0,fe=V.getAttribute("preserveAspectRatio")||"",pe=!Z||!(Z=Z.match(z)),me=!se||!_e||se==="100%"||_e==="100%",ye=pe&&me,ve={},be="",Oe=0,pt=0;if(ve.width=0,ve.height=0,ve.toBeParsed=ye,pe&&(ge||he)&&V.parentNode&&V.parentNode.nodeName!=="#document"&&(be=" translate("+s(ge)+" "+s(he)+") ",G=(V.getAttribute("transform")||"")+be,V.setAttribute("transform",G),V.removeAttribute("x"),V.removeAttribute("y")),ye)return ve;if(pe)return ve.width=s(se),ve.height=s(_e),ve;if(j=-parseFloat(Z[1]),X=-parseFloat(Z[2]),Q=parseFloat(Z[3]),ie=parseFloat(Z[4]),ve.minX=j,ve.minY=X,ve.viewBoxWidth=Q,ve.viewBoxHeight=ie,me?(ve.width=Q,ve.height=ie):(ve.width=s(se),ve.height=s(_e),re=ve.width/Q,ee=ve.height/ie),(fe=l.util.parsePreserveAspectRatioAttribute(fe)).alignX!=="none"&&(fe.meetOrSlice==="meet"&&(ee=re=re>ee?ee:re),fe.meetOrSlice==="slice"&&(ee=re=re>ee?re:ee),Oe=ve.width-Q*re,pt=ve.height-ie*re,fe.alignX==="Mid"&&(Oe/=2),fe.alignY==="Mid"&&(pt/=2),fe.alignX==="Min"&&(Oe=0),fe.alignY==="Min"&&(pt=0)),re===1&&ee===1&&j===0&&X===0&&ge===0&&he===0)return ve;if((ge||he)&&V.parentNode.nodeName!=="#document"&&(be=" translate("+s(ge)+" "+s(he)+") "),G=be+" matrix("+re+" 0 0 "+ee+" "+(j*re+Oe)+" "+(X*ee+pt)+") ",V.nodeName==="svg"){for(U=V.ownerDocument.createElementNS(l.svgNS,"g");V.firstChild;)U.appendChild(V.firstChild);V.appendChild(U)}else(U=V).removeAttribute("x"),U.removeAttribute("y"),G=U.getAttribute("transform")+G;return U.setAttribute("transform",G),ve}function J(V,j){var X="xlink:href",Q=H(V,j.getAttribute(X).slice(1));if(Q&&Q.getAttribute(X)&&J(V,Q),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach(function(G){Q&&!j.hasAttribute(G)&&Q.hasAttribute(G)&&j.setAttribute(G,Q.getAttribute(G))}),!j.children.length)for(var ie=Q.cloneNode(!0);ie.firstChild;)j.appendChild(ie.firstChild);j.removeAttribute(X)}l.parseSVGDocument=function(V,j,X,Q){if(V){(function(ge){for(var he=I(ge,["use","svg:use"]),fe=0;he.length&&fe<he.length;){var pe=he[fe],me=pe.getAttribute("xlink:href")||pe.getAttribute("href");if(me===null)return;var ye,ve,be,Oe,pt=me.slice(1),Bt=pe.getAttribute("x")||0,tn=pe.getAttribute("y")||0,Me=H(ge,pt).cloneNode(!0),ut=(Me.getAttribute("transform")||"")+" translate("+Bt+", "+tn+")",Xn=he.length,vn=l.svgNS;if(q(Me),/^svg$/i.test(Me.nodeName)){var nn=Me.ownerDocument.createElementNS(vn,"g");for(ve=0,Oe=(be=Me.attributes).length;ve<Oe;ve++)ye=be.item(ve),nn.setAttributeNS(vn,ye.nodeName,ye.nodeValue);for(;Me.firstChild;)nn.appendChild(Me.firstChild);Me=nn}for(ve=0,Oe=(be=pe.attributes).length;ve<Oe;ve++)(ye=be.item(ve)).nodeName!=="x"&&ye.nodeName!=="y"&&ye.nodeName!=="xlink:href"&&ye.nodeName!=="href"&&(ye.nodeName==="transform"?ut=ye.nodeValue+" "+ut:Me.setAttribute(ye.nodeName,ye.nodeValue));Me.setAttribute("transform",ut),Me.setAttribute("instantiated_by_use","1"),Me.removeAttribute("id"),pe.parentNode.replaceChild(Me,pe),he.length===Xn&&fe++}})(V);var ie,G,U=l.Object.__uid++,Z=q(V),re=l.util.toArray(V.getElementsByTagName("*"));if(Z.crossOrigin=Q&&Q.crossOrigin,Z.svgUid=U,re.length===0&&l.isLikelyNode){var ee=[];for(ie=0,G=(re=V.selectNodes('//*[name(.)!="svg"]')).length;ie<G;ie++)ee[ie]=re[ie];re=ee}var se=re.filter(function(ge){return q(ge),l.svgValidTagNamesRegEx.test(ge.nodeName.replace("svg:",""))&&!function(he,fe){for(;he&&(he=he.parentNode);)if(he.nodeName&&fe.test(he.nodeName.replace("svg:",""))&&!he.getAttribute("instantiated_by_use"))return!0;return!1}(ge,l.svgInvalidAncestorsRegEx)});if(!se||se&&!se.length)j&&j([],{});else{var _e={};re.filter(function(ge){return ge.nodeName.replace("svg:","")==="clipPath"}).forEach(function(ge){var he=ge.getAttribute("id");_e[he]=l.util.toArray(ge.getElementsByTagName("*")).filter(function(fe){return l.svgValidTagNamesRegEx.test(fe.nodeName.replace("svg:",""))})}),l.gradientDefs[U]=l.getGradientDefs(V),l.cssRules[U]=l.getCSSRules(V),l.clipPaths[U]=_e,l.parseElements(se,function(ge,he){j&&(j(ge,Z,he,re),delete l.gradientDefs[U],delete l.cssRules[U],delete l.clipPaths[U])},f(Z),X,Q)}}};var $=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+l.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+l.reNum+"))?\\s+(.*)");c(l,{parseFontDeclaration:function(V,j){var X=V.match($);if(X){var Q=X[1],ie=X[3],G=X[4],U=X[5],Z=X[6];Q&&(j.fontStyle=Q),ie&&(j.fontWeight=isNaN(parseFloat(ie))?ie:parseFloat(ie)),G&&(j.fontSize=s(G)),Z&&(j.fontFamily=Z),U&&(j.lineHeight=U==="normal"?1:U)}},getGradientDefs:function(V){var j,X=I(V,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),Q=0,ie={};for(Q=X.length;Q--;)(j=X[Q]).getAttribute("xlink:href")&&J(V,j),ie[j.getAttribute("id")]=j;return ie},parseAttributes:function(V,j,X){if(V){var Q,ie,G,U={};X===void 0&&(X=V.getAttribute("svgUid")),V.parentNode&&l.svgValidParentsRegEx.test(V.parentNode.nodeName)&&(U=l.parseAttributes(V.parentNode,j,X));var Z=j.reduce(function(fe,pe){return(Q=V.getAttribute(pe))&&(fe[pe]=Q),fe},{}),re=c(function(fe,pe){var me={};for(var ye in l.cssRules[pe])if(R(fe,ye.split(" ")))for(var ve in l.cssRules[pe][ye])me[ve]=l.cssRules[pe][ye][ve];return me}(V,X),l.parseStyleAttribute(V));Z=c(Z,re),re[v]&&V.setAttribute(v,re[v]),ie=G=U.fontSize||l.Text.DEFAULT_SVG_FONT_SIZE,Z[p]&&(Z[p]=ie=s(Z[p],G));var ee,se,_e={};for(var ge in Z)se=b(ee=C(ge),Z[ge],U,ie),_e[ee]=se;_e&&_e.font&&l.parseFontDeclaration(_e.font,_e);var he=c(U,_e);return l.svgValidParentsRegEx.test(V.nodeName)?he:function(fe){for(var pe in g)if(fe[g[pe]]!==void 0&&fe[pe]!==""){if(fe[pe]===void 0){if(!l.Object.prototype[pe])continue;fe[pe]=l.Object.prototype[pe]}if(fe[pe].indexOf("url(")!==0){var me=new l.Color(fe[pe]);fe[pe]=me.setAlpha(r(me.getAlpha()*fe[g[pe]],2)).toRgba()}}return fe}(he)}},parseElements:function(V,j,X,Q,ie){new l.ElementsParser(V,j,X,Q,ie).parse()},parseStyleAttribute:function(V){var j={},X=V.getAttribute("style");return X&&(typeof X=="string"?function(Q,ie){var G,U;Q.replace(/;\s*$/,"").split(";").forEach(function(Z){var re=Z.split(":");G=re[0].trim().toLowerCase(),U=re[1].trim(),ie[G]=U})}(X,j):function(Q,ie){var G,U;for(var Z in Q)Q[Z]!==void 0&&(G=Z.toLowerCase(),U=Q[Z],ie[G]=U)}(X,j)),j},parsePointsAttribute:function(V){if(!V)return null;var j,X,Q=[];for(j=0,X=(V=(V=V.replace(/,/g," ").trim()).split(/\s+/)).length;j<X;j+=2)Q.push({x:parseFloat(V[j]),y:parseFloat(V[j+1])});return Q},getCSSRules:function(V){var j,X,Q=V.getElementsByTagName("style"),ie={};for(j=0,X=Q.length;j<X;j++){var G=Q[j].textContent;(G=G.replace(/\/\*[\s\S]*?\*\//g,"")).trim()!==""&&G.split("}").filter(function(U){return U.trim()}).forEach(function(U){var Z=U.split("{"),re={},ee=Z[1].trim().split(";").filter(function(he){return he.trim()});for(j=0,X=ee.length;j<X;j++){var se=ee[j].split(":"),_e=se[0].trim(),ge=se[1].trim();re[_e]=ge}(U=Z[0].trim()).split(",").forEach(function(he){(he=he.replace(/^svg/i,"").trim())!==""&&(ie[he]?l.util.object.extend(ie[he],re):ie[he]=l.util.object.clone(re))})})}return ie},loadSVGFromURL:function(V,j,X,Q){V=V.replace(/^\n\s*/,"").trim(),new l.util.request(V,{method:"get",onComplete:function(ie){var G=ie.responseXML;if(!G||!G.documentElement)return j&&j(null),!1;l.parseSVGDocument(G.documentElement,function(U,Z,re,ee){j&&j(U,Z,re,ee)},X,Q)}})},loadSVGFromString:function(V,j,X,Q){var ie=new l.window.DOMParser().parseFromString(V.trim(),"text/xml");l.parseSVGDocument(ie.documentElement,function(G,U,Z,re){j(G,U,Z,re)},X,Q)}})}(t),S.ElementsParser=function(h,l,c,f,r,s){this.elements=h,this.callback=l,this.options=c,this.reviver=f,this.svgUid=c&&c.svgUid||0,this.parsingOptions=r,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=s},(B=S.ElementsParser.prototype).parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},B.createObjects=function(){var h=this;this.elements.forEach(function(l,c){l.setAttribute("svgUid",h.svgUid),h.createObject(l,c)})},B.findTag=function(h){return S[S.util.string.capitalize(h.tagName.replace("svg:",""))]},B.createObject=function(h,l){var c=this.findTag(h);if(c&&c.fromElement)try{c.fromElement(h,this.createCallback(l,h),this.options)}catch(f){S.log(f)}else this.checkIfDone()},B.createCallback=function(h,l){var c=this;return function(f){var r;c.resolveGradient(f,l,"fill"),c.resolveGradient(f,l,"stroke"),f instanceof S.Image&&f._originalElement&&(r=f.parsePreserveAspectRatioAttribute(l)),f._removeTransformMatrix(r),c.resolveClipPath(f,l),c.reviver&&c.reviver(l,f),c.instances[h]=f,c.checkIfDone()}},B.extractPropertyDefinition=function(h,l,c){var f=h[l],r=this.regexUrl;if(r.test(f)){r.lastIndex=0;var s=r.exec(f)[1];return r.lastIndex=0,S[c][this.svgUid][s]}},B.resolveGradient=function(h,l,c){var f=this.extractPropertyDefinition(h,c,"gradientDefs");if(f){var r=l.getAttribute(c+"-opacity"),s=S.Gradient.fromElement(f,h,r,this.options);h.set(c,s)}},B.createClipPathCallback=function(h,l){return function(c){c._removeTransformMatrix(),c.fillRule=c.clipRule,l.push(c)}},B.resolveClipPath=function(h,l){var c,f,r,s,u=this.extractPropertyDefinition(h,"clipPath","clipPaths");if(u){r=[],f=S.util.invertTransform(h.calcTransformMatrix());for(var m=u[0].parentNode,g=l;g.parentNode&&g.getAttribute("clip-path")!==h.clipPath;)g=g.parentNode;g.parentNode.appendChild(m);for(var p=0;p<u.length;p++)c=u[p],this.findTag(c).fromElement(c,this.createClipPathCallback(h,r),this.options);u=r.length===1?r[0]:new S.Group(r),s=S.util.multiplyTransformMatrices(f,u.calcTransformMatrix()),u.clipPath&&this.resolveClipPath(u,g);var v=S.util.qrDecompose(s);u.flipX=!1,u.flipY=!1,u.set("scaleX",v.scaleX),u.set("scaleY",v.scaleY),u.angle=v.angle,u.skewX=v.skewX,u.skewY=0,u.setPositionByOrigin({x:v.translateX,y:v.translateY},"center","center"),h.clipPath=u}else delete h.clipPath},B.checkIfDone=function(){--this.numElements==0&&(this.instances=this.instances.filter(function(h){return h!=null}),this.callback(this.instances,this.elements))},function(h){var l=h.fabric||(h.fabric={});function c(f,r){this.x=f,this.y=r}l.Point?l.warn("fabric.Point is already defined"):(l.Point=c,c.prototype={type:"point",constructor:c,add:function(f){return new c(this.x+f.x,this.y+f.y)},addEquals:function(f){return this.x+=f.x,this.y+=f.y,this},scalarAdd:function(f){return new c(this.x+f,this.y+f)},scalarAddEquals:function(f){return this.x+=f,this.y+=f,this},subtract:function(f){return new c(this.x-f.x,this.y-f.y)},subtractEquals:function(f){return this.x-=f.x,this.y-=f.y,this},scalarSubtract:function(f){return new c(this.x-f,this.y-f)},scalarSubtractEquals:function(f){return this.x-=f,this.y-=f,this},multiply:function(f){return new c(this.x*f,this.y*f)},multiplyEquals:function(f){return this.x*=f,this.y*=f,this},divide:function(f){return new c(this.x/f,this.y/f)},divideEquals:function(f){return this.x/=f,this.y/=f,this},eq:function(f){return this.x===f.x&&this.y===f.y},lt:function(f){return this.x<f.x&&this.y<f.y},lte:function(f){return this.x<=f.x&&this.y<=f.y},gt:function(f){return this.x>f.x&&this.y>f.y},gte:function(f){return this.x>=f.x&&this.y>=f.y},lerp:function(f,r){return r===void 0&&(r=.5),r=Math.max(Math.min(1,r),0),new c(this.x+(f.x-this.x)*r,this.y+(f.y-this.y)*r)},distanceFrom:function(f){var r=this.x-f.x,s=this.y-f.y;return Math.sqrt(r*r+s*s)},midPointFrom:function(f){return this.lerp(f)},min:function(f){return new c(Math.min(this.x,f.x),Math.min(this.y,f.y))},max:function(f){return new c(Math.max(this.x,f.x),Math.max(this.y,f.y))},toString:function(){return this.x+","+this.y},setXY:function(f,r){return this.x=f,this.y=r,this},setX:function(f){return this.x=f,this},setY:function(f){return this.y=f,this},setFromPoint:function(f){return this.x=f.x,this.y=f.y,this},swap:function(f){var r=this.x,s=this.y;this.x=f.x,this.y=f.y,f.x=r,f.y=s},clone:function(){return new c(this.x,this.y)}})}(t),function(h){var l=h.fabric||(h.fabric={});function c(f){this.status=f,this.points=[]}l.Intersection?l.warn("fabric.Intersection is already defined"):(l.Intersection=c,l.Intersection.prototype={constructor:c,appendPoint:function(f){return this.points.push(f),this},appendPoints:function(f){return this.points=this.points.concat(f),this}},l.Intersection.intersectLineLine=function(f,r,s,u){var m,g=(u.x-s.x)*(f.y-s.y)-(u.y-s.y)*(f.x-s.x),p=(r.x-f.x)*(f.y-s.y)-(r.y-f.y)*(f.x-s.x),v=(u.y-s.y)*(r.x-f.x)-(u.x-s.x)*(r.y-f.y);if(v!==0){var C=g/v,b=p/v;0<=C&&C<=1&&0<=b&&b<=1?(m=new c("Intersection")).appendPoint(new l.Point(f.x+C*(r.x-f.x),f.y+C*(r.y-f.y))):m=new c}else m=new c(g===0||p===0?"Coincident":"Parallel");return m},l.Intersection.intersectLinePolygon=function(f,r,s){var u,m,g,p,v=new c,C=s.length;for(p=0;p<C;p++)u=s[p],m=s[(p+1)%C],g=c.intersectLineLine(f,r,u,m),v.appendPoints(g.points);return v.points.length>0&&(v.status="Intersection"),v},l.Intersection.intersectPolygonPolygon=function(f,r){var s,u=new c,m=f.length;for(s=0;s<m;s++){var g=f[s],p=f[(s+1)%m],v=c.intersectLinePolygon(g,p,r);u.appendPoints(v.points)}return u.points.length>0&&(u.status="Intersection"),u},l.Intersection.intersectPolygonRectangle=function(f,r,s){var u=r.min(s),m=r.max(s),g=new l.Point(m.x,u.y),p=new l.Point(u.x,m.y),v=c.intersectLinePolygon(u,g,f),C=c.intersectLinePolygon(g,m,f),b=c.intersectLinePolygon(m,p,f),k=c.intersectLinePolygon(p,u,f),I=new c;return I.appendPoints(v.points),I.appendPoints(C.points),I.appendPoints(b.points),I.appendPoints(k.points),I.points.length>0&&(I.status="Intersection"),I})}(t),function(h){var l=h.fabric||(h.fabric={});function c(r){r?this._tryParsingColor(r):this.setSource([0,0,0,1])}function f(r,s,u){return u<0&&(u+=1),u>1&&(u-=1),u<1/6?r+6*(s-r)*u:u<.5?s:u<2/3?r+(s-r)*(2/3-u)*6:r}l.Color?l.warn("fabric.Color is already defined."):(l.Color=c,l.Color.prototype={_tryParsingColor:function(r){var s;r in c.colorNameMap&&(r=c.colorNameMap[r]),r==="transparent"&&(s=[255,255,255,0]),s||(s=c.sourceFromHex(r)),s||(s=c.sourceFromRgb(r)),s||(s=c.sourceFromHsl(r)),s||(s=[0,0,0,1]),s&&this.setSource(s)},_rgbToHsl:function(r,s,u){r/=255,s/=255,u/=255;var m,g,p,v=l.util.array.max([r,s,u]),C=l.util.array.min([r,s,u]);if(p=(v+C)/2,v===C)m=g=0;else{var b=v-C;switch(g=p>.5?b/(2-v-C):b/(v+C),v){case r:m=(s-u)/b+(s<u?6:0);break;case s:m=(u-r)/b+2;break;case u:m=(r-s)/b+4}m/=6}return[Math.round(360*m),Math.round(100*g),Math.round(100*p)]},getSource:function(){return this._source},setSource:function(r){this._source=r},toRgb:function(){var r=this.getSource();return"rgb("+r[0]+","+r[1]+","+r[2]+")"},toRgba:function(){var r=this.getSource();return"rgba("+r[0]+","+r[1]+","+r[2]+","+r[3]+")"},toHsl:function(){var r=this.getSource(),s=this._rgbToHsl(r[0],r[1],r[2]);return"hsl("+s[0]+","+s[1]+"%,"+s[2]+"%)"},toHsla:function(){var r=this.getSource(),s=this._rgbToHsl(r[0],r[1],r[2]);return"hsla("+s[0]+","+s[1]+"%,"+s[2]+"%,"+r[3]+")"},toHex:function(){var r,s,u,m=this.getSource();return r=(r=m[0].toString(16)).length===1?"0"+r:r,s=(s=m[1].toString(16)).length===1?"0"+s:s,u=(u=m[2].toString(16)).length===1?"0"+u:u,r.toUpperCase()+s.toUpperCase()+u.toUpperCase()},toHexa:function(){var r,s=this.getSource();return r=(r=(r=Math.round(255*s[3])).toString(16)).length===1?"0"+r:r,this.toHex()+r.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(r){var s=this.getSource();return s[3]=r,this.setSource(s),this},toGrayscale:function(){var r=this.getSource(),s=parseInt((.3*r[0]+.59*r[1]+.11*r[2]).toFixed(0),10),u=r[3];return this.setSource([s,s,s,u]),this},toBlackWhite:function(r){var s=this.getSource(),u=(.3*s[0]+.59*s[1]+.11*s[2]).toFixed(0),m=s[3];return r=r||127,u=Number(u)<Number(r)?0:255,this.setSource([u,u,u,m]),this},overlayWith:function(r){r instanceof c||(r=new c(r));var s,u=[],m=this.getAlpha(),g=this.getSource(),p=r.getSource();for(s=0;s<3;s++)u.push(Math.round(.5*g[s]+.5*p[s]));return u[3]=m,this.setSource(u),this}},l.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,l.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,l.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,l.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},l.Color.fromRgb=function(r){return c.fromSource(c.sourceFromRgb(r))},l.Color.sourceFromRgb=function(r){var s=r.match(c.reRGBa);if(s){var u=parseInt(s[1],10)/(/%$/.test(s[1])?100:1)*(/%$/.test(s[1])?255:1),m=parseInt(s[2],10)/(/%$/.test(s[2])?100:1)*(/%$/.test(s[2])?255:1),g=parseInt(s[3],10)/(/%$/.test(s[3])?100:1)*(/%$/.test(s[3])?255:1);return[parseInt(u,10),parseInt(m,10),parseInt(g,10),s[4]?parseFloat(s[4]):1]}},l.Color.fromRgba=c.fromRgb,l.Color.fromHsl=function(r){return c.fromSource(c.sourceFromHsl(r))},l.Color.sourceFromHsl=function(r){var s=r.match(c.reHSLa);if(s){var u,m,g,p=(parseFloat(s[1])%360+360)%360/360,v=parseFloat(s[2])/(/%$/.test(s[2])?100:1),C=parseFloat(s[3])/(/%$/.test(s[3])?100:1);if(v===0)u=m=g=C;else{var b=C<=.5?C*(v+1):C+v-C*v,k=2*C-b;u=f(k,b,p+1/3),m=f(k,b,p),g=f(k,b,p-1/3)}return[Math.round(255*u),Math.round(255*m),Math.round(255*g),s[4]?parseFloat(s[4]):1]}},l.Color.fromHsla=c.fromHsl,l.Color.fromHex=function(r){return c.fromSource(c.sourceFromHex(r))},l.Color.sourceFromHex=function(r){if(r.match(c.reHex)){var s=r.slice(r.indexOf("#")+1),u=s.length===3||s.length===4,m=s.length===8||s.length===4,g=u?s.charAt(0)+s.charAt(0):s.substring(0,2),p=u?s.charAt(1)+s.charAt(1):s.substring(2,4),v=u?s.charAt(2)+s.charAt(2):s.substring(4,6),C=m?u?s.charAt(3)+s.charAt(3):s.substring(6,8):"FF";return[parseInt(g,16),parseInt(p,16),parseInt(v,16),parseFloat((parseInt(C,16)/255).toFixed(2))]}},l.Color.fromSource=function(r){var s=new c;return s.setSource(r),s})}(t),function(h){var l=h.fabric||(h.fabric={}),c=["e","se","s","sw","w","nw","n","ne","e"],f=["ns","nesw","ew","nwse"],r={},s="left",u="top",m="right",g="bottom",p="center",v={top:g,bottom:u,left:m,right:s,center:p},C=l.util.radiansToDegrees,b=Math.sign||function(G){return(G>0)-(G<0)||+G};function k(G,U){var Z=G.angle+C(Math.atan2(U.y,U.x))+360;return Math.round(Z%360/45)}function I(G,U){var Z=U.transform.target,re=Z.canvas,ee=l.util.object.clone(U);ee.target=Z,re&&re.fire("object:"+G,ee),Z.fire(G,U)}function R(G,U){var Z=U.canvas,re=G[Z.uniScaleKey];return Z.uniformScaling&&!re||!Z.uniformScaling&&re}function N(G){return G.originX===p&&G.originY===p}function H(G,U,Z){var re=G.lockScalingX,ee=G.lockScalingY;return!((!re||!ee)&&(U||!re&&!ee||!Z)&&(!re||U!=="x")&&(!ee||U!=="y"))}function z(G,U,Z,re){return{e:G,transform:U,pointer:{x:Z,y:re}}}function q(G){return function(U,Z,re,ee){var se=Z.target,_e=se.getCenterPoint(),ge=se.translateToOriginPoint(_e,Z.originX,Z.originY),he=G(U,Z,re,ee);return se.setPositionByOrigin(ge,Z.originX,Z.originY),he}}function J(G,U){return function(Z,re,ee,se){var _e=U(Z,re,ee,se);return _e&&I(G,z(Z,re,ee,se)),_e}}function $(G,U,Z,re,ee){var se=G.target,_e=se.controls[G.corner],ge=se.canvas.getZoom(),he=se.padding/ge,fe=se.toLocalPoint(new l.Point(re,ee),U,Z);return fe.x>=he&&(fe.x-=he),fe.x<=-he&&(fe.x+=he),fe.y>=he&&(fe.y-=he),fe.y<=he&&(fe.y+=he),fe.x-=_e.offsetX,fe.y-=_e.offsetY,fe}function V(G){return G.flipX!==G.flipY}function j(G,U,Z,re,ee){if(G[U]!==0){var se=ee/G._getTransformedDimensions()[re]*G[Z];G.set(Z,se)}}function X(G,U,Z,re){var ee,se=U.target,_e=se._getTransformedDimensions(0,se.skewY),ge=$(U,U.originX,U.originY,Z,re),he=Math.abs(2*ge.x)-_e.x,fe=se.skewX;he<2?ee=0:(ee=C(Math.atan2(he/se.scaleX,_e.y/se.scaleY)),U.originX===s&&U.originY===g&&(ee=-ee),U.originX===m&&U.originY===u&&(ee=-ee),V(se)&&(ee=-ee));var pe=fe!==ee;if(pe){var me=se._getTransformedDimensions().y;se.set("skewX",ee),j(se,"skewY","scaleY","y",me)}return pe}function Q(G,U,Z,re){var ee,se=U.target,_e=se._getTransformedDimensions(se.skewX,0),ge=$(U,U.originX,U.originY,Z,re),he=Math.abs(2*ge.y)-_e.y,fe=se.skewY;he<2?ee=0:(ee=C(Math.atan2(he/se.scaleY,_e.x/se.scaleX)),U.originX===s&&U.originY===g&&(ee=-ee),U.originX===m&&U.originY===u&&(ee=-ee),V(se)&&(ee=-ee));var pe=fe!==ee;if(pe){var me=se._getTransformedDimensions().x;se.set("skewY",ee),j(se,"skewX","scaleX","x",me)}return pe}function ie(G,U,Z,re,ee){ee=ee||{};var se,_e,ge,he,fe,pe,me=U.target,ye=me.lockScalingX,ve=me.lockScalingY,be=ee.by,Oe=R(G,me),pt=H(me,be,Oe),Bt=U.gestureScale;if(pt)return!1;if(Bt)_e=U.scaleX*Bt,ge=U.scaleY*Bt;else{if(se=$(U,U.originX,U.originY,Z,re),fe=be!=="y"?b(se.x):1,pe=be!=="x"?b(se.y):1,U.signX||(U.signX=fe),U.signY||(U.signY=pe),me.lockScalingFlip&&(U.signX!==fe||U.signY!==pe))return!1;if(he=me._getTransformedDimensions(),Oe&&!be){var tn=Math.abs(se.x)+Math.abs(se.y),Me=U.original,ut=tn/(Math.abs(he.x*Me.scaleX/me.scaleX)+Math.abs(he.y*Me.scaleY/me.scaleY));_e=Me.scaleX*ut,ge=Me.scaleY*ut}else _e=Math.abs(se.x*me.scaleX/he.x),ge=Math.abs(se.y*me.scaleY/he.y);N(U)&&(_e*=2,ge*=2),U.signX!==fe&&be!=="y"&&(U.originX=v[U.originX],_e*=-1,U.signX=fe),U.signY!==pe&&be!=="x"&&(U.originY=v[U.originY],ge*=-1,U.signY=pe)}var Xn=me.scaleX,vn=me.scaleY;return be?(be==="x"&&me.set("scaleX",_e),be==="y"&&me.set("scaleY",ge)):(!ye&&me.set("scaleX",_e),!ve&&me.set("scaleY",ge)),Xn!==me.scaleX||vn!==me.scaleY}r.scaleCursorStyleHandler=function(G,U,Z){var re=R(G,Z),ee="";if(U.x!==0&&U.y===0?ee="x":U.x===0&&U.y!==0&&(ee="y"),H(Z,ee,re))return"not-allowed";var se=k(Z,U);return c[se]+"-resize"},r.skewCursorStyleHandler=function(G,U,Z){var re="not-allowed";if(U.x!==0&&Z.lockSkewingY||U.y!==0&&Z.lockSkewingX)return re;var ee=k(Z,U)%4;return f[ee]+"-resize"},r.scaleSkewCursorStyleHandler=function(G,U,Z){return G[Z.canvas.altActionKey]?r.skewCursorStyleHandler(G,U,Z):r.scaleCursorStyleHandler(G,U,Z)},r.rotationWithSnapping=J("rotating",q(function(G,U,Z,re){var ee=U,se=ee.target,_e=se.translateToOriginPoint(se.getCenterPoint(),ee.originX,ee.originY);if(se.lockRotation)return!1;var ge,he=Math.atan2(ee.ey-_e.y,ee.ex-_e.x),fe=Math.atan2(re-_e.y,Z-_e.x),pe=C(fe-he+ee.theta);if(se.snapAngle>0){var me=se.snapAngle,ye=se.snapThreshold||me,ve=Math.ceil(pe/me)*me,be=Math.floor(pe/me)*me;Math.abs(pe-be)<ye?pe=be:Math.abs(pe-ve)<ye&&(pe=ve)}return pe<0&&(pe=360+pe),pe%=360,ge=se.angle!==pe,se.angle=pe,ge})),r.scalingEqually=J("scaling",q(function(G,U,Z,re){return ie(G,U,Z,re)})),r.scalingX=J("scaling",q(function(G,U,Z,re){return ie(G,U,Z,re,{by:"x"})})),r.scalingY=J("scaling",q(function(G,U,Z,re){return ie(G,U,Z,re,{by:"y"})})),r.scalingYOrSkewingX=function(G,U,Z,re){return G[U.target.canvas.altActionKey]?r.skewHandlerX(G,U,Z,re):r.scalingY(G,U,Z,re)},r.scalingXOrSkewingY=function(G,U,Z,re){return G[U.target.canvas.altActionKey]?r.skewHandlerY(G,U,Z,re):r.scalingX(G,U,Z,re)},r.changeWidth=J("resizing",q(function(G,U,Z,re){var ee=U.target,se=$(U,U.originX,U.originY,Z,re),_e=ee.strokeWidth/(ee.strokeUniform?ee.scaleX:1),ge=N(U)?2:1,he=ee.width,fe=Math.abs(se.x*ge/ee.scaleX)-_e;return ee.set("width",Math.max(fe,0)),he!==fe})),r.skewHandlerX=function(G,U,Z,re){var ee,se=U.target,_e=se.skewX,ge=U.originY;return!se.lockSkewingX&&(_e===0?ee=$(U,p,p,Z,re).x>0?s:m:(_e>0&&(ee=ge===u?s:m),_e<0&&(ee=ge===u?m:s),V(se)&&(ee=ee===s?m:s)),U.originX=ee,J("skewing",q(X))(G,U,Z,re))},r.skewHandlerY=function(G,U,Z,re){var ee,se=U.target,_e=se.skewY,ge=U.originX;return!se.lockSkewingY&&(_e===0?ee=$(U,p,p,Z,re).y>0?u:g:(_e>0&&(ee=ge===s?u:g),_e<0&&(ee=ge===s?g:u),V(se)&&(ee=ee===u?g:u)),U.originY=ee,J("skewing",q(Q))(G,U,Z,re))},r.dragHandler=function(G,U,Z,re){var ee=U.target,se=Z-U.offsetX,_e=re-U.offsetY,ge=!ee.get("lockMovementX")&&ee.left!==se,he=!ee.get("lockMovementY")&&ee.top!==_e;return ge&&ee.set("left",se),he&&ee.set("top",_e),(ge||he)&&I("moving",z(G,U,Z,re)),ge||he},r.scaleOrSkewActionName=function(G,U,Z){var re=G[Z.canvas.altActionKey];return U.x===0?re?"skewX":"scaleY":U.y===0?re?"skewY":"scaleX":void 0},r.rotationStyleHandler=function(G,U,Z){return Z.lockRotation?"not-allowed":U.cursorStyle},r.fireEvent=I,r.wrapWithFixedAnchor=q,r.wrapWithFireEvent=J,r.getLocalPoint=$,l.controlsUtils=r}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.util.degreesToRadians,f=l.controlsUtils;f.renderCircleControl=function(r,s,u,m,g){m=m||{};var p,v=this.sizeX||m.cornerSize||g.cornerSize,C=this.sizeY||m.cornerSize||g.cornerSize,b=m.transparentCorners!==void 0?m.transparentCorners:g.transparentCorners,k=b?"stroke":"fill",I=!b&&(m.cornerStrokeColor||g.cornerStrokeColor),R=s,N=u;r.save(),r.fillStyle=m.cornerColor||g.cornerColor,r.strokeStyle=m.cornerStrokeColor||g.cornerStrokeColor,v>C?(p=v,r.scale(1,C/v),N=u*v/C):C>v?(p=C,r.scale(v/C,1),R=s*C/v):p=v,r.lineWidth=1,r.beginPath(),r.arc(R,N,p/2,0,2*Math.PI,!1),r[k](),I&&r.stroke(),r.restore()},f.renderSquareControl=function(r,s,u,m,g){m=m||{};var p=this.sizeX||m.cornerSize||g.cornerSize,v=this.sizeY||m.cornerSize||g.cornerSize,C=m.transparentCorners!==void 0?m.transparentCorners:g.transparentCorners,b=C?"stroke":"fill",k=!C&&(m.cornerStrokeColor||g.cornerStrokeColor),I=p/2,R=v/2;r.save(),r.fillStyle=m.cornerColor||g.cornerColor,r.strokeStyle=m.cornerStrokeColor||g.cornerStrokeColor,r.lineWidth=1,r.translate(s,u),r.rotate(c(g.angle)),r[b+"Rect"](-I,-R,p,v),k&&r.strokeRect(-I,-R,p,v),r.restore()}}(t),function(h){var l=h.fabric||(h.fabric={});l.Control=function(c){for(var f in c)this[f]=c[f]},l.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(c,f){return f.cursorStyle},getActionName:function(c,f){return f.actionName},getVisibility:function(c,f){var r=c._controlsVisibility;return r&&r[f]!==void 0?r[f]:this.visible},setVisibility:function(c){this.visible=c},positionHandler:function(c,f){return l.util.transformPoint({x:this.x*c.x+this.offsetX,y:this.y*c.y+this.offsetY},f)},calcCornerCoords:function(c,f,r,s,u){var m,g,p,v,C=u?this.touchSizeX:this.sizeX,b=u?this.touchSizeY:this.sizeY;if(C&&b&&C!==b){var k=Math.atan2(b,C),I=Math.sqrt(C*C+b*b)/2,R=k-l.util.degreesToRadians(c),N=Math.PI/2-k-l.util.degreesToRadians(c);m=I*l.util.cos(R),g=I*l.util.sin(R),p=I*l.util.cos(N),v=I*l.util.sin(N)}else I=.7071067812*(C&&b?C:f),R=l.util.degreesToRadians(45-c),m=p=I*l.util.cos(R),g=v=I*l.util.sin(R);return{tl:{x:r-v,y:s-p},tr:{x:r+m,y:s-g},bl:{x:r-m,y:s+g},br:{x:r+v,y:s+p}}},render:function(c,f,r,s,u){((s=s||{}).cornerStyle||u.cornerStyle)==="circle"?l.controlsUtils.renderCircleControl.call(this,c,f,r,s,u):l.controlsUtils.renderSquareControl.call(this,c,f,r,s,u)}}}(t),function(){function h(c,f){var r,s,u,m,g=c.getAttribute("style"),p=c.getAttribute("offset")||0;if(p=(p=parseFloat(p)/(/%$/.test(p)?100:1))<0?0:p>1?1:p,g){var v=g.split(/\s*;\s*/);for(v[v.length-1]===""&&v.pop(),m=v.length;m--;){var C=v[m].split(/\s*:\s*/),b=C[0].trim(),k=C[1].trim();b==="stop-color"?r=k:b==="stop-opacity"&&(u=k)}}return r||(r=c.getAttribute("stop-color")||"rgb(0,0,0)"),u||(u=c.getAttribute("stop-opacity")),s=(r=new S.Color(r)).getAlpha(),u=isNaN(parseFloat(u))?1:parseFloat(u),u*=s*f,{offset:p,color:r.toRgb(),opacity:u}}var l=S.util.object.clone;S.Gradient=S.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(c){c||(c={}),c.coords||(c.coords={});var f,r=this;Object.keys(c).forEach(function(s){r[s]=c[s]}),this.id?this.id+="_"+S.Object.__uid++:this.id=S.Object.__uid++,f={x1:c.coords.x1||0,y1:c.coords.y1||0,x2:c.coords.x2||0,y2:c.coords.y2||0},this.type==="radial"&&(f.r1=c.coords.r1||0,f.r2=c.coords.r2||0),this.coords=f,this.colorStops=c.colorStops.slice()},addColorStop:function(c){for(var f in c){var r=new S.Color(c[f]);this.colorStops.push({offset:parseFloat(f),color:r.toRgb(),opacity:r.getAlpha()})}return this},toObject:function(c){var f={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return S.util.populateWithProperties(this,f,c),f},toSVG:function(c,f){var r,s,u,m,g=l(this.coords,!0),p=(f=f||{},l(this.colorStops,!0)),v=g.r1>g.r2,C=this.gradientTransform?this.gradientTransform.concat():S.iMatrix.concat(),b=-this.offsetX,k=-this.offsetY,I=!!f.additionalTransform,R=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(p.sort(function(q,J){return q.offset-J.offset}),R==="objectBoundingBox"?(b/=c.width,k/=c.height):(b+=c.width/2,k+=c.height/2),c.type==="path"&&this.gradientUnits!=="percentage"&&(b-=c.pathOffset.x,k-=c.pathOffset.y),C[4]-=b,C[5]-=k,m='id="SVGID_'+this.id+'" gradientUnits="'+R+'"',m+=' gradientTransform="'+(I?f.additionalTransform+" ":"")+S.util.matrixToSVG(C)+'" ',this.type==="linear"?u=["<linearGradient ",m,' x1="',g.x1,'" y1="',g.y1,'" x2="',g.x2,'" y2="',g.y2,`">
`]:this.type==="radial"&&(u=["<radialGradient ",m,' cx="',v?g.x1:g.x2,'" cy="',v?g.y1:g.y2,'" r="',v?g.r1:g.r2,'" fx="',v?g.x2:g.x1,'" fy="',v?g.y2:g.y1,`">
`]),this.type==="radial"){if(v)for((p=p.concat()).reverse(),r=0,s=p.length;r<s;r++)p[r].offset=1-p[r].offset;var N=Math.min(g.r1,g.r2);if(N>0){var H=N/Math.max(g.r1,g.r2);for(r=0,s=p.length;r<s;r++)p[r].offset+=H*(1-p[r].offset)}}for(r=0,s=p.length;r<s;r++){var z=p[r];u.push("<stop ",'offset="',100*z.offset+"%",'" style="stop-color:',z.color,z.opacity!==void 0?";stop-opacity: "+z.opacity:";",`"/>
`)}return u.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),u.join("")},toLive:function(c){var f,r,s,u=S.util.object.clone(this.coords);if(this.type){for(this.type==="linear"?f=c.createLinearGradient(u.x1,u.y1,u.x2,u.y2):this.type==="radial"&&(f=c.createRadialGradient(u.x1,u.y1,u.r1,u.x2,u.y2,u.r2)),r=0,s=this.colorStops.length;r<s;r++){var m=this.colorStops[r].color,g=this.colorStops[r].opacity,p=this.colorStops[r].offset;g!==void 0&&(m=new S.Color(m).setAlpha(g).toRgba()),f.addColorStop(p,m)}return f}}}),S.util.object.extend(S.Gradient,{fromElement:function(c,f,r,s){var u=parseFloat(r)/(/%$/.test(r)?100:1);u=u<0?0:u>1?1:u,isNaN(u)&&(u=1);var m,g,p,v,C=c.getElementsByTagName("stop"),b=c.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",k=c.getAttribute("gradientTransform")||"",I=[],R=0,N=0;for(c.nodeName==="linearGradient"||c.nodeName==="LINEARGRADIENT"?(m="linear",g=function(H){return{x1:H.getAttribute("x1")||0,y1:H.getAttribute("y1")||0,x2:H.getAttribute("x2")||"100%",y2:H.getAttribute("y2")||0}}(c)):(m="radial",g=function(H){return{x1:H.getAttribute("fx")||H.getAttribute("cx")||"50%",y1:H.getAttribute("fy")||H.getAttribute("cy")||"50%",r1:0,x2:H.getAttribute("cx")||"50%",y2:H.getAttribute("cy")||"50%",r2:H.getAttribute("r")||"50%"}}(c)),p=C.length;p--;)I.push(h(C[p],u));return v=S.parseTransformAttribute(k),function(H,z,q,J){var $,V;Object.keys(z).forEach(function(j){($=z[j])==="Infinity"?V=1:$==="-Infinity"?V=0:(V=parseFloat(z[j],10),typeof $=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test($)&&(V*=.01,J==="pixels"&&(j!=="x1"&&j!=="x2"&&j!=="r2"||(V*=q.viewBoxWidth||q.width),j!=="y1"&&j!=="y2"||(V*=q.viewBoxHeight||q.height)))),z[j]=V})}(0,g,s,b),b==="pixels"&&(R=-f.left,N=-f.top),new S.Gradient({id:c.getAttribute("id"),type:m,coords:g,colorStops:I,gradientUnits:b,gradientTransform:v,offsetX:R,offsetY:N})}})}(),D=S.util.toFixed,S.Pattern=S.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(h,l){if(h||(h={}),this.id=S.Object.__uid++,this.setOptions(h),!h.source||h.source&&typeof h.source!="string")l&&l(this);else{var c=this;this.source=S.util.createImage(),S.util.loadImage(h.source,function(f,r){c.source=f,l&&l(c,r)},null,this.crossOrigin)}},toObject:function(h){var l,c,f=S.Object.NUM_FRACTION_DIGITS;return typeof this.source.src=="string"?l=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(l=this.source.toDataURL()),c={type:"pattern",source:l,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:D(this.offsetX,f),offsetY:D(this.offsetY,f),patternTransform:this.patternTransform?this.patternTransform.concat():null},S.util.populateWithProperties(this,c,h),c},toSVG:function(h){var l=typeof this.source=="function"?this.source():this.source,c=l.width/h.width,f=l.height/h.height,r=this.offsetX/h.width,s=this.offsetY/h.height,u="";return this.repeat!=="repeat-x"&&this.repeat!=="no-repeat"||(f=1,s&&(f+=Math.abs(s))),this.repeat!=="repeat-y"&&this.repeat!=="no-repeat"||(c=1,r&&(c+=Math.abs(r))),l.src?u=l.src:l.toDataURL&&(u=l.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+r+'" y="'+s+'" width="'+c+'" height="'+f+`">
<image x="0" y="0" width="`+l.width+'" height="'+l.height+'" xlink:href="'+u+`"></image>
</pattern>
`},setOptions:function(h){for(var l in h)this[l]=h[l]},toLive:function(h){var l=this.source;return!l||l.src!==void 0&&(!l.complete||l.naturalWidth===0||l.naturalHeight===0)?"":h.createPattern(l,this.repeat)}}),function(h){var l=h.fabric||(h.fabric={}),c=l.util.toFixed;l.Shadow?l.warn("fabric.Shadow is already defined."):(l.Shadow=l.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(f){for(var r in typeof f=="string"&&(f=this._parseShadow(f)),f)this[r]=f[r];this.id=l.Object.__uid++},_parseShadow:function(f){var r=f.trim(),s=l.Shadow.reOffsetsAndBlur.exec(r)||[];return{color:(r.replace(l.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseFloat(s[1],10)||0,offsetY:parseFloat(s[2],10)||0,blur:parseFloat(s[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(f){var r=40,s=40,u=l.Object.NUM_FRACTION_DIGITS,m=l.util.rotateVector({x:this.offsetX,y:this.offsetY},l.util.degreesToRadians(-f.angle)),g=new l.Color(this.color);return f.width&&f.height&&(r=100*c((Math.abs(m.x)+this.blur)/f.width,u)+20,s=100*c((Math.abs(m.y)+this.blur)/f.height,u)+20),f.flipX&&(m.x*=-1),f.flipY&&(m.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+s+'%" height="'+(100+2*s)+'%" x="-'+r+'%" width="'+(100+2*r)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+c(this.blur?this.blur/2:0,u)+`"></feGaussianBlur>
	<feOffset dx="`+c(m.x,u)+'" dy="'+c(m.y,u)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+g.toRgb()+'" flood-opacity="'+g.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var f={},r=l.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(s){this[s]!==r[s]&&(f[s]=this[s])},this),f}}),l.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/)}(t),function(){if(S.StaticCanvas)S.warn("fabric.StaticCanvas is already defined.");else{var h=S.util.object.extend,l=S.util.getElementOffset,c=S.util.removeFromArray,f=S.util.toFixed,r=S.util.transformPoint,s=S.util.invertTransform,u=S.util.getNodeCanvas,m=S.util.createCanvasElement,g=new Error("Could not initialize `canvas` element");S.StaticCanvas=S.util.createClass(S.CommonMethods,{initialize:function(p,v){v||(v={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(p,v)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:S.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(p,v){var C=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(p),this._initOptions(v),this.interactive||this._initRetinaScaling(),v.overlayImage&&this.setOverlayImage(v.overlayImage,C),v.backgroundImage&&this.setBackgroundImage(v.backgroundImage,C),v.backgroundColor&&this.setBackgroundColor(v.backgroundColor,C),v.overlayColor&&this.setOverlayColor(v.overlayColor,C),this.calcOffset()},_isRetinaScaling:function(){return S.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,S.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var p=S.devicePixelRatio;this.__initRetinaScaling(p,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(p,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(p,v,C){v.setAttribute("width",this.width*p),v.setAttribute("height",this.height*p),C.scale(p,p)},calcOffset:function(){return this._offset=l(this.lowerCanvasEl),this},setOverlayImage:function(p,v,C){return this.__setBgOverlayImage("overlayImage",p,v,C)},setBackgroundImage:function(p,v,C){return this.__setBgOverlayImage("backgroundImage",p,v,C)},setOverlayColor:function(p,v){return this.__setBgOverlayColor("overlayColor",p,v)},setBackgroundColor:function(p,v){return this.__setBgOverlayColor("backgroundColor",p,v)},__setBgOverlayImage:function(p,v,C,b){return typeof v=="string"?S.util.loadImage(v,function(k,I){if(k){var R=new S.Image(k,b);this[p]=R,R.canvas=this}C&&C(k,I)},this,b&&b.crossOrigin):(b&&v.setOptions(b),this[p]=v,v&&(v.canvas=this),C&&C(v,!1)),this},__setBgOverlayColor:function(p,v,C){return this[p]=v,this._initGradient(v,p),this._initPattern(v,p,C),this},_createCanvasElement:function(){var p=m();if(!p||(p.style||(p.style={}),p.getContext===void 0))throw g;return p},_initOptions:function(p){var v=this.lowerCanvasEl;this._setOptions(p),this.width=this.width||parseInt(v.width,10)||0,this.height=this.height||parseInt(v.height,10)||0,this.lowerCanvasEl.style&&(v.width=this.width,v.height=this.height,v.style.width=this.width+"px",v.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(p){p&&p.getContext?this.lowerCanvasEl=p:this.lowerCanvasEl=S.util.getById(p)||this._createCanvasElement(),S.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(p,v){return this.setDimensions({width:p},v)},setHeight:function(p,v){return this.setDimensions({height:p},v)},setDimensions:function(p,v){var C;for(var b in v=v||{},p)C=p[b],v.cssOnly||(this._setBackstoreDimension(b,p[b]),C+="px",this.hasLostContext=!0),v.backstoreOnly||this._setCssDimension(b,C);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),v.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(p,v){return this.lowerCanvasEl[p]=v,this.upperCanvasEl&&(this.upperCanvasEl[p]=v),this.cacheCanvasEl&&(this.cacheCanvasEl[p]=v),this[p]=v,this},_setCssDimension:function(p,v){return this.lowerCanvasEl.style[p]=v,this.upperCanvasEl&&(this.upperCanvasEl.style[p]=v),this.wrapperEl&&(this.wrapperEl.style[p]=v),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(p){var v,C,b,k=this._activeObject,I=this.backgroundImage,R=this.overlayImage;for(this.viewportTransform=p,C=0,b=this._objects.length;C<b;C++)(v=this._objects[C]).group||v.setCoords(!0);return k&&k.setCoords(),I&&I.setCoords(!0),R&&R.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(p,v){var C=p,b=this.viewportTransform.slice(0);p=r(p,s(this.viewportTransform)),b[0]=v,b[3]=v;var k=r(p,b);return b[4]+=C.x-k.x,b[5]+=C.y-k.y,this.setViewportTransform(b)},setZoom:function(p){return this.zoomToPoint(new S.Point(0,0),p),this},absolutePan:function(p){var v=this.viewportTransform.slice(0);return v[4]=-p.x,v[5]=-p.y,this.setViewportTransform(v)},relativePan:function(p){return this.absolutePan(new S.Point(-p.x-this.viewportTransform[4],-p.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(p){this.stateful&&p.setupState(),p._set("canvas",this),p.setCoords(),this.fire("object:added",{target:p}),p.fire("added")},_onObjectRemoved:function(p){this.fire("object:removed",{target:p}),p.fire("removed"),delete p.canvas},clearContext:function(p){return p.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var p=this.contextContainer;return this.renderCanvas(p,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=S.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var p={},v=this.width,C=this.height,b=s(this.viewportTransform);return p.tl=r({x:0,y:0},b),p.br=r({x:v,y:C},b),p.tr=new S.Point(p.br.x,p.tl.y),p.bl=new S.Point(p.tl.x,p.br.y),this.vptCoords=p,p},cancelRequestedRender:function(){this.isRendering&&(S.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(p,v){var C=this.viewportTransform,b=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(p),S.util.setImageSmoothing(p,this.imageSmoothingEnabled),this.fire("before:render",{ctx:p}),this._renderBackground(p),p.save(),p.transform(C[0],C[1],C[2],C[3],C[4],C[5]),this._renderObjects(p,v),p.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(p),b&&(b.canvas=this,b.shouldCache(),b._transformDone=!0,b.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(p)),this._renderOverlay(p),this.controlsAboveOverlay&&this.interactive&&this.drawControls(p),this.fire("after:render",{ctx:p})},drawClipPathOnCanvas:function(p){var v=this.viewportTransform,C=this.clipPath;p.save(),p.transform(v[0],v[1],v[2],v[3],v[4],v[5]),p.globalCompositeOperation="destination-in",C.transform(p),p.scale(1/C.zoomX,1/C.zoomY),p.drawImage(C._cacheCanvas,-C.cacheTranslationX,-C.cacheTranslationY),p.restore()},_renderObjects:function(p,v){var C,b;for(C=0,b=v.length;C<b;++C)v[C]&&v[C].render(p)},_renderBackgroundOrOverlay:function(p,v){var C=this[v+"Color"],b=this[v+"Image"],k=this.viewportTransform,I=this[v+"Vpt"];if(C||b){if(C){p.save(),p.beginPath(),p.moveTo(0,0),p.lineTo(this.width,0),p.lineTo(this.width,this.height),p.lineTo(0,this.height),p.closePath(),p.fillStyle=C.toLive?C.toLive(p,this):C,I&&p.transform(k[0],k[1],k[2],k[3],k[4],k[5]),p.transform(1,0,0,1,C.offsetX||0,C.offsetY||0);var R=C.gradientTransform||C.patternTransform;R&&p.transform(R[0],R[1],R[2],R[3],R[4],R[5]),p.fill(),p.restore()}b&&(p.save(),I&&p.transform(k[0],k[1],k[2],k[3],k[4],k[5]),b.render(p),p.restore())}},_renderBackground:function(p){this._renderBackgroundOrOverlay(p,"background")},_renderOverlay:function(p){this._renderBackgroundOrOverlay(p,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new S.Point(this.width/2,this.height/2)},centerObjectH:function(p){return this._centerObject(p,new S.Point(this.getCenterPoint().x,p.getCenterPoint().y))},centerObjectV:function(p){return this._centerObject(p,new S.Point(p.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(p){var v=this.getCenterPoint();return this._centerObject(p,v)},viewportCenterObject:function(p){var v=this.getVpCenter();return this._centerObject(p,v)},viewportCenterObjectH:function(p){var v=this.getVpCenter();return this._centerObject(p,new S.Point(v.x,p.getCenterPoint().y)),this},viewportCenterObjectV:function(p){var v=this.getVpCenter();return this._centerObject(p,new S.Point(p.getCenterPoint().x,v.y))},getVpCenter:function(){var p=this.getCenterPoint(),v=s(this.viewportTransform);return r(p,v)},_centerObject:function(p,v){return p.setPositionByOrigin(v,"center","center"),p.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(p){return this.toDatalessObject(p)},toObject:function(p){return this._toObjectMethod("toObject",p)},toDatalessObject:function(p){return this._toObjectMethod("toDatalessObject",p)},_toObjectMethod:function(p,v){var C=this.clipPath,b={version:S.version,objects:this._toObjects(p,v)};return C&&!C.excludeFromExport&&(b.clipPath=this._toObject(this.clipPath,p,v)),h(b,this.__serializeBgOverlay(p,v)),S.util.populateWithProperties(this,b,v),b},_toObjects:function(p,v){return this._objects.filter(function(C){return!C.excludeFromExport}).map(function(C){return this._toObject(C,p,v)},this)},_toObject:function(p,v,C){var b;this.includeDefaultValues||(b=p.includeDefaultValues,p.includeDefaultValues=!1);var k=p[v](C);return this.includeDefaultValues||(p.includeDefaultValues=b),k},__serializeBgOverlay:function(p,v){var C={},b=this.backgroundImage,k=this.overlayImage,I=this.backgroundColor,R=this.overlayColor;return I&&I.toObject?I.excludeFromExport||(C.background=I.toObject(v)):I&&(C.background=I),R&&R.toObject?R.excludeFromExport||(C.overlay=R.toObject(v)):R&&(C.overlay=R),b&&!b.excludeFromExport&&(C.backgroundImage=this._toObject(b,p,v)),k&&!k.excludeFromExport&&(C.overlayImage=this._toObject(k,p,v)),C},svgViewportTransformation:!0,toSVG:function(p,v){p||(p={}),p.reviver=v;var C=[];return this._setSVGPreamble(C,p),this._setSVGHeader(C,p),this.clipPath&&C.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(C,"background"),this._setSVGBgOverlayImage(C,"backgroundImage",v),this._setSVGObjects(C,v),this.clipPath&&C.push(`</g>
`),this._setSVGBgOverlayColor(C,"overlay"),this._setSVGBgOverlayImage(C,"overlayImage",v),C.push("</svg>"),C.join("")},_setSVGPreamble:function(p,v){v.suppressPreamble||p.push('<?xml version="1.0" encoding="',v.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(p,v){var C,b=v.width||this.width,k=v.height||this.height,I='viewBox="0 0 '+this.width+" "+this.height+'" ',R=S.Object.NUM_FRACTION_DIGITS;v.viewBox?I='viewBox="'+v.viewBox.x+" "+v.viewBox.y+" "+v.viewBox.width+" "+v.viewBox.height+'" ':this.svgViewportTransformation&&(C=this.viewportTransform,I='viewBox="'+f(-C[4]/C[0],R)+" "+f(-C[5]/C[3],R)+" "+f(this.width/C[0],R)+" "+f(this.height/C[3],R)+'" '),p.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',b,'" ','height="',k,'" ',I,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",S.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(v),`</defs>
`)},createSVGClipPathMarkup:function(p){var v=this.clipPath;return v?(v.clipPathId="CLIPPATH_"+S.Object.__uid++,'<clipPath id="'+v.clipPathId+`" >
`+this.clipPath.toClipPathSVG(p.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var p=this;return["background","overlay"].map(function(v){var C=p[v+"Color"];if(C&&C.toLive){var b=p[v+"Vpt"],k=p.viewportTransform,I={width:p.width/(b?k[0]:1),height:p.height/(b?k[3]:1)};return C.toSVG(I,{additionalTransform:b?S.util.matrixToSVG(k):""})}}).join("")},createSVGFontFacesMarkup:function(){var p,v,C,b,k,I,R,N,H="",z={},q=S.fontPaths,J=[];for(this._objects.forEach(function V(j){J.push(j),j._objects&&j._objects.forEach(V)}),R=0,N=J.length;R<N;R++)if(v=(p=J[R]).fontFamily,p.type.indexOf("text")!==-1&&!z[v]&&q[v]&&(z[v]=!0,p.styles))for(k in C=p.styles)for(I in b=C[k])!z[v=b[I].fontFamily]&&q[v]&&(z[v]=!0);for(var $ in z)H+=[`		@font-face {
`,"			font-family: '",$,`';
`,"			src: url('",q[$],`');
`,`		}
`].join("");return H&&(H=['	<style type="text/css">',`<![CDATA[
`,H,"]]>",`</style>
`].join("")),H},_setSVGObjects:function(p,v){var C,b,k,I=this._objects;for(b=0,k=I.length;b<k;b++)(C=I[b]).excludeFromExport||this._setSVGObject(p,C,v)},_setSVGObject:function(p,v,C){p.push(v.toSVG(C))},_setSVGBgOverlayImage:function(p,v,C){this[v]&&!this[v].excludeFromExport&&this[v].toSVG&&p.push(this[v].toSVG(C))},_setSVGBgOverlayColor:function(p,v){var C=this[v+"Color"],b=this.viewportTransform,k=this.width,I=this.height;if(C)if(C.toLive){var R=C.repeat,N=S.util.invertTransform(b),H=this[v+"Vpt"]?S.util.matrixToSVG(N):"";p.push('<rect transform="'+H+" translate(",k/2,",",I/2,')"',' x="',C.offsetX-k/2,'" y="',C.offsetY-I/2,'" ','width="',R==="repeat-y"||R==="no-repeat"?C.source.width:k,'" height="',R==="repeat-x"||R==="no-repeat"?C.source.height:I,'" fill="url(#SVGID_'+C.id+')"',`></rect>
`)}else p.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',C,'"',`></rect>
`)},sendToBack:function(p){if(!p)return this;var v,C,b,k=this._activeObject;if(p===k&&p.type==="activeSelection")for(v=(b=k._objects).length;v--;)C=b[v],c(this._objects,C),this._objects.unshift(C);else c(this._objects,p),this._objects.unshift(p);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(p){if(!p)return this;var v,C,b,k=this._activeObject;if(p===k&&p.type==="activeSelection")for(b=k._objects,v=0;v<b.length;v++)C=b[v],c(this._objects,C),this._objects.push(C);else c(this._objects,p),this._objects.push(p);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(p,v){if(!p)return this;var C,b,k,I,R,N=this._activeObject,H=0;if(p===N&&p.type==="activeSelection")for(R=N._objects,C=0;C<R.length;C++)b=R[C],(k=this._objects.indexOf(b))>0+H&&(I=k-1,c(this._objects,b),this._objects.splice(I,0,b)),H++;else(k=this._objects.indexOf(p))!==0&&(I=this._findNewLowerIndex(p,k,v),c(this._objects,p),this._objects.splice(I,0,p));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(p,v,C){var b,k;if(C){for(b=v,k=v-1;k>=0;--k)if(p.intersectsWithObject(this._objects[k])||p.isContainedWithinObject(this._objects[k])||this._objects[k].isContainedWithinObject(p)){b=k;break}}else b=v-1;return b},bringForward:function(p,v){if(!p)return this;var C,b,k,I,R,N=this._activeObject,H=0;if(p===N&&p.type==="activeSelection")for(C=(R=N._objects).length;C--;)b=R[C],(k=this._objects.indexOf(b))<this._objects.length-1-H&&(I=k+1,c(this._objects,b),this._objects.splice(I,0,b)),H++;else(k=this._objects.indexOf(p))!==this._objects.length-1&&(I=this._findNewUpperIndex(p,k,v),c(this._objects,p),this._objects.splice(I,0,p));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(p,v,C){var b,k,I;if(C){for(b=v,k=v+1,I=this._objects.length;k<I;++k)if(p.intersectsWithObject(this._objects[k])||p.isContainedWithinObject(this._objects[k])||this._objects[k].isContainedWithinObject(p)){b=k;break}}else b=v+1;return b},moveTo:function(p,v){return c(this._objects,p),this._objects.splice(v,0,p),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(S.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(p){p.dispose&&p.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),S.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),S.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),h(S.StaticCanvas.prototype,S.Observable),h(S.StaticCanvas.prototype,S.Collection),h(S.StaticCanvas.prototype,S.DataURLExporter),h(S.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(p){var v=m();if(!v||!v.getContext)return null;var C=v.getContext("2d");return C&&p==="setLineDash"?C.setLineDash!==void 0:null}}),S.StaticCanvas.prototype.toJSON=S.StaticCanvas.prototype.toObject,S.isLikelyNode&&(S.StaticCanvas.prototype.createPNGStream=function(){var p=u(this.lowerCanvasEl);return p&&p.createPNGStream()},S.StaticCanvas.prototype.createJPEGStream=function(p){var v=u(this.lowerCanvasEl);return v&&v.createJPEGStream(p)})}}(),S.BaseBrush=S.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(h){h.strokeStyle=this.color,h.lineWidth=this.width,h.lineCap=this.strokeLineCap,h.miterLimit=this.strokeMiterLimit,h.lineJoin=this.strokeLineJoin,h.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(h){var l=this.canvas.viewportTransform;h.save(),h.transform(l[0],l[1],l[2],l[3],l[4],l[5])},_setShadow:function(){if(this.shadow){var h=this.canvas,l=this.shadow,c=h.contextTop,f=h.getZoom();h&&h._isRetinaScaling()&&(f*=S.devicePixelRatio),c.shadowColor=l.color,c.shadowBlur=l.blur*f,c.shadowOffsetX=l.offsetX*f,c.shadowOffsetY=l.offsetY*f}},needsFullRender:function(){return new S.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var h=this.canvas.contextTop;h.shadowColor="",h.shadowBlur=h.shadowOffsetX=h.shadowOffsetY=0},_isOutSideCanvas:function(h){return h.x<0||h.x>this.canvas.getWidth()||h.y<0||h.y>this.canvas.getHeight()}}),S.PencilBrush=S.util.createClass(S.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(h){this.canvas=h,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(h,l,c){var f=l.midPointFrom(c);return h.quadraticCurveTo(l.x,l.y,f.x,f.y),f},onMouseDown:function(h,l){this.canvas._isMainEvent(l.e)&&(this.drawStraightLine=l.e[this.straightLineKey],this._prepareForDrawing(h),this._captureDrawingPath(h),this._render())},onMouseMove:function(h,l){if(this.canvas._isMainEvent(l.e)&&(this.drawStraightLine=l.e[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(h))&&this._captureDrawingPath(h)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var c=this._points,f=c.length,r=this.canvas.contextTop;this._saveAndTransform(r),this.oldEnd&&(r.beginPath(),r.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(r,c[f-2],c[f-1],!0),r.stroke(),r.restore()}},onMouseUp:function(h){return!this.canvas._isMainEvent(h.e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(h){var l=new S.Point(h.x,h.y);this._reset(),this._addPoint(l),this.canvas.contextTop.moveTo(l.x,l.y)},_addPoint:function(h){return!(this._points.length>1&&h.eq(this._points[this._points.length-1])||(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(h),0))},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(h){var l=new S.Point(h.x,h.y);return this._addPoint(l)},_render:function(h){var l,c,f=this._points[0],r=this._points[1];if(h=h||this.canvas.contextTop,this._saveAndTransform(h),h.beginPath(),this._points.length===2&&f.x===r.x&&f.y===r.y){var s=this.width/1e3;f=new S.Point(f.x,f.y),r=new S.Point(r.x,r.y),f.x-=s,r.x+=s}for(h.moveTo(f.x,f.y),l=1,c=this._points.length;l<c;l++)this._drawSegment(h,f,r),f=this._points[l],r=this._points[l+1];h.lineTo(f.x,f.y),h.stroke(),h.restore()},convertPointsToSVGPath:function(h){var l=this.width/1e3;return S.util.getSmoothPathFromPoints(h,l)},_isEmptySVGPath:function(h){return S.util.joinPath(h)==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(h){var l=new S.Path(h,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,l.shadow=new S.Shadow(this.shadow)),l},decimatePoints:function(h,l){if(h.length<=2)return h;var c,f=this.canvas.getZoom(),r=Math.pow(l/f,2),s=h.length-1,u=h[0],m=[u];for(c=1;c<s-1;c++)Math.pow(u.x-h[c].x,2)+Math.pow(u.y-h[c].y,2)>=r&&(u=h[c],m.push(u));return m.push(h[s]),m},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var h=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(h))this.canvas.requestRenderAll();else{var l=this.createPath(h);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:l}),this.canvas.add(l),this.canvas.requestRenderAll(),l.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:l})}}}),S.CircleBrush=S.util.createClass(S.BaseBrush,{width:10,initialize:function(h){this.canvas=h,this.points=[]},drawDot:function(h){var l=this.addPoint(h),c=this.canvas.contextTop;this._saveAndTransform(c),this.dot(c,l),c.restore()},dot:function(h,l){h.fillStyle=l.fill,h.beginPath(),h.arc(l.x,l.y,l.radius,0,2*Math.PI,!1),h.closePath(),h.fill()},onMouseDown:function(h){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(h)},_render:function(){var h,l,c=this.canvas.contextTop,f=this.points;for(this._saveAndTransform(c),h=0,l=f.length;h<l;h++)this.dot(c,f[h]);c.restore()},onMouseMove:function(h){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(h)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(h),this._render()):this.drawDot(h))},onMouseUp:function(){var h,l,c=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var f=[];for(h=0,l=this.points.length;h<l;h++){var r=this.points[h],s=new S.Circle({radius:r.radius,left:r.x,top:r.y,originX:"center",originY:"center",fill:r.fill});this.shadow&&(s.shadow=new S.Shadow(this.shadow)),f.push(s)}var u=new S.Group(f);u.canvas=this.canvas,this.canvas.fire("before:path:created",{path:u}),this.canvas.add(u),this.canvas.fire("path:created",{path:u}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=c,this.canvas.requestRenderAll()},addPoint:function(h){var l=new S.Point(h.x,h.y),c=S.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,f=new S.Color(this.color).setAlpha(S.util.getRandomInt(0,100)/100).toRgba();return l.radius=c,l.fill=f,this.points.push(l),l}}),S.SprayBrush=S.util.createClass(S.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(h){this.canvas=h,this.sprayChunks=[]},onMouseDown:function(h){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(h),this.render(this.sprayChunkPoints)},onMouseMove:function(h){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(h)||(this.addSprayChunk(h),this.render(this.sprayChunkPoints))},onMouseUp:function(){var h=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var l=[],c=0,f=this.sprayChunks.length;c<f;c++)for(var r=this.sprayChunks[c],s=0,u=r.length;s<u;s++){var m=new S.Rect({width:r[s].width,height:r[s].width,left:r[s].x+1,top:r[s].y+1,originX:"center",originY:"center",fill:this.color});l.push(m)}this.optimizeOverlapping&&(l=this._getOptimizedRects(l));var g=new S.Group(l);this.shadow&&g.set("shadow",new S.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:g}),this.canvas.add(g),this.canvas.fire("path:created",{path:g}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=h,this.canvas.requestRenderAll()},_getOptimizedRects:function(h){var l,c,f,r={};for(c=0,f=h.length;c<f;c++)r[l=h[c].left+""+h[c].top]||(r[l]=h[c]);var s=[];for(l in r)s.push(r[l]);return s},render:function(h){var l,c,f=this.canvas.contextTop;for(f.fillStyle=this.color,this._saveAndTransform(f),l=0,c=h.length;l<c;l++){var r=h[l];r.opacity!==void 0&&(f.globalAlpha=r.opacity),f.fillRect(r.x,r.y,r.width,r.width)}f.restore()},_render:function(){var h,l,c=this.canvas.contextTop;for(c.fillStyle=this.color,this._saveAndTransform(c),h=0,l=this.sprayChunks.length;h<l;h++)this.render(this.sprayChunks[h]);c.restore()},addSprayChunk:function(h){this.sprayChunkPoints=[];var l,c,f,r,s=this.width/2;for(r=0;r<this.density;r++){l=S.util.getRandomInt(h.x-s,h.x+s),c=S.util.getRandomInt(h.y-s,h.y+s),f=this.dotWidthVariance?S.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var u=new S.Point(l,c);u.width=f,this.randomOpacity&&(u.opacity=S.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(u)}this.sprayChunks.push(this.sprayChunkPoints)}}),S.PatternBrush=S.util.createClass(S.PencilBrush,{getPatternSrc:function(){var h=S.util.createCanvasElement(),l=h.getContext("2d");return h.width=h.height=25,l.fillStyle=this.color,l.beginPath(),l.arc(10,10,10,0,2*Math.PI,!1),l.closePath(),l.fill(),h},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(h){return h.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(h){this.callSuper("_setBrushStyles",h),h.strokeStyle=this.getPattern(h)},createPath:function(h){var l=this.callSuper("createPath",h),c=l._getLeftTopCoords().scalarAdd(l.strokeWidth/2);return l.stroke=new S.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-c.x,offsetY:-c.y}),l}}),function(){var h=S.util.getPointer,l=S.util.degreesToRadians,c=S.util.isTouchEvent;for(var f in S.Canvas=S.util.createClass(S.StaticCanvas,{initialize:function(r,s){s||(s={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(r,s),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=S.PencilBrush&&new S.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var r,s,u,m=this.getActiveObjects();if(m.length>0&&!this.preserveObjectStacking){s=[],u=[];for(var g=0,p=this._objects.length;g<p;g++)r=this._objects[g],m.indexOf(r)===-1?s.push(r):u.push(r);m.length>1&&(this._activeObject._objects=u),s.push.apply(s,u)}else s=this._objects;return s},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var r=this.contextContainer;return this.renderCanvas(r,this._chooseObjectsToRender()),this},renderTopLayer:function(r){r.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(r),this.contextTopDirty=!0),r.restore()},renderTop:function(){var r=this.contextTop;return this.clearContext(r),this.renderTopLayer(r),this.fire("after:render"),this},_normalizePointer:function(r,s){var u=r.calcTransformMatrix(),m=S.util.invertTransform(u),g=this.restorePointerVpt(s);return S.util.transformPoint(g,m)},isTargetTransparent:function(r,s,u){if(r.shouldCache()&&r._cacheCanvas&&r!==this._activeObject){var m=this._normalizePointer(r,{x:s,y:u}),g=Math.max(r.cacheTranslationX+m.x*r.zoomX,0),p=Math.max(r.cacheTranslationY+m.y*r.zoomY,0);return S.util.isTransparent(r._cacheContext,Math.round(g),Math.round(p),this.targetFindTolerance)}var v=this.contextCache,C=r.selectionBackgroundColor,b=this.viewportTransform;return r.selectionBackgroundColor="",this.clearContext(v),v.save(),v.transform(b[0],b[1],b[2],b[3],b[4],b[5]),r.render(v),v.restore(),r.selectionBackgroundColor=C,S.util.isTransparent(v,s,u,this.targetFindTolerance)},_isSelectionKeyPressed:function(r){return Array.isArray(this.selectionKey)?!!this.selectionKey.find(function(s){return r[s]===!0}):r[this.selectionKey]},_shouldClearSelection:function(r,s){var u=this.getActiveObjects(),m=this._activeObject;return!s||s&&m&&u.length>1&&u.indexOf(s)===-1&&m!==s&&!this._isSelectionKeyPressed(r)||s&&!s.evented||s&&!s.selectable&&m&&m!==s},_shouldCenterTransform:function(r,s,u){var m;if(r)return s==="scale"||s==="scaleX"||s==="scaleY"||s==="resizing"?m=this.centeredScaling||r.centeredScaling:s==="rotate"&&(m=this.centeredRotation||r.centeredRotation),m?!u:u},_getOriginFromCorner:function(r,s){var u={x:r.originX,y:r.originY};return s==="ml"||s==="tl"||s==="bl"?u.x="right":s!=="mr"&&s!=="tr"&&s!=="br"||(u.x="left"),s==="tl"||s==="mt"||s==="tr"?u.y="bottom":s!=="bl"&&s!=="mb"&&s!=="br"||(u.y="top"),u},_getActionFromCorner:function(r,s,u,m){if(!s||!r)return"drag";var g=m.controls[s];return g.getActionName(u,g,m)},_setupCurrentTransform:function(r,s,u){if(s){var m=this.getPointer(r),g=s.__corner,p=s.controls[g],v=u&&g?p.getActionHandler(r,s,p):S.controlsUtils.dragHandler,C=this._getActionFromCorner(u,g,r,s),b=this._getOriginFromCorner(s,g),k=r[this.centeredKey],I={target:s,action:C,actionHandler:v,corner:g,scaleX:s.scaleX,scaleY:s.scaleY,skewX:s.skewX,skewY:s.skewY,offsetX:m.x-s.left,offsetY:m.y-s.top,originX:b.x,originY:b.y,ex:m.x,ey:m.y,lastX:m.x,lastY:m.y,theta:l(s.angle),width:s.width*s.scaleX,shiftKey:r.shiftKey,altKey:k,original:S.util.saveObjectTransform(s)};this._shouldCenterTransform(s,C,k)&&(I.originX="center",I.originY="center"),I.original.originX=b.x,I.original.originY=b.y,this._currentTransform=I,this._beforeTransform(r)}},setCursor:function(r){this.upperCanvasEl.style.cursor=r},_drawSelection:function(r){var s=this._groupSelector,u=new S.Point(s.ex,s.ey),m=S.util.transformPoint(u,this.viewportTransform),g=new S.Point(s.ex+s.left,s.ey+s.top),p=S.util.transformPoint(g,this.viewportTransform),v=Math.min(m.x,p.x),C=Math.min(m.y,p.y),b=Math.max(m.x,p.x),k=Math.max(m.y,p.y),I=this.selectionLineWidth/2;this.selectionColor&&(r.fillStyle=this.selectionColor,r.fillRect(v,C,b-v,k-C)),this.selectionLineWidth&&this.selectionBorderColor&&(r.lineWidth=this.selectionLineWidth,r.strokeStyle=this.selectionBorderColor,v+=I,C+=I,b-=I,k-=I,S.Object.prototype._setLineDash.call(this,r,this.selectionDashArray),r.strokeRect(v,C,b-v,k-C))},findTarget:function(r,s){if(!this.skipTargetFind){var u,m,g=this.getPointer(r,!0),p=this._activeObject,v=this.getActiveObjects(),C=c(r),b=v.length>1&&!s||v.length===1;if(this.targets=[],b&&p._findTargetCorner(g,C)||v.length>1&&!s&&p===this._searchPossibleTargets([p],g))return p;if(v.length===1&&p===this._searchPossibleTargets([p],g)){if(!this.preserveObjectStacking)return p;u=p,m=this.targets,this.targets=[]}var k=this._searchPossibleTargets(this._objects,g);return r[this.altSelectionKey]&&k&&u&&k!==u&&(k=u,this.targets=m),k}},_checkTarget:function(r,s,u){if(s&&s.visible&&s.evented&&s.containsPoint(r)&&(!this.perPixelTargetFind&&!s.perPixelTargetFind||s.isEditing||!this.isTargetTransparent(s,u.x,u.y)))return!0},_searchPossibleTargets:function(r,s){for(var u,m,g=r.length;g--;){var p=r[g],v=p.group?this._normalizePointer(p.group,s):s;if(this._checkTarget(v,p,s)){(u=r[g]).subTargetCheck&&u instanceof S.Group&&(m=this._searchPossibleTargets(u._objects,s))&&this.targets.push(m);break}}return u},restorePointerVpt:function(r){return S.util.transformPoint(r,S.util.invertTransform(this.viewportTransform))},getPointer:function(r,s){if(this._absolutePointer&&!s)return this._absolutePointer;if(this._pointer&&s)return this._pointer;var u,m=h(r),g=this.upperCanvasEl,p=g.getBoundingClientRect(),v=p.width||0,C=p.height||0;v&&C||("top"in p&&"bottom"in p&&(C=Math.abs(p.top-p.bottom)),"right"in p&&"left"in p&&(v=Math.abs(p.right-p.left))),this.calcOffset(),m.x=m.x-this._offset.left,m.y=m.y-this._offset.top,s||(m=this.restorePointerVpt(m));var b=this.getRetinaScaling();return b!==1&&(m.x/=b,m.y/=b),u=v===0||C===0?{width:1,height:1}:{width:g.width/v,height:g.height/C},{x:m.x*u.width,y:m.y*u.height}},_createUpperCanvas:function(){var r=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),s=this.lowerCanvasEl,u=this.upperCanvasEl;u?u.className="":(u=this._createCanvasElement(),this.upperCanvasEl=u),S.util.addClass(u,"upper-canvas "+r),this.wrapperEl.appendChild(u),this._copyCanvasStyle(s,u),this._applyCanvasStyle(u),this.contextTop=u.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=S.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),S.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),S.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(r){var s=this.width||r.width,u=this.height||r.height;S.util.setStyle(r,{position:"absolute",width:s+"px",height:u+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),r.width=s,r.height=u,S.util.makeElementUnselectable(r)},_copyCanvasStyle:function(r,s){s.style.cssText=r.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var r=this._activeObject;return r?r.type==="activeSelection"&&r._objects?r._objects.slice(0):[r]:[]},_onObjectRemoved:function(r){r===this._activeObject&&(this.fire("before:selection:cleared",{target:r}),this._discardActiveObject(),this.fire("selection:cleared",{target:r}),r.fire("deselected")),r===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",r)},_fireSelectionEvents:function(r,s){var u=!1,m=this.getActiveObjects(),g=[],p=[];r.forEach(function(v){m.indexOf(v)===-1&&(u=!0,v.fire("deselected",{e:s,target:v}),p.push(v))}),m.forEach(function(v){r.indexOf(v)===-1&&(u=!0,v.fire("selected",{e:s,target:v}),g.push(v))}),r.length>0&&m.length>0?u&&this.fire("selection:updated",{e:s,selected:g,deselected:p}):m.length>0?this.fire("selection:created",{e:s,selected:g}):r.length>0&&this.fire("selection:cleared",{e:s,deselected:p})},setActiveObject:function(r,s){var u=this.getActiveObjects();return this._setActiveObject(r,s),this._fireSelectionEvents(u,s),this},_setActiveObject:function(r,s){return this._activeObject!==r&&!!this._discardActiveObject(s,r)&&!r.onSelect({e:s})&&(this._activeObject=r,!0)},_discardActiveObject:function(r,s){var u=this._activeObject;if(u){if(u.onDeselect({e:r,object:s}))return!1;this._activeObject=null}return!0},discardActiveObject:function(r){var s=this.getActiveObjects(),u=this.getActiveObject();return s.length&&this.fire("before:selection:cleared",{target:u,e:r}),this._discardActiveObject(r),this._fireSelectionEvents(s,r),this},dispose:function(){var r=this.wrapperEl;return this.removeListeners(),r.removeChild(this.upperCanvasEl),r.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(s){S.util.cleanUpJsdomNode(this[s]),this[s]=void 0}.bind(this)),r.parentNode&&r.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,S.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(r){var s=this._activeObject;s&&s._renderControls(r)},_toObject:function(r,s,u){var m=this._realizeGroupTransformOnObject(r),g=this.callSuper("_toObject",r,s,u);return this._unwindGroupTransformOnObject(r,m),g},_realizeGroupTransformOnObject:function(r){if(r.group&&r.group.type==="activeSelection"&&this._activeObject===r.group){var s={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach(function(u){s[u]=r[u]}),S.util.addTransformToObject(r,this._activeObject.calcOwnMatrix()),s}return null},_unwindGroupTransformOnObject:function(r,s){s&&r.set(s)},_setSVGObject:function(r,s,u){var m=this._realizeGroupTransformOnObject(s);this.callSuper("_setSVGObject",r,s,u),this._unwindGroupTransformOnObject(s,m)},setViewportTransform:function(r){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),S.StaticCanvas.prototype.setViewportTransform.call(this,r)}}),S.StaticCanvas)f!=="prototype"&&(S.Canvas[f]=S.StaticCanvas[f])}(),function(){var h=S.util.addListener,l=S.util.removeListener,c={passive:!1};function f(r,s){return r.button&&r.button===s-1}S.util.object.extend(S.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(h,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(r,s){var u=this.upperCanvasEl,m=this._getEventPrefix();r(S.window,"resize",this._onResize),r(u,m+"down",this._onMouseDown),r(u,m+"move",this._onMouseMove,c),r(u,m+"out",this._onMouseOut),r(u,m+"enter",this._onMouseEnter),r(u,"wheel",this._onMouseWheel),r(u,"contextmenu",this._onContextMenu),r(u,"dblclick",this._onDoubleClick),r(u,"dragover",this._onDragOver),r(u,"dragenter",this._onDragEnter),r(u,"dragleave",this._onDragLeave),r(u,"drop",this._onDrop),this.enablePointerEvents||r(u,"touchstart",this._onTouchStart,c),typeof eventjs<"u"&&s in eventjs&&(eventjs[s](u,"gesture",this._onGesture),eventjs[s](u,"drag",this._onDrag),eventjs[s](u,"orientation",this._onOrientationChange),eventjs[s](u,"shake",this._onShake),eventjs[s](u,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(l,"remove");var r=this._getEventPrefix();l(S.document,r+"up",this._onMouseUp),l(S.document,"touchend",this._onTouchEnd,c),l(S.document,r+"move",this._onMouseMove,c),l(S.document,"touchmove",this._onMouseMove,c)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(r,s){this.__onTransformGesture&&this.__onTransformGesture(r,s)},_onDrag:function(r,s){this.__onDrag&&this.__onDrag(r,s)},_onMouseWheel:function(r){this.__onMouseWheel(r)},_onMouseOut:function(r){var s=this._hoveredTarget;this.fire("mouse:out",{target:s,e:r}),this._hoveredTarget=null,s&&s.fire("mouseout",{e:r});var u=this;this._hoveredTargets.forEach(function(m){u.fire("mouse:out",{target:s,e:r}),m&&s.fire("mouseout",{e:r})}),this._hoveredTargets=[],this._iTextInstances&&this._iTextInstances.forEach(function(m){m.isEditing&&m.hiddenTextarea.focus()})},_onMouseEnter:function(r){this._currentTransform||this.findTarget(r)||(this.fire("mouse:over",{target:null,e:r}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(r,s){this.__onOrientationChange&&this.__onOrientationChange(r,s)},_onShake:function(r,s){this.__onShake&&this.__onShake(r,s)},_onLongPress:function(r,s){this.__onLongPress&&this.__onLongPress(r,s)},_onDragOver:function(r){r.preventDefault();var s=this._simpleEventHandler("dragover",r);this._fireEnterLeaveEvents(s,r)},_onDrop:function(r){return this._simpleEventHandler("drop:before",r),this._simpleEventHandler("drop",r)},_onContextMenu:function(r){return this.stopContextMenu&&(r.stopPropagation(),r.preventDefault()),!1},_onDoubleClick:function(r){this._cacheTransformEventData(r),this._handleEvent(r,"dblclick"),this._resetTransformEventData(r)},getPointerId:function(r){var s=r.changedTouches;return s?s[0]&&s[0].identifier:this.enablePointerEvents?r.pointerId:-1},_isMainEvent:function(r){return r.isPrimary===!0||r.isPrimary!==!1&&(r.type==="touchend"&&r.touches.length===0||!r.changedTouches||r.changedTouches[0].identifier===this.mainTouchId)},_onTouchStart:function(r){r.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(r)),this.__onMouseDown(r),this._resetTransformEventData();var s=this.upperCanvasEl,u=this._getEventPrefix();h(S.document,"touchend",this._onTouchEnd,c),h(S.document,"touchmove",this._onMouseMove,c),l(s,u+"down",this._onMouseDown)},_onMouseDown:function(r){this.__onMouseDown(r),this._resetTransformEventData();var s=this.upperCanvasEl,u=this._getEventPrefix();l(s,u+"move",this._onMouseMove,c),h(S.document,u+"up",this._onMouseUp),h(S.document,u+"move",this._onMouseMove,c)},_onTouchEnd:function(r){if(!(r.touches.length>0)){this.__onMouseUp(r),this._resetTransformEventData(),this.mainTouchId=null;var s=this._getEventPrefix();l(S.document,"touchend",this._onTouchEnd,c),l(S.document,"touchmove",this._onMouseMove,c);var u=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){h(u.upperCanvasEl,s+"down",u._onMouseDown),u._willAddMouseDown=0},400)}},_onMouseUp:function(r){this.__onMouseUp(r),this._resetTransformEventData();var s=this.upperCanvasEl,u=this._getEventPrefix();this._isMainEvent(r)&&(l(S.document,u+"up",this._onMouseUp),l(S.document,u+"move",this._onMouseMove,c),h(s,u+"move",this._onMouseMove,c))},_onMouseMove:function(r){!this.allowTouchScrolling&&r.preventDefault&&r.preventDefault(),this.__onMouseMove(r)},_onResize:function(){this.calcOffset()},_shouldRender:function(r){var s=this._activeObject;return!!(!!s!=!!r||s&&r&&s!==r)||(s&&s.isEditing,!1)},__onMouseUp:function(r){var s,u=this._currentTransform,m=this._groupSelector,g=!1,p=!m||m.left===0&&m.top===0;if(this._cacheTransformEventData(r),s=this._target,this._handleEvent(r,"up:before"),f(r,3))this.fireRightClick&&this._handleEvent(r,"up",3,p);else{if(f(r,2))return this.fireMiddleClick&&this._handleEvent(r,"up",2,p),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(r);else if(this._isMainEvent(r)){if(u&&(this._finalizeCurrentTransform(r),g=u.actionPerformed),!p){var v=s===this._activeObject;this._maybeGroupObjects(r),g||(g=this._shouldRender(s)||!v&&s===this._activeObject)}var C,b;if(s){if(C=s._findTargetCorner(this.getPointer(r,!0),S.util.isTouchEvent(r)),s.selectable&&s!==this._activeObject&&s.activeOn==="up")this.setActiveObject(s,r),g=!0;else{var k=s.controls[C],I=k&&k.getMouseUpHandler(r,s,k);I&&I(r,u,(b=this.getPointer(r)).x,b.y)}s.isMoving=!1}if(u&&(u.target!==s||u.corner!==C)){var R=u.target&&u.target.controls[u.corner],N=R&&R.getMouseUpHandler(r,s,k);b=b||this.getPointer(r),N&&N(r,u,b.x,b.y)}this._setCursorFromEvent(r,s),this._handleEvent(r,"up",1,p),this._groupSelector=null,this._currentTransform=null,s&&(s.__corner=0),g?this.requestRenderAll():p||this.renderTop()}}},_simpleEventHandler:function(r,s){var u=this.findTarget(s),m=this.targets,g={e:s,target:u,subTargets:m};if(this.fire(r,g),u&&u.fire(r,g),!m)return u;for(var p=0;p<m.length;p++)m[p].fire(r,g);return u},_handleEvent:function(r,s,u,m){var g=this._target,p=this.targets||[],v={e:r,target:g,subTargets:p,button:u||1,isClick:m||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};s==="up"&&(v.currentTarget=this.findTarget(r),v.currentSubTargets=this.targets),this.fire("mouse:"+s,v),g&&g.fire("mouse"+s,v);for(var C=0;C<p.length;C++)p[C].fire("mouse"+s,v)},_finalizeCurrentTransform:function(r){var s=this._currentTransform,u=s.target,m={e:r,target:u,transform:s,action:s.action};u._scaling&&(u._scaling=!1),u.setCoords(),(s.actionPerformed||this.stateful&&u.hasStateChanged())&&this._fire("modified",m)},_onMouseDownInDrawingMode:function(r){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(r).requestRenderAll();var s=this.getPointer(r);this.freeDrawingBrush.onMouseDown(s,{e:r,pointer:s}),this._handleEvent(r,"down")},_onMouseMoveInDrawingMode:function(r){if(this._isCurrentlyDrawing){var s=this.getPointer(r);this.freeDrawingBrush.onMouseMove(s,{e:r,pointer:s})}this.setCursor(this.freeDrawingCursor),this._handleEvent(r,"move")},_onMouseUpInDrawingMode:function(r){var s=this.getPointer(r);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:r,pointer:s}),this._handleEvent(r,"up")},__onMouseDown:function(r){this._cacheTransformEventData(r),this._handleEvent(r,"down:before");var s=this._target;if(f(r,3))this.fireRightClick&&this._handleEvent(r,"down",3);else if(f(r,2))this.fireMiddleClick&&this._handleEvent(r,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(r);else if(this._isMainEvent(r)&&!this._currentTransform){var u=this._pointer;this._previousPointer=u;var m=this._shouldRender(s),g=this._shouldGroup(r,s);if(this._shouldClearSelection(r,s)?this.discardActiveObject(r):g&&(this._handleGrouping(r,s),s=this._activeObject),!this.selection||s&&(s.selectable||s.isEditing||s===this._activeObject)||(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),s){var p=s===this._activeObject;s.selectable&&s.activeOn==="down"&&this.setActiveObject(s,r);var v=s._findTargetCorner(this.getPointer(r,!0),S.util.isTouchEvent(r));if(s.__corner=v,s===this._activeObject&&(v||!g)){this._setupCurrentTransform(r,s,p);var C=s.controls[v],b=(u=this.getPointer(r),C&&C.getMouseDownHandler(r,s,C));b&&b(r,this._currentTransform,u.x,u.y)}}this._handleEvent(r,"down"),(m||g)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(r){this._resetTransformEventData(),this._pointer=this.getPointer(r,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(r)||null},_beforeTransform:function(r){var s=this._currentTransform;this.stateful&&s.target.saveState(),this.fire("before:transform",{e:r,transform:s})},__onMouseMove:function(r){var s,u;if(this._handleEvent(r,"move:before"),this._cacheTransformEventData(r),this.isDrawingMode)this._onMouseMoveInDrawingMode(r);else if(this._isMainEvent(r)){var m=this._groupSelector;m?(u=this._absolutePointer,m.left=u.x-m.ex,m.top=u.y-m.ey,this.renderTop()):this._currentTransform?this._transformObject(r):(s=this.findTarget(r)||null,this._setCursorFromEvent(r,s),this._fireOverOutEvents(s,r)),this._handleEvent(r,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(r,s){var u=this._hoveredTarget,m=this._hoveredTargets,g=this.targets,p=Math.max(m.length,g.length);this.fireSyntheticInOutEvents(r,s,{oldTarget:u,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var v=0;v<p;v++)this.fireSyntheticInOutEvents(g[v],s,{oldTarget:m[v],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=r,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(r,s){var u=this._draggedoverTarget,m=this._hoveredTargets,g=this.targets,p=Math.max(m.length,g.length);this.fireSyntheticInOutEvents(r,s,{oldTarget:u,evtOut:"dragleave",evtIn:"dragenter"});for(var v=0;v<p;v++)this.fireSyntheticInOutEvents(g[v],s,{oldTarget:m[v],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=r},fireSyntheticInOutEvents:function(r,s,u){var m,g,p,v=u.oldTarget,C=v!==r,b=u.canvasEvtIn,k=u.canvasEvtOut;C&&(m={e:s,target:r,previousTarget:v},g={e:s,target:v,nextTarget:r}),p=r&&C,v&&C&&(k&&this.fire(k,g),v.fire(u.evtOut,g)),p&&(b&&this.fire(b,m),r.fire(u.evtIn,m))},__onMouseWheel:function(r){this._cacheTransformEventData(r),this._handleEvent(r,"wheel"),this._resetTransformEventData()},_transformObject:function(r){var s=this.getPointer(r),u=this._currentTransform;u.reset=!1,u.shiftKey=r.shiftKey,u.altKey=r[this.centeredKey],this._performTransformAction(r,u,s),u.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(r,s,u){var m=u.x,g=u.y,p=s.action,v=!1,C=s.actionHandler;C&&(v=C(r,s,m,g)),p==="drag"&&v&&(s.target.isMoving=!0,this.setCursor(s.target.moveCursor||this.moveCursor)),s.actionPerformed=s.actionPerformed||v},_fire:S.controlsUtils.fireEvent,_setCursorFromEvent:function(r,s){if(!s)return this.setCursor(this.defaultCursor),!1;var u=s.hoverCursor||this.hoverCursor,m=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,g=(!m||!m.contains(s))&&s._findTargetCorner(this.getPointer(r,!0));g?this.setCursor(this.getCornerCursor(g,s,r)):(s.subTargetCheck&&this.targets.concat().reverse().map(function(p){u=p.hoverCursor||u}),this.setCursor(u))},getCornerCursor:function(r,s,u){var m=s.controls[r];return m.cursorStyleHandler(u,m,s)}})}(),O=Math.min,A=Math.max,S.util.object.extend(S.Canvas.prototype,{_shouldGroup:function(h,l){var c=this._activeObject;return c&&this._isSelectionKeyPressed(h)&&l&&l.selectable&&this.selection&&(c!==l||c.type==="activeSelection")&&!l.onSelect({e:h})},_handleGrouping:function(h,l){var c=this._activeObject;c.__corner||(l!==c||(l=this.findTarget(h,!0))&&l.selectable)&&(c&&c.type==="activeSelection"?this._updateActiveSelection(l,h):this._createActiveSelection(l,h))},_updateActiveSelection:function(h,l){var c=this._activeObject,f=c._objects.slice(0);c.contains(h)?(c.removeWithUpdate(h),this._hoveredTarget=h,this._hoveredTargets=this.targets.concat(),c.size()===1&&this._setActiveObject(c.item(0),l)):(c.addWithUpdate(h),this._hoveredTarget=c,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(f,l)},_createActiveSelection:function(h,l){var c=this.getActiveObjects(),f=this._createGroup(h);this._hoveredTarget=f,this._setActiveObject(f,l),this._fireSelectionEvents(c,l)},_createGroup:function(h){var l=this._objects,c=l.indexOf(this._activeObject)<l.indexOf(h)?[this._activeObject,h]:[h,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new S.ActiveSelection(c,{canvas:this})},_groupSelectedObjects:function(h){var l,c=this._collectObjects(h);c.length===1?this.setActiveObject(c[0],h):c.length>1&&(l=new S.ActiveSelection(c.reverse(),{canvas:this}),this.setActiveObject(l,h))},_collectObjects:function(h){for(var l,c=[],f=this._groupSelector.ex,r=this._groupSelector.ey,s=f+this._groupSelector.left,u=r+this._groupSelector.top,m=new S.Point(O(f,s),O(r,u)),g=new S.Point(A(f,s),A(r,u)),p=!this.selectionFullyContained,v=f===s&&r===u,C=this._objects.length;C--&&!((l=this._objects[C])&&l.selectable&&l.visible&&(p&&l.intersectsWithRect(m,g,!0)||l.isContainedWithinRect(m,g,!0)||p&&l.containsPoint(m,null,!0)||p&&l.containsPoint(g,null,!0))&&(c.push(l),v)););return c.length>1&&(c=c.filter(function(b){return!b.onSelect({e:h})})),c},_maybeGroupObjects:function(h){this.selection&&this._groupSelector&&this._groupSelectedObjects(h),this.setCursor(this.defaultCursor),this._groupSelector=null}}),S.util.object.extend(S.StaticCanvas.prototype,{toDataURL:function(h){h||(h={});var l=h.format||"png",c=h.quality||1,f=(h.multiplier||1)*(h.enableRetinaScaling?this.getRetinaScaling():1),r=this.toCanvasElement(f,h);return S.util.toDataURL(r,l,c)},toCanvasElement:function(h,l){h=h||1;var c=((l=l||{}).width||this.width)*h,f=(l.height||this.height)*h,r=this.getZoom(),s=this.width,u=this.height,m=r*h,g=this.viewportTransform,p=(g[4]-(l.left||0))*h,v=(g[5]-(l.top||0))*h,C=this.interactive,b=[m,0,0,m,p,v],k=this.enableRetinaScaling,I=S.util.createCanvasElement(),R=this.contextTop;return I.width=c,I.height=f,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=b,this.width=c,this.height=f,this.calcViewportBoundaries(),this.renderCanvas(I.getContext("2d"),this._objects),this.viewportTransform=g,this.width=s,this.height=u,this.calcViewportBoundaries(),this.interactive=C,this.enableRetinaScaling=k,this.contextTop=R,I}}),S.util.object.extend(S.StaticCanvas.prototype,{loadFromJSON:function(h,l,c){if(h){var f=typeof h=="string"?JSON.parse(h):S.util.object.clone(h),r=this,s=f.clipPath,u=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete f.clipPath,this._enlivenObjects(f.objects,function(m){r.clear(),r._setBgOverlay(f,function(){s?r._enlivenObjects([s],function(g){r.clipPath=g[0],r.__setupCanvas.call(r,f,m,u,l)}):r.__setupCanvas.call(r,f,m,u,l)})},c),this}},__setupCanvas:function(h,l,c,f){var r=this;l.forEach(function(s,u){r.insertAt(s,u)}),this.renderOnAddRemove=c,delete h.objects,delete h.backgroundImage,delete h.overlayImage,delete h.background,delete h.overlay,this._setOptions(h),this.renderAll(),f&&f()},_setBgOverlay:function(h,l){var c={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(h.backgroundImage||h.overlayImage||h.background||h.overlay){var f=function(){c.backgroundImage&&c.overlayImage&&c.backgroundColor&&c.overlayColor&&l&&l()};this.__setBgOverlay("backgroundImage",h.backgroundImage,c,f),this.__setBgOverlay("overlayImage",h.overlayImage,c,f),this.__setBgOverlay("backgroundColor",h.background,c,f),this.__setBgOverlay("overlayColor",h.overlay,c,f)}else l&&l()},__setBgOverlay:function(h,l,c,f){var r=this;if(!l)return c[h]=!0,void(f&&f());h==="backgroundImage"||h==="overlayImage"?S.util.enlivenObjects([l],function(s){r[h]=s[0],c[h]=!0,f&&f()}):this["set"+S.util.string.capitalize(h,!0)](l,function(){c[h]=!0,f&&f()})},_enlivenObjects:function(h,l,c){h&&h.length!==0?S.util.enlivenObjects(h,function(f){l&&l(f)},null,c):l&&l([])},_toDataURL:function(h,l){this.clone(function(c){l(c.toDataURL(h))})},_toDataURLWithMultiplier:function(h,l,c){this.clone(function(f){c(f.toDataURLWithMultiplier(h,l))})},clone:function(h,l){var c=JSON.stringify(this.toJSON(l));this.cloneWithoutData(function(f){f.loadFromJSON(c,function(){h&&h(f)})})},cloneWithoutData:function(h){var l=S.util.createCanvasElement();l.width=this.width,l.height=this.height;var c=new S.Canvas(l);this.backgroundImage?(c.setBackgroundImage(this.backgroundImage.src,function(){c.renderAll(),h&&h(c)}),c.backgroundImageOpacity=this.backgroundImageOpacity,c.backgroundImageStretch=this.backgroundImageStretch):h&&h(c)}}),function(h){var l=h.fabric||(h.fabric={}),c=l.util.object.extend,f=l.util.object.clone,r=l.util.toFixed,s=l.util.string.capitalize,u=l.util.degreesToRadians,m=!l.isLikelyNode;l.Object||(l.Object=l.util.createClass(l.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:m,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(g){g&&this.setOptions(g)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=l.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(g){var p=l.perfLimitSizeTotal,v=g.width,C=g.height,b=l.maxCacheSideLimit,k=l.minCacheSideLimit;if(v<=b&&C<=b&&v*C<=p)return v<k&&(g.width=k),C<k&&(g.height=k),g;var I=v/C,R=l.util.limitDimsByArea(I,p),N=l.util.capValue,H=N(k,R.x,b),z=N(k,R.y,b);return v>H&&(g.zoomX/=v/H,g.width=H,g.capped=!0),C>z&&(g.zoomY/=C/z,g.height=z,g.capped=!0),g},_getCacheCanvasDimensions:function(){var g=this.getTotalObjectScaling(),p=this._getTransformedDimensions(0,0),v=p.x*g.scaleX/this.scaleX,C=p.y*g.scaleY/this.scaleY;return{width:v+2,height:C+2,zoomX:g.scaleX,zoomY:g.scaleY,x:v,y:C}},_updateCacheCanvas:function(){var g=this.canvas;if(this.noScaleCache&&g&&g._currentTransform){var p=g._currentTransform.target,v=g._currentTransform.action;if(this===p&&v.slice&&v.slice(0,5)==="scale")return!1}var C,b,k=this._cacheCanvas,I=this._limitCacheSize(this._getCacheCanvasDimensions()),R=l.minCacheSideLimit,N=I.width,H=I.height,z=I.zoomX,q=I.zoomY,J=N!==this.cacheWidth||H!==this.cacheHeight,$=this.zoomX!==z||this.zoomY!==q,V=J||$,j=0,X=0,Q=!1;if(J){var ie=this._cacheCanvas.width,G=this._cacheCanvas.height,U=N>ie||H>G;Q=U||(N<.9*ie||H<.9*G)&&ie>R&&G>R,U&&!I.capped&&(N>R||H>R)&&(j=.1*N,X=.1*H)}return this instanceof l.Text&&this.path&&(V=!0,Q=!0,j+=this.getHeightOfLine(0)*this.zoomX,X+=this.getHeightOfLine(0)*this.zoomY),!!V&&(Q?(k.width=Math.ceil(N+j),k.height=Math.ceil(H+X)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,k.width,k.height)),C=I.x/2,b=I.y/2,this.cacheTranslationX=Math.round(k.width/2-C)+C,this.cacheTranslationY=Math.round(k.height/2-b)+b,this.cacheWidth=N,this.cacheHeight=H,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(z,q),this.zoomX=z,this.zoomY=q,!0)},setOptions:function(g){this._setOptions(g),this._initGradient(g.fill,"fill"),this._initGradient(g.stroke,"stroke"),this._initPattern(g.fill,"fill"),this._initPattern(g.stroke,"stroke")},transform:function(g){var p=this.group&&!this.group._transformDone||this.group&&this.canvas&&g===this.canvas.contextTop,v=this.calcTransformMatrix(!p);g.transform(v[0],v[1],v[2],v[3],v[4],v[5])},toObject:function(g){var p=l.Object.NUM_FRACTION_DIGITS,v={type:this.type,version:l.version,originX:this.originX,originY:this.originY,left:r(this.left,p),top:r(this.top,p),width:r(this.width,p),height:r(this.height,p),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:r(this.strokeWidth,p),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:r(this.strokeMiterLimit,p),scaleX:r(this.scaleX,p),scaleY:r(this.scaleY,p),angle:r(this.angle,p),flipX:this.flipX,flipY:this.flipY,opacity:r(this.opacity,p),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:r(this.skewX,p),skewY:r(this.skewY,p)};return this.clipPath&&!this.clipPath.excludeFromExport&&(v.clipPath=this.clipPath.toObject(g),v.clipPath.inverted=this.clipPath.inverted,v.clipPath.absolutePositioned=this.clipPath.absolutePositioned),l.util.populateWithProperties(this,v,g),this.includeDefaultValues||(v=this._removeDefaultValues(v)),v},toDatalessObject:function(g){return this.toObject(g)},_removeDefaultValues:function(g){var p=l.util.getKlass(g.type).prototype;return p.stateProperties.forEach(function(v){v!=="left"&&v!=="top"&&(g[v]===p[v]&&delete g[v],Array.isArray(g[v])&&Array.isArray(p[v])&&g[v].length===0&&p[v].length===0&&delete g[v])}),g},toString:function(){return"#<fabric."+s(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var g=l.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(g.scaleX),scaleY:Math.abs(g.scaleY)}},getTotalObjectScaling:function(){var g=this.getObjectScaling(),p=g.scaleX,v=g.scaleY;if(this.canvas){var C=this.canvas.getZoom(),b=this.canvas.getRetinaScaling();p*=C*b,v*=C*b}return{scaleX:p,scaleY:v}},getObjectOpacity:function(){var g=this.opacity;return this.group&&(g*=this.group.getObjectOpacity()),g},_set:function(g,p){var v=g==="scaleX"||g==="scaleY",C=this[g]!==p,b=!1;return v&&(p=this._constrainScale(p)),g==="scaleX"&&p<0?(this.flipX=!this.flipX,p*=-1):g==="scaleY"&&p<0?(this.flipY=!this.flipY,p*=-1):g!=="shadow"||!p||p instanceof l.Shadow?g==="dirty"&&this.group&&this.group.set("dirty",p):p=new l.Shadow(p),this[g]=p,C&&(b=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(g)>-1?(this.dirty=!0,b&&this.group.set("dirty",!0)):b&&this.stateProperties.indexOf(g)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:l.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(g){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(g.save(),this._setupCompositeOperation(g),this.drawSelectionBackground(g),this.transform(g),this._setOpacity(g),this._setShadow(g,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(g)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(g),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),g.restore())},renderCache:function(g){g=g||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,g.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!(this.paintFirst!=="stroke"||!this.hasFill()||!this.hasStroke()||typeof this.shadow!="object")||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(g,p){if(g.save(),p.inverted?g.globalCompositeOperation="destination-out":g.globalCompositeOperation="destination-in",p.absolutePositioned){var v=l.util.invertTransform(this.calcTransformMatrix());g.transform(v[0],v[1],v[2],v[3],v[4],v[5])}p.transform(g),g.scale(1/p.zoomX,1/p.zoomY),g.drawImage(p._cacheCanvas,-p.cacheTranslationX,-p.cacheTranslationY),g.restore()},drawObject:function(g,p){var v=this.fill,C=this.stroke;p?(this.fill="black",this.stroke="",this._setClippingProperties(g)):this._renderBackground(g),this._render(g),this._drawClipPath(g,this.clipPath),this.fill=v,this.stroke=C},_drawClipPath:function(g,p){p&&(p.canvas=this.canvas,p.shouldCache(),p._transformDone=!0,p.renderCache({forClipping:!0}),this.drawClipPathOnCache(g,p))},drawCacheOnCanvas:function(g){g.scale(1/this.zoomX,1/this.zoomY),g.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(g){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!g&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!g){var p=this.cacheWidth/this.zoomX,v=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-p/2,-v/2,p,v)}return!0}return!1},_renderBackground:function(g){if(this.backgroundColor){var p=this._getNonTransformedDimensions();g.fillStyle=this.backgroundColor,g.fillRect(-p.x/2,-p.y/2,p.x,p.y),this._removeShadow(g)}},_setOpacity:function(g){this.group&&!this.group._transformDone?g.globalAlpha=this.getObjectOpacity():g.globalAlpha*=this.opacity},_setStrokeStyles:function(g,p){var v=p.stroke;v&&(g.lineWidth=p.strokeWidth,g.lineCap=p.strokeLineCap,g.lineDashOffset=p.strokeDashOffset,g.lineJoin=p.strokeLineJoin,g.miterLimit=p.strokeMiterLimit,v.toLive?v.gradientUnits==="percentage"||v.gradientTransform||v.patternTransform?this._applyPatternForTransformedGradient(g,v):(g.strokeStyle=v.toLive(g,this),this._applyPatternGradientTransform(g,v)):g.strokeStyle=p.stroke)},_setFillStyles:function(g,p){var v=p.fill;v&&(v.toLive?(g.fillStyle=v.toLive(g,this),this._applyPatternGradientTransform(g,p.fill)):g.fillStyle=v)},_setClippingProperties:function(g){g.globalAlpha=1,g.strokeStyle="transparent",g.fillStyle="#000000"},_setLineDash:function(g,p){p&&p.length!==0&&(1&p.length&&p.push.apply(p,p),g.setLineDash(p))},_renderControls:function(g,p){var v,C,b,k=this.getViewportTransform(),I=this.calcTransformMatrix();C=(p=p||{}).hasBorders!==void 0?p.hasBorders:this.hasBorders,b=p.hasControls!==void 0?p.hasControls:this.hasControls,I=l.util.multiplyTransformMatrices(k,I),v=l.util.qrDecompose(I),g.save(),g.translate(v.translateX,v.translateY),g.lineWidth=1*this.borderScaleFactor,this.group||(g.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(v.angle-=180),g.rotate(u(this.group?v.angle:this.angle)),p.forActiveSelection||this.group?C&&this.drawBordersInGroup(g,v,p):C&&this.drawBorders(g,p),b&&this.drawControls(g,p),g.restore()},_setShadow:function(g){if(this.shadow){var p,v=this.shadow,C=this.canvas,b=C&&C.viewportTransform[0]||1,k=C&&C.viewportTransform[3]||1;p=v.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),C&&C._isRetinaScaling()&&(b*=l.devicePixelRatio,k*=l.devicePixelRatio),g.shadowColor=v.color,g.shadowBlur=v.blur*l.browserShadowBlurConstant*(b+k)*(p.scaleX+p.scaleY)/4,g.shadowOffsetX=v.offsetX*b*p.scaleX,g.shadowOffsetY=v.offsetY*k*p.scaleY}},_removeShadow:function(g){this.shadow&&(g.shadowColor="",g.shadowBlur=g.shadowOffsetX=g.shadowOffsetY=0)},_applyPatternGradientTransform:function(g,p){if(!p||!p.toLive)return{offsetX:0,offsetY:0};var v=p.gradientTransform||p.patternTransform,C=-this.width/2+p.offsetX||0,b=-this.height/2+p.offsetY||0;return p.gradientUnits==="percentage"?g.transform(this.width,0,0,this.height,C,b):g.transform(1,0,0,1,C,b),v&&g.transform(v[0],v[1],v[2],v[3],v[4],v[5]),{offsetX:C,offsetY:b}},_renderPaintInOrder:function(g){this.paintFirst==="stroke"?(this._renderStroke(g),this._renderFill(g)):(this._renderFill(g),this._renderStroke(g))},_render:function(){},_renderFill:function(g){this.fill&&(g.save(),this._setFillStyles(g,this),this.fillRule==="evenodd"?g.fill("evenodd"):g.fill(),g.restore())},_renderStroke:function(g){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(g),g.save(),this.strokeUniform&&this.group){var p=this.getObjectScaling();g.scale(1/p.scaleX,1/p.scaleY)}else this.strokeUniform&&g.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(g,this.strokeDashArray),this._setStrokeStyles(g,this),g.stroke(),g.restore()}},_applyPatternForTransformedGradient:function(g,p){var v,C=this._limitCacheSize(this._getCacheCanvasDimensions()),b=l.util.createCanvasElement(),k=this.canvas.getRetinaScaling(),I=C.x/this.scaleX/k,R=C.y/this.scaleY/k;b.width=I,b.height=R,(v=b.getContext("2d")).beginPath(),v.moveTo(0,0),v.lineTo(I,0),v.lineTo(I,R),v.lineTo(0,R),v.closePath(),v.translate(I/2,R/2),v.scale(C.zoomX/this.scaleX/k,C.zoomY/this.scaleY/k),this._applyPatternGradientTransform(v,p),v.fillStyle=p.toLive(g),v.fill(),g.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),g.scale(k*this.scaleX/C.zoomX,k*this.scaleY/C.zoomY),g.strokeStyle=v.createPattern(b,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var g=l.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",g.scaleX),this.set("scaleY",g.scaleY),this.angle=g.angle,this.skewX=g.skewX,this.skewY=0}},_removeTransformMatrix:function(g){var p=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),p=l.util.transformPoint(p,this.transformMatrix)),this.transformMatrix=null,g&&(this.scaleX*=g.scaleX,this.scaleY*=g.scaleY,this.cropX=g.cropX,this.cropY=g.cropY,p.x+=g.offsetLeft,p.y+=g.offsetTop,this.width=g.width,this.height=g.height),this.setPositionByOrigin(p,"center","center")},clone:function(g,p){var v=this.toObject(p);this.constructor.fromObject?this.constructor.fromObject(v,g):l.Object._fromObject("Object",v,g)},cloneAsImage:function(g,p){var v=this.toCanvasElement(p);return g&&g(new l.Image(v)),this},toCanvasElement:function(g){g||(g={});var p=l.util,v=p.saveObjectTransform(this),C=this.group,b=this.shadow,k=Math.abs,I=(g.multiplier||1)*(g.enableRetinaScaling?l.devicePixelRatio:1);delete this.group,g.withoutTransform&&p.resetObjectTransform(this),g.withoutShadow&&(this.shadow=null);var R,N,H,z,q=l.util.createCanvasElement(),J=this.getBoundingRect(!0,!0),$=this.shadow,V={x:0,y:0};$&&(N=$.blur,R=$.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),V.x=2*Math.round(k($.offsetX)+N)*k(R.scaleX),V.y=2*Math.round(k($.offsetY)+N)*k(R.scaleY)),H=J.width+V.x,z=J.height+V.y,q.width=Math.ceil(H),q.height=Math.ceil(z);var j=new l.StaticCanvas(q,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});g.format==="jpeg"&&(j.backgroundColor="#fff"),this.setPositionByOrigin(new l.Point(j.width/2,j.height/2),"center","center");var X=this.canvas;j.add(this);var Q=j.toCanvasElement(I||1,g);return this.shadow=b,this.set("canvas",X),C&&(this.group=C),this.set(v).setCoords(),j._objects=[],j.dispose(),j=null,Q},toDataURL:function(g){return g||(g={}),l.util.toDataURL(this.toCanvasElement(g),g.format||"png",g.quality||1)},isType:function(g){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===g},complexity:function(){return 1},toJSON:function(g){return this.toObject(g)},rotate:function(g){var p=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return p&&this._setOriginToCenter(),this.set("angle",g),p&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(g,p){p=p||this.canvas.getPointer(g);var v=new l.Point(p.x,p.y),C=this._getLeftTopCoords();return this.angle&&(v=l.util.rotatePoint(v,C,u(-this.angle))),{x:v.x-C.x,y:v.y-C.y}},_setupCompositeOperation:function(g){this.globalCompositeOperation&&(g.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){l.runningAnimations&&l.runningAnimations.cancelByTarget(this)}}),l.util.createAccessors&&l.util.createAccessors(l.Object),c(l.Object.prototype,l.Observable),l.Object.NUM_FRACTION_DIGITS=2,l.Object.ENLIVEN_PROPS=["clipPath"],l.Object._fromObject=function(g,p,v,C){var b=l[g];p=f(p,!0),l.util.enlivenPatterns([p.fill,p.stroke],function(k){k[0]!==void 0&&(p.fill=k[0]),k[1]!==void 0&&(p.stroke=k[1]),l.util.enlivenObjectEnlivables(p,p,function(){var I=C?new b(p[C],p):new b(p);v&&v(I)})})},l.Object.__uid=0)}(t),Y=S.util.degreesToRadians,ne={left:-.5,center:0,right:.5},oe={top:-.5,center:0,bottom:.5},S.util.object.extend(S.Object.prototype,{translateToGivenOrigin:function(h,l,c,f,r){var s,u,m,g=h.x,p=h.y;return typeof l=="string"?l=ne[l]:l-=.5,typeof f=="string"?f=ne[f]:f-=.5,typeof c=="string"?c=oe[c]:c-=.5,typeof r=="string"?r=oe[r]:r-=.5,u=r-c,((s=f-l)||u)&&(m=this._getTransformedDimensions(),g=h.x+s*m.x,p=h.y+u*m.y),new S.Point(g,p)},translateToCenterPoint:function(h,l,c){var f=this.translateToGivenOrigin(h,l,c,"center","center");return this.angle?S.util.rotatePoint(f,h,Y(this.angle)):f},translateToOriginPoint:function(h,l,c){var f=this.translateToGivenOrigin(h,"center","center",l,c);return this.angle?S.util.rotatePoint(f,h,Y(this.angle)):f},getCenterPoint:function(){var h=new S.Point(this.left,this.top);return this.translateToCenterPoint(h,this.originX,this.originY)},getPointByOrigin:function(h,l){var c=this.getCenterPoint();return this.translateToOriginPoint(c,h,l)},toLocalPoint:function(h,l,c){var f,r,s=this.getCenterPoint();return f=l!==void 0&&c!==void 0?this.translateToGivenOrigin(s,"center","center",l,c):new S.Point(this.left,this.top),r=new S.Point(h.x,h.y),this.angle&&(r=S.util.rotatePoint(r,s,-Y(this.angle))),r.subtractEquals(f)},setPositionByOrigin:function(h,l,c){var f=this.translateToCenterPoint(h,l,c),r=this.translateToOriginPoint(f,this.originX,this.originY);this.set("left",r.x),this.set("top",r.y)},adjustPosition:function(h){var l,c,f=Y(this.angle),r=this.getScaledWidth(),s=S.util.cos(f)*r,u=S.util.sin(f)*r;l=typeof this.originX=="string"?ne[this.originX]:this.originX-.5,c=typeof h=="string"?ne[h]:h-.5,this.left+=s*(c-l),this.top+=u*(c-l),this.setCoords(),this.originX=h},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var h=this.getCenterPoint();this.originX="center",this.originY="center",this.left=h.x,this.top=h.y},_resetOrigin:function(){var h=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=h.x,this.top=h.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}}),function(){var h=S.util,l=h.degreesToRadians,c=h.multiplyTransformMatrices,f=h.transformPoint;h.object.extend(S.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(r,s){return s?r?this.calcACoords():this.calcLineCoords():(this.aCoords&&this.lineCoords||this.setCoords(!0),r?this.aCoords:this.lineCoords)},getCoords:function(r,s){return u=this._getCoords(r,s),[new S.Point(u.tl.x,u.tl.y),new S.Point(u.tr.x,u.tr.y),new S.Point(u.br.x,u.br.y),new S.Point(u.bl.x,u.bl.y)];var u},intersectsWithRect:function(r,s,u,m){var g=this.getCoords(u,m);return S.Intersection.intersectPolygonRectangle(g,r,s).status==="Intersection"},intersectsWithObject:function(r,s,u){return S.Intersection.intersectPolygonPolygon(this.getCoords(s,u),r.getCoords(s,u)).status==="Intersection"||r.isContainedWithinObject(this,s,u)||this.isContainedWithinObject(r,s,u)},isContainedWithinObject:function(r,s,u){for(var m=this.getCoords(s,u),g=s?r.aCoords:r.lineCoords,p=0,v=r._getImageLines(g);p<4;p++)if(!r.containsPoint(m[p],v))return!1;return!0},isContainedWithinRect:function(r,s,u,m){var g=this.getBoundingRect(u,m);return g.left>=r.x&&g.left+g.width<=s.x&&g.top>=r.y&&g.top+g.height<=s.y},containsPoint:function(r,s,u,m){var g=this._getCoords(u,m),p=(s=s||this._getImageLines(g),this._findCrossPoints(r,s));return p!==0&&p%2==1},isOnScreen:function(r){if(!this.canvas)return!1;var s=this.canvas.vptCoords.tl,u=this.canvas.vptCoords.br;return!!this.getCoords(!0,r).some(function(m){return m.x<=u.x&&m.x>=s.x&&m.y<=u.y&&m.y>=s.y})||!!this.intersectsWithRect(s,u,!0,r)||this._containsCenterOfCanvas(s,u,r)},_containsCenterOfCanvas:function(r,s,u){var m={x:(r.x+s.x)/2,y:(r.y+s.y)/2};return!!this.containsPoint(m,null,!0,u)},isPartiallyOnScreen:function(r){if(!this.canvas)return!1;var s=this.canvas.vptCoords.tl,u=this.canvas.vptCoords.br;return!!this.intersectsWithRect(s,u,!0,r)||this.getCoords(!0,r).every(function(m){return(m.x>=u.x||m.x<=s.x)&&(m.y>=u.y||m.y<=s.y)})&&this._containsCenterOfCanvas(s,u,r)},_getImageLines:function(r){return{topline:{o:r.tl,d:r.tr},rightline:{o:r.tr,d:r.br},bottomline:{o:r.br,d:r.bl},leftline:{o:r.bl,d:r.tl}}},_findCrossPoints:function(r,s){var u,m,g,p=0;for(var v in s)if(!((g=s[v]).o.y<r.y&&g.d.y<r.y||g.o.y>=r.y&&g.d.y>=r.y||(g.o.x===g.d.x&&g.o.x>=r.x?m=g.o.x:(u=(g.d.y-g.o.y)/(g.d.x-g.o.x),m=-(r.y-0*r.x-(g.o.y-u*g.o.x))/(0-u)),m>=r.x&&(p+=1),p!==2)))break;return p},getBoundingRect:function(r,s){var u=this.getCoords(r,s);return h.makeBoundingBoxFromPoints(u)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(r){return Math.abs(r)<this.minScaleLimit?r<0?-this.minScaleLimit:this.minScaleLimit:r===0?1e-4:r},scale:function(r){return this._set("scaleX",r),this._set("scaleY",r),this.setCoords()},scaleToWidth:function(r,s){var u=this.getBoundingRect(s).width/this.getScaledWidth();return this.scale(r/this.width/u)},scaleToHeight:function(r,s){var u=this.getBoundingRect(s).height/this.getScaledHeight();return this.scale(r/this.height/u)},calcLineCoords:function(){var r=this.getViewportTransform(),s=this.padding,u=l(this.angle),m=h.cos(u)*s,g=h.sin(u)*s,p=m+g,v=m-g,C=this.calcACoords(),b={tl:f(C.tl,r),tr:f(C.tr,r),bl:f(C.bl,r),br:f(C.br,r)};return s&&(b.tl.x-=v,b.tl.y-=p,b.tr.x+=p,b.tr.y-=v,b.bl.x-=p,b.bl.y+=v,b.br.x+=v,b.br.y+=p),b},calcOCoords:function(){var r=this._calcRotateMatrix(),s=this._calcTranslateMatrix(),u=this.getViewportTransform(),m=c(u,s),g=c(m,r),p=(g=c(g,[1/u[0],0,0,1/u[3],0,0]),this._calculateCurrentDimensions()),v={};return this.forEachControl(function(C,b,k){v[b]=C.positionHandler(p,g,k)}),v},calcACoords:function(){var r=this._calcRotateMatrix(),s=this._calcTranslateMatrix(),u=c(s,r),m=this._getTransformedDimensions(),g=m.x/2,p=m.y/2;return{tl:f({x:-g,y:-p},u),tr:f({x:g,y:-p},u),bl:f({x:-g,y:p},u),br:f({x:g,y:p},u)}},setCoords:function(r){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),r||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return h.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var r=this.getCenterPoint();return[1,0,0,1,r.x,r.y]},transformMatrixKey:function(r){var s="_",u="";return!r&&this.group&&(u=this.group.transformMatrixKey(r)+s),u+this.top+s+this.left+s+this.scaleX+s+this.scaleY+s+this.skewX+s+this.skewY+s+this.angle+s+this.originX+s+this.originY+s+this.width+s+this.height+s+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(r){var s=this.calcOwnMatrix();if(r||!this.group)return s;var u=this.transformMatrixKey(r),m=this.matrixCache||(this.matrixCache={});return m.key===u?m.value:(this.group&&(s=c(this.group.calcTransformMatrix(!1),s)),m.key=u,m.value=s,s)},calcOwnMatrix:function(){var r=this.transformMatrixKey(!0),s=this.ownMatrixCache||(this.ownMatrixCache={});if(s.key===r)return s.value;var u=this._calcTranslateMatrix(),m={angle:this.angle,translateX:u[4],translateY:u[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return s.key=r,s.value=h.composeMatrix(m),s.value},_getNonTransformedDimensions:function(){var r=this.strokeWidth;return{x:this.width+r,y:this.height+r}},_getTransformedDimensions:function(r,s){r===void 0&&(r=this.skewX),s===void 0&&(s=this.skewY);var u,m,g,p=r===0&&s===0;if(this.strokeUniform?(m=this.width,g=this.height):(m=(u=this._getNonTransformedDimensions()).x,g=u.y),p)return this._finalizeDimensions(m*this.scaleX,g*this.scaleY);var v=h.sizeAfterTransform(m,g,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:r,skewY:s});return this._finalizeDimensions(v.x,v.y)},_finalizeDimensions:function(r,s){return this.strokeUniform?{x:r+this.strokeWidth,y:s+this.strokeWidth}:{x:r,y:s}},_calculateCurrentDimensions:function(){var r=this.getViewportTransform(),s=this._getTransformedDimensions();return f(s,r,!0).scalarAdd(2*this.padding)}})}(),S.util.object.extend(S.Object.prototype,{sendToBack:function(){return this.group?S.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?S.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(h){return this.group?S.StaticCanvas.prototype.sendBackwards.call(this.group,this,h):this.canvas&&this.canvas.sendBackwards(this,h),this},bringForward:function(h){return this.group?S.StaticCanvas.prototype.bringForward.call(this.group,this,h):this.canvas&&this.canvas.bringForward(this,h),this},moveTo:function(h){return this.group&&this.group.type!=="activeSelection"?S.StaticCanvas.prototype.moveTo.call(this.group,this,h):this.canvas&&this.canvas.moveTo(this,h),this}}),function(){function h(c,f){if(f){if(f.toLive)return c+": url(#SVGID_"+f.id+"); ";var r=new S.Color(f),s=c+": "+r.toRgb()+"; ",u=r.getAlpha();return u!==1&&(s+=c+"-opacity: "+u.toString()+"; "),s}return c+": none; "}var l=S.util.toFixed;S.util.object.extend(S.Object.prototype,{getSvgStyles:function(c){var f=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):"none",u=this.strokeDashOffset?this.strokeDashOffset:"0",m=this.strokeLineCap?this.strokeLineCap:"butt",g=this.strokeLineJoin?this.strokeLineJoin:"miter",p=this.strokeMiterLimit?this.strokeMiterLimit:"4",v=this.opacity!==void 0?this.opacity:"1",C=this.visible?"":" visibility: hidden;",b=c?"":this.getSvgFilter(),k=h("fill",this.fill);return[h("stroke",this.stroke),"stroke-width: ",r,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",m,"; ","stroke-dashoffset: ",u,"; ","stroke-linejoin: ",g,"; ","stroke-miterlimit: ",p,"; ",k,"fill-rule: ",f,"; ","opacity: ",v,";",b,C].join("")},getSvgSpanStyles:function(c,f){var r="; ",s=c.fontFamily?"font-family: "+(c.fontFamily.indexOf("'")===-1&&c.fontFamily.indexOf('"')===-1?"'"+c.fontFamily+"'":c.fontFamily)+r:"",u=c.strokeWidth?"stroke-width: "+c.strokeWidth+r:"",m=c.fontSize?"font-size: "+c.fontSize+"px"+r:"",g=c.fontStyle?"font-style: "+c.fontStyle+r:"",p=c.fontWeight?"font-weight: "+c.fontWeight+r:"",v=c.fill?h("fill",c.fill):"",C=c.stroke?h("stroke",c.stroke):"",b=this.getSvgTextDecoration(c);return b&&(b="text-decoration: "+b+r),[C,u,s,m,g,p,b,v,c.deltaY?"baseline-shift: "+-c.deltaY+"; ":"",f?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(c){return["overline","underline","line-through"].filter(function(f){return c[f.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(c,f){var r=c?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+S.util.matrixToSVG(r)+(f||"")+'" '},_setSVGBg:function(c){if(this.backgroundColor){var f=S.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',l(-this.width/2,f),'" y="',l(-this.height/2,f),'" width="',l(this.width,f),'" height="',l(this.height,f),`"></rect>
`)}},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(c),{reviver:c})},toClipPathSVG:function(c){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(c),{reviver:c})},_createBaseClipPathSVGMarkup:function(c,f){var r=(f=f||{}).reviver,s=f.additionalTransform||"",u=[this.getSvgTransform(!0,s),this.getSvgCommons()].join(""),m=c.indexOf("COMMON_PARTS");return c[m]=u,r?r(c.join("")):c.join("")},_createBaseSVGMarkup:function(c,f){var r,s,u=(f=f||{}).noStyle,m=f.reviver,g=u?"":'style="'+this.getSvgStyles()+'" ',p=f.withShadow?'style="'+this.getSvgFilter()+'" ':"",v=this.clipPath,C=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",b=v&&v.absolutePositioned,k=this.stroke,I=this.fill,R=this.shadow,N=[],H=c.indexOf("COMMON_PARTS"),z=f.additionalTransform;return v&&(v.clipPathId="CLIPPATH_"+S.Object.__uid++,s='<clipPath id="'+v.clipPathId+`" >
`+v.toClipPathSVG(m)+`</clipPath>
`),b&&N.push("<g ",p,this.getSvgCommons(),` >
`),N.push("<g ",this.getSvgTransform(!1),b?"":p+this.getSvgCommons(),` >
`),r=[g,C,u?"":this.addPaintOrder()," ",z?'transform="'+z+'" ':""].join(""),c[H]=r,I&&I.toLive&&N.push(I.toSVG(this)),k&&k.toLive&&N.push(k.toSVG(this)),R&&N.push(R.toSVG(this)),v&&N.push(s),N.push(c.join("")),N.push(`</g>
`),b&&N.push(`</g>
`),m?m(N.join("")):N.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var h=S.util.object.extend,l="stateProperties";function c(r,s,u){var m={};u.forEach(function(g){m[g]=r[g]}),h(r[s],m,!0)}function f(r,s,u){if(r===s)return!0;if(Array.isArray(r)){if(!Array.isArray(s)||r.length!==s.length)return!1;for(var m=0,g=r.length;m<g;m++)if(!f(r[m],s[m]))return!1;return!0}if(r&&typeof r=="object"){var p,v=Object.keys(r);if(!s||typeof s!="object"||!u&&v.length!==Object.keys(s).length)return!1;for(m=0,g=v.length;m<g;m++)if((p=v[m])!=="canvas"&&p!=="group"&&!f(r[p],s[p]))return!1;return!0}}S.util.object.extend(S.Object.prototype,{hasStateChanged:function(r){var s="_"+(r=r||l);return Object.keys(this[s]).length<this[r].length||!f(this[s],this,!0)},saveState:function(r){var s=r&&r.propertySet||l,u="_"+s;return this[u]?(c(this,u,this[s]),r&&r.stateProperties&&c(this,u,r.stateProperties),this):this.setupState(r)},setupState:function(r){var s=(r=r||{}).propertySet||l;return r.propertySet=s,this["_"+s]={},this.saveState(r),this}})}(),function(){var h=S.util.degreesToRadians;S.util.object.extend(S.Object.prototype,{_findTargetCorner:function(l,c){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var f,r,s,u=l.x,m=l.y,g=Object.keys(this.oCoords),p=g.length-1;for(this.__corner=0;p>=0;p--)if(s=g[p],this.isControlVisible(s)&&(r=this._getImageLines(c?this.oCoords[s].touchCorner:this.oCoords[s].corner),(f=this._findCrossPoints({x:u,y:m},r))!==0&&f%2==1))return this.__corner=s,s;return!1},forEachControl:function(l){for(var c in this.controls)l(this.controls[c],c,this)},_setCornerCoords:function(){var l=this.oCoords;for(var c in l){var f=this.controls[c];l[c].corner=f.calcCornerCoords(this.angle,this.cornerSize,l[c].x,l[c].y,!1),l[c].touchCorner=f.calcCornerCoords(this.angle,this.touchCornerSize,l[c].x,l[c].y,!0)}},drawSelectionBackground:function(l){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;l.save();var c=this.getCenterPoint(),f=this._calculateCurrentDimensions(),r=this.canvas.viewportTransform;return l.translate(c.x,c.y),l.scale(1/r[0],1/r[3]),l.rotate(h(this.angle)),l.fillStyle=this.selectionBackgroundColor,l.fillRect(-f.x/2,-f.y/2,f.x,f.y),l.restore(),this},drawBorders:function(l,c){c=c||{};var f=this._calculateCurrentDimensions(),r=this.borderScaleFactor,s=f.x+r,u=f.y+r,m=c.hasControls!==void 0?c.hasControls:this.hasControls,g=!1;return l.save(),l.strokeStyle=c.borderColor||this.borderColor,this._setLineDash(l,c.borderDashArray||this.borderDashArray),l.strokeRect(-s/2,-u/2,s,u),m&&(l.beginPath(),this.forEachControl(function(p,v,C){p.withConnection&&p.getVisibility(C,v)&&(g=!0,l.moveTo(p.x*s,p.y*u),l.lineTo(p.x*s+p.offsetX,p.y*u+p.offsetY))}),g&&l.stroke()),l.restore(),this},drawBordersInGroup:function(l,c,f){f=f||{};var r=S.util.sizeAfterTransform(this.width,this.height,c),s=this.strokeWidth,u=this.strokeUniform,m=this.borderScaleFactor,g=r.x+s*(u?this.canvas.getZoom():c.scaleX)+m,p=r.y+s*(u?this.canvas.getZoom():c.scaleY)+m;return l.save(),this._setLineDash(l,f.borderDashArray||this.borderDashArray),l.strokeStyle=f.borderColor||this.borderColor,l.strokeRect(-g/2,-p/2,g,p),l.restore(),this},drawControls:function(l,c){c=c||{},l.save();var f,r,s=this.canvas.getRetinaScaling();return l.setTransform(s,0,0,s,0,0),l.strokeStyle=l.fillStyle=c.cornerColor||this.cornerColor,this.transparentCorners||(l.strokeStyle=c.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(l,c.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(f=this.group.calcTransformMatrix()),this.forEachControl(function(u,m,g){r=g.oCoords[m],u.getVisibility(g,m)&&(f&&(r=S.util.transformPoint(r,f)),u.render(l,r.x,r.y,c,g))}),l.restore(),this},isControlVisible:function(l){return this.controls[l]&&this.controls[l].getVisibility(this,l)},setControlVisible:function(l,c){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[l]=c,this},setControlsVisibility:function(l){for(var c in l||(l={}),l)this.setControlVisible(c,l[c]);return this},onDeselect:function(){},onSelect:function(){}})}(),S.util.object.extend(S.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(h,l){var c=function(){},f=(l=l||{}).onComplete||c,r=l.onChange||c,s=this;return S.util.animate({target:this,startValue:h.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(u){h.set("left",u),s.requestRenderAll(),r()},onComplete:function(){h.setCoords(),f()}})},fxCenterObjectV:function(h,l){var c=function(){},f=(l=l||{}).onComplete||c,r=l.onChange||c,s=this;return S.util.animate({target:this,startValue:h.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(u){h.set("top",u),s.requestRenderAll(),r()},onComplete:function(){h.setCoords(),f()}})},fxRemove:function(h,l){var c=function(){},f=(l=l||{}).onComplete||c,r=l.onChange||c,s=this;return S.util.animate({target:this,startValue:h.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(u){h.set("opacity",u),s.requestRenderAll(),r()},onComplete:function(){s.remove(h),f()}})}}),S.util.object.extend(S.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var h,l,c=[],f=[];for(h in arguments[0])c.push(h);for(var r=0,s=c.length;r<s;r++)h=c[r],l=r!==s-1,f.push(this._animate(h,arguments[0][h],arguments[1],l));return f}return this._animate.apply(this,arguments)},_animate:function(h,l,c,f){var r,s=this;l=l.toString(),c=c?S.util.object.clone(c):{},~h.indexOf(".")&&(r=h.split("."));var u=s.colorProperties.indexOf(h)>-1||r&&s.colorProperties.indexOf(r[1])>-1,m=r?this.get(r[0])[r[1]]:this.get(h);"from"in c||(c.from=m),u||(l=~l.indexOf("=")?m+parseFloat(l.replace("=","")):parseFloat(l));var g={target:this,startValue:c.from,endValue:l,byValue:c.by,easing:c.easing,duration:c.duration,abort:c.abort&&function(p,v,C){return c.abort.call(s,p,v,C)},onChange:function(p,v,C){r?s[r[0]][r[1]]=p:s.set(h,p),f||c.onChange&&c.onChange(p,v,C)},onComplete:function(p,v,C){f||(s.setCoords(),c.onComplete&&c.onComplete(p,v,C))}};return u?S.util.animateColor(g.startValue,g.endValue,g.duration,g):S.util.animate(g)}}),function(h){var l=h.fabric||(h.fabric={}),c=l.util.object.extend,f=l.util.object.clone,r={x1:1,x2:1,y1:1,y2:1};function s(u,m){var g=u.origin,p=u.axis1,v=u.axis2,C=u.dimension,b=m.nearest,k=m.center,I=m.farthest;return function(){switch(this.get(g)){case b:return Math.min(this.get(p),this.get(v));case k:return Math.min(this.get(p),this.get(v))+.5*this.get(C);case I:return Math.max(this.get(p),this.get(v))}}}l.Line?l.warn("fabric.Line is already defined"):(l.Line=l.util.createClass(l.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:l.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(u,m){u||(u=[0,0,0,0]),this.callSuper("initialize",m),this.set("x1",u[0]),this.set("y1",u[1]),this.set("x2",u[2]),this.set("y2",u[3]),this._setWidthHeight(m)},_setWidthHeight:function(u){u||(u={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in u?u.left:this._getLeftToOriginX(),this.top="top"in u?u.top:this._getTopToOriginY()},_set:function(u,m){return this.callSuper("_set",u,m),r[u]!==void 0&&this._setWidthHeight(),this},_getLeftToOriginX:s({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:s({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(u){u.beginPath();var m=this.calcLinePoints();u.moveTo(m.x1,m.y1),u.lineTo(m.x2,m.y2),u.lineWidth=this.strokeWidth;var g=u.strokeStyle;u.strokeStyle=this.stroke||u.fillStyle,this.stroke&&this._renderStroke(u),u.strokeStyle=g},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(u){return c(this.callSuper("toObject",u),this.calcLinePoints())},_getNonTransformedDimensions:function(){var u=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(u.y-=this.strokeWidth),this.height===0&&(u.x-=this.strokeWidth)),u},calcLinePoints:function(){var u=this.x1<=this.x2?-1:1,m=this.y1<=this.y2?-1:1,g=u*this.width*.5,p=m*this.height*.5;return{x1:g,x2:u*this.width*-.5,y1:p,y2:m*this.height*-.5}},_toSVG:function(){var u=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',u.x1,'" y1="',u.y1,'" x2="',u.x2,'" y2="',u.y2,`" />
`]}}),l.Line.ATTRIBUTE_NAMES=l.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),l.Line.fromElement=function(u,m,g){g=g||{};var p=l.parseAttributes(u,l.Line.ATTRIBUTE_NAMES),v=[p.x1||0,p.y1||0,p.x2||0,p.y2||0];m(new l.Line(v,c(p,g)))},l.Line.fromObject=function(u,m){var g=f(u,!0);g.points=[u.x1,u.y1,u.x2,u.y2],l.Object._fromObject("Line",g,function(p){delete p.points,m&&m(p)},"points")})}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.util.degreesToRadians;l.Circle?l.warn("fabric.Circle is already defined."):(l.Circle=l.util.createClass(l.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:l.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(f,r){return this.callSuper("_set",f,r),f==="radius"&&this.setRadius(r),this},toObject:function(f){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(f))},_toSVG:function(){var f,r=(this.endAngle-this.startAngle)%360;if(r===0)f=["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,`" />
`];else{var s=c(this.startAngle),u=c(this.endAngle),m=this.radius;f=['<path d="M '+l.util.cos(s)*m+" "+l.util.sin(s)*m," A "+m+" "+m," 0 ",+(r>180?"1":"0")+" 1"," "+l.util.cos(u)*m+" "+l.util.sin(u)*m,'" ',"COMMON_PARTS",` />
`]}return f},_render:function(f){f.beginPath(),f.arc(0,0,this.radius,c(this.startAngle),c(this.endAngle),!1),this._renderPaintInOrder(f)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(f){return this.radius=f,this.set("width",2*f).set("height",2*f)}}),l.Circle.ATTRIBUTE_NAMES=l.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),l.Circle.fromElement=function(f,r){var s,u=l.parseAttributes(f,l.Circle.ATTRIBUTE_NAMES);if(!("radius"in(s=u)&&s.radius>=0))throw new Error("value of `r` attribute is required and can not be negative");u.left=(u.left||0)-u.radius,u.top=(u.top||0)-u.radius,r(new l.Circle(u))},l.Circle.fromObject=function(f,r){l.Object._fromObject("Circle",f,r)})}(t),function(h){var l=h.fabric||(h.fabric={});l.Triangle?l.warn("fabric.Triangle is already defined"):(l.Triangle=l.util.createClass(l.Object,{type:"triangle",width:100,height:100,_render:function(c){var f=this.width/2,r=this.height/2;c.beginPath(),c.moveTo(-f,r),c.lineTo(0,-r),c.lineTo(f,r),c.closePath(),this._renderPaintInOrder(c)},_toSVG:function(){var c=this.width/2,f=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-c+" "+f,"0 "+-f,c+" "+f].join(","),'" />']}}),l.Triangle.fromObject=function(c,f){return l.Object._fromObject("Triangle",c,f)})}(t),function(h){var l=h.fabric||(h.fabric={}),c=2*Math.PI;l.Ellipse?l.warn("fabric.Ellipse is already defined."):(l.Ellipse=l.util.createClass(l.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:l.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(f){this.callSuper("initialize",f),this.set("rx",f&&f.rx||0),this.set("ry",f&&f.ry||0)},_set:function(f,r){switch(this.callSuper("_set",f,r),f){case"rx":this.rx=r,this.set("width",2*r);break;case"ry":this.ry=r,this.set("height",2*r)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(f){return this.callSuper("toObject",["rx","ry"].concat(f))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(f){f.beginPath(),f.save(),f.transform(1,0,0,this.ry/this.rx,0,0),f.arc(0,0,this.rx,0,c,!1),f.restore(),this._renderPaintInOrder(f)}}),l.Ellipse.ATTRIBUTE_NAMES=l.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),l.Ellipse.fromElement=function(f,r){var s=l.parseAttributes(f,l.Ellipse.ATTRIBUTE_NAMES);s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,r(new l.Ellipse(s))},l.Ellipse.fromObject=function(f,r){l.Object._fromObject("Ellipse",f,r)})}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.util.object.extend;l.Rect?l.warn("fabric.Rect is already defined"):(l.Rect=l.util.createClass(l.Object,{stateProperties:l.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:l.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(f){this.callSuper("initialize",f),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(f){var r=this.rx?Math.min(this.rx,this.width/2):0,s=this.ry?Math.min(this.ry,this.height/2):0,u=this.width,m=this.height,g=-this.width/2,p=-this.height/2,v=r!==0||s!==0,C=.4477152502;f.beginPath(),f.moveTo(g+r,p),f.lineTo(g+u-r,p),v&&f.bezierCurveTo(g+u-C*r,p,g+u,p+C*s,g+u,p+s),f.lineTo(g+u,p+m-s),v&&f.bezierCurveTo(g+u,p+m-C*s,g+u-C*r,p+m,g+u-r,p+m),f.lineTo(g+r,p+m),v&&f.bezierCurveTo(g+C*r,p+m,g,p+m-C*s,g,p+m-s),f.lineTo(g,p+s),v&&f.bezierCurveTo(g,p+C*s,g+C*r,p,g+r,p),f.closePath(),this._renderPaintInOrder(f)},toObject:function(f){return this.callSuper("toObject",["rx","ry"].concat(f))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),l.Rect.ATTRIBUTE_NAMES=l.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),l.Rect.fromElement=function(f,r,s){if(!f)return r(null);s=s||{};var u=l.parseAttributes(f,l.Rect.ATTRIBUTE_NAMES);u.left=u.left||0,u.top=u.top||0,u.height=u.height||0,u.width=u.width||0;var m=new l.Rect(c(s?l.util.object.clone(s):{},u));m.visible=m.visible&&m.width>0&&m.height>0,r(m)},l.Rect.fromObject=function(f,r){return l.Object._fromObject("Rect",f,r)})}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.util.object.extend,f=l.util.array.min,r=l.util.array.max,s=l.util.toFixed,u=l.util.projectStrokeOnPoints;l.Polyline?l.warn("fabric.Polyline is already defined"):(l.Polyline=l.util.createClass(l.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:l.Object.prototype.cacheProperties.concat("points"),initialize:function(m,g){g=g||{},this.points=m||[],this.callSuper("initialize",g),this._setPositionDimensions(g)},_projectStrokeOnPoints:function(){return u(this.points,this,!0)},_setPositionDimensions:function(m){var g,p=this._calcDimensions(m),v=this.exactBoundingBox?this.strokeWidth:0;this.width=p.width-v,this.height=p.height-v,m.fromSVG||(g=this.translateToGivenOrigin({x:p.left-this.strokeWidth/2+v/2,y:p.top-this.strokeWidth/2+v/2},"left","top",this.originX,this.originY)),m.left===void 0&&(this.left=m.fromSVG?p.left:g.x),m.top===void 0&&(this.top=m.fromSVG?p.top:g.y),this.pathOffset={x:p.left+this.width/2+v/2,y:p.top+this.height/2+v/2}},_calcDimensions:function(){var m=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,g=f(m,"x")||0,p=f(m,"y")||0;return{left:g,top:p,width:(r(m,"x")||0)-g,height:(r(m,"y")||0)-p}},toObject:function(m){return c(this.callSuper("toObject",m),{points:this.points.concat()})},_toSVG:function(){for(var m=[],g=this.pathOffset.x,p=this.pathOffset.y,v=l.Object.NUM_FRACTION_DIGITS,C=0,b=this.points.length;C<b;C++)m.push(s(this.points[C].x-g,v),",",s(this.points[C].y-p,v)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',m.join(""),`" />
`]},commonRender:function(m){var g,p=this.points.length,v=this.pathOffset.x,C=this.pathOffset.y;if(!p||isNaN(this.points[p-1].y))return!1;m.beginPath(),m.moveTo(this.points[0].x-v,this.points[0].y-C);for(var b=0;b<p;b++)g=this.points[b],m.lineTo(g.x-v,g.y-C);return!0},_render:function(m){this.commonRender(m)&&this._renderPaintInOrder(m)},complexity:function(){return this.get("points").length}}),l.Polyline.ATTRIBUTE_NAMES=l.SHARED_ATTRIBUTES.concat(),l.Polyline.fromElementGenerator=function(m){return function(g,p,v){if(!g)return p(null);v||(v={});var C=l.parsePointsAttribute(g.getAttribute("points")),b=l.parseAttributes(g,l[m].ATTRIBUTE_NAMES);b.fromSVG=!0,p(new l[m](C,c(b,v)))}},l.Polyline.fromElement=l.Polyline.fromElementGenerator("Polyline"),l.Polyline.fromObject=function(m,g){return l.Object._fromObject("Polyline",m,g,"points")})}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.util.projectStrokeOnPoints;l.Polygon?l.warn("fabric.Polygon is already defined"):(l.Polygon=l.util.createClass(l.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return c(this.points,this)},_render:function(f){this.commonRender(f)&&(f.closePath(),this._renderPaintInOrder(f))}}),l.Polygon.ATTRIBUTE_NAMES=l.SHARED_ATTRIBUTES.concat(),l.Polygon.fromElement=l.Polyline.fromElementGenerator("Polygon"),l.Polygon.fromObject=function(f,r){l.Object._fromObject("Polygon",f,r,"points")})}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.util.array.min,f=l.util.array.max,r=l.util.object.extend,s=l.util.object.clone,u=l.util.toFixed;l.Path?l.warn("fabric.Path is already defined"):(l.Path=l.util.createClass(l.Object,{type:"path",path:null,cacheProperties:l.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:l.Object.prototype.stateProperties.concat("path"),initialize:function(m,g){delete(g=s(g||{})).path,this.callSuper("initialize",g),this._setPath(m||[],g)},_setPath:function(m,g){this.path=l.util.makePathSimpler(Array.isArray(m)?m:l.util.parsePath(m)),l.Polyline.prototype._setPositionDimensions.call(this,g||{})},_renderPathCommands:function(m){var g,p=0,v=0,C=0,b=0,k=0,I=0,R=-this.pathOffset.x,N=-this.pathOffset.y;m.beginPath();for(var H=0,z=this.path.length;H<z;++H)switch((g=this.path[H])[0]){case"L":C=g[1],b=g[2],m.lineTo(C+R,b+N);break;case"M":p=C=g[1],v=b=g[2],m.moveTo(C+R,b+N);break;case"C":C=g[5],b=g[6],k=g[3],I=g[4],m.bezierCurveTo(g[1]+R,g[2]+N,k+R,I+N,C+R,b+N);break;case"Q":m.quadraticCurveTo(g[1]+R,g[2]+N,g[3]+R,g[4]+N),C=g[3],b=g[4],k=g[1],I=g[2];break;case"z":case"Z":C=p,b=v,m.closePath()}},_render:function(m){this._renderPathCommands(m),this._renderPaintInOrder(m)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(m){return r(this.callSuper("toObject",m),{path:this.path.map(function(g){return g.slice()})})},toDatalessObject:function(m){var g=this.toObject(["sourcePath"].concat(m));return g.sourcePath&&delete g.path,g},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',l.util.joinPath(this.path),'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var m=l.Object.NUM_FRACTION_DIGITS;return" translate("+u(-this.pathOffset.x,m)+", "+u(-this.pathOffset.y,m)+")"},toClipPathSVG:function(m){var g=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:m,additionalTransform:g})},toSVG:function(m){var g=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:m,additionalTransform:g})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var m,g,p=[],v=[],C=0,b=0,k=0,I=0,R=0,N=this.path.length;R<N;++R){switch((m=this.path[R])[0]){case"L":k=m[1],I=m[2],g=[];break;case"M":C=k=m[1],b=I=m[2],g=[];break;case"C":g=l.util.getBoundsOfCurve(k,I,m[1],m[2],m[3],m[4],m[5],m[6]),k=m[5],I=m[6];break;case"Q":g=l.util.getBoundsOfCurve(k,I,m[1],m[2],m[1],m[2],m[3],m[4]),k=m[3],I=m[4];break;case"z":case"Z":k=C,I=b}g.forEach(function(q){p.push(q.x),v.push(q.y)}),p.push(k),v.push(I)}var H=c(p)||0,z=c(v)||0;return{left:H,top:z,width:(f(p)||0)-H,height:(f(v)||0)-z}}}),l.Path.fromObject=function(m,g){if(typeof m.sourcePath=="string"){var p=m.sourcePath;l.loadSVGFromURL(p,function(v){var C=v[0];C.setOptions(m),g&&g(C)})}else l.Object._fromObject("Path",m,g,"path")},l.Path.ATTRIBUTE_NAMES=l.SHARED_ATTRIBUTES.concat(["d"]),l.Path.fromElement=function(m,g,p){var v=l.parseAttributes(m,l.Path.ATTRIBUTE_NAMES);v.fromSVG=!0,g(new l.Path(v.d,r(v,p)))})}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.util.array.min,f=l.util.array.max;l.Group||(l.Group=l.util.createClass(l.Object,l.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(r,s,u){s=s||{},this._objects=[],u&&this.callSuper("initialize",s),this._objects=r||[];for(var m=this._objects.length;m--;)this._objects[m].group=this;if(u)this._updateObjectsACoords();else{var g=s&&s.centerPoint;s.originX!==void 0&&(this.originX=s.originX),s.originY!==void 0&&(this.originY=s.originY),g||this._calcBounds(),this._updateObjectsCoords(g),delete s.centerPoint,this.callSuper("initialize",s)}this.setCoords()},_updateObjectsACoords:function(){for(var r=this._objects.length;r--;)this._objects[r].setCoords(!0)},_updateObjectsCoords:function(r){r=r||this.getCenterPoint();for(var s=this._objects.length;s--;)this._updateObjectCoords(this._objects[s],r)},_updateObjectCoords:function(r,s){var u=r.left,m=r.top;r.set({left:u-s.x,top:m-s.y}),r.group=this,r.setCoords(!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(r){var s=!!this.group;return this._restoreObjectsState(),l.util.resetObjectTransform(this),r&&(s&&l.util.removeTransformFromObject(r,this.group.calcTransformMatrix()),this._objects.push(r),r.group=this,r._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,s?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(r){return this._restoreObjectsState(),l.util.resetObjectTransform(this),this.remove(r),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(r){this.dirty=!0,r.group=this,r._set("canvas",this.canvas)},_onObjectRemoved:function(r){this.dirty=!0,delete r.group},_set:function(r,s){var u=this._objects.length;if(this.useSetOnGroup)for(;u--;)this._objects[u].setOnGroup(r,s);if(r==="canvas")for(;u--;)this._objects[u]._set(r,s);l.Object.prototype._set.call(this,r,s)},toObject:function(r){var s=this.includeDefaultValues,u=this._objects.filter(function(g){return!g.excludeFromExport}).map(function(g){var p=g.includeDefaultValues;g.includeDefaultValues=s;var v=g.toObject(r);return g.includeDefaultValues=p,v}),m=l.Object.prototype.toObject.call(this,r);return m.objects=u,m},toDatalessObject:function(r){var s,u=this.sourcePath;if(u)s=u;else{var m=this.includeDefaultValues;s=this._objects.map(function(p){var v=p.includeDefaultValues;p.includeDefaultValues=m;var C=p.toDatalessObject(r);return p.includeDefaultValues=v,C})}var g=l.Object.prototype.toDatalessObject.call(this,r);return g.objects=s,g},render:function(r){this._transformDone=!0,this.callSuper("render",r),this._transformDone=!1},shouldCache:function(){var r=l.Object.prototype.shouldCache.call(this);if(r){for(var s=0,u=this._objects.length;s<u;s++)if(this._objects[s].willDrawShadow())return this.ownCaching=!1,!1}return r},willDrawShadow:function(){if(l.Object.prototype.willDrawShadow.call(this))return!0;for(var r=0,s=this._objects.length;r<s;r++)if(this._objects[r].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(r){for(var s=0,u=this._objects.length;s<u;s++)this._objects[s].render(r);this._drawClipPath(r,this.clipPath)},isCacheDirty:function(r){if(this.callSuper("isCacheDirty",r))return!0;if(!this.statefullCache)return!1;for(var s=0,u=this._objects.length;s<u;s++)if(this._objects[s].isCacheDirty(!0)){if(this._cacheCanvas){var m=this.cacheWidth/this.zoomX,g=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-m/2,-g/2,m,g)}return!0}return!1},_restoreObjectsState:function(){var r=this.calcOwnMatrix();return this._objects.forEach(function(s){l.util.addTransformToObject(s,r),delete s.group,s.setCoords()}),this},destroy:function(){return this._objects.forEach(function(r){r.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(r){r.dispose&&r.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var r=this._objects,s=this.canvas;this._objects=[];var u=this.toObject();delete u.objects;var m=new l.ActiveSelection([]);return m.set(u),m.type="activeSelection",s.remove(this),r.forEach(function(g){g.group=m,g.dirty=!0,s.add(g)}),m.canvas=s,m._objects=r,s._activeObject=m,m.setCoords(),m}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject(function(r){r.setCoords(!0)}),this},_calcBounds:function(r){for(var s,u,m,g,p=[],v=[],C=["tr","br","bl","tl"],b=0,k=this._objects.length,I=C.length;b<k;++b){for(m=(s=this._objects[b]).calcACoords(),g=0;g<I;g++)u=C[g],p.push(m[u].x),v.push(m[u].y);s.aCoords=m}this._getBounds(p,v,r)},_getBounds:function(r,s,u){var m=new l.Point(c(r),c(s)),g=new l.Point(f(r),f(s)),p=m.y||0,v=m.x||0,C=g.x-m.x||0,b=g.y-m.y||0;this.width=C,this.height=b,u||this.setPositionByOrigin({x:v,y:p},"left","top")},_toSVG:function(r){for(var s=["<g ","COMMON_PARTS",` >
`],u=0,m=this._objects.length;u<m;u++)s.push("		",this._objects[u].toSVG(r));return s.push(`</g>
`),s},getSvgStyles:function(){var r=this.opacity!==void 0&&this.opacity!==1?"opacity: "+this.opacity+";":"",s=this.visible?"":" visibility: hidden;";return[r,this.getSvgFilter(),s].join("")},toClipPathSVG:function(r){for(var s=[],u=0,m=this._objects.length;u<m;u++)s.push("	",this._objects[u].toClipPathSVG(r));return this._createBaseClipPathSVGMarkup(s,{reviver:r})}}),l.Group.fromObject=function(r,s){var u=r.objects,m=l.util.object.clone(r,!0);delete m.objects,typeof u!="string"?l.util.enlivenObjects(u,function(g){var p=l.util.object.clone(r,!0);delete p.objects,l.util.enlivenObjectEnlivables(r,p,function(){s&&s(new l.Group(g,p,!0))})}):l.loadSVGFromURL(u,function(g){var p=l.util.groupSVGElements(g,r,u);p.set(m),s&&s(p)})})}(t),function(h){var l=h.fabric||(h.fabric={});l.ActiveSelection||(l.ActiveSelection=l.util.createClass(l.Group,{type:"activeSelection",initialize:function(c,f){f=f||{},this._objects=c||[];for(var r=this._objects.length;r--;)this._objects[r].group=this;f.originX&&(this.originX=f.originX),f.originY&&(this.originY=f.originY),this._calcBounds(),this._updateObjectsCoords(),l.Object.prototype.initialize.call(this,f),this.setCoords()},toGroup:function(){var c=this._objects.concat();this._objects=[];var f=l.Object.prototype.toObject.call(this),r=new l.Group([]);if(delete f.type,r.set(f),c.forEach(function(u){u.canvas.remove(u),u.group=r}),r._objects=c,!this.canvas)return r;var s=this.canvas;return s.add(r),s._activeObject=r,r.setCoords(),r},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(c,f,r){c.save(),c.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",c,f),(r=r||{}).hasControls===void 0&&(r.hasControls=!1),r.forActiveSelection=!0;for(var s=0,u=this._objects.length;s<u;s++)this._objects[s]._renderControls(c,r);c.restore()}}),l.ActiveSelection.fromObject=function(c,f){l.util.enlivenObjects(c.objects,function(r){delete c.objects,f&&f(new l.ActiveSelection(r,c,!0))})})}(t),function(h){var l=S.util.object.extend;h.fabric||(h.fabric={}),h.fabric.Image?S.warn("fabric.Image is already defined."):(S.Image=S.util.createClass(S.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:S.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:S.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(c,f){f||(f={}),this.filters=[],this.cacheKey="texture"+S.Object.__uid++,this.callSuper("initialize",f),this._initElement(c,f)},getElement:function(){return this._element||{}},setElement:function(c,f){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=c,this._originalElement=c,this._initConfig(f),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(c){var f=S.filterBackend;f&&f.evictCachesForKey&&f.evictCachesForKey(c)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(c){S.util.cleanUpJsdomNode(this[c]),this[c]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var c=this.getElement();return{width:c.naturalWidth||c.width,height:c.naturalHeight||c.height}},_stroke:function(c){if(this.stroke&&this.strokeWidth!==0){var f=this.width/2,r=this.height/2;c.beginPath(),c.moveTo(-f,-r),c.lineTo(f,-r),c.lineTo(f,r),c.lineTo(-f,r),c.lineTo(-f,-r),c.closePath()}},toObject:function(c){var f=[];this.filters.forEach(function(s){s&&f.push(s.toObject())});var r=l(this.callSuper("toObject",["cropX","cropY"].concat(c)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:f});return this.resizeFilter&&(r.resizeFilter=this.resizeFilter.toObject()),r},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var c,f=[],r=[],s=this._element,u=-this.width/2,m=-this.height/2,g="",p="";if(!s)return[];if(this.hasCrop()){var v=S.Object.__uid++;f.push('<clipPath id="imageCrop_'+v+`">
`,'	<rect x="'+u+'" y="'+m+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),g=' clip-path="url(#imageCrop_'+v+')" '}if(this.imageSmoothing||(p='" image-rendering="optimizeSpeed'),r.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',u-this.cropX,'" y="',m-this.cropY,'" width="',s.width||s.naturalWidth,'" height="',s.height||s.height,p,'"',g,`></image>
`),this.stroke||this.strokeDashArray){var C=this.fill;this.fill=null,c=["	<rect ",'x="',u,'" y="',m,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=C}return this.paintFirst!=="fill"?f.concat(c,r):f.concat(r,c)},getSrc:function(c){var f=c?this._element:this._originalElement;return f?f.toDataURL?f.toDataURL():this.srcFromAttribute?f.getAttribute("src"):f.src:this.src||""},setSrc:function(c,f,r){return S.util.loadImage(c,function(s,u){this.setElement(s,r),this._setWidthHeight(),f&&f(this,u)},this,r&&r.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var c=this.resizeFilter,f=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),s=r.scaleX,u=r.scaleY,m=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!c||s>f&&u>f)return this._element=m,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,void(this._lastScaleY=u);S.filterBackend||(S.filterBackend=S.initFilterBackend());var g=S.util.createCanvasElement(),p=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,v=m.width,C=m.height;g.width=v,g.height=C,this._element=g,this._lastScaleX=c.scaleX=s,this._lastScaleY=c.scaleY=u,S.filterBackend.applyFilters([c],m,v,C,this._element,p),this._filterScalingX=g.width/this._originalElement.width,this._filterScalingY=g.height/this._originalElement.height},applyFilters:function(c){if(c=(c=c||this.filters||[]).filter(function(m){return m&&!m.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),c.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var f=this._originalElement,r=f.naturalWidth||f.width,s=f.naturalHeight||f.height;if(this._element===this._originalElement){var u=S.util.createCanvasElement();u.width=r,u.height=s,this._element=u,this._filteredEl=u}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,s),this._lastScaleX=1,this._lastScaleY=1;return S.filterBackend||(S.filterBackend=S.initFilterBackend()),S.filterBackend.applyFilters(c,this._originalElement,r,s,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(c){S.util.setImageSmoothing(c,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(c),this._renderPaintInOrder(c)},drawCacheOnCanvas:function(c){S.util.setImageSmoothing(c,this.imageSmoothing),S.Object.prototype.drawCacheOnCanvas.call(this,c)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(c){var f=this._element;if(f){var r=this._filterScalingX,s=this._filterScalingY,u=this.width,m=this.height,g=Math.min,p=Math.max,v=p(this.cropX,0),C=p(this.cropY,0),b=f.naturalWidth||f.width,k=f.naturalHeight||f.height,I=v*r,R=C*s,N=g(u*r,b-I),H=g(m*s,k-R),z=-u/2,q=-m/2,J=g(u,b/r-v),$=g(m,k/s-C);f&&c.drawImage(f,I,R,N,H,z,q,J,$)}},_needsResize:function(){var c=this.getTotalObjectScaling();return c.scaleX!==this._lastScaleX||c.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(c,f){this.setElement(S.util.getById(c),f),S.util.addClass(this.getElement(),S.Image.CSS_CANVAS)},_initConfig:function(c){c||(c={}),this.setOptions(c),this._setWidthHeight(c)},_initFilters:function(c,f){c&&c.length?S.util.enlivenObjects(c,function(r){f&&f(r)},"fabric.Image.filters"):f&&f()},_setWidthHeight:function(c){c||(c={});var f=this.getElement();this.width=c.width||f.naturalWidth||f.width||0,this.height=c.height||f.naturalHeight||f.height||0},parsePreserveAspectRatioAttribute:function(){var c,f=S.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),r=this._element.width,s=this._element.height,u=1,m=1,g=0,p=0,v=0,C=0,b=this.width,k=this.height,I={width:b,height:k};return!f||f.alignX==="none"&&f.alignY==="none"?(u=b/r,m=k/s):(f.meetOrSlice==="meet"&&(c=(b-r*(u=m=S.util.findScaleToFit(this._element,I)))/2,f.alignX==="Min"&&(g=-c),f.alignX==="Max"&&(g=c),c=(k-s*m)/2,f.alignY==="Min"&&(p=-c),f.alignY==="Max"&&(p=c)),f.meetOrSlice==="slice"&&(c=r-b/(u=m=S.util.findScaleToCover(this._element,I)),f.alignX==="Mid"&&(v=c/2),f.alignX==="Max"&&(v=c),c=s-k/m,f.alignY==="Mid"&&(C=c/2),f.alignY==="Max"&&(C=c),r=b/u,s=k/m)),{width:r,height:s,scaleX:u,scaleY:m,offsetLeft:g,offsetTop:p,cropX:v,cropY:C}}}),S.Image.CSS_CANVAS="canvas-img",S.Image.prototype.getSvgSrc=S.Image.prototype.getSrc,S.Image.fromObject=function(c,f){var r=S.util.object.clone(c);S.util.loadImage(r.src,function(s,u){u?f&&f(null,!0):S.Image.prototype._initFilters.call(r,r.filters,function(m){r.filters=m||[],S.Image.prototype._initFilters.call(r,[r.resizeFilter],function(g){r.resizeFilter=g[0],S.util.enlivenObjectEnlivables(r,r,function(){var p=new S.Image(s,r);f(p,!1)})})})},null,r.crossOrigin)},S.Image.fromURL=function(c,f,r){S.util.loadImage(c,function(s,u){f&&f(new S.Image(s,r),u)},null,r&&r.crossOrigin)},S.Image.ATTRIBUTE_NAMES=S.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),S.Image.fromElement=function(c,f,r){var s=S.parseAttributes(c,S.Image.ATTRIBUTE_NAMES);S.Image.fromURL(s["xlink:href"],f,l(r?S.util.object.clone(r):{},s))})}(t),S.util.object.extend(S.Object.prototype,{_getAngleValueForStraighten:function(){var h=this.angle%360;return h>0?90*Math.round((h-1)/90):90*Math.round(h/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(h){var l=function(){},c=(h=h||{}).onComplete||l,f=h.onChange||l,r=this;return S.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(s){r.rotate(s),f()},onComplete:function(){r.setCoords(),c()}})}}),S.util.object.extend(S.StaticCanvas.prototype,{straightenObject:function(h){return h.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(h){return h.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function h(c,f){var r="precision "+f+` float;
void main(){}`,s=c.createShader(c.FRAGMENT_SHADER);return c.shaderSource(s,r),c.compileShader(s),!!c.getShaderParameter(s,c.COMPILE_STATUS)}function l(c){c&&c.tileSize&&(this.tileSize=c.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}S.isWebglSupported=function(c){if(S.isLikelyNode)return!1;c=c||S.WebglFilterBackend.prototype.tileSize;var f=document.createElement("canvas"),r=f.getContext("webgl")||f.getContext("experimental-webgl"),s=!1;if(r){S.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),s=S.maxTextureSize>=c;for(var u=["highp","mediump","lowp"],m=0;m<3;m++)if(h(r,u[m])){S.webGlPrecision=u[m];break}}return this.isSupported=s,s},S.WebglFilterBackend=l,l.prototype={tileSize:2048,resources:{},setupGLContext:function(c,f){this.dispose(),this.createWebGLCanvas(c,f),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(c,f)},chooseFastestCopyGLTo2DMethod:function(c,f){var r,s=window.performance!==void 0;try{new ImageData(1,1),r=!0}catch{r=!1}var u=typeof ArrayBuffer<"u",m=typeof Uint8ClampedArray<"u";if(s&&r&&u&&m){var g=S.util.createCanvasElement(),p=new ArrayBuffer(c*f*4);if(S.forceGLPutImageData)return this.imageBuffer=p,void(this.copyGLTo2D=Ce);var v,C,b={imageBuffer:p,destinationWidth:c,destinationHeight:f,targetCanvas:g};g.width=c,g.height=f,v=window.performance.now(),le.call(b,this.gl,b),C=window.performance.now()-v,v=window.performance.now(),Ce.call(b,this.gl,b),C>window.performance.now()-v?(this.imageBuffer=p,this.copyGLTo2D=Ce):this.copyGLTo2D=le}},createWebGLCanvas:function(c,f){var r=S.util.createCanvasElement();r.width=c,r.height=f;var s={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},u=r.getContext("webgl",s);u||(u=r.getContext("experimental-webgl",s)),u&&(u.clearColor(0,0,0,0),this.canvas=r,this.gl=u)},applyFilters:function(c,f,r,s,u,m){var g,p=this.gl;m&&(g=this.getCachedTexture(m,f));var v={originalWidth:f.width||f.originalWidth,originalHeight:f.height||f.originalHeight,sourceWidth:r,sourceHeight:s,destinationWidth:r,destinationHeight:s,context:p,sourceTexture:this.createTexture(p,r,s,!g&&f),targetTexture:this.createTexture(p,r,s),originalTexture:g||this.createTexture(p,r,s,!g&&f),passes:c.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:u},C=p.createFramebuffer();return p.bindFramebuffer(p.FRAMEBUFFER,C),c.forEach(function(b){b&&b.applyTo(v)}),function(b){var k=b.targetCanvas,I=k.width,R=k.height,N=b.destinationWidth,H=b.destinationHeight;I===N&&R===H||(k.width=N,k.height=H)}(v),this.copyGLTo2D(p,v),p.bindTexture(p.TEXTURE_2D,null),p.deleteTexture(v.sourceTexture),p.deleteTexture(v.targetTexture),p.deleteFramebuffer(C),u.getContext("2d").setTransform(1,0,0,1,0,0),v},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(c,f,r,s){var u=c.createTexture();return c.bindTexture(c.TEXTURE_2D,u),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),s?c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,s):c.texImage2D(c.TEXTURE_2D,0,c.RGBA,f,r,0,c.RGBA,c.UNSIGNED_BYTE,null),u},getCachedTexture:function(c,f){if(this.textureCache[c])return this.textureCache[c];var r=this.createTexture(this.gl,f.width,f.height,f);return this.textureCache[c]=r,r},evictCachesForKey:function(c){this.textureCache[c]&&(this.gl.deleteTexture(this.textureCache[c]),delete this.textureCache[c])},copyGLTo2D:le,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var c=this.gl,f={renderer:"",vendor:""};if(!c)return f;var r=c.getExtension("WEBGL_debug_renderer_info");if(r){var s=c.getParameter(r.UNMASKED_RENDERER_WEBGL),u=c.getParameter(r.UNMASKED_VENDOR_WEBGL);s&&(f.renderer=s.toLowerCase()),u&&(f.vendor=u.toLowerCase())}return this.gpuInfo=f,f}}}(),function(){var h=function(){};function l(){}S.Canvas2dFilterBackend=l,l.prototype={evictCachesForKey:h,dispose:h,clearWebGLCaches:h,resources:{},applyFilters:function(c,f,r,s,u){var m=u.getContext("2d");m.drawImage(f,0,0,r,s);var g={sourceWidth:r,sourceHeight:s,imageData:m.getImageData(0,0,r,s),originalEl:f,originalImageData:m.getImageData(0,0,r,s),canvasEl:u,ctx:m,filterBackend:this};return c.forEach(function(p){p.applyTo(g)}),g.imageData.width===r&&g.imageData.height===s||(u.width=g.imageData.width,u.height=g.imageData.height),m.putImageData(g.imageData,0,0),g}}}(),S.Image=S.Image||{},S.Image.filters=S.Image.filters||{},S.Image.filters.BaseFilter=S.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(h){h&&this.setOptions(h)},setOptions:function(h){for(var l in h)this[l]=h[l]},createProgram:function(h,l,c){l=l||this.fragmentSource,c=c||this.vertexSource,S.webGlPrecision!=="highp"&&(l=l.replace(/precision highp float/g,"precision "+S.webGlPrecision+" float"));var f=h.createShader(h.VERTEX_SHADER);if(h.shaderSource(f,c),h.compileShader(f),!h.getShaderParameter(f,h.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+h.getShaderInfoLog(f));var r=h.createShader(h.FRAGMENT_SHADER);if(h.shaderSource(r,l),h.compileShader(r),!h.getShaderParameter(r,h.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+h.getShaderInfoLog(r));var s=h.createProgram();if(h.attachShader(s,f),h.attachShader(s,r),h.linkProgram(s),!h.getProgramParameter(s,h.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+h.getProgramInfoLog(s));var u=this.getAttributeLocations(h,s),m=this.getUniformLocations(h,s)||{};return m.uStepW=h.getUniformLocation(s,"uStepW"),m.uStepH=h.getUniformLocation(s,"uStepH"),{program:s,attributeLocations:u,uniformLocations:m}},getAttributeLocations:function(h,l){return{aPosition:h.getAttribLocation(l,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(h,l,c){var f=l.aPosition,r=h.createBuffer();h.bindBuffer(h.ARRAY_BUFFER,r),h.enableVertexAttribArray(f),h.vertexAttribPointer(f,2,h.FLOAT,!1,0,0),h.bufferData(h.ARRAY_BUFFER,c,h.STATIC_DRAW)},_setupFrameBuffer:function(h){var l,c,f=h.context;h.passes>1?(l=h.destinationWidth,c=h.destinationHeight,h.sourceWidth===l&&h.sourceHeight===c||(f.deleteTexture(h.targetTexture),h.targetTexture=h.filterBackend.createTexture(f,l,c)),f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,h.targetTexture,0)):(f.bindFramebuffer(f.FRAMEBUFFER,null),f.finish())},_swapTextures:function(h){h.passes--,h.pass++;var l=h.targetTexture;h.targetTexture=h.sourceTexture,h.sourceTexture=l},isNeutralState:function(){var h=this.mainParameter,l=S.Image.filters[this.type].prototype;if(h){if(Array.isArray(l[h])){for(var c=l[h].length;c--;)if(this[h][c]!==l[h][c])return!1;return!0}return l[h]===this[h]}return!1},applyTo:function(h){h.webgl?(this._setupFrameBuffer(h),this.applyToWebGL(h),this._swapTextures(h)):this.applyTo2d(h)},retrieveShader:function(h){return h.programCache.hasOwnProperty(this.type)||(h.programCache[this.type]=this.createProgram(h.context)),h.programCache[this.type]},applyToWebGL:function(h){var l=h.context,c=this.retrieveShader(h);h.pass===0&&h.originalTexture?l.bindTexture(l.TEXTURE_2D,h.originalTexture):l.bindTexture(l.TEXTURE_2D,h.sourceTexture),l.useProgram(c.program),this.sendAttributeData(l,c.attributeLocations,h.aPosition),l.uniform1f(c.uniformLocations.uStepW,1/h.sourceWidth),l.uniform1f(c.uniformLocations.uStepH,1/h.sourceHeight),this.sendUniformData(l,c.uniformLocations),l.viewport(0,0,h.destinationWidth,h.destinationHeight),l.drawArrays(l.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(h,l,c){h.activeTexture(c),h.bindTexture(h.TEXTURE_2D,l),h.activeTexture(h.TEXTURE0)},unbindAdditionalTexture:function(h,l){h.activeTexture(l),h.bindTexture(h.TEXTURE_2D,null),h.activeTexture(h.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(h){this[this.mainParameter]=h},sendUniformData:function(){},createHelpLayer:function(h){if(!h.helpLayer){var l=document.createElement("canvas");l.width=h.sourceWidth,l.height=h.sourceHeight,h.helpLayer=l}},toObject:function(){var h={type:this.type},l=this.mainParameter;return l&&(h[l]=this[l]),h},toJSON:function(){return this.toObject()}}),S.Image.filters.BaseFilter.fromObject=function(h,l){var c=new S.Image.filters[h.type](h);return l&&l(c),c},function(h){var l=h.fabric||(h.fabric={}),c=l.Image.filters,f=l.util.createClass;c.ColorMatrix=f(c.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(r){this.callSuper("initialize",r),this.matrix=this.matrix.slice(0)},applyTo2d:function(r){var s,u,m,g,p,v=r.imageData.data,C=v.length,b=this.matrix,k=this.colorsOnly;for(p=0;p<C;p+=4)s=v[p],u=v[p+1],m=v[p+2],k?(v[p]=s*b[0]+u*b[1]+m*b[2]+255*b[4],v[p+1]=s*b[5]+u*b[6]+m*b[7]+255*b[9],v[p+2]=s*b[10]+u*b[11]+m*b[12]+255*b[14]):(g=v[p+3],v[p]=s*b[0]+u*b[1]+m*b[2]+g*b[3]+255*b[4],v[p+1]=s*b[5]+u*b[6]+m*b[7]+g*b[8]+255*b[9],v[p+2]=s*b[10]+u*b[11]+m*b[12]+g*b[13]+255*b[14],v[p+3]=s*b[15]+u*b[16]+m*b[17]+g*b[18]+255*b[19])},getUniformLocations:function(r,s){return{uColorMatrix:r.getUniformLocation(s,"uColorMatrix"),uConstants:r.getUniformLocation(s,"uConstants")}},sendUniformData:function(r,s){var u=this.matrix,m=[u[0],u[1],u[2],u[3],u[5],u[6],u[7],u[8],u[10],u[11],u[12],u[13],u[15],u[16],u[17],u[18]],g=[u[4],u[9],u[14],u[19]];r.uniformMatrix4fv(s.uColorMatrix,!1,m),r.uniform4fv(s.uConstants,g)}}),l.Image.filters.ColorMatrix.fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.Image.filters,f=l.util.createClass;c.Brightness=f(c.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(r){if(this.brightness!==0){var s,u=r.imageData.data,m=u.length,g=Math.round(255*this.brightness);for(s=0;s<m;s+=4)u[s]=u[s]+g,u[s+1]=u[s+1]+g,u[s+2]=u[s+2]+g}},getUniformLocations:function(r,s){return{uBrightness:r.getUniformLocation(s,"uBrightness")}},sendUniformData:function(r,s){r.uniform1f(s.uBrightness,this.brightness)}}),l.Image.filters.Brightness.fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.util.object.extend,f=l.Image.filters,r=l.util.createClass;f.Convolute=r(f.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(s){var u=Math.sqrt(this.matrix.length),m=this.type+"_"+u+"_"+(this.opaque?1:0),g=this.fragmentSource[m];return s.programCache.hasOwnProperty(m)||(s.programCache[m]=this.createProgram(s.context,g)),s.programCache[m]},applyTo2d:function(s){var u,m,g,p,v,C,b,k,I,R,N,H,z,q=s.imageData,J=q.data,$=this.matrix,V=Math.round(Math.sqrt($.length)),j=Math.floor(V/2),X=q.width,Q=q.height,ie=s.ctx.createImageData(X,Q),G=ie.data,U=this.opaque?1:0;for(N=0;N<Q;N++)for(R=0;R<X;R++){for(v=4*(N*X+R),u=0,m=0,g=0,p=0,z=0;z<V;z++)for(H=0;H<V;H++)C=R+H-j,(b=N+z-j)<0||b>=Q||C<0||C>=X||(k=4*(b*X+C),I=$[z*V+H],u+=J[k]*I,m+=J[k+1]*I,g+=J[k+2]*I,U||(p+=J[k+3]*I));G[v]=u,G[v+1]=m,G[v+2]=g,G[v+3]=U?J[v+3]:p}s.imageData=ie},getUniformLocations:function(s,u){return{uMatrix:s.getUniformLocation(u,"uMatrix"),uOpaque:s.getUniformLocation(u,"uOpaque"),uHalfSize:s.getUniformLocation(u,"uHalfSize"),uSize:s.getUniformLocation(u,"uSize")}},sendUniformData:function(s,u){s.uniform1fv(u.uMatrix,this.matrix)},toObject:function(){return c(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),l.Image.filters.Convolute.fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.Image.filters,f=l.util.createClass;c.Grayscale=f(c.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(r){var s,u,m=r.imageData.data,g=m.length,p=this.mode;for(s=0;s<g;s+=4)p==="average"?u=(m[s]+m[s+1]+m[s+2])/3:p==="lightness"?u=(Math.min(m[s],m[s+1],m[s+2])+Math.max(m[s],m[s+1],m[s+2]))/2:p==="luminosity"&&(u=.21*m[s]+.72*m[s+1]+.07*m[s+2]),m[s]=u,m[s+1]=u,m[s+2]=u},retrieveShader:function(r){var s=this.type+"_"+this.mode;if(!r.programCache.hasOwnProperty(s)){var u=this.fragmentSource[this.mode];r.programCache[s]=this.createProgram(r.context,u)}return r.programCache[s]},getUniformLocations:function(r,s){return{uMode:r.getUniformLocation(s,"uMode")}},sendUniformData:function(r,s){r.uniform1i(s.uMode,1)},isNeutralState:function(){return!1}}),l.Image.filters.Grayscale.fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.Image.filters,f=l.util.createClass;c.Invert=f(c.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(r){var s,u=r.imageData.data,m=u.length;for(s=0;s<m;s+=4)u[s]=255-u[s],u[s+1]=255-u[s+1],u[s+2]=255-u[s+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(r,s){return{uInvert:r.getUniformLocation(s,"uInvert")}},sendUniformData:function(r,s){r.uniform1i(s.uInvert,this.invert)}}),l.Image.filters.Invert.fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.util.object.extend,f=l.Image.filters,r=l.util.createClass;f.Noise=r(f.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(s){if(this.noise!==0){var u,m,g=s.imageData.data,p=g.length,v=this.noise;for(u=0,p=g.length;u<p;u+=4)m=(.5-Math.random())*v,g[u]+=m,g[u+1]+=m,g[u+2]+=m}},getUniformLocations:function(s,u){return{uNoise:s.getUniformLocation(u,"uNoise"),uSeed:s.getUniformLocation(u,"uSeed")}},sendUniformData:function(s,u){s.uniform1f(u.uNoise,this.noise/255),s.uniform1f(u.uSeed,Math.random())},toObject:function(){return c(this.callSuper("toObject"),{noise:this.noise})}}),l.Image.filters.Noise.fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.Image.filters,f=l.util.createClass;c.Pixelate=f(c.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(r){var s,u,m,g,p,v,C,b,k,I,R,N=r.imageData,H=N.data,z=N.height,q=N.width;for(u=0;u<z;u+=this.blocksize)for(m=0;m<q;m+=this.blocksize)for(g=H[s=4*u*q+4*m],p=H[s+1],v=H[s+2],C=H[s+3],I=Math.min(u+this.blocksize,z),R=Math.min(m+this.blocksize,q),b=u;b<I;b++)for(k=m;k<R;k++)H[s=4*b*q+4*k]=g,H[s+1]=p,H[s+2]=v,H[s+3]=C},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(r,s){return{uBlocksize:r.getUniformLocation(s,"uBlocksize"),uStepW:r.getUniformLocation(s,"uStepW"),uStepH:r.getUniformLocation(s,"uStepH")}},sendUniformData:function(r,s){r.uniform1f(s.uBlocksize,this.blocksize)}}),l.Image.filters.Pixelate.fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.util.object.extend,f=l.Image.filters,r=l.util.createClass;f.RemoveColor=r(f.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(s){var u,m,g,p,v=s.imageData.data,C=255*this.distance,b=new l.Color(this.color).getSource(),k=[b[0]-C,b[1]-C,b[2]-C],I=[b[0]+C,b[1]+C,b[2]+C];for(u=0;u<v.length;u+=4)m=v[u],g=v[u+1],p=v[u+2],m>k[0]&&g>k[1]&&p>k[2]&&m<I[0]&&g<I[1]&&p<I[2]&&(v[u+3]=0)},getUniformLocations:function(s,u){return{uLow:s.getUniformLocation(u,"uLow"),uHigh:s.getUniformLocation(u,"uHigh")}},sendUniformData:function(s,u){var m=new l.Color(this.color).getSource(),g=parseFloat(this.distance),p=[0+m[0]/255-g,0+m[1]/255-g,0+m[2]/255-g,1],v=[m[0]/255+g,m[1]/255+g,m[2]/255+g,1];s.uniform4fv(u.uLow,p),s.uniform4fv(u.uHigh,v)},toObject:function(){return c(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),l.Image.filters.RemoveColor.fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.Image.filters,f=l.util.createClass,r={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var s in r)c[s]=f(c.ColorMatrix,{type:s,matrix:r[s],mainParameter:!1,colorsOnly:!0}),l.Image.filters[s].fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric,c=l.Image.filters,f=l.util.createClass;c.BlendColor=f(c.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(r){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[r]+`}
}`},retrieveShader:function(r){var s,u=this.type+"_"+this.mode;return r.programCache.hasOwnProperty(u)||(s=this.buildSource(this.mode),r.programCache[u]=this.createProgram(r.context,s)),r.programCache[u]},applyTo2d:function(r){var s,u,m,g,p,v,C,b=r.imageData.data,k=b.length,I=1-this.alpha;s=(C=new l.Color(this.color).getSource())[0]*this.alpha,u=C[1]*this.alpha,m=C[2]*this.alpha;for(var R=0;R<k;R+=4)switch(g=b[R],p=b[R+1],v=b[R+2],this.mode){case"multiply":b[R]=g*s/255,b[R+1]=p*u/255,b[R+2]=v*m/255;break;case"screen":b[R]=255-(255-g)*(255-s)/255,b[R+1]=255-(255-p)*(255-u)/255,b[R+2]=255-(255-v)*(255-m)/255;break;case"add":b[R]=g+s,b[R+1]=p+u,b[R+2]=v+m;break;case"diff":case"difference":b[R]=Math.abs(g-s),b[R+1]=Math.abs(p-u),b[R+2]=Math.abs(v-m);break;case"subtract":b[R]=g-s,b[R+1]=p-u,b[R+2]=v-m;break;case"darken":b[R]=Math.min(g,s),b[R+1]=Math.min(p,u),b[R+2]=Math.min(v,m);break;case"lighten":b[R]=Math.max(g,s),b[R+1]=Math.max(p,u),b[R+2]=Math.max(v,m);break;case"overlay":b[R]=s<128?2*g*s/255:255-2*(255-g)*(255-s)/255,b[R+1]=u<128?2*p*u/255:255-2*(255-p)*(255-u)/255,b[R+2]=m<128?2*v*m/255:255-2*(255-v)*(255-m)/255;break;case"exclusion":b[R]=s+g-2*s*g/255,b[R+1]=u+p-2*u*p/255,b[R+2]=m+v-2*m*v/255;break;case"tint":b[R]=s+g*I,b[R+1]=u+p*I,b[R+2]=m+v*I}},getUniformLocations:function(r,s){return{uColor:r.getUniformLocation(s,"uColor")}},sendUniformData:function(r,s){var u=new l.Color(this.color).getSource();u[0]=this.alpha*u[0]/255,u[1]=this.alpha*u[1]/255,u[2]=this.alpha*u[2]/255,u[3]=this.alpha,r.uniform4fv(s.uColor,u)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),l.Image.filters.BlendColor.fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric,c=l.Image.filters,f=l.util.createClass;c.BlendImage=f(c.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(r){var s=this.type+"_"+this.mode,u=this.fragmentSource[this.mode];return r.programCache.hasOwnProperty(s)||(r.programCache[s]=this.createProgram(r.context,u)),r.programCache[s]},applyToWebGL:function(r){var s=r.context,u=this.createTexture(r.filterBackend,this.image);this.bindAdditionalTexture(s,u,s.TEXTURE1),this.callSuper("applyToWebGL",r),this.unbindAdditionalTexture(s,s.TEXTURE1)},createTexture:function(r,s){return r.getCachedTexture(s.cacheKey,s._element)},calculateMatrix:function(){var r=this.image,s=r._element.width,u=r._element.height;return[1/r.scaleX,0,0,0,1/r.scaleY,0,-r.left/s,-r.top/u,1]},applyTo2d:function(r){var s,u,m,g,p,v,C,b,k,I,R,N=r.imageData,H=r.filterBackend.resources,z=N.data,q=z.length,J=N.width,$=N.height,V=this.image;H.blendImage||(H.blendImage=l.util.createCanvasElement()),I=(k=H.blendImage).getContext("2d"),k.width!==J||k.height!==$?(k.width=J,k.height=$):I.clearRect(0,0,J,$),I.setTransform(V.scaleX,0,0,V.scaleY,V.left,V.top),I.drawImage(V._element,0,0,J,$),R=I.getImageData(0,0,J,$).data;for(var j=0;j<q;j+=4)switch(p=z[j],v=z[j+1],C=z[j+2],b=z[j+3],s=R[j],u=R[j+1],m=R[j+2],g=R[j+3],this.mode){case"multiply":z[j]=p*s/255,z[j+1]=v*u/255,z[j+2]=C*m/255,z[j+3]=b*g/255;break;case"mask":z[j+3]=g}},getUniformLocations:function(r,s){return{uTransformMatrix:r.getUniformLocation(s,"uTransformMatrix"),uImage:r.getUniformLocation(s,"uImage")}},sendUniformData:function(r,s){var u=this.calculateMatrix();r.uniform1i(s.uImage,1),r.uniformMatrix3fv(s.uTransformMatrix,!1,u)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),l.Image.filters.BlendImage.fromObject=function(r,s){l.Image.fromObject(r.image,function(u){var m=l.util.object.clone(r);m.image=u,s(new l.Image.filters.BlendImage(m))})}}(t),function(h){var l=h.fabric||(h.fabric={}),c=Math.pow,f=Math.floor,r=Math.sqrt,s=Math.abs,u=Math.round,m=Math.sin,g=Math.ceil,p=l.Image.filters,v=l.util.createClass;p.Resize=v(p.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(C,b){return{uDelta:C.getUniformLocation(b,"uDelta"),uTaps:C.getUniformLocation(b,"uTaps")}},sendUniformData:function(C,b){C.uniform2fv(b.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),C.uniform1fv(b.uTaps,this.taps)},retrieveShader:function(C){var b=this.getFilterWindow(),k=this.type+"_"+b;if(!C.programCache.hasOwnProperty(k)){var I=this.generateShader(b);C.programCache[k]=this.createProgram(C.context,I)}return C.programCache[k]},getFilterWindow:function(){var C=this.tempScale;return Math.ceil(this.lanczosLobes/C)},getTaps:function(){for(var C=this.lanczosCreate(this.lanczosLobes),b=this.tempScale,k=this.getFilterWindow(),I=new Array(k),R=1;R<=k;R++)I[R-1]=C(R*b);return I},generateShader:function(C){for(var b=new Array(C),k=this.fragmentSourceTOP,I=1;I<=C;I++)b[I-1]=I+".0 * uDelta";return k+="uniform float uTaps["+C+`];
`,k+=`void main() {
`,k+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,k+=`  float sum = 1.0;
`,b.forEach(function(R,N){k+="  color += texture2D(uTexture, vTexCoord + "+R+") * uTaps["+N+`];
`,k+="  color += texture2D(uTexture, vTexCoord - "+R+") * uTaps["+N+`];
`,k+="  sum += 2.0 * uTaps["+N+`];
`}),k+=`  gl_FragColor = color / sum;
`,k+="}"},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(C){C.webgl?(C.passes++,this.width=C.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=C.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),C.destinationWidth=this.dW,this._setupFrameBuffer(C),this.applyToWebGL(C),this._swapTextures(C),C.sourceWidth=C.destinationWidth,this.height=C.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),C.destinationHeight=this.dH,this._setupFrameBuffer(C),this.applyToWebGL(C),this._swapTextures(C),C.sourceHeight=C.destinationHeight):this.applyTo2d(C)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(C){return function(b){if(b>=C||b<=-C)return 0;if(b<11920929e-14&&b>-11920929e-14)return 1;var k=(b*=Math.PI)/C;return m(b)/b*m(k)/k}},applyTo2d:function(C){var b=C.imageData,k=this.scaleX,I=this.scaleY;this.rcpScaleX=1/k,this.rcpScaleY=1/I;var R,N=b.width,H=b.height,z=u(N*k),q=u(H*I);this.resizeType==="sliceHack"?R=this.sliceByTwo(C,N,H,z,q):this.resizeType==="hermite"?R=this.hermiteFastResize(C,N,H,z,q):this.resizeType==="bilinear"?R=this.bilinearFiltering(C,N,H,z,q):this.resizeType==="lanczos"&&(R=this.lanczosResize(C,N,H,z,q)),C.imageData=R},sliceByTwo:function(C,b,k,I,R){var N,H,z=C.imageData,q=.5,J=!1,$=!1,V=b*q,j=k*q,X=l.filterBackend.resources,Q=0,ie=0,G=b,U=0;for(X.sliceByTwo||(X.sliceByTwo=document.createElement("canvas")),((N=X.sliceByTwo).width<1.5*b||N.height<k)&&(N.width=1.5*b,N.height=k),(H=N.getContext("2d")).clearRect(0,0,1.5*b,k),H.putImageData(z,0,0),I=f(I),R=f(R);!J||!$;)b=V,k=j,I<f(V*q)?V=f(V*q):(V=I,J=!0),R<f(j*q)?j=f(j*q):(j=R,$=!0),H.drawImage(N,Q,ie,b,k,G,U,V,j),Q=G,ie=U,U+=j;return H.getImageData(Q,ie,I,R)},lanczosResize:function(C,b,k,I,R){var N=C.imageData.data,H=C.ctx.createImageData(I,R),z=H.data,q=this.lanczosCreate(this.lanczosLobes),J=this.rcpScaleX,$=this.rcpScaleY,V=2/this.rcpScaleX,j=2/this.rcpScaleY,X=g(J*this.lanczosLobes/2),Q=g($*this.lanczosLobes/2),ie={},G={},U={};return function Z(re){var ee,se,_e,ge,he,fe,pe,me,ye,ve,be;for(G.x=(re+.5)*J,U.x=f(G.x),ee=0;ee<R;ee++){for(G.y=(ee+.5)*$,U.y=f(G.y),he=0,fe=0,pe=0,me=0,ye=0,se=U.x-X;se<=U.x+X;se++)if(!(se<0||se>=b)){ve=f(1e3*s(se-G.x)),ie[ve]||(ie[ve]={});for(var Oe=U.y-Q;Oe<=U.y+Q;Oe++)Oe<0||Oe>=k||(be=f(1e3*s(Oe-G.y)),ie[ve][be]||(ie[ve][be]=q(r(c(ve*V,2)+c(be*j,2))/1e3)),(_e=ie[ve][be])>0&&(he+=_e,fe+=_e*N[ge=4*(Oe*b+se)],pe+=_e*N[ge+1],me+=_e*N[ge+2],ye+=_e*N[ge+3]))}z[ge=4*(ee*I+re)]=fe/he,z[ge+1]=pe/he,z[ge+2]=me/he,z[ge+3]=ye/he}return++re<I?Z(re):H}(0)},bilinearFiltering:function(C,b,k,I,R){var N,H,z,q,J,$,V,j,X,Q=0,ie=this.rcpScaleX,G=this.rcpScaleY,U=4*(b-1),Z=C.imageData.data,re=C.ctx.createImageData(I,R),ee=re.data;for(z=0;z<R;z++)for(q=0;q<I;q++)for(J=ie*q-(N=f(ie*q)),$=G*z-(H=f(G*z)),X=4*(H*b+N),V=0;V<4;V++)j=Z[X+V]*(1-J)*(1-$)+Z[X+4+V]*J*(1-$)+Z[X+U+V]*$*(1-J)+Z[X+U+4+V]*J*$,ee[Q++]=j;return re},hermiteFastResize:function(C,b,k,I,R){for(var N=this.rcpScaleX,H=this.rcpScaleY,z=g(N/2),q=g(H/2),J=C.imageData.data,$=C.ctx.createImageData(I,R),V=$.data,j=0;j<R;j++)for(var X=0;X<I;X++){for(var Q=4*(X+j*I),ie=0,G=0,U=0,Z=0,re=0,ee=0,se=0,_e=(j+.5)*H,ge=f(j*H);ge<(j+1)*H;ge++)for(var he=s(_e-(ge+.5))/q,fe=(X+.5)*N,pe=he*he,me=f(X*N);me<(X+1)*N;me++){var ye=s(fe-(me+.5))/z,ve=r(pe+ye*ye);ve>1&&ve<-1||(ie=2*ve*ve*ve-3*ve*ve+1)>0&&(se+=ie*J[3+(ye=4*(me+ge*b))],U+=ie,J[ye+3]<255&&(ie=ie*J[ye+3]/250),Z+=ie*J[ye],re+=ie*J[ye+1],ee+=ie*J[ye+2],G+=ie)}V[Q]=Z/G,V[Q+1]=re/G,V[Q+2]=ee/G,V[Q+3]=se/U}return $},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),l.Image.filters.Resize.fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.Image.filters,f=l.util.createClass;c.Contrast=f(c.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(r){if(this.contrast!==0){var s,u=r.imageData.data,m=u.length,g=Math.floor(255*this.contrast),p=259*(g+255)/(255*(259-g));for(s=0;s<m;s+=4)u[s]=p*(u[s]-128)+128,u[s+1]=p*(u[s+1]-128)+128,u[s+2]=p*(u[s+2]-128)+128}},getUniformLocations:function(r,s){return{uContrast:r.getUniformLocation(s,"uContrast")}},sendUniformData:function(r,s){r.uniform1f(s.uContrast,this.contrast)}}),l.Image.filters.Contrast.fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.Image.filters,f=l.util.createClass;c.Saturation=f(c.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(r){if(this.saturation!==0){var s,u,m=r.imageData.data,g=m.length,p=-this.saturation;for(s=0;s<g;s+=4)u=Math.max(m[s],m[s+1],m[s+2]),m[s]+=u!==m[s]?(u-m[s])*p:0,m[s+1]+=u!==m[s+1]?(u-m[s+1])*p:0,m[s+2]+=u!==m[s+2]?(u-m[s+2])*p:0}},getUniformLocations:function(r,s){return{uSaturation:r.getUniformLocation(s,"uSaturation")}},sendUniformData:function(r,s){r.uniform1f(s.uSaturation,-this.saturation)}}),l.Image.filters.Saturation.fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.Image.filters,f=l.util.createClass;c.Vibrance=f(c.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(r){if(this.vibrance!==0){var s,u,m,g,p=r.imageData.data,v=p.length,C=-this.vibrance;for(s=0;s<v;s+=4)u=Math.max(p[s],p[s+1],p[s+2]),m=(p[s]+p[s+1]+p[s+2])/3,g=2*Math.abs(u-m)/255*C,p[s]+=u!==p[s]?(u-p[s])*g:0,p[s+1]+=u!==p[s+1]?(u-p[s+1])*g:0,p[s+2]+=u!==p[s+2]?(u-p[s+2])*g:0}},getUniformLocations:function(r,s){return{uVibrance:r.getUniformLocation(s,"uVibrance")}},sendUniformData:function(r,s){r.uniform1f(s.uVibrance,-this.vibrance)}}),l.Image.filters.Vibrance.fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.Image.filters,f=l.util.createClass;c.Blur=f(c.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(r){r.webgl?(this.aspectRatio=r.sourceWidth/r.sourceHeight,r.passes++,this._setupFrameBuffer(r),this.horizontal=!0,this.applyToWebGL(r),this._swapTextures(r),this._setupFrameBuffer(r),this.horizontal=!1,this.applyToWebGL(r),this._swapTextures(r)):this.applyTo2d(r)},applyTo2d:function(r){r.imageData=this.simpleBlur(r)},simpleBlur:function(r){var s,u,m=r.filterBackend.resources,g=r.imageData.width,p=r.imageData.height;m.blurLayer1||(m.blurLayer1=l.util.createCanvasElement(),m.blurLayer2=l.util.createCanvasElement()),s=m.blurLayer1,u=m.blurLayer2,s.width===g&&s.height===p||(u.width=s.width=g,u.height=s.height=p);var v,C,b,k,I=s.getContext("2d"),R=u.getContext("2d"),N=.06*this.blur*.5;for(I.putImageData(r.imageData,0,0),R.clearRect(0,0,g,p),k=-15;k<=15;k++)b=N*(C=k/15)*g+(v=(Math.random()-.5)/4),R.globalAlpha=1-Math.abs(C),R.drawImage(s,b,v),I.drawImage(u,0,0),R.globalAlpha=1,R.clearRect(0,0,u.width,u.height);for(k=-15;k<=15;k++)b=N*(C=k/15)*p+(v=(Math.random()-.5)/4),R.globalAlpha=1-Math.abs(C),R.drawImage(s,v,b),I.drawImage(u,0,0),R.globalAlpha=1,R.clearRect(0,0,u.width,u.height);r.ctx.drawImage(s,0,0);var H=r.ctx.getImageData(0,0,s.width,s.height);return I.globalAlpha=1,I.clearRect(0,0,s.width,s.height),H},getUniformLocations:function(r,s){return{delta:r.getUniformLocation(s,"uDelta")}},sendUniformData:function(r,s){var u=this.chooseRightDelta();r.uniform2fv(s.delta,u)},chooseRightDelta:function(){var r,s=1,u=[0,0];return this.horizontal?this.aspectRatio>1&&(s=1/this.aspectRatio):this.aspectRatio<1&&(s=this.aspectRatio),r=s*this.blur*.12,this.horizontal?u[0]=r:u[1]=r,u}}),c.Blur.fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.Image.filters,f=l.util.createClass;c.Gamma=f(c.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(r){this.gamma=[1,1,1],c.BaseFilter.prototype.initialize.call(this,r)},applyTo2d:function(r){var s,u=r.imageData.data,m=this.gamma,g=u.length,p=1/m[0],v=1/m[1],C=1/m[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),s=0,g=256;s<g;s++)this.rVals[s]=255*Math.pow(s/255,p),this.gVals[s]=255*Math.pow(s/255,v),this.bVals[s]=255*Math.pow(s/255,C);for(s=0,g=u.length;s<g;s+=4)u[s]=this.rVals[u[s]],u[s+1]=this.gVals[u[s+1]],u[s+2]=this.bVals[u[s+2]]},getUniformLocations:function(r,s){return{uGamma:r.getUniformLocation(s,"uGamma")}},sendUniformData:function(r,s){r.uniform3fv(s.uGamma,this.gamma)}}),l.Image.filters.Gamma.fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.Image.filters,f=l.util.createClass;c.Composed=f(c.BaseFilter,{type:"Composed",subFilters:[],initialize:function(r){this.callSuper("initialize",r),this.subFilters=this.subFilters.slice(0)},applyTo:function(r){r.passes+=this.subFilters.length-1,this.subFilters.forEach(function(s){s.applyTo(r)})},toObject:function(){return l.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(r){return r.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(r){return!r.isNeutralState()})}}),l.Image.filters.Composed.fromObject=function(r,s){var u=(r.subFilters||[]).map(function(g){return new l.Image.filters[g.type](g)}),m=new l.Image.filters.Composed({subFilters:u});return s&&s(m),m}}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.Image.filters,f=l.util.createClass;c.HueRotation=f(c.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var r=this.rotation*Math.PI,s=l.util.cos(r),u=l.util.sin(r),m=1/3,g=Math.sqrt(m)*u,p=1-s;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=s+p/3,this.matrix[1]=m*p-g,this.matrix[2]=m*p+g,this.matrix[5]=m*p+g,this.matrix[6]=s+m*p,this.matrix[7]=m*p-g,this.matrix[10]=m*p-g,this.matrix[11]=m*p+g,this.matrix[12]=s+m*p},isNeutralState:function(r){return this.calculateMatrix(),c.BaseFilter.prototype.isNeutralState.call(this,r)},applyTo:function(r){this.calculateMatrix(),c.BaseFilter.prototype.applyTo.call(this,r)}}),l.Image.filters.HueRotation.fromObject=l.Image.filters.BaseFilter.fromObject}(t),function(h){var l=h.fabric||(h.fabric={}),c=l.util.object.clone;if(l.Text)l.warn("fabric.Text is already defined");else{var f="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");l.Text=l.util.createClass(l.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:l.Object.prototype.stateProperties.concat(f),cacheProperties:l.Object.prototype.cacheProperties.concat(f),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(r,s){this.styles=s&&s.styles||{},this.text=r,this.__skipDimension=!0,this.callSuper("initialize",s),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var r=this.path;r&&(r.segmentsInfo=l.util.getPathSegmentsInfo(r.path))},getMeasuringContext:function(){return l._measuringContext||(l._measuringContext=this.canvas&&this.canvas.contextCache||l.util.createCanvasElement().getContext("2d")),l._measuringContext},_splitText:function(){var r=this._splitTextIntoLines(this.text);return this.textLines=r.lines,this._textLines=r.graphemeLines,this._unwrappedTextLines=r._unwrappedLines,this._text=r.graphemeText,r},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var r,s,u,m,g,p,v,C=0,b=this._textLines.length;C<b;C++)if((this.textAlign==="justify"||C!==b-1&&!this.isEndOfWrapping(C))&&(m=0,g=this._textLines[C],(s=this.getLineWidth(C))<this.width&&(v=this.textLines[C].match(this._reSpacesAndTabs)))){u=v.length,r=(this.width-s)/u;for(var k=0,I=g.length;k<=I;k++)p=this.__charBounds[C][k],this._reSpaceAndTab.test(g[k])?(p.width+=r,p.kernedWidth+=r,p.left+=m,m+=r):p.left+=m}},isEndOfWrapping:function(r){return r===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var r=this.callSuper("_getCacheCanvasDimensions"),s=this.fontSize;return r.width+=s*r.zoomX,r.height+=s*r.zoomY,r},_render:function(r){var s=this.path;s&&!s.isNotVisible()&&s._render(r),this._setTextStyles(r),this._renderTextLinesBackground(r),this._renderTextDecoration(r,"underline"),this._renderText(r),this._renderTextDecoration(r,"overline"),this._renderTextDecoration(r,"linethrough")},_renderText:function(r){this.paintFirst==="stroke"?(this._renderTextStroke(r),this._renderTextFill(r)):(this._renderTextFill(r),this._renderTextStroke(r))},_setTextStyles:function(r,s,u){if(r.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":r.textBaseline="middle";break;case"ascender":r.textBaseline="top";break;case"descender":r.textBaseline="bottom"}r.font=this._getFontDeclaration(s,u)},calcTextWidth:function(){for(var r=this.getLineWidth(0),s=1,u=this._textLines.length;s<u;s++){var m=this.getLineWidth(s);m>r&&(r=m)}return r},_renderTextLine:function(r,s,u,m,g,p){this._renderChars(r,s,u,m,g,p)},_renderTextLinesBackground:function(r){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var s,u,m,g,p,v,C,b=r.fillStyle,k=this._getLeftOffset(),I=this._getTopOffset(),R=0,N=0,H=this.path,z=0,q=this._textLines.length;z<q;z++)if(s=this.getHeightOfLine(z),this.textBackgroundColor||this.styleHas("textBackgroundColor",z)){m=this._textLines[z],u=this._getLineLeftOffset(z),N=0,R=0,g=this.getValueOfPropertyAt(z,0,"textBackgroundColor");for(var J=0,$=m.length;J<$;J++)p=this.__charBounds[z][J],v=this.getValueOfPropertyAt(z,J,"textBackgroundColor"),H?(r.save(),r.translate(p.renderLeft,p.renderTop),r.rotate(p.angle),r.fillStyle=v,v&&r.fillRect(-p.width/2,-s/this.lineHeight*(1-this._fontSizeFraction),p.width,s/this.lineHeight),r.restore()):v!==g?(C=k+u+R,this.direction==="rtl"&&(C=this.width-C-N),r.fillStyle=g,g&&r.fillRect(C,I,N,s/this.lineHeight),R=p.left,N=p.width,g=v):N+=p.kernedWidth;v&&!H&&(C=k+u+R,this.direction==="rtl"&&(C=this.width-C-N),r.fillStyle=v,r.fillRect(C,I,N,s/this.lineHeight)),I+=s}else I+=s;r.fillStyle=b,this._removeShadow(r)}},getFontCache:function(r){var s=r.fontFamily.toLowerCase();l.charWidthsCache[s]||(l.charWidthsCache[s]={});var u=l.charWidthsCache[s],m=r.fontStyle.toLowerCase()+"_"+(r.fontWeight+"").toLowerCase();return u[m]||(u[m]={}),u[m]},_measureChar:function(r,s,u,m){var g,p,v,C,b=this.getFontCache(s),k=u+r,I=this._getFontDeclaration(s)===this._getFontDeclaration(m),R=s.fontSize/this.CACHE_FONT_SIZE;if(u&&b[u]!==void 0&&(v=b[u]),b[r]!==void 0&&(C=g=b[r]),I&&b[k]!==void 0&&(C=(p=b[k])-v),g===void 0||v===void 0||p===void 0){var N=this.getMeasuringContext();this._setTextStyles(N,s,!0)}return g===void 0&&(C=g=N.measureText(r).width,b[r]=g),v===void 0&&I&&u&&(v=N.measureText(u).width,b[u]=v),I&&p===void 0&&(p=N.measureText(k).width,b[k]=p,C=p-v),{width:g*R,kernedWidth:C*R}},getHeightOfChar:function(r,s){return this.getValueOfPropertyAt(r,s,"fontSize")},measureLine:function(r){var s=this._measureLine(r);return this.charSpacing!==0&&(s.width-=this._getWidthOfCharSpacing()),s.width<0&&(s.width=0),s},_measureLine:function(r){var s,u,m,g,p,v,C=0,b=this._textLines[r],k=new Array(b.length),I=0,R=this.path,N=this.pathSide==="right";for(this.__charBounds[r]=k,s=0;s<b.length;s++)u=b[s],g=this._getGraphemeBox(u,r,s,m),k[s]=g,C+=g.kernedWidth,m=u;if(k[s]={left:g?g.left+g.width:0,width:0,kernedWidth:0,height:this.fontSize},R){switch(v=R.segmentsInfo[R.segmentsInfo.length-1].length,(p=l.util.getPointOnPath(R.path,0,R.segmentsInfo)).x+=R.pathOffset.x,p.y+=R.pathOffset.y,this.textAlign){case"left":I=N?v-C:0;break;case"center":I=(v-C)/2;break;case"right":I=N?0:v-C}for(I+=this.pathStartOffset*(N?-1:1),s=N?b.length-1:0;N?s>=0:s<b.length;N?s--:s++)g=k[s],I>v?I%=v:I<0&&(I+=v),this._setGraphemeOnPath(I,g,p),I+=g.kernedWidth}return{width:C,numOfSpaces:0}},_setGraphemeOnPath:function(r,s,u){var m=r+s.kernedWidth/2,g=this.path,p=l.util.getPointOnPath(g.path,m,g.segmentsInfo);s.renderLeft=p.x-u.x,s.renderTop=p.y-u.y,s.angle=p.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(r,s,u,m,g){var p,v=this.getCompleteStyleDeclaration(s,u),C=m?this.getCompleteStyleDeclaration(s,u-1):{},b=this._measureChar(r,v,m,C),k=b.kernedWidth,I=b.width;this.charSpacing!==0&&(I+=p=this._getWidthOfCharSpacing(),k+=p);var R={width:I,left:0,height:v.fontSize,kernedWidth:k,deltaY:v.deltaY};if(u>0&&!g){var N=this.__charBounds[s][u-1];R.left=N.left+N.width+b.kernedWidth-b.width}return R},getHeightOfLine:function(r){if(this.__lineHeights[r])return this.__lineHeights[r];for(var s=this._textLines[r],u=this.getHeightOfChar(r,0),m=1,g=s.length;m<g;m++)u=Math.max(this.getHeightOfChar(r,m),u);return this.__lineHeights[r]=u*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var r,s=0,u=0,m=this._textLines.length;u<m;u++)r=this.getHeightOfLine(u),s+=u===m-1?r/this.lineHeight:r;return s},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(r,s){r.save();for(var u=0,m=this._getLeftOffset(),g=this._getTopOffset(),p=0,v=this._textLines.length;p<v;p++){var C=this.getHeightOfLine(p),b=C/this.lineHeight,k=this._getLineLeftOffset(p);this._renderTextLine(s,r,this._textLines[p],m+k,g+u+b,p),u+=C}r.restore()},_renderTextFill:function(r){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(r,"fillText")},_renderTextStroke:function(r){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(r),r.save(),this._setLineDash(r,this.strokeDashArray),r.beginPath(),this._renderTextCommon(r,"strokeText"),r.closePath(),r.restore())},_renderChars:function(r,s,u,m,g,p){var v,C,b,k,I,R=this.getHeightOfLine(p),N=this.textAlign.indexOf("justify")!==-1,H="",z=0,q=this.path,J=!N&&this.charSpacing===0&&this.isEmptyStyles(p)&&!q,$=this.direction==="ltr",V=this.direction==="ltr"?1:-1,j=s.canvas.getAttribute("dir");if(s.save(),j!==this.direction&&(s.canvas.setAttribute("dir",$?"ltr":"rtl"),s.direction=$?"ltr":"rtl",s.textAlign=$?"left":"right"),g-=R*this._fontSizeFraction/this.lineHeight,J)return this._renderChar(r,s,p,0,u.join(""),m,g,R),void s.restore();for(var X=0,Q=u.length-1;X<=Q;X++)k=X===Q||this.charSpacing||q,H+=u[X],b=this.__charBounds[p][X],z===0?(m+=V*(b.kernedWidth-b.width),z+=b.width):z+=b.kernedWidth,N&&!k&&this._reSpaceAndTab.test(u[X])&&(k=!0),k||(v=v||this.getCompleteStyleDeclaration(p,X),C=this.getCompleteStyleDeclaration(p,X+1),k=this._hasStyleChanged(v,C)),k&&(q?(s.save(),s.translate(b.renderLeft,b.renderTop),s.rotate(b.angle),this._renderChar(r,s,p,X,H,-z/2,0,R),s.restore()):(I=m,this._renderChar(r,s,p,X,H,I,g,R)),H="",v=C,m+=V*z,z=0);s.restore()},_applyPatternGradientTransformText:function(r){var s,u=l.util.createCanvasElement(),m=this.width+this.strokeWidth,g=this.height+this.strokeWidth;return u.width=m,u.height=g,(s=u.getContext("2d")).beginPath(),s.moveTo(0,0),s.lineTo(m,0),s.lineTo(m,g),s.lineTo(0,g),s.closePath(),s.translate(m/2,g/2),s.fillStyle=r.toLive(s),this._applyPatternGradientTransform(s,r),s.fill(),s.createPattern(u,"no-repeat")},handleFiller:function(r,s,u){var m,g;return u.toLive?u.gradientUnits==="percentage"||u.gradientTransform||u.patternTransform?(m=-this.width/2,g=-this.height/2,r.translate(m,g),r[s]=this._applyPatternGradientTransformText(u),{offsetX:m,offsetY:g}):(r[s]=u.toLive(r,this),this._applyPatternGradientTransform(r,u)):(r[s]=u,{offsetX:0,offsetY:0})},_setStrokeStyles:function(r,s){return r.lineWidth=s.strokeWidth,r.lineCap=this.strokeLineCap,r.lineDashOffset=this.strokeDashOffset,r.lineJoin=this.strokeLineJoin,r.miterLimit=this.strokeMiterLimit,this.handleFiller(r,"strokeStyle",s.stroke)},_setFillStyles:function(r,s){return this.handleFiller(r,"fillStyle",s.fill)},_renderChar:function(r,s,u,m,g,p,v){var C,b,k=this._getStyleDeclaration(u,m),I=this.getCompleteStyleDeclaration(u,m),R=r==="fillText"&&I.fill,N=r==="strokeText"&&I.stroke&&I.strokeWidth;(N||R)&&(s.save(),R&&(C=this._setFillStyles(s,I)),N&&(b=this._setStrokeStyles(s,I)),s.font=this._getFontDeclaration(I),k&&k.textBackgroundColor&&this._removeShadow(s),k&&k.deltaY&&(v+=k.deltaY),R&&s.fillText(g,p-C.offsetX,v-C.offsetY),N&&s.strokeText(g,p-b.offsetX,v-b.offsetY),s.restore())},setSuperscript:function(r,s){return this._setScript(r,s,this.superscript)},setSubscript:function(r,s){return this._setScript(r,s,this.subscript)},_setScript:function(r,s,u){var m=this.get2DCursorLocation(r,!0),g=this.getValueOfPropertyAt(m.lineIndex,m.charIndex,"fontSize"),p=this.getValueOfPropertyAt(m.lineIndex,m.charIndex,"deltaY"),v={fontSize:g*u.size,deltaY:p+g*u.baseline};return this.setSelectionStyles(v,r,s),this},_hasStyleChanged:function(r,s){return r.fill!==s.fill||r.stroke!==s.stroke||r.strokeWidth!==s.strokeWidth||r.fontSize!==s.fontSize||r.fontFamily!==s.fontFamily||r.fontWeight!==s.fontWeight||r.fontStyle!==s.fontStyle||r.deltaY!==s.deltaY},_hasStyleChangedForSvg:function(r,s){return this._hasStyleChanged(r,s)||r.overline!==s.overline||r.underline!==s.underline||r.linethrough!==s.linethrough},_getLineLeftOffset:function(r){var s=this.getLineWidth(r),u=this.width-s,m=this.textAlign,g=this.direction,p=0,v=this.isEndOfWrapping(r);return m==="justify"||m==="justify-center"&&!v||m==="justify-right"&&!v||m==="justify-left"&&!v?0:(m==="center"&&(p=u/2),m==="right"&&(p=u),m==="justify-center"&&(p=u/2),m==="justify-right"&&(p=u),g==="rtl"&&(p-=u),p)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var r=this._forceClearCache;return r||(r=this.hasStateChanged("_dimensionAffectingProps")),r&&(this.dirty=!0,this._forceClearCache=!1),r},getLineWidth:function(r){if(this.__lineWidths[r]!==void 0)return this.__lineWidths[r];var s=this.measureLine(r).width;return this.__lineWidths[r]=s,s},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(r,s,u){var m=this._getStyleDeclaration(r,s);return m&&m[u]!==void 0?m[u]:this[u]},_renderTextDecoration:function(r,s){if(this[s]||this.styleHas(s)){for(var u,m,g,p,v,C,b,k,I,R,N,H,z,q,J,$,V=this._getLeftOffset(),j=this._getTopOffset(),X=this.path,Q=this._getWidthOfCharSpacing(),ie=this.offsets[s],G=0,U=this._textLines.length;G<U;G++)if(u=this.getHeightOfLine(G),this[s]||this.styleHas(s,G)){b=this._textLines[G],q=u/this.lineHeight,p=this._getLineLeftOffset(G),R=0,N=0,k=this.getValueOfPropertyAt(G,0,s),$=this.getValueOfPropertyAt(G,0,"fill"),I=j+q*(1-this._fontSizeFraction),m=this.getHeightOfChar(G,0),v=this.getValueOfPropertyAt(G,0,"deltaY");for(var Z=0,re=b.length;Z<re;Z++)if(H=this.__charBounds[G][Z],z=this.getValueOfPropertyAt(G,Z,s),J=this.getValueOfPropertyAt(G,Z,"fill"),g=this.getHeightOfChar(G,Z),C=this.getValueOfPropertyAt(G,Z,"deltaY"),X&&z&&J)r.save(),r.fillStyle=$,r.translate(H.renderLeft,H.renderTop),r.rotate(H.angle),r.fillRect(-H.kernedWidth/2,ie*g+C,H.kernedWidth,this.fontSize/15),r.restore();else if((z!==k||J!==$||g!==m||C!==v)&&N>0){var ee=V+p+R;this.direction==="rtl"&&(ee=this.width-ee-N),k&&$&&(r.fillStyle=$,r.fillRect(ee,I+ie*m+v,N,this.fontSize/15)),R=H.left,N=H.width,k=z,$=J,m=g,v=C}else N+=H.kernedWidth;ee=V+p+R,this.direction==="rtl"&&(ee=this.width-ee-N),r.fillStyle=J,z&&J&&r.fillRect(ee,I+ie*m+v,N-Q,this.fontSize/15),j+=u}else j+=u;this._removeShadow(r)}},_getFontDeclaration:function(r,s){var u=r||this,m=this.fontFamily,g=l.Text.genericFonts.indexOf(m.toLowerCase())>-1,p=m===void 0||m.indexOf("'")>-1||m.indexOf(",")>-1||m.indexOf('"')>-1||g?u.fontFamily:'"'+u.fontFamily+'"';return[l.isLikelyNode?u.fontWeight:u.fontStyle,l.isLikelyNode?u.fontStyle:u.fontWeight,s?this.CACHE_FONT_SIZE+"px":u.fontSize+"px",p].join(" ")},render:function(r){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",r)))},_splitTextIntoLines:function(r){for(var s=r.split(this._reNewline),u=new Array(s.length),m=[`
`],g=[],p=0;p<s.length;p++)u[p]=l.util.string.graphemeSplit(s[p]),g=g.concat(u[p],m);return g.pop(),{_unwrappedLines:u,lines:s,graphemeText:g,graphemeLines:u}},toObject:function(r){var s=f.concat(r),u=this.callSuper("toObject",s);return u.styles=c(this.styles,!0),u.path&&(u.path=this.path.toObject()),u},set:function(r,s){this.callSuper("set",r,s);var u=!1,m=!1;if(typeof r=="object")for(var g in r)g==="path"&&this.setPathInfo(),u=u||this._dimensionAffectingProps.indexOf(g)!==-1,m=m||g==="path";else u=this._dimensionAffectingProps.indexOf(r)!==-1,m=r==="path";return m&&this.setPathInfo(),u&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),l.Text.ATTRIBUTE_NAMES=l.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),l.Text.DEFAULT_SVG_FONT_SIZE=16,l.Text.fromElement=function(r,s,u){if(!r)return s(null);var m=l.parseAttributes(r,l.Text.ATTRIBUTE_NAMES),g=m.textAnchor||"left";if((u=l.util.object.extend(u?c(u):{},m)).top=u.top||0,u.left=u.left||0,m.textDecoration){var p=m.textDecoration;p.indexOf("underline")!==-1&&(u.underline=!0),p.indexOf("overline")!==-1&&(u.overline=!0),p.indexOf("line-through")!==-1&&(u.linethrough=!0),delete u.textDecoration}"dx"in m&&(u.left+=m.dx),"dy"in m&&(u.top+=m.dy),"fontSize"in u||(u.fontSize=l.Text.DEFAULT_SVG_FONT_SIZE);var v="";"textContent"in r?v=r.textContent:"firstChild"in r&&r.firstChild!==null&&"data"in r.firstChild&&r.firstChild.data!==null&&(v=r.firstChild.data),v=v.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var C=u.strokeWidth;u.strokeWidth=0;var b=new l.Text(v,u),k=b.getScaledHeight()/b.height,I=((b.height+b.strokeWidth)*b.lineHeight-b.height)*k,R=b.getScaledHeight()+I,N=0;g==="center"&&(N=b.getScaledWidth()/2),g==="right"&&(N=b.getScaledWidth()),b.set({left:b.left-N,top:b.top-(R-b.fontSize*(.07+b._fontSizeFraction))/b.lineHeight,strokeWidth:C!==void 0?C:1}),s(b)},l.Text.fromObject=function(r,s){var u=c(r),m=r.path;return delete u.path,l.Object._fromObject("Text",u,function(g){m?l.Object._fromObject("Path",m,function(p){g.set("path",p),s(g)},"path"):s(g)},"text")},l.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],l.util.createAccessors&&l.util.createAccessors(l.Text)}}(t),S.util.object.extend(S.Text.prototype,{isEmptyStyles:function(h){if(!this.styles||h!==void 0&&!this.styles[h])return!0;var l=h===void 0?this.styles:{line:this.styles[h]};for(var c in l)for(var f in l[c])for(var r in l[c][f])return!1;return!0},styleHas:function(h,l){if(!this.styles||!h||h===""||l!==void 0&&!this.styles[l])return!1;var c=l===void 0?this.styles:{0:this.styles[l]};for(var f in c)for(var r in c[f])if(c[f][r][h]!==void 0)return!0;return!1},cleanStyle:function(h){if(!this.styles||!h||h==="")return!1;var l,c,f=this.styles,r=0,s=!0,u=0;for(var m in f){for(var g in l=0,f[m]){var p;r++,(p=f[m][g]).hasOwnProperty(h)?(c?p[h]!==c&&(s=!1):c=p[h],p[h]===this[h]&&delete p[h]):s=!1,Object.keys(p).length!==0?l++:delete f[m][g]}l===0&&delete f[m]}for(var v=0;v<this._textLines.length;v++)u+=this._textLines[v].length;s&&r===u&&(this[h]=c,this.removeStyle(h))},removeStyle:function(h){if(this.styles&&h&&h!==""){var l,c,f,r=this.styles;for(c in r){for(f in l=r[c])delete l[f][h],Object.keys(l[f]).length===0&&delete l[f];Object.keys(l).length===0&&delete r[c]}}},_extendStyles:function(h,l){var c=this.get2DCursorLocation(h);this._getLineStyle(c.lineIndex)||this._setLineStyle(c.lineIndex),this._getStyleDeclaration(c.lineIndex,c.charIndex)||this._setStyleDeclaration(c.lineIndex,c.charIndex,{}),S.util.object.extend(this._getStyleDeclaration(c.lineIndex,c.charIndex),l)},get2DCursorLocation:function(h,l){h===void 0&&(h=this.selectionStart);for(var c=l?this._unwrappedTextLines:this._textLines,f=c.length,r=0;r<f;r++){if(h<=c[r].length)return{lineIndex:r,charIndex:h};h-=c[r].length+this.missingNewlineOffset(r)}return{lineIndex:r-1,charIndex:c[r-1].length<h?c[r-1].length:h}},getSelectionStyles:function(h,l,c){h===void 0&&(h=this.selectionStart||0),l===void 0&&(l=this.selectionEnd||h);for(var f=[],r=h;r<l;r++)f.push(this.getStyleAtPosition(r,c));return f},getStyleAtPosition:function(h,l){var c=this.get2DCursorLocation(h);return(l?this.getCompleteStyleDeclaration(c.lineIndex,c.charIndex):this._getStyleDeclaration(c.lineIndex,c.charIndex))||{}},setSelectionStyles:function(h,l,c){l===void 0&&(l=this.selectionStart||0),c===void 0&&(c=this.selectionEnd||l);for(var f=l;f<c;f++)this._extendStyles(f,h);return this._forceClearCache=!0,this},_getStyleDeclaration:function(h,l){var c=this.styles&&this.styles[h];return c?c[l]:null},getCompleteStyleDeclaration:function(h,l){for(var c,f=this._getStyleDeclaration(h,l)||{},r={},s=0;s<this._styleProperties.length;s++)r[c=this._styleProperties[s]]=f[c]===void 0?this[c]:f[c];return r},_setStyleDeclaration:function(h,l,c){this.styles[h][l]=c},_deleteStyleDeclaration:function(h,l){delete this.styles[h][l]},_getLineStyle:function(h){return!!this.styles[h]},_setLineStyle:function(h){this.styles[h]={}},_deleteLineStyle:function(h){delete this.styles[h]}}),function(){function h(l){l.textDecoration&&(l.textDecoration.indexOf("underline")>-1&&(l.underline=!0),l.textDecoration.indexOf("line-through")>-1&&(l.linethrough=!0),l.textDecoration.indexOf("overline")>-1&&(l.overline=!0),delete l.textDecoration)}S.IText=S.util.createClass(S.Text,S.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(l,c){this.callSuper("initialize",l,c),this.initBehavior()},setSelectionStart:function(l){l=Math.max(l,0),this._updateAndFire("selectionStart",l)},setSelectionEnd:function(l){l=Math.min(l,this.text.length),this._updateAndFire("selectionEnd",l)},_updateAndFire:function(l,c){this[l]!==c&&(this._fireSelectionChanged(),this[l]=c),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(l){this.clearContextTop(),this.callSuper("render",l),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(l){this.callSuper("_render",l)},clearContextTop:function(l){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var c=this.canvas.contextTop,f=this.canvas.viewportTransform;c.save(),c.transform(f[0],f[1],f[2],f[3],f[4],f[5]),this.transform(c),this._clearTextArea(c),l||c.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var l=this._getCursorBoundaries(),c=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(l,c):this.renderSelection(l,c),c.restore()}},_clearTextArea:function(l){var c=this.width+4,f=this.height+4;l.clearRect(-c/2,-f/2,c,f)},_getCursorBoundaries:function(l){l===void 0&&(l=this.selectionStart);var c=this._getLeftOffset(),f=this._getTopOffset(),r=this._getCursorBoundariesOffsets(l);return{left:c,top:f,leftOffset:r.left,topOffset:r.top}},_getCursorBoundariesOffsets:function(l){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var c,f,r,s,u=0,m=0,g=this.get2DCursorLocation(l);r=g.charIndex,f=g.lineIndex;for(var p=0;p<f;p++)u+=this.getHeightOfLine(p);c=this._getLineLeftOffset(f);var v=this.__charBounds[f][r];return v&&(m=v.left),this.charSpacing!==0&&r===this._textLines[f].length&&(m-=this._getWidthOfCharSpacing()),s={top:u,left:c+(m>0?m:0)},this.direction==="rtl"&&(s.left*=-1),this.cursorOffsetCache=s,this.cursorOffsetCache},renderCursor:function(l,c){var f=this.get2DCursorLocation(),r=f.lineIndex,s=f.charIndex>0?f.charIndex-1:0,u=this.getValueOfPropertyAt(r,s,"fontSize"),m=this.scaleX*this.canvas.getZoom(),g=this.cursorWidth/m,p=l.topOffset,v=this.getValueOfPropertyAt(r,s,"deltaY");p+=(1-this._fontSizeFraction)*this.getHeightOfLine(r)/this.lineHeight-u*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(l,c),c.fillStyle=this.cursorColor||this.getValueOfPropertyAt(r,s,"fill"),c.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,c.fillRect(l.left+l.leftOffset-g/2,p+l.top+v,g,u)},renderSelection:function(l,c){for(var f=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,r=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,s=this.textAlign.indexOf("justify")!==-1,u=this.get2DCursorLocation(f),m=this.get2DCursorLocation(r),g=u.lineIndex,p=m.lineIndex,v=u.charIndex<0?0:u.charIndex,C=m.charIndex<0?0:m.charIndex,b=g;b<=p;b++){var k,I=this._getLineLeftOffset(b)||0,R=this.getHeightOfLine(b),N=0,H=0;if(b===g&&(N=this.__charBounds[g][v].left),b>=g&&b<p)H=s&&!this.isEndOfWrapping(b)?this.width:this.getLineWidth(b)||5;else if(b===p)if(C===0)H=this.__charBounds[p][C].left;else{var z=this._getWidthOfCharSpacing();H=this.__charBounds[p][C-1].left+this.__charBounds[p][C-1].width-z}k=R,(this.lineHeight<1||b===p&&this.lineHeight>1)&&(R/=this.lineHeight);var q=l.left+I+N,J=H-N,$=R,V=0;this.inCompositionMode?(c.fillStyle=this.compositionColor||"black",$=1,V=R):c.fillStyle=this.selectionColor,this.direction==="rtl"&&(q=this.width-q-J),c.fillRect(q,l.top+l.topOffset+V,J,$),l.topOffset+=k}},getCurrentCharFontSize:function(){var l=this._getCurrentCharIndex();return this.getValueOfPropertyAt(l.l,l.c,"fontSize")},getCurrentCharColor:function(){var l=this._getCurrentCharIndex();return this.getValueOfPropertyAt(l.l,l.c,"fill")},_getCurrentCharIndex:function(){var l=this.get2DCursorLocation(this.selectionStart,!0),c=l.charIndex>0?l.charIndex-1:0;return{l:l.lineIndex,c}}}),S.IText.fromObject=function(l,c){if(h(l),l.styles)for(var f in l.styles)for(var r in l.styles[f])h(l.styles[f][r]);S.Object._fromObject("IText",l,c,"text")}}(),K=S.util.object.clone,S.util.object.extend(S.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var h=this;this.on("added",function(){var l=h.canvas;l&&(l._hasITextHandlers||(l._hasITextHandlers=!0,h._initCanvasHandlers(l)),l._iTextInstances=l._iTextInstances||[],l._iTextInstances.push(h))})},initRemovedHandler:function(){var h=this;this.on("removed",function(){var l=h.canvas;l&&(l._iTextInstances=l._iTextInstances||[],S.util.removeFromArray(l._iTextInstances,h),l._iTextInstances.length===0&&(l._hasITextHandlers=!1,h._removeCanvasHandlers(l)))})},_initCanvasHandlers:function(h){h._mouseUpITextHandler=function(){h._iTextInstances&&h._iTextInstances.forEach(function(l){l.__isMousedown=!1})},h.on("mouse:up",h._mouseUpITextHandler)},_removeCanvasHandlers:function(h){h.off("mouse:up",h._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(h,l,c,f){var r;return r={isAborted:!1,abort:function(){this.isAborted=!0}},h.animate("_currentCursorOpacity",l,{duration:c,onComplete:function(){r.isAborted||h[f]()},onChange:function(){h.canvas&&h.selectionStart===h.selectionEnd&&h.renderCursorOrSelection()},abort:function(){return r.isAborted}}),r},_onTickComplete:function(){var h=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){h._currentTickCompleteState=h._animateCursor(h,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(h){var l=this,c=h?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){l._tick()},c)},abortCursorAnimation:function(){var h=this._currentTickState||this._currentTickCompleteState,l=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,h&&l&&l.clearContext(l.contextTop||l.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(h){var l=0,c=h-1;if(this._reSpace.test(this._text[c]))for(;this._reSpace.test(this._text[c]);)l++,c--;for(;/\S/.test(this._text[c])&&c>-1;)l++,c--;return h-l},findWordBoundaryRight:function(h){var l=0,c=h;if(this._reSpace.test(this._text[c]))for(;this._reSpace.test(this._text[c]);)l++,c++;for(;/\S/.test(this._text[c])&&c<this._text.length;)l++,c++;return h+l},findLineBoundaryLeft:function(h){for(var l=0,c=h-1;!/\n/.test(this._text[c])&&c>-1;)l++,c--;return h-l},findLineBoundaryRight:function(h){for(var l=0,c=h;!/\n/.test(this._text[c])&&c<this._text.length;)l++,c++;return h+l},searchWordBoundary:function(h,l){for(var c=this._text,f=this._reSpace.test(c[h])?h-1:h,r=c[f],s=S.reNonWord;!s.test(r)&&f>0&&f<c.length;)r=c[f+=l];return s.test(r)&&(f+=l===1?0:1),f},selectWord:function(h){h=h||this.selectionStart;var l=this.searchWordBoundary(h,-1),c=this.searchWordBoundary(h,1);this.selectionStart=l,this.selectionEnd=c,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(h){h=h||this.selectionStart;var l=this.findLineBoundaryLeft(h),c=this.findLineBoundaryRight(h);return this.selectionStart=l,this.selectionEnd=c,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(h){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(h),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(h){h._iTextInstances&&h._iTextInstances.forEach(function(l){l.selected=!1,l.isEditing&&l.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(h){if(this.__isMousedown&&this.isEditing){var l=this.getSelectionStartFromPointer(h.e),c=this.selectionStart,f=this.selectionEnd;(l===this.__selectionStartOnMouseDown&&c!==f||c!==l&&f!==l)&&(l>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=l):(this.selectionStart=l,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===c&&this.selectionEnd===f||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(h,l,c){var f=c.slice(0,h),r=S.util.string.graphemeSplit(f).length;if(h===l)return{selectionStart:r,selectionEnd:r};var s=c.slice(h,l);return{selectionStart:r,selectionEnd:r+S.util.string.graphemeSplit(s).length}},fromGraphemeToStringSelection:function(h,l,c){var f=c.slice(0,h).join("").length;return h===l?{selectionStart:f,selectionEnd:f}:{selectionStart:f,selectionEnd:f+c.slice(h,l).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var h=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=h.selectionStart,this.hiddenTextarea.selectionEnd=h.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var h=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=h.selectionEnd,this.inCompositionMode||(this.selectionStart=h.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var h=this._calcTextareaPosition();this.hiddenTextarea.style.left=h.left,this.hiddenTextarea.style.top=h.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var h=this.inCompositionMode?this.compositionStart:this.selectionStart,l=this._getCursorBoundaries(h),c=this.get2DCursorLocation(h),f=c.lineIndex,r=c.charIndex,s=this.getValueOfPropertyAt(f,r,"fontSize")*this.lineHeight,u=l.leftOffset,m=this.calcTransformMatrix(),g={x:l.left+u,y:l.top+l.topOffset+s},p=this.canvas.getRetinaScaling(),v=this.canvas.upperCanvasEl,C=v.width/p,b=v.height/p,k=C-s,I=b-s,R=v.clientWidth/C,N=v.clientHeight/b;return g=S.util.transformPoint(g,m),(g=S.util.transformPoint(g,this.canvas.viewportTransform)).x*=R,g.y*=N,g.x<0&&(g.x=0),g.x>k&&(g.x=k),g.y<0&&(g.y=0),g.y>I&&(g.y=I),g.x+=this.canvas._offset.left,g.y+=this.canvas._offset.top,{left:g.x+"px",top:g.y+"px",fontSize:s+"px",charHeight:s}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var h=this._textBeforeEdit!==this.text,l=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,l&&(l.blur&&l.blur(),l.parentNode&&l.parentNode.removeChild(l)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),h&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),h&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var h in this.styles)this._textLines[h]||delete this.styles[h]},removeStyleFromTo:function(h,l){var c,f,r=this.get2DCursorLocation(h,!0),s=this.get2DCursorLocation(l,!0),u=r.lineIndex,m=r.charIndex,g=s.lineIndex,p=s.charIndex;if(u!==g){if(this.styles[u])for(c=m;c<this._unwrappedTextLines[u].length;c++)delete this.styles[u][c];if(this.styles[g])for(c=p;c<this._unwrappedTextLines[g].length;c++)(f=this.styles[g][c])&&(this.styles[u]||(this.styles[u]={}),this.styles[u][m+c-p]=f);for(c=u+1;c<=g;c++)delete this.styles[c];this.shiftLineStyles(g,u-g)}else if(this.styles[u]){f=this.styles[u];var v,C,b=p-m;for(c=m;c<p;c++)delete f[c];for(C in this.styles[u])(v=parseInt(C,10))>=p&&(f[v-b]=f[C],delete f[C])}},shiftLineStyles:function(h,l){var c=K(this.styles);for(var f in this.styles){var r=parseInt(f,10);r>h&&(this.styles[r+l]=c[r],c[r-l]||delete this.styles[r])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(h,l,c,f){var r,s={},u=!1,m=this._unwrappedTextLines[h].length===l;for(var g in c||(c=1),this.shiftLineStyles(h,c),this.styles[h]&&(r=this.styles[h][l===0?l:l-1]),this.styles[h]){var p=parseInt(g,10);p>=l&&(u=!0,s[p-l]=this.styles[h][g],m&&l===0||delete this.styles[h][g])}var v=!1;for(u&&!m&&(this.styles[h+c]=s,v=!0),v&&c--;c>0;)f&&f[c-1]?this.styles[h+c]={0:K(f[c-1])}:r?this.styles[h+c]={0:K(r)}:delete this.styles[h+c],c--;this._forceClearCache=!0},insertCharStyleObject:function(h,l,c,f){this.styles||(this.styles={});var r=this.styles[h],s=r?K(r):{};for(var u in c||(c=1),s){var m=parseInt(u,10);m>=l&&(r[m+c]=s[m],s[m-c]||delete r[m])}if(this._forceClearCache=!0,f)for(;c--;)Object.keys(f[c]).length&&(this.styles[h]||(this.styles[h]={}),this.styles[h][l+c]=K(f[c]));else if(r)for(var g=r[l?l-1:1];g&&c--;)this.styles[h][l+c]=K(g)},insertNewStyleBlock:function(h,l,c){for(var f=this.get2DCursorLocation(l,!0),r=[0],s=0,u=0;u<h.length;u++)h[u]===`
`?r[++s]=0:r[s]++;for(r[0]>0&&(this.insertCharStyleObject(f.lineIndex,f.charIndex,r[0],c),c=c&&c.slice(r[0]+1)),s&&this.insertNewlineStyleObject(f.lineIndex,f.charIndex+r[0],s),u=1;u<s;u++)r[u]>0?this.insertCharStyleObject(f.lineIndex+u,0,r[u],c):c&&this.styles[f.lineIndex+u]&&c[0]&&(this.styles[f.lineIndex+u][0]=c[0]),c=c&&c.slice(r[u]+1);r[u]>0&&this.insertCharStyleObject(f.lineIndex+u,0,r[u],c)},setSelectionStartEndWithShift:function(h,l,c){c<=h?(l===h?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=h),this.selectionStart=c):c>h&&c<l?this._selectionDirection==="right"?this.selectionEnd=c:this.selectionStart=c:(l===h?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=l),this.selectionEnd=c)},setSelectionInBoundaries:function(){var h=this.text.length;this.selectionStart>h?this.selectionStart=h:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>h?this.selectionEnd=h:this.selectionEnd<0&&(this.selectionEnd=0)}}),S.util.object.extend(S.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(h){if(this.canvas){this.__newClickTime=+new Date;var l=h.pointer;this.isTripleClick(l)&&(this.fire("tripleclick",h),this._stopEvent(h.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=l,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(h){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===h.x&&this.__lastPointer.y===h.y},_stopEvent:function(h){h.preventDefault&&h.preventDefault(),h.stopPropagation&&h.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(h){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(h.e))},tripleClickHandler:function(h){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(h.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(h){!this.canvas||!this.editable||h.e.button&&h.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(h.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(h){!this.canvas||!this.editable||h.e.button&&h.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(h){if(this.__isMousedown=!1,!(!this.editable||this.group||h.transform&&h.transform.actionPerformed||h.e.button&&h.e.button!==1)){if(this.canvas){var l=this.canvas._activeObject;if(l&&l!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(h.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(h){var l=this.getSelectionStartFromPointer(h),c=this.selectionStart,f=this.selectionEnd;h.shiftKey?this.setSelectionStartEndWithShift(c,f,l):(this.selectionStart=l,this.selectionEnd=l),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(h){for(var l,c=this.getLocalPointer(h),f=0,r=0,s=0,u=0,m=0,g=0,p=this._textLines.length;g<p&&s<=c.y;g++)s+=this.getHeightOfLine(g)*this.scaleY,m=g,g>0&&(u+=this._textLines[g-1].length+this.missingNewlineOffset(g-1));r=this._getLineLeftOffset(m)*this.scaleX,l=this._textLines[m],this.direction==="rtl"&&(c.x=this.width*this.scaleX-c.x+r);for(var v=0,C=l.length;v<C&&(f=r,(r+=this.__charBounds[m][v].kernedWidth*this.scaleX)<=c.x);v++)u++;return this._getNewSelectionStartFromOffset(c,f,r,u,C)},_getNewSelectionStartFromOffset:function(h,l,c,f,r){var s=h.x-l,u=c-h.x,m=f+(u>s||u<0?0:1);return this.flipX&&(m=r-m),m>this._text.length&&(m=this._text.length),m}}),S.util.object.extend(S.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=S.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var h=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+h.top+"; left: "+h.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; paddingｰtop: "+h.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):S.document.body.appendChild(this.hiddenTextarea),S.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),S.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),S.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),S.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),S.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),S.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),S.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),S.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),S.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(S.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(h){if(this.isEditing){var l=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(h.keyCode in l)this[l[h.keyCode]](h);else{if(!(h.keyCode in this.ctrlKeysMapDown)||!h.ctrlKey&&!h.metaKey)return;this[this.ctrlKeysMapDown[h.keyCode]](h)}h.stopImmediatePropagation(),h.preventDefault(),h.keyCode>=33&&h.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(h){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:h.keyCode in this.ctrlKeysMapUp&&(h.ctrlKey||h.metaKey)&&(this[this.ctrlKeysMapUp[h.keyCode]](h),h.stopImmediatePropagation(),h.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(h){var l=this.fromPaste;if(this.fromPaste=!1,h&&h.stopPropagation(),this.isEditing){var c,f,r,s,u,m=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,g=this._text.length,p=m.length,v=p-g,C=this.selectionStart,b=this.selectionEnd,k=C!==b;if(this.hiddenTextarea.value==="")return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var I=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),R=C>I.selectionStart;k?(c=this._text.slice(C,b),v+=b-C):p<g&&(c=R?this._text.slice(b+v,b):this._text.slice(C,C-v)),f=m.slice(I.selectionEnd-v,I.selectionEnd),c&&c.length&&(f.length&&(r=this.getSelectionStyles(C,C+1,!1),r=f.map(function(){return r[0]})),k?(s=C,u=b):R?(s=b-c.length,u=b):(s=b,u=b+c.length),this.removeStyleFromTo(s,u)),f.length&&(l&&f.join("")===S.copiedText&&!S.disableStyleCopyPaste&&(r=S.copiedTextStyle),this.insertNewStyleBlock(f,C,r)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(h){this.compositionStart=h.target.selectionStart,this.compositionEnd=h.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(S.copiedText=this.getSelectedText(),S.disableStyleCopyPaste?S.copiedTextStyle=null:S.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(h){return h&&h.clipboardData||S.window.clipboardData},_getWidthBeforeCursor:function(h,l){var c,f=this._getLineLeftOffset(h);return l>0&&(f+=(c=this.__charBounds[h][l-1]).left+c.width),f},getDownCursorOffset:function(h,l){var c=this._getSelectionForOffset(h,l),f=this.get2DCursorLocation(c),r=f.lineIndex;if(r===this._textLines.length-1||h.metaKey||h.keyCode===34)return this._text.length-c;var s=f.charIndex,u=this._getWidthBeforeCursor(r,s),m=this._getIndexOnLine(r+1,u);return this._textLines[r].slice(s).length+m+1+this.missingNewlineOffset(r)},_getSelectionForOffset:function(h,l){return h.shiftKey&&this.selectionStart!==this.selectionEnd&&l?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(h,l){var c=this._getSelectionForOffset(h,l),f=this.get2DCursorLocation(c),r=f.lineIndex;if(r===0||h.metaKey||h.keyCode===33)return-c;var s=f.charIndex,u=this._getWidthBeforeCursor(r,s),m=this._getIndexOnLine(r-1,u),g=this._textLines[r].slice(0,s),p=this.missingNewlineOffset(r-1);return-this._textLines[r-1].length+m-g.length+(1-p)},_getIndexOnLine:function(h,l){for(var c,f,r=this._textLines[h],s=this._getLineLeftOffset(h),u=0,m=0,g=r.length;m<g;m++)if((s+=c=this.__charBounds[h][m].width)>l){f=!0;var p=s-c,v=s,C=Math.abs(p-l);u=Math.abs(v-l)<C?m:m-1;break}return f||(u=r.length-1),u},moveCursorDown:function(h){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",h)},moveCursorUp:function(h){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",h)},_moveCursorUpOrDown:function(h,l){var c=this["get"+h+"CursorOffset"](l,this._selectionDirection==="right");l.shiftKey?this.moveCursorWithShift(c):this.moveCursorWithoutShift(c),c!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(h){var l=this._selectionDirection==="left"?this.selectionStart+h:this.selectionEnd+h;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,l),h!==0},moveCursorWithoutShift:function(h){return h<0?(this.selectionStart+=h,this.selectionEnd=this.selectionStart):(this.selectionEnd+=h,this.selectionStart=this.selectionEnd),h!==0},moveCursorLeft:function(h){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",h)},_move:function(h,l,c){var f;if(h.altKey)f=this["findWordBoundary"+c](this[l]);else{if(!h.metaKey&&h.keyCode!==35&&h.keyCode!==36)return this[l]+=c==="Left"?-1:1,!0;f=this["findLineBoundary"+c](this[l])}if(typeof f!==void 0&&this[l]!==f)return this[l]=f,!0},_moveLeft:function(h,l){return this._move(h,l,"Left")},_moveRight:function(h,l){return this._move(h,l,"Right")},moveCursorLeftWithoutShift:function(h){var l=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(l=this._moveLeft(h,"selectionStart")),this.selectionEnd=this.selectionStart,l},moveCursorLeftWithShift:function(h){return this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd?this._moveLeft(h,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection="left",this._moveLeft(h,"selectionStart")):void 0},moveCursorRight:function(h){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",h)},_moveCursorLeftOrRight:function(h,l){var c="moveCursor"+h+"With";this._currentCursorOpacity=1,l.shiftKey?c+="Shift":c+="outShift",this[c](l)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(h){return this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd?this._moveRight(h,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(h,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(h){var l=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(l=this._moveRight(h,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,l},removeChars:function(h,l){l===void 0&&(l=h+1),this.removeStyleFromTo(h,l),this._text.splice(h,l-h),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(h,l,c,f){f===void 0&&(f=c),f>c&&this.removeStyleFromTo(c,f);var r=S.util.string.graphemeSplit(h);this.insertNewStyleBlock(r,c,l),this._text=[].concat(this._text.slice(0,c),r,this._text.slice(f)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var h=S.util.toFixed,l=/  +/g;S.util.object.extend(S.Text.prototype,{_toSVG:function(){var c=this._getSVGLeftTopOffsets(),f=this._getSVGTextAndBg(c.textTop,c.textLeft);return this._wrapSVGTextAndBg(f)},toSVG:function(c){return this._createBaseSVGMarkup(this._toSVG(),{reviver:c,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(c){var f=this.getSvgTextDecoration(this);return[c.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",f?'text-decoration="'+f+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",c.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(c,f){var r,s=[],u=[],m=c;this._setSVGBg(u);for(var g=0,p=this._textLines.length;g<p;g++)r=this._getLineLeftOffset(g),(this.textBackgroundColor||this.styleHas("textBackgroundColor",g))&&this._setSVGTextLineBg(u,g,f+r,m),this._setSVGTextLineText(s,g,f+r,m),m+=this.getHeightOfLine(g);return{textSpans:s,textBgRects:u}},_createTextCharSpan:function(c,f,r,s){var u=c!==c.trim()||c.match(l),m=this.getSvgSpanStyles(f,u),g=m?'style="'+m+'"':"",p=f.deltaY,v="",C=S.Object.NUM_FRACTION_DIGITS;return p&&(v=' dy="'+h(p,C)+'" '),['<tspan x="',h(r,C),'" y="',h(s,C),'" ',v,g,">",S.util.string.escapeXml(c),"</tspan>"].join("")},_setSVGTextLineText:function(c,f,r,s){var u,m,g,p,v,C=this.getHeightOfLine(f),b=this.textAlign.indexOf("justify")!==-1,k="",I=0,R=this._textLines[f];s+=C*(1-this._fontSizeFraction)/this.lineHeight;for(var N=0,H=R.length-1;N<=H;N++)v=N===H||this.charSpacing,k+=R[N],g=this.__charBounds[f][N],I===0?(r+=g.kernedWidth-g.width,I+=g.width):I+=g.kernedWidth,b&&!v&&this._reSpaceAndTab.test(R[N])&&(v=!0),v||(u=u||this.getCompleteStyleDeclaration(f,N),m=this.getCompleteStyleDeclaration(f,N+1),v=this._hasStyleChangedForSvg(u,m)),v&&(p=this._getStyleDeclaration(f,N)||{},c.push(this._createTextCharSpan(k,p,r,s)),k="",u=m,r+=I,I=0)},_pushTextBgRect:function(c,f,r,s,u,m){var g=S.Object.NUM_FRACTION_DIGITS;c.push("		<rect ",this._getFillAttributes(f),' x="',h(r,g),'" y="',h(s,g),'" width="',h(u,g),'" height="',h(m,g),`"></rect>
`)},_setSVGTextLineBg:function(c,f,r,s){for(var u,m,g=this._textLines[f],p=this.getHeightOfLine(f)/this.lineHeight,v=0,C=0,b=this.getValueOfPropertyAt(f,0,"textBackgroundColor"),k=0,I=g.length;k<I;k++)u=this.__charBounds[f][k],(m=this.getValueOfPropertyAt(f,k,"textBackgroundColor"))!==b?(b&&this._pushTextBgRect(c,b,r+C,s,v,p),C=u.left,v=u.width,b=m):v+=u.kernedWidth;m&&this._pushTextBgRect(c,m,r+C,s,v,p)},_getFillAttributes:function(c){var f=c&&typeof c=="string"?new S.Color(c):"";return f&&f.getSource()&&f.getAlpha()!==1?'opacity="'+f.getAlpha()+'" fill="'+f.setAlpha(1).toRgb()+'"':'fill="'+c+'"'},_getSVGLineTopOffset:function(c){for(var f,r=0,s=0;s<c;s++)r+=this.getHeightOfLine(s);return f=this.getHeightOfLine(s),{lineTop:r,offset:(this._fontSizeMult-this._fontSizeFraction)*f/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(c){return S.Object.prototype.getSvgStyles.call(this,c)+" white-space: pre;"}})}(),function(h){var l=h.fabric||(h.fabric={});l.Textbox=l.util.createClass(l.IText,l.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:l.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(c){for(var f=0,r=0,s=0,u={},m=0;m<c.graphemeLines.length;m++)c.graphemeText[s]===`
`&&m>0?(r=0,s++,f++):!this.splitByGrapheme&&this._reSpaceAndTab.test(c.graphemeText[s])&&m>0&&(r++,s++),u[m]={line:f,offset:r},s+=c.graphemeLines[m].length,r+=c.graphemeLines[m].length;return u},styleHas:function(c,f){if(this._styleMap&&!this.isWrapping){var r=this._styleMap[f];r&&(f=r.line)}return l.Text.prototype.styleHas.call(this,c,f)},isEmptyStyles:function(c){if(!this.styles)return!0;var f,r,s=0,u=!1,m=this._styleMap[c],g=this._styleMap[c+1];for(var p in m&&(c=m.line,s=m.offset),g&&(u=g.line===c,f=g.offset),r=c===void 0?this.styles:{line:this.styles[c]})for(var v in r[p])if(v>=s&&(!u||v<f))for(var C in r[p][v])return!1;return!0},_getStyleDeclaration:function(c,f){if(this._styleMap&&!this.isWrapping){var r=this._styleMap[c];if(!r)return null;c=r.line,f=r.offset+f}return this.callSuper("_getStyleDeclaration",c,f)},_setStyleDeclaration:function(c,f,r){var s=this._styleMap[c];c=s.line,f=s.offset+f,this.styles[c][f]=r},_deleteStyleDeclaration:function(c,f){var r=this._styleMap[c];c=r.line,f=r.offset+f,delete this.styles[c][f]},_getLineStyle:function(c){var f=this._styleMap[c];return!!this.styles[f.line]},_setLineStyle:function(c){var f=this._styleMap[c];this.styles[f.line]={}},_wrapText:function(c,f){var r,s=[];for(this.isWrapping=!0,r=0;r<c.length;r++)s=s.concat(this._wrapLine(c[r],r,f));return this.isWrapping=!1,s},_measureWord:function(c,f,r){var s,u=0;r=r||0;for(var m=0,g=c.length;m<g;m++)u+=this._getGraphemeBox(c[m],f,m+r,s,!0).kernedWidth,s=c[m];return u},_wrapLine:function(c,f,r,s){var u=0,m=this.splitByGrapheme,g=[],p=[],v=m?l.util.string.graphemeSplit(c):c.split(this._wordJoiners),C="",b=0,k=m?"":" ",I=0,R=0,N=0,H=!0,z=this._getWidthOfCharSpacing();s=s||0,v.length===0&&v.push([]),r-=s;for(var q=0;q<v.length;q++)C=m?v[q]:l.util.string.graphemeSplit(v[q]),I=this._measureWord(C,f,b),b+=C.length,(u+=R+I-z)>r&&!H?(g.push(p),p=[],u=I,H=!0):u+=z,H||m||p.push(k),p=p.concat(C),R=m?0:this._measureWord([k],f,b),b++,H=!1,I>N&&(N=I);return q&&g.push(p),N+s>this.dynamicMinWidth&&(this.dynamicMinWidth=N-z+s),g},isEndOfWrapping:function(c){return!this._styleMap[c+1]||this._styleMap[c+1].line!==this._styleMap[c].line},missingNewlineOffset:function(c){return this.splitByGrapheme?this.isEndOfWrapping(c)?1:0:1},_splitTextIntoLines:function(c){for(var f=l.Text.prototype._splitTextIntoLines.call(this,c),r=this._wrapText(f.lines,this.width),s=new Array(r.length),u=0;u<r.length;u++)s[u]=r[u].join("");return f.lines=s,f.graphemeLines=r,f},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var c={};for(var f in this._styleMap)this._textLines[f]&&(c[this._styleMap[f].line]=1);for(var f in this.styles)c[f]||delete this.styles[f]},toObject:function(c){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(c))}}),l.Textbox.fromObject=function(c,f){return l.Object._fromObject("Textbox",c,f,"text")}}(t),function(){var h=S.controlsUtils,l=h.scaleSkewCursorStyleHandler,c=h.scaleCursorStyleHandler,f=h.scalingEqually,r=h.scalingYOrSkewingX,s=h.scalingXOrSkewingY,u=h.scaleOrSkewActionName,m=S.Object.prototype.controls;if(m.ml=new S.Control({x:-.5,y:0,cursorStyleHandler:l,actionHandler:s,getActionName:u}),m.mr=new S.Control({x:.5,y:0,cursorStyleHandler:l,actionHandler:s,getActionName:u}),m.mb=new S.Control({x:0,y:.5,cursorStyleHandler:l,actionHandler:r,getActionName:u}),m.mt=new S.Control({x:0,y:-.5,cursorStyleHandler:l,actionHandler:r,getActionName:u}),m.tl=new S.Control({x:-.5,y:-.5,cursorStyleHandler:c,actionHandler:f}),m.tr=new S.Control({x:.5,y:-.5,cursorStyleHandler:c,actionHandler:f}),m.bl=new S.Control({x:-.5,y:.5,cursorStyleHandler:c,actionHandler:f}),m.br=new S.Control({x:.5,y:.5,cursorStyleHandler:c,actionHandler:f}),m.mtr=new S.Control({x:0,y:-.5,actionHandler:h.rotationWithSnapping,cursorStyleHandler:h.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),S.Textbox){var g=S.Textbox.prototype.controls={};g.mtr=m.mtr,g.tr=m.tr,g.br=m.br,g.tl=m.tl,g.bl=m.bl,g.mt=m.mt,g.mb=m.mb,g.mr=new S.Control({x:.5,y:0,actionHandler:h.changeWidth,cursorStyleHandler:l,actionName:"resizing"}),g.ml=new S.Control({x:-.5,y:0,actionHandler:h.changeWidth,cursorStyleHandler:l,actionName:"resizing"})}}()},192:()=>{},898:()=>{},245:()=>{}},zu={};function ii(e){var t=zu[e];if(t!==void 0)return t.exports;var n=zu[e]={exports:{}};return b_[e](n,n.exports,ii),n.exports}ii.d=(e,t)=>{for(var n in t)ii.o(t,n)&&!ii.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},ii.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Yf={};(()=>{let e;ii.d(Yf,{R:()=>e}),e=typeof document<"u"&&typeof window<"u"?ii(653).fabric:{version:"5.2.1"}})();var Te=Yf.R;const Ds=typeof self>"u";let yr,ln,wo,hs,Ke;if(typeof navigator<"u"&&(yr=navigator,ln=yr.userAgent,wo=yr.platform,hs=yr.mediaDevices),!Ds){const e={Edge:{search:"Edg",verSearch:"Edg"},OPR:null,Chrome:null,Safari:{str:yr.vendor,search:"Apple",verSearch:["Version","iPhone OS","CPU OS"]},Firefox:null,Explorer:{search:"MSIE",verSearch:"MSIE"}},t={HarmonyOS:null,Android:null,iPhone:null,iPad:null,Windows:{str:wo,search:"Win"},Mac:{str:wo},Linux:{str:wo}};let n="unknownBrowser",i=0,o="unknownOS";for(let a in e){const d=e[a]||{};let _=d.str||ln,y=d.search||a,w=d.verStr||ln,x=d.verSearch||a;if(x instanceof Array||(x=[x]),_.indexOf(y)!=-1){n=a;for(let T of x){let E=w.indexOf(T);if(E!=-1){i=parseFloat(w.substring(E+T.length+1));break}}break}}for(let a in t){const d=t[a]||{};let _=d.str||ln,y=d.search||a;if(_.indexOf(y)!=-1){o=a;break}}o=="Linux"&&ln.indexOf("Windows NT")!=-1&&(o="HarmonyOS"),Ke={browser:n,version:i,OS:o}}Ds&&(Ke={browser:"ssr",version:0,OS:"ssr"});const E_=typeof WebAssembly<"u"&&ln&&!(/Safari/.test(ln)&&!/Chrome/.test(ln)&&/\(.+\s11_2_([2-6]).*\)/.test(ln)),T_=!(typeof Worker>"u"),Xf=!(!hs||!hs.getUserMedia),k_=async()=>{let e=!1;if(Xf)try{(await hs.getUserMedia({video:!0})).getTracks().forEach(t=>{t.stop()}),e=!0}catch{}return e};Ke.browser==="Chrome"&&Ke.version>66||Ke.browser==="Safari"&&Ke.version>13||Ke.browser==="OPR"&&Ke.version>43||Ke.browser==="Edge"&&Ke.version;const I_=(()=>{if(!Ds&&document.currentScript){let e=document.currentScript.src,t=e.indexOf("?");if(t!=-1)e=e.substring(0,t);else{let n=e.indexOf("#");n!=-1&&(e=e.substring(0,n))}return e.substring(0,e.lastIndexOf("/")+1)}return"./"})();class Tt{constructor(t,n){this._zIndex=null,this._drawingLayer=null,this._drawingLayerId=null,this._mapStyle=new Map,this.mapEvent_Callbacks=new Map([["selected",new Map],["deselected",new Map],["mousedown",new Map],["mouseup",new Map],["dblclick",new Map],["mouseover",new Map],["mouseout",new Map]]),this.mapNoteName_Content=new Map([]),this.isDrawingItem=!0,this._setFabricObject(t),this._mediaType=t.type,this.styleSelector="default",this.styleId=n}get mediaType(){return this._mediaType}get drawingLayerId(){return this._drawingLayerId}_setFabricObject(t){this._fabricObject=t,this._fabricObject.on("selected",()=>{this.styleSelector="selected"}),this._fabricObject.on("deselected",()=>{this._fabricObject.canvas&&this._fabricObject.canvas.getActiveObjects().includes(this._fabricObject)?this.styleSelector="selected":this.styleSelector="default",this._fabricObject.type==="textbox"&&(this._fabricObject.isEditing&&this._fabricObject.exitEditing(),this._fabricObject.selected=!1)}),t.getDrawingItem=()=>this}_getFabricObject(){return this._fabricObject}_on(t,n){if(!n)return;const i=t.toLowerCase(),o=this.mapEvent_Callbacks.get(i);if(!o)throw new Error(`Event '${t}' does not exist.`);let a=o.get(n);a||(a=d=>{const _=d.e;if(!_)return void(n&&n.apply(this,[{targetItem:this,itemClientX:null,itemClientY:null,itemPageX:null,itemPageY:null}]));const y={targetItem:this,itemClientX:null,itemClientY:null,itemPageX:null,itemPageY:null};if(this._drawingLayer){let w,x,T,E;const M=_.target.getBoundingClientRect();w=M.left,x=M.top,T=w+window.scrollX,E=x+window.scrollY;const F=this._drawingLayer.fabricCanvas.lowerCanvasEl.width,P=this._drawingLayer.fabricCanvas.lowerCanvasEl.height,B=parseFloat(window.getComputedStyle(this._drawingLayer.fabricCanvas.lowerCanvasEl).width),D=parseFloat(window.getComputedStyle(this._drawingLayer.fabricCanvas.lowerCanvasEl).height),O=B/D,A=F/P,Y=this._drawingLayer._getObjectFit();let ne,oe,K,S,ue=1;if(Y==="contain")O<A?(ue=B/F,ne=w+this.get("x")*ue,oe=x+this.get("y")*ue+(D-P*ue)/2,K=T+this.get("x")*ue,S=E+this.get("y")*ue+(D-P*ue)/2):(ue=D/P,ne=w+this.get("x")*ue+(B-F*ue)/2,oe=x+this.get("y")*ue,K=T+this.get("x")*ue+(B-F*ue)/2,S=E+this.get("y")*ue);else if(Y==="cover")if(O<A){ue=D/P;let le=this.get("x")*ue-(F*ue-B)/2;le=Math.max(le,0),le=Math.min(le,B),ne=w+le,oe=x+this.get("y")*ue,K=T+le,S=E+this.get("y")*ue}else{ue=B/F;let le=this.get("y")*ue-(P*ue-D)/2;le=Math.max(le,0),le=Math.min(le,D),ne=w+this.get("x")*ue,oe=x+le,K=T+this.get("x")*ue,S=E+le}y.itemClientX=Math.round(ne),y.itemClientY=Math.round(oe),y.itemPageX=Math.round(K),y.itemPageY=Math.round(S)}for(let w of Object.getOwnPropertyNames(y))Object.defineProperty(_,w,{value:y[w],writable:!0});n&&n.apply(this,[_])},o.set(n,a),this._fabricObject.on(i==="dblclick"?"mousedblclick":i,a))}on(t,n){this._on(t,n)}_off(t,n){const i=t.toLowerCase(),o=this.mapEvent_Callbacks.get(i);if(!o)throw new Error(`Event '${t}' does not exist.`);let a=o.get(n);a&&(o.delete(n),this._fabricObject.off(i==="dblclick"?"mousedblclick":i,a))}off(t,n){this._off(t,n)}_setEditable(t){const n=this._fabricObject;t?(n.selectable=!0,n.hasControls=!0,n.hoverCursor=null):(n.selectable=!1,n.hasControls=!1,n.hoverCursor="default")}hasNote(t){return this.mapNoteName_Content.has(t)}addNote(t,n){if(this.hasNote(t.name)&&!n)throw new Error("A note with the same name already exists, please use a different name.");const i=t.content?JSON.parse(JSON.stringify(t.content)):t.content;this.mapNoteName_Content.set(t.name,[i])}getNote(t){const n=this.mapNoteName_Content.get(t);return n?n.length===1?{name:t,content:n[0]?JSON.parse(JSON.stringify(n[0])):n[0]}:{name:t,content:JSON.parse(JSON.stringify(n))}:null}getNotes(){const t=[];for(let n of this.mapNoteName_Content){let i=n[1].length===1?n[1][0]:n[1];i=i&&JSON.parse(JSON.stringify(i)),t.push({name:n[0],content:i})}return t}updateNote(t,n,i){const o=this.mapNoteName_Content.get(t);if(!o)throw new Error("The note name does not exist.");i||(o.length=0),n=n&&JSON.parse(JSON.stringify(n)),o.push(n)}deleteNote(t){this.mapNoteName_Content.delete(t)}clearNotes(){this.mapNoteName_Content.clear()}_extendSet(t,n){return!1}_extendGet(t){}set(t,n){if(!this._extendSet(t,n))if(t==="x"){const i=this._fabricObject.group;i?(this._fabricObject.set("left",n-i.left-i.width/2),i.addWithUpdate()):this._fabricObject.set("left",n)}else if(t==="y"){const i=this._fabricObject.group;i?(this._fabricObject.set("top",n-i.top-i.height/2),i.addWithUpdate()):this._fabricObject.set("top",n)}else t==="styleId"?this.styleId=n:this._fabricObject.set(t,n);["vertices","startPoint","endPoint","x","y","left","top","width","height","scaleX","scaleY","skewX","skewY","padding","angle","strokeWidth"].includes(t)&&this._fabricObject.setCoords()}get(t){let n=this._extendGet(t);if(n===void 0)if(t==="x"){const i=this._fabricObject.group;n=i?this._fabricObject.get("left")+i.left+i.width/2:this._fabricObject.get("left")}else if(t==="y"){const i=this._fabricObject.group;n=i?this._fabricObject.get("top")+i.top+i.height/2:this._fabricObject.get("top")}else n=["type","mediaType"].includes(t)?this.mediaType:t==="styleSelector"?this.styleSelector:t==="styleId"?this.styleId:t==="drawingLayerId"?this.drawingLayerId:this._fabricObject.get(t);return n}setAttribute(t,n){this.set(t,n)}getAttribute(t){return this.get(t)}}function hl(e,t,n){let i=n.points[this.pointIndex].x-n.pathOffset.x,o=n.points[this.pointIndex].y-n.pathOffset.y;return Te.util.transformPoint({x:i,y:o},n.calcTransformMatrix())}function $f(e){let t=new Te.Point(e.strokeUniform?1/e.scaleX:1,e.strokeUniform?1/e.scaleY:1).multiply(e.strokeWidth);return new Te.Point(e.width+t.x,e.height+t.y)}function dl(e,t,n,i){let o=t.target,a=o.controls[o.__corner],d=o.toLocalPoint(new Te.Point(n,i),"center","center"),_=$f(o),y=o._getTransformedDimensions(0,0),w={x:d.x*_.x/y.x+o.pathOffset.x,y:d.y*_.y/y.y+o.pathOffset.y};return o.points[a.pointIndex]=w,!0}function fl(e,t){return function(n,i,o,a){let d=i.target,_=Te.util.transformPoint({x:d.points[e].x-d.pathOffset.x,y:d.points[e].y-d.pathOffset.y},d.calcTransformMatrix()),y=t(n,i,o,a);d._setPositionDimensions({});let w=$f(d),x=(d.points[e].x-d.pathOffset.x)/w.x,T=(d.points[e].y-d.pathOffset.y)/w.y;return d.setPositionByOrigin(_,x+.5,T+.5),y}}Tt.arrMediaTypes=["rect","arc","polygon","image","text","line","path"],Tt.arrStyleSelectors=["default","selected"];class Yu extends Tt{constructor(t,n){super(new Te.Polygon(t,{objectCaching:!1}),n);const i=this._fabricObject;let o=i.points.length-1;i.controls=i.points.reduce(function(a,d,_){return a["p"+_]=new Te.Control({positionHandler:hl,actionHandler:fl(_>0?_-1:o,dl),actionName:"modifyPolygon",pointIndex:_}),a},{})}_extendSet(t,n){if(t==="vertices"){const i=this._fabricObject;if(i.group){const a=i.group;i.points=n.map(d=>({x:d.x-a.left-a.width/2,y:d.y-a.top-a.height/2})),a.addWithUpdate()}else i.points=n;const o=i.points.length-1;return i.controls=i.points.reduce(function(a,d,_){return a["p"+_]=new Te.Control({positionHandler:hl,actionHandler:fl(_>0?_-1:o,dl),actionName:"modifyPolygon",pointIndex:_}),a},{}),i._setPositionDimensions({}),!0}}_extendGet(t){if(t==="vertices"){const n=[],i=this._fabricObject;if(i.selectable&&!i.group)for(let o in i.oCoords)n.push({x:i.oCoords[o].x,y:i.oCoords[o].y});else for(let o of i.points){let a=o.x-i.pathOffset.x,d=o.y-i.pathOffset.y;const _=Te.util.transformPoint({x:a,y:d},i.calcTransformMatrix());n.push({x:_.x,y:_.y})}return n}}}const Xu=e=>{let t=(n=>n.split(`
`).map(i=>i.split("	")))(e);return(n=>{for(let i=0;;i++){let o=-1;for(let a=0;a<n.length;a++){let d=n[a][i];d!==void 0&&d.length>o&&(o=d.length)}if(o===-1)break;for(let a=0;a<n.length;a++){if(i>=n[a].length-1)continue;let d=" ".repeat(o+2-n[a][i].length);n[a][i]=n[a][i].concat(d)}}})(t),(n=>{let i="";for(let o=0;o<n.length;o++)i=i.concat(...n[o],o===n.length-1?"":`
`);return i})(t)};class Zf extends Tt{constructor(t,n,i,o,a){if(typeof o!="number"||o<=0)throw new RangeError("Invalid width.");super(new Te.Textbox(Xu(t),{left:n,top:i,width:o}),a),this._mediaType="text",this._text=t}_extendSet(t,n){if(t==="text")return this._text=n,this._fabricObject.set("text",Xu(n)),!0}_extendGet(t){if(t==="text")return this._text}}typeof document<"u"&&typeof window<"u"&&(Te.StaticCanvas.prototype.dispose=function(){return this.isRendering&&(Te.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(e){e.dispose&&e.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),Te.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},Te.Object.prototype.transparentCorners=!1,Te.Object.prototype.cornerSize=20,Te.Object.prototype.touchCornerSize=100,Te.Object.prototype.cornerColor="rgb(254,142,20)",Te.Object.prototype.cornerStyle="circle",Te.Object.prototype.strokeUniform=!0,Te.Object.prototype.hasBorders=!1,Te.Canvas.prototype.containerClass="",Te.Canvas.prototype.getPointer=function(e,t){if(this._absolutePointer&&!t)return this._absolutePointer;if(this._pointer&&t)return this._pointer;var n,i=this.upperCanvasEl,o=Te.util.getPointer(e,i),a=i.getBoundingClientRect(),d=a.width||0,_=a.height||0;d&&_||("top"in a&&"bottom"in a&&(_=Math.abs(a.top-a.bottom)),"right"in a&&"left"in a&&(d=Math.abs(a.right-a.left))),this.calcOffset(),o.x=o.x-this._offset.left,o.y=o.y-this._offset.top,t||(o=this.restorePointerVpt(o));var y=this.getRetinaScaling();if(y!==1&&(o.x/=y,o.y/=y),d!==0&&_!==0){var w=window.getComputedStyle(i).objectFit,x=i.width,T=i.height,E=d,M=_;n={width:x/E,height:T/M};var F,P,B=x/T,D=E/M;return w==="contain"?B>D?(F=E,P=E/B,{x:o.x*n.width,y:(o.y-(M-P)/2)*n.width}):(F=M*B,P=M,{x:(o.x-(E-F)/2)*n.height,y:o.y*n.height}):w==="cover"?B>D?{x:(x-n.height*E)/2+o.x*n.height,y:o.y*n.height}:{x:o.x*n.width,y:(T-n.width*M)/2+o.y*n.width}:{x:o.x*n.width,y:o.y*n.height}}return n={width:1,height:1},{x:o.x*n.width,y:o.y*n.height}},Te.Canvas.prototype._onTouchStart=function(e){var t=this.findTarget(e);!this.allowTouchScrolling&&e.cancelable&&e.preventDefault&&e.preventDefault(),t&&e.cancelable&&e.preventDefault&&e.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),this._resetTransformEventData();var n=this.upperCanvasEl,i=this._getEventPrefix();Te.util.addListener(Te.document,"touchend",this._onTouchEnd,{passive:!1}),Te.util.addListener(Te.document,"touchmove",this._onMouseMove,{passive:!1}),Te.util.removeListener(n,i+"down",this._onMouseDown)},Te.Textbox.prototype._wrapLine=function(e,t,n,i){const o=e.match(/[\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\uff66-\uff9f]/g),a=!(!o||!o.length);var d=0,_=this.splitByGrapheme||a,y=[],w=[],x=_?Te.util.string.graphemeSplit(e):e.split(this._wordJoiners),T="",E=0,M=_?"":" ",F=0,P=0,B=0,D=!0,O=this._getWidthOfCharSpacing();i=i||0,x.length===0&&x.push([]),n-=i;for(var A=0;A<x.length;A++)T=_?x[A]:Te.util.string.graphemeSplit(x[A]),F=this._measureWord(T,t,E),E+=T.length,(d+=P+F-O)>n&&!D?(y.push(w),w=[],d=F,D=!0):d+=O,D||_||w.push(M),w=w.concat(T),P=_?0:this._measureWord([M],t,E),E++,D=!1,F>B&&(B=F);return A&&y.push(w),B+i>this.dynamicMinWidth&&(this.dynamicMinWidth=B-O+i),y});class O_{constructor(t,n,i,o){let a,d;switch(this.mapMediaType_Style=new Map,this.mode="viewer",this.onSelectionChange=null,this._arrDrwaingItem=[],this._arrFabricObject=[],this._visible=!0,t.hasOwnProperty("getFabricCanvas")?this.fabricCanvas=t.getFabricCanvas():(this.fabricCanvas=new Te.Canvas(t,Object.assign(o,{allowTouchScrolling:!0})),this.fabricCanvas.setDimensions({width:"100%",height:"100%"},{cssOnly:!0}),this.fabricCanvas.lowerCanvasEl.className="",this.fabricCanvas.upperCanvasEl.className="",this.fabricCanvas.on("selection:created",function(_){const y=_.selected,w=[];for(let x of y){const T=x.getDrawingItem()._drawingLayer;T&&!w.includes(T)&&w.push(T)}for(let x of w){const T=[];for(let E of y){const M=E.getDrawingItem();M._drawingLayer===x&&T.push(M)}setTimeout(()=>{x.onSelectionChange&&x.onSelectionChange(T,[])},0)}}),this.fabricCanvas.on("before:selection:cleared",function(_){const y=this.getActiveObjects(),w=[];for(let x of y){const T=x.getDrawingItem()._drawingLayer;T&&!w.includes(T)&&w.push(T)}for(let x of w){const T=[];for(let E of y){const M=E.getDrawingItem();M._drawingLayer===x&&T.push(M)}setTimeout(()=>{const E=[];for(let M of T)x.hasDrawingItem(M)&&E.push(M);E.length>0&&x.onSelectionChange&&x.onSelectionChange([],E)},0)}}),this.fabricCanvas.on("selection:updated",function(_){const y=_.selected,w=_.deselected,x=[];for(let T of y){const E=T.getDrawingItem()._drawingLayer;E&&!x.includes(E)&&x.push(E)}for(let T of w){const E=T.getDrawingItem()._drawingLayer;E&&!x.includes(E)&&x.push(E)}for(let T of x){const E=[],M=[];for(let F of y){const P=F.getDrawingItem();P._drawingLayer===T&&E.push(P)}for(let F of w){const P=F.getDrawingItem();P._drawingLayer===T&&M.push(P)}setTimeout(()=>{T.onSelectionChange&&T.onSelectionChange(E,M)},0)}}),this.fabricCanvas.wrapperEl.style.position="absolute",t.getFabricCanvas=()=>this.fabricCanvas),this.id=n,this._mapDrawingStyles=i,n){case 1:a=i.get(1),d=i.get(5);break;case 2:a=i.get(2),d=i.get(6);break;case 3:a=i.get(3),d=i.get(7);break;default:a=i.get(4),d=i.get(8)}for(let _ of Tt.arrMediaTypes)this.mapMediaType_Style.set(_,{default:a,selected:d})}getId(){return this.id}_getDrawingStyle(t,n){if(typeof t!="number")throw new Error("Invalid style id.");const i=this._mapDrawingStyles.get(t);return i?n?JSON.parse(JSON.stringify(i)):i:null}setVisible(t){if(t){for(let n of this._arrFabricObject)n.visible=!0;this._visible=!0}else{for(let n of this._arrFabricObject)n.visible=!1;this._visible=!1}this.fabricCanvas.renderAll()}isVisible(){return this._visible}_getItemCurrentStyleId(t){return t.styleId?t.styleId:this.mapMediaType_Style.get(t._mediaType)[t.styleSelector].styleId}_getItemCurrentStyle(t){return t.styleId?this._getDrawingStyle(t.styleId):t._mapStyle.get(t.styleSelector)||null}_changeMediaTypeCurStyleInStyleSelector(t,n,i,o){let a;switch(t){case"rect":a=this.fabricCanvas.getObjects("rect");break;case"arc":a=this.fabricCanvas.getObjects("circle");break;case"polygon":a=this.fabricCanvas.getObjects("polygon");break;case"image":a=this.fabricCanvas.getObjects("image");break;case"text":a=this.fabricCanvas.getObjects("textbox");break;case"line":a=this.fabricCanvas.getObjects("line");break;case"path":a=this.fabricCanvas.getObjects("path")}for(let d of a){if(!this._arrFabricObject.includes(d))continue;const _=d.getDrawingItem();_.styleSelector===n&&this._changeItemStyle(_,i,!0)}o||this.fabricCanvas.renderAll()}_changeItemStyle(t,n,i){if(!t||!n)return;const o=t._getFabricObject();typeof t.styleId=="number"&&(n=this._getDrawingStyle(t.styleId)),o.strokeWidth=n.lineWidth,n.paintMode==="fill"?(o.fill=n.fillStyle,o.stroke=n.fillStyle):n.paintMode==="stroke"?(o.fill="transparent",o.stroke=n.strokeStyle):n.paintMode==="strokeAndFill"&&(o.fill=n.fillStyle,o.stroke=n.strokeStyle),o.fontFamily&&(o.fontFamily=n.fontFamily),o.fontSize&&(o.fontSize=n.fontSize),o.group||(o.dirty=!0),i||this.fabricCanvas.renderAll()}_updateGroupItem(t,n,i){if(!t||!n)return;const o=t.getChildItems();if(i==="add"){if(o.includes(n))return;const a=n._getFabricObject();if(this.fabricCanvas.getObjects().includes(a)){if(!this._arrFabricObject.includes(a))throw new Error("Existed in other drawing layers.");n._zIndex=null}else{let d;if(n.styleId)d=this._getDrawingStyle(n.styleId);else{d=this.mapMediaType_Style.get(n._mediaType)[t.styleSelector];const _=()=>{this._changeItemStyle(n,this.mapMediaType_Style.get(n._mediaType).selected,!0)},y=()=>{this._changeItemStyle(n,this.mapMediaType_Style.get(n._mediaType).default,!0)};n._on("selected",_),n._on("deselected",y),n._funcChangeStyleToSelected=_,n._funcChangeStyleToDefault=y}n._drawingLayer=this,n._drawingLayerId=this.id,this._changeItemStyle(n,d,!0)}t._fabricObject.addWithUpdate(n._getFabricObject())}else{if(i!=="remove"||!o.includes(n))return;n._zIndex=null,n._drawingLayer=null,n._drawingLayerId=null,n._off("selected",n._funcChangeStyleToSelected),n._off("deselected",n._funcChangeStyleToDefault),n._funcChangeStyleToSelected=null,n._funcChangeStyleToDefault=null,t._fabricObject.removeWithUpdate(n._getFabricObject())}this.fabricCanvas.renderAll()}_addDrawingItem(t,n){let i=t._getFabricObject();const o=this.fabricCanvas.getObjects();let a,d;if(o.includes(i)){if(this._arrFabricObject.includes(i))return;throw new Error("Existed in other drawing layers.")}if(t._mediaType==="group"){a=t.getChildItems();for(let w of a)if(w._drawingLayer&&w._drawingLayer!==this)throw new Error("The childItems of DT_Group have existed in other drawing layers.")}if(n&&typeof n=="object"&&!Array.isArray(n))for(let w in n)i.set(w,n[w]);if(a){for(let w of a){const x=this.mapMediaType_Style.get(w._mediaType);for(let T of Tt.arrStyleSelectors)w._mapStyle.set(T,x[T]);if(w.styleId)d=this._getDrawingStyle(w.styleId);else{d=x.default;const T=()=>{this._changeItemStyle(w,this.mapMediaType_Style.get(w._mediaType).selected,!0)},E=()=>{this._changeItemStyle(w,this.mapMediaType_Style.get(w._mediaType).default,!0)};w._on("selected",T),w._on("deselected",E),w._funcChangeStyleToSelected=T,w._funcChangeStyleToDefault=E}w._drawingLayer=this,w._drawingLayerId=this.id,this._changeItemStyle(w,d,!0)}i.dirty=!0,this.fabricCanvas.renderAll()}else{const w=this.mapMediaType_Style.get(t._mediaType);for(let x of Tt.arrStyleSelectors)t._mapStyle.set(x,w[x]);if(t.styleId)d=this._getDrawingStyle(t.styleId);else{d=w.default;const x=()=>{this._changeItemStyle(t,this.mapMediaType_Style.get(t._mediaType).selected)},T=()=>{this._changeItemStyle(t,this.mapMediaType_Style.get(t._mediaType).default)};t._on("selected",x),t._on("deselected",T),t._funcChangeStyleToSelected=x,t._funcChangeStyleToDefault=T}this._changeItemStyle(t,d)}t._zIndex=this.id,t._drawingLayer=this,t._drawingLayerId=this.id;const _=this._arrFabricObject.length;let y=o.length;if(_)y=o.indexOf(this._arrFabricObject[_-1])+1;else for(let w=0;w<o.length;w++)if(t._zIndex<o[w].getDrawingItem()._zIndex){y=w;break}this._arrDrwaingItem.push(t),this._arrFabricObject.push(i),this._visible?i.visible=!0:i.visible=!1,this.fabricCanvas.insertAt(i,y,!1)}addDrawingItem(t){if(!t||!t.isDrawingItem)throw TypeError("Illegal drawing item.");if(this.mode==="viewer")t._setEditable(!1);else{if(this.mode!=="editor")throw new Error("Illegal 'mode'.");t._setEditable(!0)}this._addDrawingItem(t)}addDrawingItems(t){for(let n of t)this.addDrawingItem(n)}removeDrawingItem(t){if(!t||!t.isDrawingItem)throw TypeError("Illegal drawing item.");if(!this.hasDrawingItem(t))return;if(t._zIndex=null,t._drawingLayer=null,t._drawingLayerId=null,t._mediaType==="group"){const i=t.getChildItems();for(let o of i)o._zIndex=null,o._drawingLayer=null,o._drawingLayerId=null,o._off("selected",o._funcChangeStyleToSelected),o._off("deselected",o._funcChangeStyleToDefault),o._funcChangeStyleToSelected=null,o._funcChangeStyleToDefault=null,o._mapStyle.clear()}else t._off("selected",t._funcChangeStyleToSelected),t._off("deselected",t._funcChangeStyleToDefault),t._funcChangeStyleToSelected=null,t._funcChangeStyleToDefault=null,t._mapStyle.clear();const n=t._getFabricObject();t.styleSelector==="selected"&&(n.group?n.group.removeWithUpdate(n):this.fabricCanvas._activeObject=null,t.styleSelector="default"),this.fabricCanvas.remove(n),this._arrDrwaingItem.splice(this._arrDrwaingItem.indexOf(t),1),this._arrFabricObject.splice(this._arrFabricObject.indexOf(n),1)}removeDrawingItems(t){for(let n of t)this.removeDrawingItem(n)}setDrawingItems(t){this.clearDrawingItems(),this.addDrawingItems(t)}getDrawingItems(t){return t&&typeof t=="function"?this._arrDrwaingItem.filter(t):Array.from(this._arrDrwaingItem)}getSelectedDrawingItems(){const t=this.fabricCanvas.getActiveObjects(),n=[];for(let i of t)this._arrFabricObject.includes(i)&&n.push(i.getDrawingItem());return n}hasDrawingItem(t){if(!t||!t.isDrawingItem)throw TypeError("Illegal drawing item.");return this._arrDrwaingItem.includes(t)}clearDrawingItems(){this.removeDrawingItems(Array.from(this._arrDrwaingItem))}setDrawingStyle(t,n,i){n=n?n.toLocaleLowerCase():"all",i=i?i.toLocaleLowerCase():"all";let o,a=this._getDrawingStyle(t);if(n==="all"){const d=this.mapMediaType_Style.keys();for(let _ of d)if(o=this.mapMediaType_Style.get(_),i==="all")for(let y of Tt.arrStyleSelectors){this._changeMediaTypeCurStyleInStyleSelector(_,y,a,!0),o[y]=a;for(let w of this._arrDrwaingItem)w._mapStyle.set(y,a)}else{this._changeMediaTypeCurStyleInStyleSelector(_,i,a,!0),o[i]=a;for(let y of this._arrDrwaingItem)y._mapStyle.set(i,a)}this.fabricCanvas.renderAll()}else if(o=this.mapMediaType_Style.get(n),i==="all")for(let d of Tt.arrStyleSelectors){this._changeMediaTypeCurStyleInStyleSelector(n,d,a,!0),o[d]=a;for(let _ of this._arrDrwaingItem)_._mediaType===n&&_._mapStyle.set(d,a)}else{this._changeMediaTypeCurStyleInStyleSelector(n,i,a,!0),o[i]=a;for(let d of this._arrDrwaingItem)d._mediaType===n&&d._mapStyle.set(i,a)}}setMode(t){if((t=t.toLocaleLowerCase())==="viewer"){for(let n of this._arrDrwaingItem)n._setEditable(!1);this.fabricCanvas.discardActiveObject(),this.fabricCanvas.renderAll(),this.mode="viewer"}else{if(t!=="editor")throw new RangeError("Invalid value.");for(let n of this._arrDrwaingItem)n._setEditable(!0);this.mode="editor"}this._manager._switchPointerEvent()}getMode(){return this.mode}_setDimensions(t,n){this.fabricCanvas.setDimensions(t,n)}_setObjectFit(t){if(t=t.toLowerCase(),!["contain","cover"].includes(t))throw new Error(`Unsupported value '${t}'.`);this.fabricCanvas.lowerCanvasEl.style.objectFit=t,this.fabricCanvas.upperCanvasEl.style.objectFit=t}_getObjectFit(){return this.fabricCanvas.lowerCanvasEl.style.objectFit}renderAll(){for(let t of this._arrDrwaingItem){const n=this._getItemCurrentStyle(t);this._changeItemStyle(t,n,!0)}this.fabricCanvas.renderAll()}dispose(){this.clearDrawingItems(),this._manager._arrDrawingLayer.length===1&&(this.fabricCanvas.wrapperEl.style.pointerEvents="none",this.fabricCanvas.dispose(),this._arrDrwaingItem.length=0,this._arrFabricObject.length=0)}}class L_{constructor(){this._arrDrawingLayer=[],this._mapDrawingStyles=new Map([[1,{id:1,lineWidth:4,fillStyle:"rgba(73, 173, 245, 0.3)",strokeStyle:"rgba(73, 173, 245, 1)",paintMode:"stroke",fontFamily:"consolas",fontSize:40}],[2,{id:2,lineWidth:2,fillStyle:"rgba(73, 245, 73, 0.3)",strokeStyle:"rgba(73, 245, 73, 0.9)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[3,{id:3,lineWidth:2,fillStyle:"rgba(254, 180, 32, 0.3)",strokeStyle:"rgba(254, 180, 32, 0.9)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[4,{id:4,lineWidth:2,fillStyle:"rgba(245, 236, 73, 0.3)",strokeStyle:"rgba(245, 236, 73, 1)",paintMode:"stroke",fontFamily:"consolas",fontSize:40}],[5,{id:5,lineWidth:4,fillStyle:"rgba(73, 173, 245, 0.3)",strokeStyle:"rgba(73, 173, 245, 1)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[6,{id:6,lineWidth:2,fillStyle:"rgba(73, 245, 73, 0.3)",strokeStyle:"rgba(73, 245, 73, 0.9)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[7,{id:7,lineWidth:2,fillStyle:"rgba(254, 180, 32, 0.3)",strokeStyle:"rgba(254, 180, 32, 1)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}],[8,{id:8,lineWidth:2,fillStyle:"rgba(245, 236, 73, 0.3)",strokeStyle:"rgba(245, 236, 73, 1)",paintMode:"strokeAndFill",fontFamily:"consolas",fontSize:40}]]),this._defaultStyleTemplate={lineWidth:2,fillStyle:"rgba(245, 236, 73, 0.3)",strokeStyle:"rgba(245, 236, 73, 1)",paintMode:"stroke",fontFamily:"consolas",fontSize:40}}createDrawingStyle(t){if(!t)throw new Error("Invalid style definition.");let n;if(t.hasOwnProperty("id")){if(this._mapDrawingStyles.has(t.id))throw new Error("Existing drawing style id.");n=t.id}else{let o=100;for(;this._mapDrawingStyles.has(o);)o++;n=o}const i=JSON.parse(JSON.stringify(t));i.id=n;for(let o in this._defaultStyleTemplate)i.hasOwnProperty(o)||(i[o]=this._defaultStyleTemplate[o]);return this._mapDrawingStyles.set(n,i),i.id}_getDrawingStyle(t,n){if(typeof t!="number")throw new Error("Invalid style id.");const i=this._mapDrawingStyles.get(t);return i?n?JSON.parse(JSON.stringify(i)):i:null}getDrawingStyle(t){return this._getDrawingStyle(t,!0)}getDrawingStyles(){return JSON.parse(JSON.stringify(Array.from(this._mapDrawingStyles.values())))}_updateDrawingStyle(t,n){const i=this._mapDrawingStyles.get(t);if(i)for(let o in n)i.hasOwnProperty(o)&&(i[o]=n[o])}updateDrawingStyle(t,n){this._updateDrawingStyle(t,n);for(let i of this._arrDrawingLayer)i.renderAll()}createDrawingLayer(t,n){const i=a=>{for(let d of this._arrDrawingLayer)if(d.getId()===a)return!0;return!1};if(n===void 0){for(let a=100;;a++)if(!i(a)){n=a;break}}else if(i(n))throw new Error("Existed drawing layer id.");const o=new O_(t,n,this._mapDrawingStyles,{enableRetinaScaling:!1});return o._manager=this,this._arrDrawingLayer.push(o),this._switchPointerEvent(),o}deleteDrawingLayer(t){const n=this.getDrawingLayer(t);if(!n)return;const i=this._arrDrawingLayer;n.dispose(),i.splice(i.indexOf(n),1),this._switchPointerEvent()}clearDrawingLayers(){for(let t of this._arrDrawingLayer)t.dispose();this._arrDrawingLayer.length=0}getDrawingLayer(t){for(let n of this._arrDrawingLayer)if(n.getId()===t)return n;return null}getDrawingLayers(){return Array.from(this._arrDrawingLayer)}getSelectedDrawingItems(){if(!this._arrDrawingLayer.length)return;const t=this._arrDrawingLayer[0].fabricCanvas.getActiveObjects(),n=[];for(let i of t)n.push(i.getDrawingItem());return n}setDimensions(t,n){this._arrDrawingLayer.length&&this._arrDrawingLayer[0]._setDimensions(t,n)}setObjectFit(t){for(let n of this._arrDrawingLayer)n&&n._setObjectFit(t)}getObjectFit(){return this._arrDrawingLayer.length?this._arrDrawingLayer[0]._getObjectFit():null}setVisible(t){this._arrDrawingLayer.length&&(this._arrDrawingLayer[0].fabricCanvas.wrapperEl.style.display=t?"block":"none")}_switchPointerEvent(){if(this._arrDrawingLayer.length)for(let t of this._arrDrawingLayer)t.getMode()}}class R_{constructor(t){this._controlTarget=null,this._arrUsers=[],this._mapAction_UserArgs=new Map,this._mapProperty_UserValue=new Map,this._mapAction_Callbacks=new Map,this._controlTarget=t}setControlTarget(t){this._controlTarget=t}getControlTarget(){return this._controlTarget}register(t){this._arrUsers.includes(t)||this._arrUsers.push(t)}logout(t){const n=this._arrUsers.indexOf(t);n!==-1&&(this.clearUserDisiredAction({user:t}),this.clearUserDisiredValue({user:t}),this._arrUsers.splice(n,1))}getRegisteredUsers(){return this._arrUsers}ifUserExisted(t){return this._arrUsers.includes(t)}setDisiredValue(t,n,i,o){if(!this._arrUsers.includes(t))throw new Error("Unregistered user.");o&&(this._controlTarget[n]=i),this._mapProperty_UserValue.get(n)?this._mapProperty_UserValue.get(n).set(t,i):this._mapProperty_UserValue.set(n,new Map([[t,i]]))}clearUserDisiredValue(t){if(t&&(t.user||t.property)){if(t.property&&t.user){const n=this._mapProperty_UserValue.get(t.property);if(!n)return;n.delete(t.user)}else if(t.property)this._mapProperty_UserValue.delete(t.property);else if(t.user)for(let n of this._mapProperty_UserValue.values())n.delete(t.user)}else this._mapProperty_UserValue=new Map}getValue(t){if(!this._controlTarget)throw new Error("Control target is not set.");return this._controlTarget[t]}getPropertyDisiredValue(t){if(this._mapProperty_UserValue.get(t)){const n=[],i=this._mapProperty_UserValue.get(t);for(let o of i.values())n.push(o);return n}return null}setDisiredAction(t,n,i,o){if(!this._arrUsers.includes(t))throw new Error("Unregistered user.");return i||(i=[]),o?this._controlTarget[n](...i):(this._mapAction_UserArgs.get(n)?this._mapAction_UserArgs.get(n).set(t,i):this._mapAction_UserArgs.set(n,new Map([[t,i]])),this._render(n))}clearUserDisiredAction(t){if(t&&(t.user||t.actionName)){if(t.actionName&&t.user){const n=this._mapAction_UserArgs.get(t.actionName);if(!n)return;n.delete(t.user)}else if(t.actionName)this._mapAction_UserArgs.delete(t.actionName);else if(t.user)for(let n of this._mapAction_UserArgs.values())n.delete(t.user);this.render()}else this._mapAction_UserArgs=new Map}addCallback(t,n){const i=this._mapAction_Callbacks.get(t);i?i.push(n):this._mapAction_Callbacks.set(t,[n])}removeCallback(t,n){const i=this._mapAction_Callbacks.get(t);if(!i)return;const o=i.indexOf(n);o!==-1&&i.splice(o,1)}clearCallback(t){t?this._mapAction_Callbacks.delete(t):this._mapAction_Callbacks.clear()}_fireCallback(t){const n=this._mapAction_Callbacks.get(t);if(n)for(let i of n){if(!i)return;setTimeout(i.bind(this._controlTarget),0)}}_render(t){const n=this._mapAction_UserArgs.get(t);if(!n)throw new Error("Unrecorded action.");if(n.size===this._arrUsers.length){let i=[];for(let o of n.values())o.length>0&&(i=o);if(this._controlTarget[t]){const o=this._controlTarget[t](...i);return this._mapAction_UserArgs.delete(t),this._fireCallback(t),o}}}render(t){if(t)return this._render(t);for(let n of this._mapAction_UserArgs.keys())this._render(n)}}class Ct{static multiply(t,n){const i=[];for(let o=0;o<3;o++){const a=n.slice(3*o,3*o+3);for(let d=0;d<3;d++){const _=[t[d],t[d+3],t[d+6]].reduce((y,w,x)=>y+w*a[x],0);i.push(_)}}return i}static identity(){return[1,0,0,0,1,0,0,0,1]}static translate(t,n,i){return Ct.multiply(t,[1,0,0,0,1,0,n,i,1])}static rotate(t,n){var i=Math.cos(n),o=Math.sin(n);return Ct.multiply(t,[i,-o,0,o,i,0,0,0,1])}static scale(t,n,i){return Ct.multiply(t,[n,0,0,0,i,0,0,0,1])}}var ke;(function(e){e.GREY="grey",e.GREY32="grey32",e.RGBA="rgba",e.RBGA="rbga",e.GRBA="grba",e.GBRA="gbra",e.BRGA="brga",e.BGRA="bgra"})(ke||(ke={}));const wt=(e,t,n,i)=>{let o=t+Math.round((e-t)/n)*n;return i&&(o=Math.min(o,i)),o};class xe{constructor(){this._maxCvsSideLength=void 0,this._defaultMaxCvsSideLength=null,this._predefinedResolutions=[{width:160,height:120},{width:320,height:240},{width:480,height:360},{width:640,height:480},{width:800,height:600},{width:960,height:720},{width:1280,height:720},{width:1920,height:1080},{width:2560,height:1440},{width:3840,height:2160}],this._mapCameraResolutions=new Map,this._bWebGLSupported=!0,this.extraBindings=[],this._singleFrameMode=!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),this._cvsSingleFrameMode=null,this._cvsOriginalImage=null,this._imgWidth=0,this._imgHeight=0,this._singleFrameModeIpt=null,this._clickIptSingleFrameMode=()=>{if(this.singleFrameMode&&!this.getDrawingLayers().some(t=>t.getMode()=="editor")){if(!this._singleFrameModeIpt){const t=document.createElement("input");this._singleFrameModeIpt=t,t.setAttribute("type","file"),t.setAttribute("accept",".jpg,.jpeg,.icon,.gif,.svg,.webp,.png,.bmp"),t.setAttribute("capture",""),t.addEventListener("change",async()=>{const n=t.files[0];t.value="";const i=await(async w=>{let x=null,T=null;if(typeof createImageBitmap<"u")try{if(x=await createImageBitmap(w),x)return x}catch{}var E;return x||(T=await(E=w,new Promise((M,F)=>{let P=URL.createObjectURL(E),B=new Image;B.dbrObjUrl=P,B.src=P,B.onload=()=>{M(B)},B.onerror=D=>{F(new Error("Can't convert blob to image : "+(D instanceof Event?D.type:D)))}}))),T})(n),o=i instanceof HTMLImageElement?i.naturalWidth:i.width,a=i instanceof HTMLImageElement?i.naturalHeight:i.height;this._imgWidth=o,this._imgHeight=a;const d=w=>{const x=Date.now();if(o===0||a===0)return null;if(w instanceof HTMLImageElement&&!w.complete)throw new Error("The source is not loaded.");const T=this._scanRegion,E=this.getFrameSize(o,a,T,this.maxCvsSideLength);if(!E)return null;let M=!0;o===E.sWidth&&a===E.sHeight&&(M=!1);const F=this.mapPixelFormatString_Enum.get(this.framePixelFormat.toLowerCase()),P={data:null,region:T?JSON.parse(JSON.stringify(T)):null,sx:E.sx,sy:E.sy,width:E.dWidth,height:E.dHeight,colorMode:null,pixelFormat:null,timeSpent:null,timeStamp:null,isCropped:M,toCanvas:this._toCanvas,_sWidth:E.sWidth,_sHeight:E.sHeight,_bUseWebGL:null},B=this._getImageData(w,o,a,E,null,{pixelFormat:F});if(!B)return null;const D=Date.now();return P.data=B.data,P.pixelFormat=P.colorMode=B.pixelFormat,P._bUseWebGL=B._bUseWebGL,P.timeSpent=D-x,P.timeStamp=D,B.pixelFormat===ke.GREY?P.stride=P.width:P.stride=4*P.width,P};(w=>{let x=this._cvsSingleFrameMode;if(!x){if(x=document.createElement("canvas"),!this._videoContainer)throw new Error("Unable to find video element");this._videoContainer.after(x),x.style.position="absolute",x.style.width="100%",x.style.height="100%",x.style.left="0",x.style.top="0",x.style.objectFit="contain",x.style.pointerEvents="none",this._cvsSingleFrameMode=x}x.width==o&&x.height==a||(x.width=o,x.height=a);const T=x.getContext("2d");T.clearRect(0,0,x.width,x.height),T.drawImage(w,0,0)})(i),this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let w of this._arrScanRegionOverlays)w&&this._updateScanRegionOverlay(w);let _;this._updateDrawingLayersSize();try{_=d(i)}catch(w){throw w}const y=this.mapCameraEvents.get("singleframeacquired");for(let w of y)if(w)try{const x={data:new Uint8Array(_.data),region:JSON.parse(JSON.stringify(_.region)),sx:_.sx,sy:_.sy,width:_.width,height:_.height,stride:_.stride,colorMode:_.colorMode,pixelFormat:_.pixelFormat,timeSpent:_.timeSpent,timeStamp:_.timeStamp,isCropped:_.isCropped,toCanvas:_.toCanvas,_sWidth:_._sWidth,_sHeight:_._sHeight,_bUseWebGL:_._bUseWebGL};await w.apply(this,[x])}catch(x){console.error(x)}}),t.style.position="fixed",t.style.left="-1px",t.style.top="-1px",t.style.width="1px",t.style.height="1px",t.style.backgroundColor="transparent",t.style.color="transparent",document.body.appendChild(t)}this._singleFrameModeIpt.click()}},this.styleEls=[],this._framePixelFormat=void 0,this._defaultFramePixelFormat="rgba",this.mapPixelFormatString_Enum=new Map([["grey",ke.GREY],["grey32",ke.GREY32],["rgba",ke.RGBA],["rbga",ke.RBGA],["grba",ke.GRBA],["gbra",ke.GBRA],["brga",ke.BRGA],["bgra",ke.BGRA]]),this.shaderPixelFormat=ke.RGBA,this.maxVideoCvsLength=3,this._reusedCvs=null,this._reusedWebGLCvs=null,this._tempDataContainer=null,this._webGLTexture=null,this._webGLProgramInfo=null,this._webGLBuffers=null,this._softwareScale=1,this._scaleCenter={x:0,y:0},this._focusParameters={maxTimeout:400,minTimeout:300,kTimeout:void 0,oldDistance:null,fds:null,isDoingFocus:0,taskBackToContinous:null,curFocusTaskId:0,focusCancelableTime:1500,defaultFocusAreaSizeRatio:6,focusBackToContinousTime:5e3,tapFocusMinDistance:null,tapFocusMaxDistance:null,_focusArea:null},this._tapFocusEnabled=!0,this._focusSupported=!0,this._tapDoFocus=async t=>{if(this._touchMoved)return void(this._touchMoved=!1);if(!this._tapFocusEnabled||!this._bOpen||this.singleFrameMode||!this._video||this._video.paused||!this._videoTrack||!this._focusSupported||this.getDrawingLayers().some(ne=>ne.getMode()=="editor"))return;if(!this._focusParameters.fds&&(this._focusParameters.fds=(await this.getCapabilities()).focusDistance,!this._focusParameters.fds))return void(this._focusSupported=!1);if(this._focusParameters.kTimeout==null&&(this._focusParameters.kTimeout=(this._focusParameters.maxTimeout-this._focusParameters.minTimeout)/(1/this._focusParameters.fds.min-1/this._focusParameters.fds.max)),this._focusParameters.isDoingFocus==1)return;let n,i,o,a;if(this._focusParameters.taskBackToContinous&&(clearTimeout(this._focusParameters.taskBackToContinous),this._focusParameters.taskBackToContinous=null),t instanceof MouseEvent)n=t.clientX,i=t.clientY;else{if(!(t instanceof TouchEvent))throw new Error("Unknown event type.");if(!t.changedTouches.length)return;n=t.changedTouches[0].clientX,i=t.changedTouches[0].clientY}const d=this.getVideoFit(),_=this._video.videoWidth,y=this._video.videoHeight,w=this._elContainer.getBoundingClientRect(),x=w.left,T=w.top,E=window.getComputedStyle(this._elContainer),M=parseFloat(E.width),F=parseFloat(E.height),P=M/F,B=_/y;let D=1;if(d==="contain")B>P?(D=M/_,o=(n-x)/D,a=(i-T-(F-M/B)/2)/D):(D=F/y,a=(i-T)/D,o=(n-x-(M-F*B)/2)/D);else{if(d!=="cover")throw new Error("Unsupported object-fit.");B>P?(D=F/y,a=(i-T)/D,o=(n-x+(F*B-M)/2)/D):(D=M/_,o=(n-x)/D,a=(i-T+(M/B-F)/2)/D)}const O={x:o+"px",y:a+"px"},A=2*Math.round(Math.min(_,y)/this._focusParameters.defaultFocusAreaSizeRatio/2)+"px",Y=A;await this._setLocalFocus(O,A,Y,this._focusParameters.tapFocusMinDistance,this._focusParameters.tapFocusMaxDistance),this._focusParameters.taskBackToContinous=setTimeout(()=>{this._videoTrack&&this._videoTrack.applyConstraints({advanced:[{focusMode:"continuous"}]}).catch(()=>{})},this._focusParameters.focusBackToContinousTime)},this._touchMoved=!1,this._touchMoveEvent=()=>{this._touchMoved=!0},this._recordedStates={},this.playCallbackInfo=null,this._toCanvas=function(){const t=document.createElement("canvas");let n;if(t.width=this.width,t.height=this.height,(this.pixelFormat||this.colorMode)==="grey"){n=new Uint8ClampedArray(this.width*this.height*4);for(let o=0;o<n.length;o+=4)n[o]=this.data[o/4],n[o+1]=this.data[o/4],n[o+2]=this.data[o/4],n[o+3]=255}else n=new Uint8ClampedArray(this.data.buffer);const i=new ImageData(n,this.width,this.height);return t.getContext("2d").putImageData(i,0,0),t},this._onCameraSelChange=async()=>{await this.selectCamera(this._selCam.value),this._bOpen||this.stop()},this._onResolutionSelChange=async()=>{let t,n;if(this._selRsl&&this._selRsl.selectedIndex!=-1){let i=this._selRsl.options[this._selRsl.selectedIndex];t=i.getAttribute("data-width"),n=i.getAttribute("data-height")}await this.setResolution(t,n),this._bOpen||this.stop()},this._onCloseBtnClick=()=>{this.close(!0)},this._bOpen=!1,this.isCameraEnhancer=!0,this.isDisposed=!1,this.disposed=!1,this.videoSrc=null,this.videoSettings={video:{width:{ideal:1280},height:{ideal:720},facingMode:{ideal:"environment"}}},this.iPlayRound=0,this.promisePlay=null,this._ifSaveLastUsedCamera=!1,this.ifSkipCameraInspection=!1,this._allCameras=[],this._currentCamera=null,this._videoTrack=null,this._lastDeviceId=void 0,this._vc_bPlayingVideoBeforeHide=!1,this._ev_documentHideEvent=()=>{if(!this.singleFrameMode)if(document.visibilityState==="visible"){if(this._bOpen&&this._vc_bPlayingVideoBeforeHide){if(this.videoSrc)this._video.play();else if(this._video.srcObject){const t=this._video.srcObject.getTracks()[0];this._video.srcObject.active&&t&&!t.muted?this._video.play():this.play()}}}else document.visibilityState==="hidden"&&(["iPhone","iPad","Mac"].includes(Ke.OS)?(this._vc_bPlayingVideoBeforeHide=!0,this._video&&this._video.pause()):this._video&&!this._video.paused?(this._vc_bPlayingVideoBeforeHide=!0,this._video.pause()):this._vc_bPlayingVideoBeforeHide=!1)},this.containerClassName="dce-video-container",this._elContainer=null,this._videoContainer=null,this._video=null,this.videoFit="contain",this._cvsScanRegion=null,this._divScanArea=null,this._divScanLight=null,this._bgLoading=null,this._selCam=null,this._bgCamera=null,this._selRsl=null,this._optGotRsl=null,this._btnClose=null,this._selMinLtr=null,this._optGotMinLtr=null,this.regionMaskFillStyle="rgba(0,0,0,0.5)",this.regionMaskStrokeStyle="rgb(254,142,20)",this.regionMaskLineWidth=2,this._bShowScanRegionMask=!0,this._bShowScanRegionLaser=void 0,this._defaultBShowScanRegionLaser=!1,this._scanRegion=null,this._arrScanRegionOverlays=[],this._layerBaseCvs=null,this._drawingLayerOfTip=null,this._tipArgs={x:void 0,y:void 0,width:void 0,duration:void 0,autoShowSuggestedTip:void 0},this._hideTipTimeoutId=null,this.onTipSuggested=null,this._cvsViewDecorator=null,this._decoratorType=[],this._decoratorArea=null,this._viewDecoratorInfo={rectangle:{lineWidth:4,strokeStyle:"rgb(254,142,20)",fillStyle:"transparent",maskFillStyle:"transparent"},focus:{lineWidth:4,strokeStyle:"rgb(254,142,20)",fillStyle:"transparent",maskFillStyle:"transparent"},crossline:{lineWidth:2,strokeStyle:"rgb(254,142,20)"},crosshair:{lineWidth:4,strokeStyle:"rgb(254,142,20)"}},this._croppingRegions=void 0,this._defaultCroppingRegions=[null],this.bIncreaseRegionIndexAuto=!0,this._croppingRegionIndex=0,this._loopInterval=void 0,this._defaultLoopInterval=0,this._maxNumberOfFramesInBuffer=void 0,this._defaultMaxNumberOfFramesInBuffer=1,this._frameQueue=[],this._bFetchingLoopStarted=!1,this._refreshInterval=void 0,this._defaultRefreshInterval=-1,this._updateLayersTimeout=500,this._updateLayers=()=>{this._cvsScanRegion&&(this._cvsScanRegion.style.display="none"),this._divScanLight&&(this._divScanLight.style.display="none"),this._cvsViewDecorator&&(this._cvsViewDecorator.style.display="none");for(let t of this._arrScanRegionOverlays)t&&(t.style.display="none");this._resizeTimeoutId&&clearTimeout(this._resizeTimeoutId),this._resizeTimeoutId=setTimeout(()=>{if(!this.isDisposed||!this.disposed){this.ifShowScanRegionMask&&this.showScanRegionMask(),this.ifShowScanRegionLaser&&this.showScanRegionLaser(),this._cvsViewDecorator&&this.showViewDecorator(),this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let t of this._arrScanRegionOverlays)t&&(t.style.display="",this._updateScanRegionOverlay(t));this._updateDrawingLayersSize(),this._updateVideoContainerStyle()}},this._updateLayersTimeout)},this._windowResizeListener=()=>{this._windowWidth!==document.documentElement.clientWidth&&(this._windowWidth=document.documentElement.clientWidth,this._updateLayers())},this.mapCameraEvents=new Map([["cameraopen",[]],["cameraclose",[]],["camerachange",[]],["resolutionchange",[]],["played",[]],["singleframeacquired",[]],["frameaddedtobuffer",[]]]),this._controler=null}static getVersion(){return this._version}static async detectEnvironment(){return await(async()=>({wasm:E_,worker:T_,getUserMedia:Xf,camera:await k_(),browser:Ke.browser,version:Ke.version,OS:Ke.OS}))()}static set engineResourcePath(t){if(this._hasEngineResourceLoaded)throw new Error("`engineResourcePath` is not allowed to change after `createInstance` is called.");xe._engineResourcePath=(n=>{if(n==null&&(n="./"),!Ds){let i=document.createElement("a");i.href=n,n=i.href}return n.endsWith("/")||(n+="/"),n})(t)}static get engineResourcePath(){return this._engineResourcePath}static isStorageAvailable(t){let n;try{n=window[t];const i="__storage_test__";return n.setItem(i,i),n.removeItem(i),!0}catch(i){return i instanceof DOMException&&(i.code===22||i.code===1014||i.name==="QuotaExceededError"||i.name==="NS_ERROR_DOM_QUOTA_REACHED")&&n&&n.length!==0}}static isDCEFrame(t){return!(!t||typeof t!="object"||Array.isArray(t))&&"data"in t&&"region"in t&&"sx"in t&&"sy"in t&&"width"in t&&"height"in t&&("colorMode"in t||"pixelFormat"in t)&&"timeSpent"in t&&"timeStamp"in t&&"isCropped"in t&&"toCanvas"in t&&"_sWidth"in t&&"_sHeight"in t&&"_bUseWebGL"in t}static async testCameraAccess(){try{if(!navigator||!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return{ok:!1,message:"Insecure context."};(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(t=>{t.stop()})}catch(t){if(t.name==="OverconstrainedError"||t.name==="NotFoundError")return{ok:!1,message:"No camera detected."};if(t.name==="NotAllowedError")return{ok:!1,message:"No permission to access camera."};if(t.name==="AbortError")return{ok:!1,message:"Some problem occurred which prevented the device from being used."};if(t.name==="NotReadableError")return{ok:!1,message:"A hardware error occurred."};if(t.name==="SecurityError")return{ok:!1,message:"User media support is disabled."};throw t}return{ok:!0,message:"Successfully accessed the camera."}}set maxCvsSideLength(t){if(t<=0)throw new Error("Invalid value.");this._maxCvsSideLength=t}get maxCvsSideLength(){if(this._maxCvsSideLength!==void 0)return this._maxCvsSideLength;if(this._controler){const t=this._controler.getPropertyDisiredValue("maxCvsSideLength");if(t&&t.length===1)return t[0]}return this._defaultMaxCvsSideLength}static set defaultUIElementURL(t){xe._defaultUIElementURL=t}static get defaultUIElementURL(){var t;return(t=xe._defaultUIElementURL)===null||t===void 0?void 0:t.replace("@engineResourcePath/",xe.engineResourcePath)}getUIElement(){return this.UIElement}async setUIElement(t){if(this._bOpen)throw new Error("It is not allowed to change the UIElement when the camera is open.");if(typeof t=="string"||t instanceof String){if(!t.trim().startsWith("<")){let i=await fetch(t);if(!i.ok)throw Error("setUIElement(elementOrUrl): Network Error: "+i.statusText);t=await i.text()}if(!t.trim().startsWith("<"))throw Error("setUIElement(elementOrUrl): Can't get valid HTMLElement.");let n=document.createElement("div");n.innerHTML=t;for(let i=0;i<n.childElementCount;++i){let o=n.children[i];o instanceof HTMLStyleElement&&(this.styleEls.push(o),document.head.append(o))}(t=n.childElementCount==1?n.children[0]:n).remove()}this.UIElement=t,this._uiOriginalState={display:t&&t.style.display,inDom:document.body.contains(t)}}appendAndShowUI(){this.UIElement&&(this.UIElement.parentNode||(this.UIElement.style.position="fixed",this.UIElement.style.left="0",this.UIElement.style.top="0",document.body.append(this.UIElement)),this.UIElement.style.display=="none"&&(this.UIElement.style.display=""))}hideUI(){this.UIElement&&(this.UIElement.style.display="none")}get singleFrameMode(){return this._singleFrameMode}set singleFrameMode(t){if(this._bOpen)throw new Error("It is not allowed to change `singleFrameMode` when the camera is open.");this._singleFrameMode=t}set frameColorMode(t){this._framePixelFormat=t}get frameColorMode(){if(this._framePixelFormat!==void 0)return this._framePixelFormat;if(this._controler){const t=this._controler.getPropertyDisiredValue("framePixelFormat")||this._controler.getPropertyDisiredValue("frameColorMode");if(t&&t.length===1)return t[0]}return this._defaultFramePixelFormat}set framePixelFormat(t){this._framePixelFormat=t}get framePixelFormat(){if(this._framePixelFormat!==void 0)return this._framePixelFormat;if(this._controler){const t=this._controler.getPropertyDisiredValue("framePixelFormat")||this._controler.getPropertyDisiredValue("frameColorMode");if(t&&t.length===1)return t[0]}return this._defaultFramePixelFormat}set bOpen(t){if(this._bOpen=t,t){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let n of this._arrScanRegionOverlays)n&&this._updateScanRegionOverlay(n);this._updateDrawingLayersSize(),this.ifShowScanRegionMask?this.showScanRegionMask():this.hideScanRegionMask(),this.ifShowScanRegionLaser?this.showScanRegionLaser():this.hideScanRegionLaser(),this.showViewDecorator(),this.showScanRegionOverlays(),this._drawingLayersManager.setVisible(!0)}else this._softwareScale=1}set ifSaveLastUsedCamera(t){t?xe.isStorageAvailable("localStorage")?this._ifSaveLastUsedCamera=!0:(this._ifSaveLastUsedCamera=!1,console.warn("Local storage is unavailable")):this._ifSaveLastUsedCamera=!1}get ifSaveLastUsedCamera(){return this._ifSaveLastUsedCamera}get video(){return this._video}setVideoFit(t){if(t=t.toLowerCase(),!["contain","cover"].includes(t))throw new Error(`Unsupported value '${t}'.`);if(this.videoFit=t,this._video&&(this._video.style.objectFit=t,!this.singleFrameMode)){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let n of this._arrScanRegionOverlays)n&&this._updateScanRegionOverlay(n);this._updateVideoContainerStyle(),this._drawingLayersManager.setObjectFit(t)}}getVideoFit(){return this.videoFit}_showElClassName(){this._cvsScanRegion&&this._cvsScanRegion.classList.add("cvs-scan-region-mask"),this._cvsViewDecorator&&this._cvsViewDecorator.classList.add("cvs-view-decorator"),this._scanRegionOverlayContainer&&this._scanRegionOverlayContainer.classList.add("div-scan-region-overlay-container"),this._layerBaseCvs&&this._layerBaseCvs.classList.add("cvs-drawing-layer-base"),this._layerBaseCvs&&this._layerBaseCvs.parentElement.classList.add("div-drawing-layer-container"),this._cvsOriginalImage&&this._cvsOriginalImage.classList.add("cvs-original-image"),this._cvsSingleFrameMode&&this._cvsSingleFrameMode.classList.add("cvs-single-frame")}_hideElClassName(){this._cvsScanRegion&&this._cvsScanRegion.classList.remove("cvs-scan-region-mask"),this._cvsViewDecorator&&this._cvsViewDecorator.classList.remove("cvs-view-decorator"),this._scanRegionOverlayContainer&&this._scanRegionOverlayContainer.classList.remove("div-scan-region-overlay-container"),this._layerBaseCvs&&this._layerBaseCvs.classList.remove("cvs-drawing-layer-base"),this._layerBaseCvs&&this._layerBaseCvs.parentElement.classList.remove("div-drawing-layer-container"),this._cvsOriginalImage&&this._cvsOriginalImage.classList.remove("cvs-original-image"),this._cvsSingleFrameMode&&this._cvsSingleFrameMode.classList.remove("cvs-single-frame")}set ifShowScanRegionMask(t){this._bShowScanRegionMask=t,t?this.showScanRegionMask():this.hideScanRegionMask()}get ifShowScanRegionMask(){return this._bShowScanRegionMask}showScanRegionMask(){this._cvsScanRegion&&(this._cvsScanRegion.style.display=="none"&&(this._cvsScanRegion.style.display=""),this._recordedStates.maskShow=!0)}hideScanRegionMask(){this._cvsScanRegion&&(this._cvsScanRegion.style.display="none",this._recordedStates.maskShow=!1)}set ifShowScanRegionLaser(t){this._bShowScanRegionLaser=t,t?this.showScanRegionLaser():this.hideScanRegionLaser()}get ifShowScanRegionLaser(){if(this._bShowScanRegionLaser!==void 0)return this._bShowScanRegionLaser;if(this._controler){const t=this._controler.getPropertyDisiredValue("ifShowScanRegionLaser");if(t&&t.length){let n=0;for(let i of t)i||n++;return n!==this._controler.getRegisteredUsers().length}}return this._defaultBShowScanRegionLaser}showScanRegionLaser(){this._divScanLight&&(this._divScanLight.style.display=="none"&&(this._divScanLight.style.display="block"),this._recordedStates.laserShow=!0)}hideScanRegionLaser(){this._divScanLight&&(this._divScanLight.style.display="none",this._recordedStates.laserShow=!1)}_checkValidRegion(t){return!(t!==null&&(!t||!(t.hasOwnProperty("regionLeft")&&t.hasOwnProperty("regionTop")&&t.hasOwnProperty("regionRight")&&t.hasOwnProperty("regionBottom")&&t.hasOwnProperty("regionMeasuredByPercentage"))||t.regionLeft<0||t.regionTop<0||t.regionRight<0||t.regionBottom<0||t.regionMeasuredByPercentage&&(t.regionLeft>100||t.regionTop>100||t.regionRight>100||t.regionBottom>100)))}set scanRegion(t){if(!this._checkValidRegion(t))throw new Error("Invalid region.");this._scanRegion=JSON.parse(JSON.stringify(t)),this._updateScanRegionCanvas(),this._updateScanAreaDiv();for(let n of this._arrScanRegionOverlays)n&&this._updateScanRegionOverlay(n)}setScanRegion(t){this.scanRegion=t}getScanRegion(){return JSON.parse(JSON.stringify(this._scanRegion))}_calculateCvsSize(){var t,n;let i,o,a;if(this.singleFrameMode?(i=this._imgWidth,o=this._imgHeight,a="contain"):(i=(t=this._video)===null||t===void 0?void 0:t.videoWidth,o=(n=this._video)===null||n===void 0?void 0:n.videoHeight,a=this.getVideoFit()),!i||!o)throw new Error("Invalid content dimensions.");return{width:i,height:o,objectFit:a}}addScanRegionOverlayCanvas(){this._assertOpen();const t=document.createElement("canvas");if(this._updateScanRegionOverlay(t),!this._scanRegionOverlayContainer){const n=document.createElement("div");if(this._scanRegionOverlayContainer=n,n.style.position="absolute",n.style.left="0",n.style.top="0",n.style.width="100%",n.style.height="100%",n.style.overflow="hidden",n.style.pointerEvents="none",this._layerBaseCvs)this._layerBaseCvs.parentElement.after(n);else if(this._cvsScanRegion)this._cvsScanRegion.after(n);else if(this._cvsOriginalImage)this._cvsOriginalImage.after(n);else if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(n);else{if(!this._videoContainer)throw new Error("Unable to find video element");this._videoContainer.after(n)}this._recordedStates.overlayShow=!0}return this._scanRegionOverlayContainer.append(t),this._arrScanRegionOverlays.push(t),t}removeScanRegionOverlayCanvas(t){const n=this._arrScanRegionOverlays.indexOf(t);n!==-1&&(t.remove(),this._arrScanRegionOverlays.splice(n,1))}_updateScanRegionOverlay(t){if(!t)return;let n;try{n=this._calculateCvsSize()}catch(Y){if((Y.message||Y)==="Invalid content dimensions.")return;throw Y}const{width:i,height:o,objectFit:a}=n;if(i<=0||o<=0)return t.width=0,void(t.height=0);const d=this._getRegionInPixels(i,o,this._scanRegion),_=this.getFrameSize(i,o,this._scanRegion,this.maxCvsSideLength),y=_.dWidth,w=_.dHeight;t.width==y&&t.height==w||(t.width=y,t.height=w);const x=window.getComputedStyle(this._elContainer),T=parseFloat(x.width),E=parseFloat(x.height),M=T/E,F=i/o;let P,B,D,O,A=1;a==="contain"?(F>M?(A=T/i,P=0,B=(E-o*A)/2):(A=E/o,P=(T-i*A)/2,B=0),P+=d.regionLeft*A,B+=d.regionTop*A,D=(d.regionRight-d.regionLeft)*A,O=(d.regionBottom-d.regionTop)*A):a==="cover"?(F>M?(A=E/o,P=d.regionLeft*A-(i*A-T)/2,B=d.regionTop*A):(A=T/i,P=d.regionLeft*A,B=d.regionTop*A-(o*A-E)/2),D=(d.regionRight-d.regionLeft)*A,O=(d.regionBottom-d.regionTop)*A):(P=0,B=0,D=0,O=0),t.style.position="absolute",t.style.left=P+"px",t.style.top=B+"px",t.style.width=D+"px",t.style.height=O+"px"}showScanRegionOverlays(){this._scanRegionOverlayContainer&&(this._scanRegionOverlayContainer.style.display=="none"&&(this._scanRegionOverlayContainer.style.display=""),this._recordedStates.overlayShow=!0)}hideScanRegionOverlays(){this._scanRegionOverlayContainer&&(this._scanRegionOverlayContainer.style.display="none",this._recordedStates.overlayShow=!1)}setViewDecorator(t,n){if(!t)return void(this._cvsViewDecorator&&(this._cvsViewDecorator.remove(),this._cvsViewDecorator=null));if(!n)throw new Error("Invalid area.");this._assertOpen();let i=[];if(typeof t=="string"?i.push(t):Array.isArray(t)&&(i=JSON.parse(JSON.stringify(t))),!this._cvsViewDecorator){if(this._cvsViewDecorator=document.createElement("canvas"),this._scanRegionOverlayContainer)this._scanRegionOverlayContainer.after(this._cvsViewDecorator);else if(this._layerBaseCvs)this._layerBaseCvs.parentElement.after(this._cvsViewDecorator);else if(this._cvsScanRegion)this._cvsScanRegion.after(this._cvsViewDecorator);else if(this._cvsOriginalImage)this._cvsOriginalImage.after(this._cvsViewDecorator);else if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(this._cvsViewDecorator);else{if(!this._videoContainer)throw new Error("Unable to find video element");this._videoContainer.after(this._cvsViewDecorator)}this._recordedStates.decoratorShow=!0}this._decoratorArea=JSON.parse(JSON.stringify(n)),this._decoratorType.length=0;const o=["rectangle","focus"],a=["crossline","crosshair"];let d=!1,_=!1;for(let y of i)y=y.toLowerCase(),o.includes(y)&&!d&&(d=!0,this._decoratorType.push(y)),a.includes(y)&&!_&&(_=!0,!this._decoratorType.includes(y)&&this._decoratorType.push(y));this._updateViewDecorator()}getViewDecorator(){return{type:JSON.parse(JSON.stringify(this._decoratorType)),area:JSON.parse(JSON.stringify(this._decoratorArea)),canvas:this._cvsViewDecorator}}showViewDecorator(){this._cvsViewDecorator&&(this._cvsViewDecorator.style.display=="none"&&(this._cvsViewDecorator.style.display=""),this._recordedStates.decoratorShow=!0)}hideViewDecorator(){this._cvsViewDecorator&&(this._cvsViewDecorator.style.display="none",this._recordedStates.decoratorShow=!1)}setViewDecoratorLineWidth(t,n){if(typeof t!="string")throw new Error("The 'type' should be a string.");if(t=t.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(t))throw new Error(`The type of '${t}' doesn't exist.`);if(!this._viewDecoratorInfo[t].hasOwnProperty("lineWidth"))throw new Error(`It is not allowed to change the property 'lineWidth' when the decorator type is '${t}'.`);this._viewDecoratorInfo[t].lineWidth=n,this._updateViewDecorator()}setViewDecoratorStrokeStyle(t,n){if(typeof t!="string")throw new Error("The 'type' should be a string.");if(t=t.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(t))throw new Error(`The type of '${t}' doesn't exist.`);if(!this._viewDecoratorInfo[t].hasOwnProperty("strokeStyle"))throw new Error(`It is not allowed to change the property 'strokeStyle' when the decorator type is '${t}'.`);this._viewDecoratorInfo[t].strokeStyle=n,this._updateViewDecorator()}setViewDecoratorFillStyle(t,n){if(typeof t!="string")throw new Error("The 'type' should be a string.");if(t=t.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(t))throw new Error(`The type of '${t}' doesn't exist.`);if(!this._viewDecoratorInfo[t].hasOwnProperty("fillStyle"))throw new Error(`It is not allowed to change the property 'fillStyle' when the decorator type is '${t}'.`);this._viewDecoratorInfo[t].fillStyle=n,this._updateViewDecorator()}setViewDecoratorMaskFillStyle(t,n){if(typeof t!="string")throw new Error("The 'type' should be a string.");if(t=t.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(t))throw new Error(`The type of '${t}' doesn't exist.`);if(!this._viewDecoratorInfo[t].hasOwnProperty("maskFillStyle"))throw new Error(`It is not allowed to change the property 'maskFillStyle' when the decorator type is '${t}'.`);this._viewDecoratorInfo[t].maskFillStyle=n,this._updateViewDecorator()}_updateViewDecorator(){if(!this._bOpen||!this._cvsViewDecorator||!this._decoratorArea)return;let t;if(this.singleFrameMode)t="contain";else{if(!this._video)return;t=this.getVideoFit()}const n=this._cvsViewDecorator;n.style.position="absolute",n.style.width="100%",n.style.height="100%",n.style.left="0",n.style.top="0",n.style.objectFit=t,n.style.pointerEvents="none";const i=this.getVisibleRegion(!0);if(!i)return;const o=i.regionRight-i.regionLeft,a=i.regionBottom-i.regionTop;if(n.width==o&&n.height==a||(n.width=o,n.height=a),o<=0||a<=0)return;const d=n.getContext("2d");d.clearRect(0,0,n.width,n.height);const _=this._decoratorArea.x/100*o,y=this._decoratorArea.y/100*a,w=this._decoratorArea.width/100*o,x=this._decoratorArea.height/100*a;for(let T of this._decoratorType){if(T==="rectangle"){d.fillStyle=this._viewDecoratorInfo.rectangle.maskFillStyle,d.fillRect(0,0,n.width,n.height),d.clearRect(Math.round(_),Math.round(y),Math.round(w),Math.round(x)),d.fillStyle=this._viewDecoratorInfo.rectangle.fillStyle,d.fillRect(Math.round(_),Math.round(y),Math.round(w),Math.round(x)),d.lineWidth=this._viewDecoratorInfo.rectangle.lineWidth,d.strokeStyle=this._viewDecoratorInfo.rectangle.strokeStyle;const E=d.lineWidth/2;d.strokeRect(Math.round(_-E),Math.round(y-E),Math.round(w+d.lineWidth),Math.round(x+d.lineWidth))}if(T==="focus"){d.fillStyle=this._viewDecoratorInfo.focus.maskFillStyle,d.fillRect(0,0,n.width,n.height),d.clearRect(Math.round(_),Math.round(y),Math.round(w),Math.round(x)),d.fillStyle=this._viewDecoratorInfo.focus.fillStyle,d.fillRect(Math.round(_),Math.round(y),Math.round(w),Math.round(x)),d.lineWidth=this._viewDecoratorInfo.focus.lineWidth,d.strokeStyle=this._viewDecoratorInfo.focus.strokeStyle;const E=d.lineWidth/2,M=[0,.25,.75,1],F=[0,.25,.75,1];d.beginPath();for(let P=0;P<M.length;P++)if(P==0||P==3)for(let B=0;B<F.length;B+=2)d.moveTo(Math.round(_+M[P]*w),Math.round(y+F[B]*x)),d.lineTo(Math.round(_+M[P]*w),Math.round(y+F[B+1]*x));for(let P=0;P<F.length;P++)if(P==0||P==3)for(let B=0;B<M.length;B+=2)d.moveTo(Math.round(_+M[B]*w-E),Math.round(y+F[P]*x)),d.lineTo(Math.round(_+M[B+1]*w+E),Math.round(y+F[P]*x));d.stroke()}if(T==="crossline"&&(d.beginPath(),d.lineWidth=this._viewDecoratorInfo.crossline.lineWidth,d.strokeStyle=this._viewDecoratorInfo.crossline.strokeStyle,d.moveTo(Math.round(_),Math.round(y+x/2)),d.lineTo(Math.round(_+w),Math.round(y+x/2)),d.moveTo(Math.round(_+w/2),Math.round(y)),d.lineTo(Math.round(_+w/2),Math.round(y+x)),d.stroke()),T==="crosshair"){d.beginPath();const E=.05*Math.min(w,x);d.lineWidth=this._viewDecoratorInfo.crosshair.lineWidth,d.strokeStyle=this._viewDecoratorInfo.crosshair.strokeStyle,d.moveTo(Math.round(_+(w-E)/2),Math.round(y+x/2)),d.lineTo(Math.round(_+(w+E)/2),Math.round(y+x/2)),d.moveTo(Math.round(_+w/2),Math.round(y+(x-E)/2)),d.lineTo(Math.round(_+w/2),Math.round(y+(x+E)/2)),d.stroke()}}}getVisibleRegion(t){let n;this._assertOpen();try{n=this._calculateCvsSize()}catch(_){if((_.message||_)==="Invalid content dimensions.")return null;throw _}const{width:i,height:o,objectFit:a}=n;let d=(()=>{const _=parseFloat(window.getComputedStyle(this._elContainer).width),y=parseFloat(window.getComputedStyle(this._elContainer).height);let w,x={regionBottom:o,regionRight:i,regionLeft:0,regionTop:0,regionMeasuredByPercentage:!1};return a==="cover"?_/y<i/o?(w=y/o,x.regionLeft=Math.floor((i-_/w)/2),x.regionRight=Math.ceil(i-x.regionLeft),x.regionTop=0,x.regionBottom=o):(w=_/i,x.regionTop=Math.floor((o-y/w)/2),x.regionBottom=Math.ceil(o-x.regionTop),x.regionLeft=0,x.regionRight=i):a==="none"&&(_<i&&y<o?(x.regionLeft=Math.floor((i-_)/2),x.regionRight=Math.ceil(i-x.regionLeft),x.regionTop=Math.floor((o-y)/2),x.regionBottom=Math.ceil(o-x.regionTop)):_<i?(x.regionLeft=Math.floor((i-_)/2),x.regionRight=Math.ceil(i-x.regionLeft),x.regionTop=0,x.regionBottom=o):y<o&&(x.regionTop=Math.floor((o-y)/2),x.regionBottom=Math.ceil(o-x.regionTop),x.regionLeft=0,x.regionRight=i)),x})();return t?d.regionMeasuredByPercentage=!1:(d.regionBottom=Math.ceil(d.regionBottom/o*100),d.regionRight=Math.ceil(d.regionRight/i*100),d.regionLeft=Math.floor(d.regionLeft/i*100),d.regionTop=Math.floor(d.regionTop/o*100),d.regionMeasuredByPercentage=!0),d}setScanRegionMaskStyle(t){t&&(t.fillStyle&&(this.regionMaskFillStyle=t.fillStyle),t.strokeStyle&&(this.regionMaskStrokeStyle=t.strokeStyle),t.lineWidth&&(this.regionMaskLineWidth=t.lineWidth),this._updateScanRegionCanvas())}_getRegionInPixels(t,n,i){if(!(t<=0||n<=0))return i?i.regionMeasuredByPercentage?{regionLeft:Math.round(i.regionLeft/100*t),regionTop:Math.round(i.regionTop/100*n),regionRight:Math.round(i.regionRight/100*t),regionBottom:Math.round(i.regionBottom/100*n),regionMeasuredByPercentage:!1}:JSON.parse(JSON.stringify(i)):{regionLeft:0,regionTop:0,regionRight:t,regionBottom:n,regionMeasuredByPercentage:!1}}_updateScanRegionCanvas(){if(!this._bOpen)return;let t;try{t=this._calculateCvsSize()}catch(y){if((y.message||y)==="Invalid content dimensions.")return;throw y}const{width:n,height:i,objectFit:o}=t;if(n<=0||i<=0)return void(this._cvsScanRegion&&(this._cvsScanRegion.width=0,this._cvsScanRegion.height=0));const a=this._getRegionInPixels(n,i,this._scanRegion);if(!this._cvsScanRegion){if(this._cvsScanRegion=document.createElement("canvas"),this._cvsOriginalImage)this._cvsOriginalImage.after(this._cvsScanRegion);else if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(this._cvsScanRegion);else{if(!this._videoContainer)throw new Error("Unable to find video element");this._videoContainer.after(this._cvsScanRegion)}this._recordedStates.maskShow=!0}const d=this._cvsScanRegion;d.style.position="absolute",d.style.width="100%",d.style.height="100%",d.style.left="0",d.style.top="0",d.style.objectFit=o,d.style.pointerEvents="none",d.width==n&&d.height==i||(d.width=n,d.height=i);const _=d.getContext("2d");if(_.clearRect(0,0,d.width,d.height),a.regionLeft!=0||a.regionRight!=n||a.regionTop!=0||a.regionBottom!=i){const y=a.regionLeft,w=a.regionTop,x=a.regionRight-a.regionLeft,T=a.regionBottom-a.regionTop;_.fillStyle=this.regionMaskFillStyle,_.fillRect(0,0,d.width,d.height),_.clearRect(Math.round(y),Math.round(w),Math.round(x),Math.round(T)),_.strokeStyle=this.regionMaskStrokeStyle,_.lineWidth=this.regionMaskLineWidth;const E=_.lineWidth/2;_.strokeRect(Math.round(y-E),Math.round(w-E),Math.round(x+_.lineWidth),Math.round(T+_.lineWidth))}}_updateScanAreaDiv(){if(!this._bOpen)return;let t;try{t=this._calculateCvsSize()}catch(B){if((B.message||B)==="Invalid content dimensions.")return;throw B}const{width:n,height:i,objectFit:o}=t;if(!this._divScanArea)return;if(n<=0||i<=0)return this._divScanArea.style.width="0",void(this._divScanArea.style.height="0");const a=this._getRegionInPixels(n,i,this._scanRegion),d=window.getComputedStyle(this._elContainer),_=parseFloat(d.width),y=parseFloat(d.height),w=_/y,x=n/i;let T,E,M,F,P=1;if(o==="contain")w<x?(P=_/n,T=0,E=(y-i*P)/2):(P=y/i,T=(_-n*P)/2,E=0),T+=a.regionLeft*P,E+=a.regionTop*P,M=(a.regionRight-a.regionLeft)*P,F=(a.regionBottom-a.regionTop)*P;else if(o==="cover")if(w<x){P=y/i,T=a.regionLeft*P-(n*P-_)/2,T=Math.max(T,0),T=Math.min(T,parseFloat(d.width)),E=a.regionTop*P;let B=a.regionRight*P-(n*P-_)/2;B=Math.max(B,0),B=Math.min(B,parseFloat(d.width)),M=B-T,F=(a.regionBottom-a.regionTop)*P}else{P=_/n,T=a.regionLeft*P,E=a.regionTop*P-(i*P-y)/2,E=Math.max(E,0),E=Math.min(E,parseFloat(d.height));let B=a.regionBottom*P-(i*P-y)/2;B=Math.max(B,0),B=Math.min(B,parseFloat(d.height)),M=(a.regionRight-a.regionLeft)*P,F=B-E}else T=0,E=0,M=0,F=0;this._divScanArea.style.left=T+"px",this._divScanArea.style.top=E+"px",this._divScanArea.style.width=M+"px",this._divScanArea.style.height=F+"px"}set croppingRegions(t){this._croppingRegions=t,this._bFetchingLoopStarted&&(this.bIncreaseRegionIndexAuto&&(this._croppingRegionIndex=0),this._fetchingLoop(!1))}get croppingRegions(){if(this._croppingRegions!==void 0)return this._croppingRegions;if(this._controler){const t=this._controler.getPropertyDisiredValue("croppingRegions");if(t&&t.length===1)return t[0]}return this._defaultCroppingRegions}set croppingRegionIndex(t){t<0?(this.bIncreaseRegionIndexAuto=!0,this._croppingRegionIndex=0):(this.bIncreaseRegionIndexAuto=!1,this._croppingRegionIndex=t)}get croppingRegionIndex(){return this._croppingRegionIndex}set loopInterval(t){if(t<0)throw new Error("'Invalid value.");this._loopInterval=t,this._bFetchingLoopStarted&&this._fetchingLoop(!1)}get loopInterval(){if(this._loopInterval!==void 0)return this._loopInterval;if(this._controler){const t=this._controler.getPropertyDisiredValue("loopInterval");if(t&&t.length===1)return t[0]}return this._defaultLoopInterval}set maxNumberOfFramesInBuffer(t){if(t<=0)throw new Error("Invalid value.");for(this._maxNumberOfFramesInBuffer=t;this._frameQueue&&this._frameQueue.length>this.maxNumberOfFramesInBuffer;)this._frameQueue.shift()}get maxNumberOfFramesInBuffer(){if(this._maxNumberOfFramesInBuffer!==void 0)return this._maxNumberOfFramesInBuffer;if(this._controler){const t=this._controler.getPropertyDisiredValue("maxNumberOfFramesInBuffer");if(t&&t.length===1)return t[0]}return this._defaultMaxNumberOfFramesInBuffer}get numberOfFramesInBuffer(){return this._frameQueue.length}set refreshInterval(t){this._refreshInterval=t}get refreshInterval(){if(this._refreshInterval!==void 0)return this._refreshInterval;if(this._controler){const t=this._controler.getPropertyDisiredValue("refreshInterval");if(t&&t.length===1)return t[0]}return this._defaultRefreshInterval}static async createInstance(t){let n=new xe;(typeof t=="string"||t instanceof String)&&(t=JSON.parse(t));for(let i in t)n[i]=t[i];return this._hasEngineResourceLoaded=!0,n._drawingLayersManager=new L_,n}static async playVideo(t,n,i){return new Promise((o,a)=>{t||a(new Error("Invalid video element.")),n||a(new Error("Invalid source.")),t.onloadedmetadata=async()=>{t.onloadedmetadata=null,await t.play(),o(t)},typeof n=="string"||n instanceof String?t.src=n:t.srcObject=n,i!==void 0&&setTimeout(()=>a(new Error("Failed to play video. Timeout.")),i)})}static findBestRearCameraInIOS(t){if(!t||!t.length)return null;const n=["back","baksidan","bakre","bak","後置","后置","背面","خلفية","задна","posteriore","posterior","zadní","bagside","rück","πίσω","trasera","taka","arrière","אחורית","बैक","stražnja","hátsó","belakang","aртқы","후면","achterzijde","tylny","traseira","spate","задняя","задней","zadná","านหลัง","arka","sau"],i=["triple","三镜头","三鏡頭","トリプル","ثلاثية","тройна","trojný","τριπλή","kolmois","משולשת","ट्रिपल","trostruka","tiga","tripla","үштік","트리플","trippelt","trippel","trójobiektywowy","triplă","тройная","trojitá","สาม","üçlü","потроєна","ba camera"],o=["dual wide","dual-weitwinkel","dual con gran angular","dual","doble","double","双广角","雙廣角","デュアル広角","مزدوجة عريضة","двойна широкоъгълна","duální širokoúhlý","διπλή ευρεία","laajakulmainen kaksois","כפולה רחבה","ड्युअल वाइड","dvostruka široka","kettős, széles látószögű","ganda","doppia con grandangolo","қос кең бұрышты","듀얼 와이드","dwikamera","dobbelt vidvinkelkamera","dwuobiektywowy","dupla grande-angular","grande angular dupla","dublă","двойная широкоугольная","duálna širokouhlá","dubbel vidvinkel","คู่ด้านหลังมุมกว้าง","çift geniş","здвоєна ширококутна","kép rộng mặt sau"],a=t.filter(y=>{const w=y.label.toLowerCase();return n.some(x=>w.includes(x))});if(!a.length)return null;const d=a.find(y=>{const w=y.label.toLowerCase();return i.some(x=>w.includes(x))});if(d)return d.deviceId;const _=a.find(y=>{const w=y.label.toLowerCase();return o.some(x=>w.includes(x))});return _?_.deviceId:a[0].deviceId}static findBestRearCamera(t){if(!t||!t.length)return null;if(["iPhone","iPad","Mac"].includes(Ke.OS))return xe.findBestRearCameraInIOS(t);const n=["rear","back","rück","arrière","trasera","trás","traseira","posteriore","posterior","后面","後面","背面","后置","後置","背置","задней","خلفية","후","arka","achterzijde","หลัง","baksidan","bagside","sau","bak","tylny","taka","אחורית","πίσω","spate","hátsó","zadní","darrere","zadná","задня","stražnja","belakang","बैक","задна","aртқы","задняя","bakre","านหลัง"];for(let i of t){const o=i.label.toLowerCase();if(o&&n.some(a=>o.includes(a))&&/\b0(\b)?/.test(o))return i.deviceId}return["Android","HarmonyOS"].includes(Ke.OS)?t[t.length-1].deviceId:null}async play(t,n,i,o){if(this._video&&this.videoSrc){const _=await xe.playVideo(this._video,this.videoSrc,4e3);if(!this._video)return _.pause(),this.playCallbackInfo={width:0,height:0,deviceId:null},{width:0,height:0,deviceId:null};const y={width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId};this.playCallbackInfo=JSON.parse(JSON.stringify(y));const w=this.mapCameraEvents.get("played");for(let x of w){if(!x)continue;const T=JSON.parse(JSON.stringify(y));setTimeout(()=>{this.isDisposed&&this.disposed||x.apply(this,[T])},0)}return this._recordedStates.videoPlaying=!0,y}if(this.singleFrameMode)return o&&o.notTriggerSingleFrameClick||this._clickIptSingleFrameMode(),this.playCallbackInfo={width:0,height:0,deviceId:null},{width:0,height:0,deviceId:null};if(!this._video)throw new Error("'video' is null or undefined.");const a=++this.iPlayRound;if(this.promisePlay&&(await this.promisePlay,a<this.iPlayRound))return this.playCallbackInfo={width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId},{width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId};this.promisePlay=(async()=>{var _;try{this._video&&this._video.srcObject&&this.stop(),xe._onLog&&xe._onLog("DCE: ======before video========");const y=()=>{if(!this._video)throw T&&T.getTracks().forEach(A=>{A.stop()}),this._videoTrack=null,this._currentCamera=null,new Error("'video' is null or undefined.")},w=this.getVideoSettings();let x,T;if(typeof w.video=="boolean"&&(w.video={}),t)delete w.video.facingMode,w.video.deviceId={exact:t};else if(!w.video.deviceId){if(this._lastDeviceId)delete w.video.facingMode,w.video.deviceId={exact:this._lastDeviceId};else if(this.ifSaveLastUsedCamera&&xe.isStorageAvailable&&window.localStorage.getItem("dce_last_camera_id")){delete w.video.facingMode,w.video.deviceId={ideal:window.localStorage.getItem("dce_last_camera_id")};const A=JSON.parse(window.localStorage.getItem("dce_last_apply_width")),Y=JSON.parse(window.localStorage.getItem("dce_last_apply_height"));A&&Y&&(w.video.width=A,w.video.height=Y)}else if(!this.ifSkipCameraInspection){if(w.video.facingMode){if(await this.getAllCameras(!1),!this._video)throw new Error("'video' is null or undefined.");let A=w.video.facingMode;if(A instanceof Array&&A.length&&(A=A[0]),A=A.exact||A.ideal||A,A==="environment"){x=!0;const Y=xe.findBestRearCamera(this._allCameras);Y&&(delete w.video.facingMode,w.video.deviceId={exact:Y})}}}}n&&(w.video.width={ideal:n}),i&&(w.video.height={ideal:i}),xe._onLog&&xe._onLog("DCE: ======try getUserMedia========");let E=[0,500],M=null;const F=async A=>{for(let Y of E){Y&&await new Promise(ne=>setTimeout(ne,Y)),y();try{xe._onLog&&xe._onLog("DCE: ask "+JSON.stringify(A)),T=await navigator.mediaDevices.getUserMedia(A);break}catch(ne){if(y(),ne.name==="NotFoundError"||ne.name==="NotAllowedError")throw ne;M=ne,xe._onLog&&xe._onLog("DCE: "+ne.message||ne)}}y()};let P;if(await F(w),T||(xe._onLog&&xe._onLog("DCE: ======try getUserMedia again========"),P=JSON.parse(JSON.stringify(w)),typeof P.video=="object"&&(["iPhone","iPad"].includes(Ke.OS)?(n>=1280||i>=1280?P.video.width=1280:n>=640||i>=640?P.video.width=640:(n<640||i<640)&&(P.video.width=320),delete P.video.height):x&&!w.video.deviceId?(delete P.video.facingMode,this._allCameras.length&&(P.video.deviceId={ideal:this._allCameras[this._allCameras.length-1].deviceId})):P.video=!0),xe._onLog&&xe._onLog("DCE: "+P),await F(P)),T||(E=[1e3,2e3],await F(w)),T||await F(P),!T)throw M;const B=()=>{const A=T.getVideoTracks();let Y,ne;if(A.length&&(Y=this._videoTrack=A[0]),this._video&&Y){const oe=Y.getSettings();if(oe){for(let K of this._allCameras)if(oe.deviceId===K.deviceId){K._checked=!0,K.label=Y.label,ne=K;break}}}this._currentCamera=ne};if(await this.getAllCameras(!1),y(),x&&!this.ifSkipCameraInspection){B();const A=xe.findBestRearCamera(this._allCameras),Y=(_=this._currentCamera)===null||_===void 0?void 0:_.deviceId;A&&A!=Y&&(T.getTracks().forEach(ne=>{ne.stop()}),E=[0,500,1e3,2e3],w.video.deviceId={exact:A},await F(w))}xe._onLog&&xe._onLog("DCE: ======play video========"),y(),await xe.playVideo(this._video,T,4e3),y(),xe._onLog&&xe._onLog("DCE: ======played video========"),this._bgLoading&&(this._bgLoading.style.animationPlayState="paused");const D=this._video.videoWidth+"x"+this._video.videoHeight;this._optGotRsl&&(this._optGotRsl.setAttribute("data-width",this._video.videoWidth),this._optGotRsl.setAttribute("data-height",this._video.videoHeight),this._optGotRsl.innerText=D,this._selRsl&&this._optGotRsl.parentNode==this._selRsl&&(this._selRsl.value="got")),xe._onLog&&xe._onLog("DCE: got "+D),B(),this._renderSelCameraInfo();const O={width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId};if(O.deviceId&&(this._lastDeviceId=O.deviceId,this.ifSaveLastUsedCamera&&xe.isStorageAvailable&&(window.localStorage.setItem("dce_last_camera_id",this._lastDeviceId),w.video.width&&w.video.height&&(window.localStorage.setItem("dce_last_apply_width",JSON.stringify(w.video.width)),window.localStorage.setItem("dce_last_apply_height",JSON.stringify(w.video.height))))),!o||!o.notTriggerPlayedEvent){const A=this.mapCameraEvents.get("played");for(let Y of A){if(!Y)continue;const ne=JSON.parse(JSON.stringify(O));setTimeout(()=>{this.isDisposed&&this.disposed||Y.apply(this,[ne])},0)}}return this.promisePlay=null,O}catch(y){throw this.promisePlay=null,this._bgLoading&&(this._bgLoading.style.display="none"),y.name==="NotFoundError"&&(DOMException?y=new DOMException("No camera available, please use a device with an accessible camera.",y.name):(y=new Error("No camera available, please use a device with an accessible camera.")).name="NotFoundError"),y}})();const d=await this.promisePlay;return this.playCallbackInfo=JSON.parse(JSON.stringify(d)),this._recordedStates.videoPlaying=!0,d}async resume(){this._assertOpen(),this._video&&(await this._video.play(),this._recordedStates.videoPlaying=!0),this.ifShowScanRegionLaser&&this.showScanRegionLaser()}pause(){this._assertOpen(),this._video&&(this._video.pause(),this._recordedStates.videoPlaying=!1),this.ifShowScanRegionLaser&&this.hideScanRegionLaser()}isPaused(){var t;return!this.singleFrameMode&&((t=this._video)===null||t===void 0?void 0:t.paused)===!0}_bindUI(){if(!this.UIElement)throw new Error("Need to define `UIElement` before opening.");const t=[this.UIElement];for(let n=0;n<t.length;++n)for(let i of t[n].children)t.push(i);for(let n of t){if(!this._video&&n.classList.contains(this.containerClassName)){this._elContainer=n;const i=document.createElement("video");i.style.position="absolute",i.style.left="0",i.style.top="0",i.style.width="100%",i.style.height="100%",i.style.objectFit=this.getVideoFit(),i.setAttribute("playsinline","true"),i.setAttribute("muted","true"),this._video=i;const o=document.createElement("div");o.append(i),o.style.position="absolute",o.style.left="0",o.style.top="0",o.style.width="100%",o.style.height="100%",o.style.overflow="hidden",this._videoContainer=o,n.prepend(o)}else!this._divScanArea&&n.classList.contains("dce-scanarea")?this._divScanArea=n:!this._divScanLight&&n.classList.contains("dce-scanlight")?this._divScanLight=n:!this._bgLoading&&n.classList.contains("dce-bg-loading")?this._bgLoading=n:!this._bgCamera&&n.classList.contains("dce-bg-camera")?this._bgCamera=n:!this._selCam&&n.classList.contains("dce-sel-camera")?this._selCam=n:!this._selRsl&&n.classList.contains("dce-sel-resolution")?(this._selRsl=n,this.videoSrc||this.singleFrameMode||this._selRsl.options.length||(this._selRsl.innerHTML=[this._optGotRsl?"":'<option class="dce-opt-gotResolution" value="got"></option>','<option data-width="1920" data-height="1080">1920x1080</option>','<option data-width="1280" data-height="720">1280x720</option>','<option data-width="640" data-height="480">640x480</option>'].join(""),this._optGotRsl=this._optGotRsl||this._selRsl.options[0])):!this._optGotRsl&&n.classList.contains("dce-opt-gotResolution")?this._optGotRsl=n:!this._btnClose&&n.classList.contains("dce-btn-close")?this._btnClose=n:!this._selMinLtr&&n.classList.contains("dlr-sel-minletter")?(this._selMinLtr=n,this._selMinLtr.options.length||(this._selMinLtr.innerHTML=[this._optGotMinLtr?"":'<option class="dlr-opt-gotMinLtr" value="got"></option>','<option value="0" selected>any letter</option>','<option value="3">3+ letters</option>','<option value="5">5+ letters</option>','<option value="8">8+ letters</option>','<option value="12">12+ letters</option>','<option value="17">17+ letters</option>','<option value="30">30+ letters</option>','<option value="50">50+ letters</option>','<option value="80">80+ letters</option>','<option value="120">120+ letters</option>'].join(""),this._optGotMinLtr=this._optGotMinLtr||this._selMinLtr.options[0])):!this._optGotMinLtr&&n.classList.contains("dlr-opt-gotMinLtr")&&(this._optGotMinLtr=n);if(this.extraBindings&&this.extraBindings.length)for(let i of this.extraBindings)try{i(n)}catch{}}if(!this._video)throw this._unbindUI(),Error(`Can not find the video container element with class '${this.containerClassName}'`);this.singleFrameMode||this.videoSrc?(this.singleFrameMode&&(this._elContainer&&(this._elContainer.addEventListener("click",this._clickIptSingleFrameMode),this._elContainer.setAttribute("title","Take a photo")),this._bgCamera&&(this._bgCamera.style.display="block")),this._selCam&&(this._selCam.style.display="none"),this._selRsl&&(this._selRsl.style.display="none"),this._selMinLtr&&(this._selMinLtr.style.display="none")):(this._elContainer&&(["Android","HarmonyOS"].includes(Ke.OS)?(this._elContainer.addEventListener("touchend",this._tapDoFocus),this._elContainer.addEventListener("touchmove",this._touchMoveEvent)):this._elContainer.addEventListener("click",this._tapDoFocus)),this._selCam&&(this._selCam.style.display="block",this._selCam.addEventListener("change",this._onCameraSelChange)),this._selRsl&&(this._selRsl.style.display="block",this._selRsl.addEventListener("change",this._onResolutionSelChange)),this._selMinLtr&&(this._selMinLtr.style.display="block"),this._bgLoading&&(this._bgLoading.style.display="block")),this._btnClose&&this._btnClose.addEventListener("click",this._onCloseBtnClick),document.addEventListener("visibilitychange",this._ev_documentHideEvent),window.ResizeObserver&&(this._resizeObserver||(this._resizeObserver=new ResizeObserver(n=>{for(let i of n)i.target===this._elContainer&&this._updateLayers()})),this._elContainer&&this._resizeObserver.observe(this._elContainer)),this._windowWidth=document.documentElement.clientWidth,window.addEventListener("resize",this._windowResizeListener)}_unbindUI(){this.singleFrameMode?(this._elContainer&&(this._elContainer.removeEventListener("click",this._clickIptSingleFrameMode),this._elContainer.removeAttribute("title")),this._bgCamera&&(this._bgCamera.style.display="none")):this._bgLoading&&(this._bgLoading.style.display="none"),this._elContainer&&(this._elContainer.removeEventListener("click",this._tapDoFocus),this._elContainer.removeEventListener("touchend",this._tapDoFocus),this._elContainer.removeEventListener("touchmove",this._touchMoveEvent)),this._selCam&&this._selCam.removeEventListener("change",this._onCameraSelChange),this._selRsl&&this._selRsl.removeEventListener("change",this._onResolutionSelChange),this._btnClose&&this._btnClose.removeEventListener("click",this._onCloseBtnClick),this.hideScanRegionLaser(),this.hideViewDecorator(),this.hideScanRegionOverlays(),this._drawingLayersManager.setVisible(!1),this._hideOriginalImageCvs(),this._videoContainer&&this._videoContainer.remove(),this._video=null,this._videoContainer=null,this._elContainer=null,this._selCam=null,this._selRsl=null,this._optGotRsl=null,this._btnClose=null,this._selMinLtr=null,this._optGotMinLtr=null,this._divScanArea=null,this._divScanLight=null,this._cvsScanRegion&&(this._cvsScanRegion.remove(),this._cvsScanRegion=null),this._singleFrameModeIpt&&(this._singleFrameModeIpt.remove(),this._singleFrameModeIpt=null),this._cvsSingleFrameMode&&(this._cvsSingleFrameMode.remove(),this._cvsSingleFrameMode=null),document.removeEventListener("visibilitychange",this._ev_documentHideEvent),window.ResizeObserver&&this._resizeObserver&&this._resizeObserver.disconnect(),window.removeEventListener("resize",this._windowResizeListener)}_assertOpen(){if(!this._bOpen)throw Error("The camera is not open.")}async open(t){this.UIElement||await this.setUIElement(xe.defaultUIElementURL),this._bindUI(),t&&this.appendAndShowUI();let n=await this.play();this.bOpen=!0,this._focusParameters.fds=null,this._focusParameters.kTimeout=void 0,this._focusSupported=!0,this._tapFocusEnabled&&!this.singleFrameMode&&(this._focusParameters.fds=(await this.getCapabilities()).focusDistance,this._focusParameters.fds||(this._focusSupported=!1,this._tapFocusEnabled=!1));const i=this.mapCameraEvents.get("cameraopen");for(let o of i){if(!o)continue;const a=JSON.parse(JSON.stringify(n));setTimeout(()=>{this.isDisposed&&this.disposed||o.apply(this,[a])},0)}return n}close(t){if(!this._video)return;this.stop(),this._hideOriginalImage(!1),this.hideTip(),this._unbindUI(),t&&this.hideUI(),this.stopFetchingLoop(),this.bOpen=!1;const n=this.mapCameraEvents.get("cameraclose");for(let i of n){if(!i)continue;const o={width:0,height:0,deviceId:null};setTimeout(()=>{this.isDisposed&&this.disposed||i.apply(this,[o])},0)}}stop(){this._video&&this._video.srcObject&&(this._video.srcObject.getTracks().forEach(t=>{t.stop()}),this._video.srcObject=null,this._videoTrack=null,this._currentCamera=null),this._video&&this.videoSrc&&(this._video.pause(),this._video.currentTime=0),this._bgLoading&&(this._bgLoading.style.animationPlayState=""),this._frameQueue.length=0,this._reusedCvs&&this._reusedCvs.ctx2d&&this._reusedCvs.ctx2d.clearRect(0,0,this._reusedCvs.width,this._reusedCvs.height),this.forceLoseContext()}async getAllCameras(t=!0){let n=(await navigator.mediaDevices.enumerateDevices()).filter(a=>a.kind==="videoinput");if(t&&n&&n.length&&!n[0].deviceId){let a=await navigator.mediaDevices.getUserMedia({video:!0});n=(await navigator.mediaDevices.enumerateDevices()).filter(d=>d.kind==="videoinput"),a.getTracks().forEach(d=>{d.stop()})}const i=[],o=[];if(this._allCameras)for(let a of this._allCameras)a._checked&&o.push(a);for(let a=0;a<n.length;a++){let d,_=n[a];for(let y of o)if(_.deviceId==y.deviceId){d=y;break}d||(d={deviceId:_.deviceId,label:_.label?_.label:"camera "+a,_checked:!1}),d.deviceId&&i.push(d)}return this._allCameras=i,i}_renderSelCameraInfo(){if(!this._selCam)return;let t;this._selCam.textContent="";for(let n of this._allCameras){const i=document.createElement("option");i.value=n.deviceId,i.innerText=n.label,this._selCam.append(i),n.deviceId&&this._currentCamera&&this._currentCamera.deviceId==n.deviceId&&(t=i)}this._selCam.value=t?t.value:""}getSelectedCamera(){if(!this._bOpen){let t="";const n=this.videoSettings.video.deviceId;n&&(t=n.exact||n.ideal||n);for(let i of this._allCameras)if(i.deviceId===t)return JSON.parse(JSON.stringify(i));return{deviceId:t,label:"",_checked:!1}}return this._currentCamera}async selectCamera(t){let n="";if(t&&(n=t.deviceId||t),this.videoSettings.video.deviceId={exact:n},!this._bOpen||this._video.paused)return null;let i=null;this._currentCamera&&(i=this._currentCamera.deviceId);const o=this._video.videoWidth,a=this._video.videoHeight,d=await this.play(t.deviceId||t);if(this._focusParameters.fds=null,this._focusParameters.kTimeout=void 0,this._focusSupported=!0,this._tapFocusEnabled&&!this.singleFrameMode&&(this._focusParameters.fds=(await this.getCapabilities()).focusDistance,this._focusParameters.fds||(this._focusSupported=!1,this._tapFocusEnabled=!1)),i!==d.deviceId){const _=this.mapCameraEvents.get("camerachange");for(let y of _){if(!y)continue;const w=JSON.parse(JSON.stringify(d));setTimeout(()=>{this.isDisposed&&this.disposed||y.apply(this,[w])},0)}}if(o!==d.width||a!==d.height){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let y of this._arrScanRegionOverlays)y&&this._updateScanRegionOverlay(y);this._updateDrawingLayersSize(),this._updateVideoContainerStyle();const _=this.mapCameraEvents.get("resolutionchange");for(let y of _){if(!y)continue;const w=JSON.parse(JSON.stringify(d));setTimeout(()=>{this.isDisposed&&this.disposed||y.apply(this,[w])},0)}}return d}getResolution(){if(this._bOpen)return[this._video.videoWidth,this._video.videoHeight];{let t=0,n=0;const i=this.videoSettings.video.width,o=this.videoSettings.video.height;return i&&(t=i.exact||i.ideal||i),o&&(n=o.exact||o.ideal||o),[t,n]}}async setResolution(t,n){let i,o;if(t instanceof Array?(i=t[0],o=t[1]):(i=t,o=n),this.videoSettings.video.width={ideal:i},this.videoSettings.video.height={ideal:o},!this._bOpen||this._video.paused)return null;const a=this._video.videoWidth,d=this._video.videoHeight,_=await this.play(null,i,o);if(a!==_.width||d!==_.height){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let w of this._arrScanRegionOverlays)w&&this._updateScanRegionOverlay(w);this._updateDrawingLayersSize(),this._updateVideoContainerStyle();const y=this.mapCameraEvents.get("resolutionchange");for(let w of y){if(!w)continue;const x=JSON.parse(JSON.stringify(_));setTimeout(()=>{this.isDisposed&&this.disposed||w.apply(this,[x])},0)}}return _}async getResolutions(t){var n,i;let o="";const a=(_,y)=>{const w=this._mapCameraResolutions.get(_);if(!w||!w.length)return!1;for(let x of w)if(x[0]===y.width&&x[1]===y.height)return!0;return!1},d=async(_,y,w)=>{const x={video:{deviceId:{exact:_},width:{ideal:y},height:{ideal:w}}};let T=null;try{T=await navigator.mediaDevices.getUserMedia(x)}catch{return null}if(!T)return null;const E=T.getVideoTracks();let M=null;try{const F=E[0].getSettings();M={width:F.width,height:F.height}}catch{const P=document.createElement("video");P.srcObject=T,M={width:P.videoWidth,height:P.videoHeight},P.srcObject=null}return E.forEach(F=>{F.stop()}),M};if(!this._bOpen){const _=(i=(n=this.videoSettings)===null||n===void 0?void 0:n.video)===null||i===void 0?void 0:i.deviceId;if(!_||(o=_.hasOwnProperty("exact")?this.videoSettings.video.deviceId.exact:_.hasOwnProperty("ideal")?this.videoSettings.video.deviceId.ideal:this.videoSettings.video.deviceId,!o))return null;let y=this._mapCameraResolutions.get(o);if(y&&!t)return this._mapCameraResolutions.get(o);this._mapCameraResolutions.set(o,[]),y=this._mapCameraResolutions.get(o);for(let w of this._predefinedResolutions){const x=await d(o,w.width,w.height);x&&!a(o,x)&&y.push([x.width,x.height])}return y}if(this._currentCamera){o=this._currentCamera.deviceId;let _=this._mapCameraResolutions.get(o);if(_&&!t)return this._mapCameraResolutions.get(o);this._mapCameraResolutions.set(o,[]),_=this._mapCameraResolutions.get(o);let y=this._videoTrack;for(let w of this._predefinedResolutions){await y.applyConstraints({width:{ideal:w.width},height:{ideal:w.height}});const x=y.getSettings(),T={width:x.width,height:x.height};a(o,T)||_.push([T.width,T.height])}return this._video.srcObject.getTracks().forEach(w=>{w.stop()}),await this.play(o,null,null,{notTriggerPlayedEvent:!0}),_}return null}on(t,n){if(!n)return;const i=this.mapCameraEvents.get(t.toLowerCase());if(!i)throw new Error(`Event '${t}' does not exist.`);i.includes(n)||i.push(n)}off(t,n){const i=this.mapCameraEvents.get(t.toLowerCase());if(!i)throw new Error(`Event '${t}' does not exist.`);const o=i.indexOf(n);o!==-1&&i.splice(o,1)}offAll(t){if(t){if(typeof t=="string"){const n=this.mapCameraEvents.get(t);n&&(n.length=0)}}else for(let n of this.mapCameraEvents.values())n&&(n.length=0)}getVideoSettings(){return JSON.parse(JSON.stringify(this.videoSettings))}updateVideoSettings(t){if(this.videoSettings=JSON.parse(JSON.stringify(t)),this._lastDeviceId=null,this._bOpen)return this.play()}isOpen(){return this._bOpen}getCapabilities(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getCapabilities()' is unavailable in singleFrameMode.");return this._videoTrack&&this._videoTrack.getCapabilities?this._videoTrack.getCapabilities():{}}getCameraSettings(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getCameraSettings()' is unavailable in singleFrameMode.");return this._videoTrack?this._videoTrack.getSettings():null}getConstraints(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getConstraints()' is unavailable in singleFrameMode.");return this._videoTrack?this._videoTrack.getConstraints():null}async applyConstraints(t){if(this._assertOpen(),this.singleFrameMode)throw new Error("'applyConstraints()' is unavailable in singleFrameMode.");if(!this._videoTrack)throw new Error('"_videoTrack" is null.');if(!this._videoTrack.applyConstraints)throw Error("Not supported.");return await this._videoTrack.applyConstraints(t)}async turnOnTorch(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'turnOnTorch()' is unavailable in singleFrameMode.");if(this.getCapabilities().torch)return await this._videoTrack.applyConstraints({advanced:[{torch:!0}]});throw Error("Not supported.")}async turnOffTorch(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'turnOffTorch()' is unavailable in singleFrameMode.");if(this.getCapabilities().torch)return await this._videoTrack.applyConstraints({advanced:[{torch:!1}]});throw Error("Not supported.")}async setColorTemperature(t){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setColorTemperature()' is unavailable in singleFrameMode.");let n=this.getCapabilities().colorTemperature;if(!n)throw Error("Not supported.");return t<n.min?t=n.min:t>n.max&&(t=n.max),await this._videoTrack.applyConstraints({advanced:[{colorTemperature:t,whiteBalanceMode:"manual"}]})}getColorTemperature(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getColorTemperature()' is unavailable in singleFrameMode.");return this._videoTrack?this._videoTrack.getSettings().colorTemperature||0:null}async setExposureCompensation(t){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setExposureCompensation()' is unavailable in singleFrameMode.");let n=this.getCapabilities().exposureCompensation;if(!n)throw Error("Not supported.");return t<n.min?t=n.min:t>n.max&&(t=n.max),await this._videoTrack.applyConstraints({advanced:[{exposureCompensation:t}]})}getExposureCompensation(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getExposureCompensation()' is unavailable in singleFrameMode.");return this._videoTrack?this._videoTrack.getSettings().exposureCompensation||0:null}async _setHardwareScale(t){if(this._assertOpen(),this.singleFrameMode)throw new Error("'_setHardwareScale()' is unavailable in singleFrameMode.");if(t<1)throw new RangeError("Invalid value.");if(!this._videoTrack)return;const n=this.getCapabilities().zoom;if(!n)throw new Error("Not supported.");return t<n.min?t=n.min:t>n.max&&(t=n.max),t=wt(t,n.min,n.step,n.max),await this._videoTrack.applyConstraints({advanced:[{zoom:t}]}),t}_getHardwareScale(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'_getHardwareScale()' is unavailable in singleFrameMode.");return this._videoTrack?this._videoTrack.getSettings().zoom||1:null}_setSoftwareScale(t,n){if(this._assertOpen(),this.singleFrameMode)throw new Error("'_setSoftwareScale()' is unavailable in singleFrameMode.");if(t<1)throw new RangeError("Invalid value.");n&&this._setScaleCenter(n),this._softwareScale=t,this._scaleVideo(t,n)}_getSoftwareScale(){return this._softwareScale}_setScaleCenter(t){if(this._assertOpen(),this.singleFrameMode)throw new Error("'_setScaleCenter()' is unavailable in singleFrameMode.");if(!t||typeof t.x!="string"||typeof t.y!="string")throw new Error("Invalid center.");const n=this._video.videoWidth,i=this._video.videoHeight;let o=0,a=0;if(t.x.endsWith("px"))o=parseFloat(t.x);else{if(!t.x.endsWith("%"))throw new Error("Invalid scale center.");o=parseFloat(t.x)/100*n}if(t.y.endsWith("px"))a=parseFloat(t.y);else{if(!t.y.endsWith("%"))throw new Error("Invalid scale center.");a=parseFloat(t.y)/100*i}if(o==NaN||a==NaN)throw new Error("Invalid scale center.");this._scaleCenter={x:o,y:a}}_resetScaleCenter(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'_resetScaleCenter()' is unavailable in singleFrameMode.");const t=this._video.videoWidth,n=this._video.videoHeight;this._scaleCenter={x:t/2,y:n/2}}_isVideoCenter(t){if(this._assertOpen(),this.singleFrameMode)throw new Error("'_isVideoCenter()' is unavailable in singleFrameMode.");return t&&t.x==this._video.videoWidth/2&&t.y==this._video.videoHeight/2}async _setZoom(t){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setZoom()' is unavailable in singleFrameMode.");if(t<1)throw new RangeError("Invalid value.");this._resetScaleCenter();try{if(this._isVideoCenter(this._scaleCenter)){const n=await this._setHardwareScale(t);let i=this._getHardwareScale();i==1&&n!=1&&(i=n),t>i?this._setSoftwareScale(t/i):this._setSoftwareScale(1)}else await this._setHardwareScale(1),this._setSoftwareScale(t)}catch(n){if((n.message||n)!=="Not supported.")throw n;this._setSoftwareScale(t)}}async setZoom(t){if(typeof t!="number"&&typeof t!="object")throw new TypeError("Illegal type of argument.");if(typeof t=="number")return this._setZoom(t);if(this._assertOpen(),this.singleFrameMode)throw new Error("'setZoom()' is unavailable in singleFrameMode.");if(t){if(typeof t.factor!="number")throw new TypeError("Illegal type of 'factor'.");if(t.factor<1)throw new RangeError("Invalid value.");t.centerPoint?this._setScaleCenter(t.centerPoint):this._resetScaleCenter();try{if(this._isVideoCenter(this._scaleCenter)){const n=await this._setHardwareScale(t.factor);let i=this._getHardwareScale();i==1&&n!=1&&(i=n),t.factor>i?this._setSoftwareScale(t.factor/i):this._setSoftwareScale(1)}else await this._setHardwareScale(1),this._setSoftwareScale(t.factor)}catch(n){if((n.message||n)!=="Not supported.")throw n;this._setSoftwareScale(t.factor)}}}getZoom(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getZoom()' is unavailable in singleFrameMode.");return this._videoTrack?this._getHardwareScale()*this._softwareScale:null}getZoomSettings(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getZoom()' is unavailable in singleFrameMode.");return this._videoTrack?{factor:this._getHardwareScale()*this._softwareScale}:null}async resetZoom(){await this.setZoom({factor:1})}async setFrameRate(t){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setFrameRate()' is unavailable in singleFrameMode.");let n=this.getCapabilities().frameRate;if(!n)throw Error("Not supported.");return t<n.min?t=n.min:t>n.max&&(t=n.max),await this._videoTrack.applyConstraints({width:{ideal:Math.max(this._video.videoWidth,this._video.videoHeight)},frameRate:t})}getFrameRate(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getFrameRate()' is unavailable in singleFrameMode.");return this._videoTrack?this._videoTrack.getSettings().frameRate:null}async _setFocus(t,n){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setFocus()' is unavailable in singleFrameMode.");if(typeof t!="string")throw Error("Invalid focus mode.");t=t.toLowerCase();const i=this.getCapabilities().focusMode,o=this.getCapabilities().focusDistance;if(!i)throw Error("Not supported.");if(!i.includes(t))throw Error("Unsupported mode.");if(n>=0){if(!o)throw Error("Manual focus unsupported.");return n<o.min?n=o.min:n>o.max&&(n=o.max),n=wt(n,o.min,o.step,o.max),await this._videoTrack.applyConstraints({advanced:[{focusMode:t,focusDistance:n}]})}return await this._videoTrack.applyConstraints({advanced:[{focusMode:t}]})}async setFocus(t,n){if(typeof t=="string")return this._setFocus(t,n);if(this._assertOpen(),this.singleFrameMode)throw new Error("'setFocus()' is unavailable in singleFrameMode.");if(!t)return;const i=this.getCapabilities(),o=i.focusMode,a=i.focusDistance;if(!o)throw Error("Not supported.");if(typeof t.mode!="string")throw Error("Invalid focus mode.");const d=t.mode.toLowerCase();if(!o.includes(d))throw Error("Unsupported focus mode.");if(d!=="manual")return this._focusParameters._focusArea=null,await this._videoTrack.applyConstraints({advanced:[{focusMode:d}]});if(!a)throw Error("Manual focus unsupported.");if(t.hasOwnProperty("distance")){let _=t.distance;return _<a.min?_=a.min:_>a.max&&(_=a.max),_=wt(_,a.min,a.step,a.max),this._focusParameters._focusArea=null,await this._videoTrack.applyConstraints({advanced:[{focusMode:d,focusDistance:_}]})}if(!t.area)throw new Error("'distance' or 'area' should be specified in 'manual' mode.");{const _=t.area.centerPoint;let y=t.area.width,w=t.area.height;if(!y||!w){const x=this._video.videoWidth,T=this._video.videoHeight;y||(y=2*Math.round(Math.min(x,T)/this._focusParameters.defaultFocusAreaSizeRatio/2)+"px"),w||(w=2*Math.round(Math.min(x,T)/this._focusParameters.defaultFocusAreaSizeRatio/2)+"px")}this._focusParameters._focusArea={centerPoint:{x:_.x,y:_.y},width:y,height:w},await this._setLocalFocus(_,y,w)}}getFocus(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'_getHardwareScale()' is unavailable in singleFrameMode.");if(!this._videoTrack)return null;const t=this._videoTrack.getSettings().focusMode;return t?t==="continuous"?{mode:t}:{mode:t,distance:this._videoTrack.getSettings().focusDistance}:null}getFocusSettings(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'_getHardwareScale()' is unavailable in singleFrameMode.");if(!this._videoTrack)return null;const t=this._videoTrack.getSettings(),n=t.focusMode;return n?n==="manual"?this._focusParameters._focusArea?{mode:"manual",area:JSON.parse(JSON.stringify(this._focusParameters._focusArea))}:{mode:"manual",distance:t.focusDistance}:{mode:n}:null}async _setFocusAndGetContract(t,n){const i=E=>{if(!this._bOpen||!this._videoTrack||this.video.paused||E.focusTaskId!=this._focusParameters.curFocusTaskId){this._bOpen&&this._videoTrack&&!this.video.paused||(this._focusParameters.isDoingFocus=0);const M=new Error(`Focus task ${E.focusTaskId} canceled.`);throw M.name="DeprecatedTaskError",M}this._focusParameters.isDoingFocus===1&&Date.now()-E.timeStart>this._focusParameters.focusCancelableTime&&(this._focusParameters.isDoingFocus=-1)};let o;n=wt(n,this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),await this._videoTrack.applyConstraints({advanced:[{focusMode:"manual",focusDistance:n}]}),i(t),o=this._focusParameters.oldDistance==null?this._focusParameters.kTimeout*Math.max(Math.abs(1/this._focusParameters.fds.min-1/n),Math.abs(1/this._focusParameters.fds.max-1/n))+this._focusParameters.minTimeout:this._focusParameters.kTimeout*Math.abs(1/this._focusParameters.oldDistance-1/n)+this._focusParameters.minTimeout,this._focusParameters.oldDistance=n,await new Promise(E=>{setTimeout(E,o)}),i(t);let a=t.focusL-t.focusW/2,d=t.focusT-t.focusH/2,_=t.focusW,y=t.focusH;if(a>=this.video.videoWidth||d>=this.video.videoHeight)throw new Error("Invalid area.");a+_>this.video.videoWidth&&(_=this.video.videoWidth-a),d+y>this.video.videoHeight&&(y=this.video.videoHeight-d);const w=this._getImageData(this.video,this.video.videoWidth,this.video.videoHeight,{sx:a,sy:d,sWidth:_,sHeight:y,dWidth:_,dHeight:y},null,{pixelFormat:ke.RGBA});if(!w)return this._setFocusAndGetContract(t,n);const x=w.data;let T=0;for(let E=0,M=x.length-8;E<M;++E){let F=x[E]-x[E+8];++E;let P=x[E]-x[E+8];++E;let B=x[E]-x[E+8];++E,T+=F*F+P*P+B*B}return-T}async _doFocusDetail(t,n,i,o,a,d,_){let y;if(n=wt(n,this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),o=wt(o,this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),d?d=wt(d,this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max):(d=wt(Math.sqrt((n||this._focusParameters.fds.step)*(o||this._focusParameters.fds.step)),this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),_=await this._setFocusAndGetContract(t,d)),_<=i&&_<=a?y=3:i<a&&i<_?y=1:a<i&&a<_&&(y=2),(o-n)/2<=this._focusParameters.fds.step)return y===3||(y===1?await this._videoTrack.applyConstraints({advanced:[{focusMode:"manual",focusDistance:n}]}):y===2&&await this._videoTrack.applyConstraints({advanced:[{focusMode:"manual",focusDistance:o}]})),!0;if(y===1)return await this._doFocusDetail(t,n,i,d,_);if(y===2)return await this._doFocusDetail(t,d,_,o,a);if(y!==3)return i=await this._setFocusAndGetContract(t,n),a=await this._setFocusAndGetContract(t,o),await this._doFocusDetail(t,n,i,o,a);let w=wt(Math.sqrt((n||this._focusParameters.fds.step)*(d||this._focusParameters.fds.step)),this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),x=wt(Math.sqrt((o||this._focusParameters.fds.step)*(d||this._focusParameters.fds.step)),this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max);if(Math.abs(1/this._focusParameters.oldDistance-1/w)<=Math.abs(1/this._focusParameters.oldDistance-1/x)){let T=await this._setFocusAndGetContract(t,w);if(T<_)return await this._doFocusDetail(t,n,i,d,_,w,T);if(T==_)return await this._doFocusDetail(t,w,T,d,_);let E=await this._setFocusAndGetContract(t,x);if(T>_&&_<E)return await this._doFocusDetail(t,w,T,x,E,d,_);if(_==E)return await this._doFocusDetail(t,d,_,x,E);if(_>E)return await this._doFocusDetail(t,d,_,o,a,x,E)}else{let T=await this._setFocusAndGetContract(t,x);if(_>T)return await this._doFocusDetail(t,d,_,o,a,x,T);if(_==T)return await this._doFocusDetail(t,d,_,x,T);let E=await this._setFocusAndGetContract(t,w);if(E>_&&_<T)return await this._doFocusDetail(t,w,E,x,T,d,_);if(E==_)return await this._doFocusDetail(t,w,E,d,_);if(E<_)return await this._doFocusDetail(t,n,i,d,_,w,E)}return!1}async _setLocalFocus(t,n,i,o,a){if(this._focusParameters.isDoingFocus==1)return!1;if(!t||typeof t.x!="string"||typeof t.y!="string")throw new Error("Invalid centerPoint.");if(!n||typeof n!="string")throw new Error("Invalid width.");if(!i||typeof i!="string")throw new Error("Invalid height.");const d=this._video.videoWidth,_=this._video.videoHeight;let y=0,w=0;if(t.x.endsWith("px"))y=parseFloat(t.x);else{if(!t.x.endsWith("%"))throw new Error("Invalid centerPoint.");y=parseFloat(t.x)/100*d}if(t.y.endsWith("px"))w=parseFloat(t.y);else{if(!t.y.endsWith("%"))throw new Error("Invalid centerPoint.");w=parseFloat(t.y)/100*_}if(y==NaN||w==NaN)throw new Error("Invalid centerPoint.");let x=0;if(n.endsWith("px"))x=parseFloat(n);else{if(!n.endsWith("%"))throw new Error("Invalid width.");x=parseFloat(n)/100*d}if(x==NaN)throw new Error("Invalid width.");let T=0;if(i.endsWith("px"))T=parseFloat(i);else{if(!i.endsWith("%"))throw new Error("Invalid height.");T=parseFloat(i)/100*_}if(T==NaN)throw new Error("Invalid height.");if(this._softwareScale!==1){const F=this._softwareScale,P=this._scaleCenter;x/=F,T/=F,y=(1-1/F)*P.x+y/F,w=(1-1/F)*P.y+w/F}if(!this._focusSupported)throw new Error("Manual focus unsupported.");if(!this._focusParameters.fds&&(this._focusParameters.fds=(await this.getCapabilities()).focusDistance,!this._focusParameters.fds))throw this._focusSupported=!1,new Error("Manual focus unsupported.");this._focusParameters.kTimeout==null&&(this._focusParameters.kTimeout=(this._focusParameters.maxTimeout-this._focusParameters.minTimeout)/(1/this._focusParameters.fds.min-1/this._focusParameters.fds.max)),this._focusParameters.isDoingFocus=1;const E={focusL:y,focusT:w,focusW:x,focusH:T,focusTaskId:++this._focusParameters.curFocusTaskId,timeStart:Date.now()},M=async(F,P,B)=>{try{(P==null||P<this._focusParameters.fds.min)&&(P=this._focusParameters.fds.min),(B==null||B>this._focusParameters.fds.max)&&(B=this._focusParameters.fds.max),this._focusParameters.oldDistance=null;let D=wt(Math.sqrt(B*(P||this._focusParameters.fds.step)),this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),O=wt(Math.sqrt((P||this._focusParameters.fds.step)*D),this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),A=wt(Math.sqrt(D*B),this._focusParameters.fds.min,this._focusParameters.fds.step,this._focusParameters.fds.max),Y=await this._setFocusAndGetContract(F,A),ne=await this._setFocusAndGetContract(F,O),oe=await this._setFocusAndGetContract(F,D);if(ne>oe&&oe<Y){const K=await this._doFocusDetail(F,O,ne,A,Y,D,oe);return this._focusParameters.isDoingFocus=0,K}if(ne<oe&&ne<Y){let K=await this._setFocusAndGetContract(F,P);const S=await this._doFocusDetail(F,P,K,D,oe,O,ne);return this._focusParameters.isDoingFocus=0,S}if(oe>Y&&ne>Y){let K=await this._setFocusAndGetContract(F,B);const S=await this._doFocusDetail(F,D,oe,B,K,A,Y);return this._focusParameters.isDoingFocus=0,S}if(ne==oe&&oe<Y){const K=await this._doFocusDetail(F,O,ne,D,oe);return this._focusParameters.isDoingFocus=0,K}if(oe==Y&&ne>oe){const K=await this._doFocusDetail(F,D,oe,A,Y);return this._focusParameters.isDoingFocus=0,K}return M(F,P,B)}catch(D){if(D.name!=="DeprecatedTaskError")throw D}};return M(E,o,a)}async enableTapToFocus(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'enableTapToFocus()' is unavailable in singleFrameMode.");if(!this._videoTrack)throw new Error("Video is not playing.");if(!this._focusSupported)throw new Error("Tapping to focus unsupported.");if(!this._focusParameters.fds&&(this._focusParameters.fds=(await this.getCapabilities()).focusDistance,!this._focusParameters.fds))throw this._focusSupported=!1,this._tapFocusEnabled=!1,new Error("Tapping to focus unsupported.");this._tapFocusEnabled=!0}disableTapToFocus(){this._tapFocusEnabled=!1}isTapToFocusEnabled(){return this._tapFocusEnabled}_updateVideoContainerStyle(){if(!this._video||this.singleFrameMode)return;const t=this._getSoftwareScale(),n=this._videoContainer;if(this.videoFit==="contain"&&t>1){const i=this._video.videoWidth,o=this._video.videoHeight,a=window.getComputedStyle(this._elContainer),d=parseFloat(a.width),_=parseFloat(a.height),y=i/o;if(d/_<y){let w=d/y;n.style.left="0",n.style.top=(_-w)/2/_*100+"%",n.style.width="100%",n.style.height=w/_*100+"%"}else{let w=_*y;n.style.left=(d-w)/2/d*100+"%",n.style.top="0",n.style.width=w/d*100+"%",n.style.height="100%"}}else n.style.left="0",n.style.top="0",n.style.width="100%",n.style.height="100%"}_scaleVideo(t,n){if(this._video&&!this.singleFrameMode){if(t<1)throw new RangeError("Invalid scale value.");if(n&&this._setScaleCenter(n),t===1)this._video.style.transform="";else{const i=this.getVideoFit(),o=this._video.videoWidth,a=this._video.videoHeight,d=window.getComputedStyle(this._elContainer),_=parseFloat(d.width),y=parseFloat(d.height),w=_/y,x=o/a;let T=1;i==="contain"?T=w<x?_/(o/t):y/(a/t):i==="cover"&&(T=x>w?y/(o/t):_/(a/t));const E=T*(1-1/t)*(o/2-this._scaleCenter.x),M=T*(1-1/t)*(a/2-this._scaleCenter.y);this._video.style.transform=`translate(${E}px, ${M}px) scale(${t})`}this._updateVideoContainerStyle()}}getFrameSize(t,n,i,o){if(!t||!n)return null;let a,d,_,y,w=t,x=n;const T={regionLeft:0,regionTop:0,regionRight:w,regionBottom:x,regionMeasuredByPercentage:!1};i?(i.regionMeasuredByPercentage?(T.regionLeft=i.regionLeft*w/100,T.regionTop=i.regionTop*x/100,T.regionRight=i.regionRight*w/100,T.regionBottom=i.regionBottom*x/100):(T.regionLeft=i.regionLeft,T.regionTop=i.regionTop,T.regionRight=i.regionRight,T.regionBottom=i.regionBottom),a=Math.round(T.regionLeft),d=Math.round(T.regionTop),w=Math.round(T.regionRight-T.regionLeft),x=Math.round(T.regionBottom-T.regionTop)):(a=0,d=0,w=Math.round(w),x=Math.round(x));const E=Math.max(w,x);if(o&&o>0&&E>o){const M=o/E;w>x?(_=o,y=Math.round(x*M)):(_=Math.round(w*M),y=o)}else _=w,y=x;return _<=0||y<=0?null:{sx:a,sy:d,sWidth:w,sHeight:x,dWidth:_,dHeight:y}}getFrame(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getFrame()' is unavailable in singleFrameMode.");return this._getVideoData()}getImage(){return this.getFrame()}_drawImage(t,n,i,o,a,d,_){if(this.isDisposed&&this.disposed)throw Error("The 'CameraEnhancer' instance has been disposed.");if(!i||!o)return null;if(n instanceof HTMLVideoElement&&n.readyState!==4||n instanceof HTMLImageElement&&!n.complete)throw new Error("The source is not loaded.");let y=0,w=0,x=i,T=o,E=0,M=0,F=i,P=o;a&&(a.sx&&(y=Math.round(a.sx)),a.sy&&(w=Math.round(a.sy)),a.sWidth&&(x=Math.round(a.sWidth)),a.sHeight&&(T=Math.round(a.sHeight)),a.dx&&(E=Math.round(a.dx)),a.dy&&(M=Math.round(a.dy)),a.dWidth&&(F=Math.round(a.dWidth)),a.dHeight&&(P=Math.round(a.dHeight)));let B=ke.RGBA;_&&_.pixelFormat&&(B=_.pixelFormat);const D=t;if(_&&_.bUseWebGL){(D.width<E+F||D.height<M+P)&&(D.width=E+F,D.height=M+P,D.ctxWebGL&&D.ctxWebGL.viewport(0,0,E+F,M+P));const O=D.ctxWebGL||D.getContext("webgl",{antialias:!1})||D.getContext("experimental-webgl",{antialias:!1});if(!O){const K=new Error("WebGL error: unable to initialize WebGL. Your browser or machine may not support it.");throw K.name="WebGLError",K}if(!D.ctxWebGL||B!==this.shaderPixelFormat){D.ctxWebGL=O;const K=f=>{const r=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,r),f.bufferData(f.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),f.STATIC_DRAW);const s=f.createBuffer();return f.bindBuffer(f.ARRAY_BUFFER,s),f.bufferData(f.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),f.STATIC_DRAW),{positions:r,texCoords:s}},S=f=>{const r=f.createTexture();return f.bindTexture(f.TEXTURE_2D,r),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),r},ue=(f,r)=>{const s=f.createProgram();if(r.forEach(u=>f.attachShader(s,u)),f.linkProgram(s),!f.getProgramParameter(s,f.LINK_STATUS)){const u=new Error(`An error occured linking the program: ${f.getProgramInfoLog(s)}.`);throw u.name="WebGLError",u}return f.useProgram(s),s},le=(f,r,s)=>{const u=f.createShader(r);if(f.shaderSource(u,s),f.compileShader(u),!f.getShaderParameter(u,f.COMPILE_STATUS)){const m=new Error(`An error occured compiling the shader: ${f.getShaderInfoLog(u)}.`);throw m.name="WebGLError",m}return u},Ce=`
                    attribute vec2 a_position;
                    attribute vec2 a_texCoord;

                    uniform mat3 u_matrix;
                    uniform mat3 u_textureMatrix;

                    varying vec2 v_texCoord;
                    void main(void) {
                    gl_Position = vec4((u_matrix * vec3(a_position, 1)).xy, 0, 1.0);
                    v_texCoord = vec4((u_textureMatrix * vec3(a_texCoord, 1)).xy, 0, 1.0).xy;
                    }
                `;let h="rgb";["rgba","rbga","grba","gbra","brga","bgra"].includes(B)&&(h=B.slice(0,3));const l=`
                    precision mediump float;
                    varying vec2 v_texCoord;
                    uniform sampler2D u_image;
                    uniform float uColorFactor;

                    void main() {
                        vec4 sample = texture2D(u_image, v_texCoord);
                        float grey = 0.21 * sample.r + 0.71 * sample.g + 0.07 * sample.b;
                        gl_FragColor = vec4(sample.${h} * (1.0 - uColorFactor) + (grey * uColorFactor), sample.a);
                    }
                `,c=ue(O,[le(O,O.VERTEX_SHADER,Ce),le(O,O.FRAGMENT_SHADER,l)]);this._webGLProgramInfo={program:c,attribLocations:{vertexPosition:O.getAttribLocation(c,"a_position"),texPosition:O.getAttribLocation(c,"a_texCoord")},uniformLocations:{uSampler:O.getUniformLocation(c,"u_image"),uColorFactor:O.getUniformLocation(c,"uColorFactor"),uMatrix:O.getUniformLocation(c,"u_matrix"),uTextureMatrix:O.getUniformLocation(c,"u_textureMatrix")}},this._webGLBuffers=K(O),this._webGLTexture=S(O),this.shaderPixelFormat=B}const A=(K,S,ue)=>{K.bindBuffer(K.ARRAY_BUFFER,S),K.enableVertexAttribArray(ue),K.vertexAttribPointer(ue,2,K.FLOAT,!1,0,0)},Y=(K,S,ue)=>{const le=K.RGBA,Ce=K.RGBA,h=K.UNSIGNED_BYTE;K.bindTexture(K.TEXTURE_2D,S),K.texImage2D(K.TEXTURE_2D,0,le,Ce,h,ue)},ne=(K,S,ue,le)=>{K.clearColor(0,0,0,1),K.clearDepth(1),K.enable(K.DEPTH_TEST),K.depthFunc(K.LEQUAL),K.clear(K.COLOR_BUFFER_BIT|K.DEPTH_BUFFER_BIT),A(K,ue.positions,S.attribLocations.vertexPosition),A(K,ue.texCoords,S.attribLocations.texPosition),K.activeTexture(K.TEXTURE0),K.bindTexture(K.TEXTURE_2D,le),K.uniform1i(S.uniformLocations.uSampler,0),K.uniform1f(S.uniformLocations.uColorFactor,[ke.GREY,ke.GREY32].includes(B)?1:0);let Ce,h,l=Ct.translate(Ct.identity(),-1,-1);l=Ct.scale(l,2,2),l=Ct.scale(l,1/K.canvas.width,1/K.canvas.height),Ce=Ct.translate(l,E,M),Ce=Ct.scale(Ce,F,P),K.uniformMatrix3fv(S.uniformLocations.uMatrix,!1,Ce),h=Ct.translate(Ct.identity(),y/i,w/o),h=Ct.scale(h,x/i,T/o),K.uniformMatrix3fv(S.uniformLocations.uTextureMatrix,!1,h),K.drawArrays(K.TRIANGLES,0,6)};let oe;if(Y(O,this._webGLTexture,n),ne(O,this._webGLProgramInfo,this._webGLBuffers,this._webGLTexture),d){if(d.length<F*P*4)throw new Error("Unexpected size of the 'bufferContainer'.");oe=d}else oe=new Uint8Array(F*P*4);if(O.readPixels(E,M,F,P,O.RGBA,O.UNSIGNED_BYTE,oe),oe[3]!==255){this._bWebGLSupported=!1;const K=new Error("WebGL error: incorrect WebGL drawing.");throw K.name="WebGLError",K}return{context:O,pixelFormat:B===ke.GREY?ke.GREY32:B,_bUseWebGL:!0}}{D.ctx2d||(D.ctx2d=D.getContext("2d",{willReadFrequently:!0}));const O=D.ctx2d;if(!O)throw new Error("Unable to get 'CanvasRenderingContext2D' from canvas.");return(D.width<E+F||D.height<M+P)&&(D.width=E+F,D.height=M+P),O.drawImage(n,y,w,x,T,E,M,F,P),{context:O,pixelFormat:ke.RGBA,_bUseWebGL:!1}}}_readCvsData(t,n,i){let o,a=0,d=0,_=t.canvas.width,y=t.canvas.height;if(n&&(n.x&&(a=n.x),n.y&&(d=n.y),n.width&&(_=n.width),n.height&&(y=n.height)),t instanceof WebGLRenderingContext){const w=t;if(i){if(i.length<_*y*4)throw new Error("Unexpected size of the 'bufferContainer'.");w.readPixels(a,d,_,y,w.RGBA,w.UNSIGNED_BYTE,i),o=new Uint8Array(i.buffer,0,_*y*4)}else o=new Uint8Array(_*y*4),w.readPixels(a,d,_,y,w.RGBA,w.UNSIGNED_BYTE,o)}else if(t instanceof CanvasRenderingContext2D){let w;if(w=t.getImageData(a,d,_,y),o=new Uint8Array(w.data.buffer),i){if(i.length<o.length)throw new Error("Unexpected size of the 'bufferContainer'.");i.set(o)}}return o}_transformPixelFormat(t,n,i,o){let a;if(n===i)return o?new Uint8Array(t):t;const d=[ke.RGBA,ke.RBGA,ke.GRBA,ke.GBRA,ke.BRGA,ke.BGRA];if(d.includes(n))if(i===ke.GREY){a=new Uint8Array(t.length/4);for(let _=0;_<t.length;_+=4){const y=.21*t[_]+.71*t[_+1]+.07*t[_+2];a[_/4]=y}}else if(i===ke.GREY32){a=o?new Uint8Array(t):t;for(let _=0;_<t.length;_+=4){const y=.21*t[_]+.71*t[_+1]+.07*t[_+2];a[_]=y,a[_+1]=y,a[_+2]=y}}else{if(!d.includes(i))throw new Error("Unable to transform.");if(o){a=new Uint8Array(t);const _=n.indexOf("r"),y=n.indexOf("g"),w=n.indexOf("b"),x=i.indexOf("r"),T=i.indexOf("g"),E=i.indexOf("b");for(let M=0;M<t.length;M+=4)a[M+x]=t[M+_],a[M+T]=t[M+y],a[M+E]=t[M+w]}else{a=t;const _=n.indexOf("r"),y=n.indexOf("g"),w=n.indexOf("b"),x=i.indexOf("r"),T=i.indexOf("g"),E=i.indexOf("b");for(let M=0;M<t.length;M+=4){let F=[t[M],t[M+1],t[M+2]];a[M+x]=F[_],a[M+T]=F[y],a[M+E]=F[w]}}}else if(n===ke.GREY){if(i!==ke.GREY32)throw new Error("Unable to transform.");a=new Uint8Array(4*t.length);for(let _=0;_<t.length;_++)a[4*_]=t[_],a[4*_+1]=t[_],a[4*_+2]=t[_],a[4*_+3]=255}else{if(n!==ke.GREY32)throw new Error("Unable to transform.");if(i!==ke.GREY)throw new Error("Unable to transform.");a=new Uint8Array(new Uint32Array(t.buffer))}return a}_getImageData(t,n,i,o,a,d){if(this.isDisposed&&this.disposed)throw Error("The 'CameraEnhancer' instance has been disposed.");if(!n||!i)return null;if(o.sx>n||o.sy>i||o.sx+o.sWidth>n||o.sy+o.sHeight>i)throw new Error("Invalid position.");if(t instanceof HTMLVideoElement&&t.readyState!==4||t instanceof HTMLImageElement&&!t.complete)throw new Error("The source is not loaded.");const _=Math.round(o.sx),y=Math.round(o.sy),w=Math.round(o.sWidth),x=Math.round(o.sHeight),T=Math.round(o.dWidth),E=Math.round(o.dHeight);let M=ke.RGBA;d&&d.pixelFormat&&(M=d.pixelFormat);let F,P,B,D=this._bWebGLSupported;d&&d.bUseWebGL==0&&(D=!1),D?(this._reusedWebGLCvs||(this._reusedWebGLCvs=document.createElement("canvas")),F=this._reusedWebGLCvs):(this._reusedCvs||(this._reusedCvs=document.createElement("canvas")),F=this._reusedCvs);try{if(D)if(xe._onLog&&xe._onLog("DCE: _getImageData() in WebGL."),a)if(M===ke.GREY){if(B=new Uint8Array(T*E*4),P=this._drawImage(F,t,n,i,{sx:_,sy:y,sWidth:w,sHeight:x,dWidth:T,dHeight:E},B,{pixelFormat:M,bUseWebGL:D}),B=this._transformPixelFormat(B,P.pixelFormat,M),a){if(a.length<B.length)throw new Error("Unexpected size of the 'bufferContainer'.");a.set(B)}}else P=this._drawImage(F,t,n,i,{sx:_,sy:y,sWidth:w,sHeight:x,dWidth:T,dHeight:E},a,{pixelFormat:M,bUseWebGL:D}),B=new Uint8Array(a.buffer,0,T*E*4),B=this._transformPixelFormat(B,P.pixelFormat,M);else M===ke.GREY?((!this._tempDataContainer||this._tempDataContainer.length<T*E*4)&&(this._tempDataContainer=new Uint8Array(T*E*4)),B=new Uint8Array(this._tempDataContainer.buffer,0,T*E*4)):B=new Uint8Array(T*E*4),P=this._drawImage(F,t,n,i,{sx:_,sy:y,sWidth:w,sHeight:x,dWidth:T,dHeight:E},B,{pixelFormat:M,bUseWebGL:D}),B=this._transformPixelFormat(B,P.pixelFormat,M);else if(xe._onLog&&xe._onLog("DCE: _getImageData() in context2d."),P=this._drawImage(F,t,n,i,{sx:_,sy:y,sWidth:w,sHeight:x,dWidth:T,dHeight:E},null,{pixelFormat:ke.RGBA,bUseWebGL:D}),B=this._readCvsData(P.context,null,null),B=this._transformPixelFormat(B,P.pixelFormat,M),a){if(a.length<B.length)throw new Error("Unexpected size of the 'bufferContainer'.");a.set(B)}}catch(O){if(O.name==="WebGLError")return this.forceLoseContext(),this._bWebGLSupported=!1,this._getImageData(t,n,i,{sx:_,sy:y,sWidth:w,sHeight:x,dWidth:T,dHeight:E},a,d);throw O}return{data:B,pixelFormat:M,_bUseWebGL:P._bUseWebGL}}forceLoseContext(){if(!this._reusedWebGLCvs)return;const t=this._reusedWebGLCvs.ctxWebGL;t&&!t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").loseContext(),this._webGLTexture=null,this._webGLProgramInfo=null,this._webGLBuffers=null,this._reusedWebGLCvs=null}_getVideoData(t,n){if(this.isDisposed&&this.disposed)throw Error("The 'CameraEnhancer' instance has been disposed.");if(this._assertOpen(),this.singleFrameMode)throw new Error("'_getVideoData()' is unavailable in singleFrameMode.");if(!this._video||this._video.readyState!==4)return null;const i=Date.now();let o=this._scanRegion;n&&n.hasOwnProperty("region")&&(o=n.region);let a=this.mapPixelFormatString_Enum.get(this.framePixelFormat.toLowerCase());n&&n.pixelFormat&&(a=this.mapPixelFormatString_Enum.get(n.pixelFormat.toLowerCase()));let d=this._softwareScale;n&&n.scale&&(d=n.scale);const _=this._video.videoWidth,y=this._video.videoHeight;let w=this._scaleCenter;if(n&&n.scaleCenter){if(typeof n.scaleCenter.x!="string"||typeof n.scaleCenter.y!="string")throw new Error("Invalid scale center.");let P=0,B=0;if(n.scaleCenter.x.endsWith("px"))P=parseFloat(n.scaleCenter.x);else{if(!n.scaleCenter.x.endsWith("%"))throw new Error("Invalid scale center.");P=parseFloat(n.scaleCenter.x)/100*_}if(n.scaleCenter.y.endsWith("px"))B=parseFloat(n.scaleCenter.y);else{if(!n.scaleCenter.y.endsWith("%"))throw new Error("Invalid scale center.");B=parseFloat(n.scaleCenter.y)/100*y}if(P==NaN||B==NaN)throw new Error("Invalid scale center.");w.x=Math.round(P),w.y=Math.round(B)}if(_===0||y===0)return null;const x=this.getFrameSize(_,y,o,this.maxCvsSideLength);if(!x)return null;let T=!0;_===x.sWidth&&y===x.sHeight&&(T=!1);const E={data:null,region:o?JSON.parse(JSON.stringify(o)):null,sx:x.sx,sy:x.sy,width:x.dWidth,height:x.dHeight,colorMode:null,pixelFormat:null,timeSpent:null,timeStamp:null,isCropped:T,toCanvas:this._toCanvas,_sWidth:x.sWidth,_sHeight:x.sHeight,_bUseWebGL:null};d!==1&&(x.sWidth=Math.round(x.sWidth/d),x.sHeight=Math.round(x.sHeight/d),x.sx=Math.round((1-1/d)*w.x+x.sx/d),x.sy=Math.round((1-1/d)*w.y+x.sy/d));const M=this._getImageData(this._video,_,y,x,t,{pixelFormat:a});if(!M)return null;const F=Date.now();return E.data=M.data,E.pixelFormat=E.colorMode=M.pixelFormat,E._bUseWebGL=M._bUseWebGL,E.timeSpent=F-i,E.timeStamp=F,M.pixelFormat===ke.GREY?E.stride=E.width:E.stride=4*E.width,E}getCurrentRegion(){let t=null;if(this._scanRegion)t=this._scanRegion;else if(this.croppingRegions){if(this._croppingRegionIndex>=this.croppingRegions.length||this._croppingRegionIndex<0)throw new Error("The 'croppingRegionIndex' is out of bounds.");t=this.croppingRegions[this._croppingRegionIndex],this.bIncreaseRegionIndexAuto&&++this._croppingRegionIndex>=this.croppingRegions.length&&(this._croppingRegionIndex=0)}return t}_fetchingLoop(t){if(this.isDisposed&&this.disposed)return;if(!this._bOpen||!this.isFetchingLoopStarted())return void this.stopFetchingLoop();const n=()=>{const o=this.getCurrentRegion();let a=this._getVideoData(null,{region:o});if(!a)return void xe._onLog;for(;this._frameQueue&&this._frameQueue.length>=this.maxNumberOfFramesInBuffer;)this._frameQueue.shift();this._frameQueue.push(a);const d=this.mapCameraEvents.get("frameaddedtobuffer");for(let _ of d)_&&setTimeout(()=>{this.isDisposed&&this.disposed||_.apply(this)},0)},i=()=>{this.isDisposed&&this.disposed||(this._frameLoopTimeoutId2&&clearTimeout(this._frameLoopTimeoutId2),this.refreshInterval<=0||(this._frameLoopTimeoutId2=setTimeout(()=>{this.isDisposed&&this.disposed||(this._bOpen&&this.isFetchingLoopStarted()?(n(),i()):this.stopFetchingLoop())},this.refreshInterval)))};t&&(this._frameQueue.length<this.maxNumberOfFramesInBuffer?(n(),this.refreshInterval>0&&i()):this.refreshInterval>0?(n(),i()):this.refreshInterval===0?n():this.refreshInterval),this._frameLoopTimeoutId&&clearTimeout(this._frameLoopTimeoutId),this._frameLoopTimeoutId=setTimeout(()=>{this.isDisposed&&this.disposed||this._fetchingLoop(!0)},this.loopInterval)}startFetchingLoop(){if(this.isDisposed&&this.disposed)throw Error("The 'CameraEnhancer' instance has been disposed.");if(this._assertOpen(),this.singleFrameMode)throw Error("'startFetchingLoop()' is unavailable in singleFrameMode.");this.isFetchingLoopStarted()||(this._bFetchingLoopStarted=!0,this._recordedStates.fetchingLoopStart=!0,this._fetchingLoop(!0))}isFetchingLoopStarted(){return this._bFetchingLoopStarted}stopFetchingLoop(){this._bFetchingLoopStarted&&(this._frameLoopTimeoutId&&clearTimeout(this._frameLoopTimeoutId),this._frameQueue.length=0,this._bFetchingLoopStarted=!1,this._recordedStates.fetchingLoopStart=!1)}getFrameFromBuffer(t){return this._frameQueue&&this._frameQueue.length?t?t<this._frameQueue.length?(this._frameLoopTimeoutId2&&clearTimeout(this._frameLoopTimeoutId2),this._frameQueue.splice(t,1)[0]):void 0:(this._frameLoopTimeoutId2&&clearTimeout(this._frameLoopTimeoutId2),this._frameQueue.pop()):null}clearFrameBuffer(){this._frameQueue&&(this._frameQueue.length=0)}_createDrawingLayerBaseCvs(){let t;this._assertOpen();try{t=this._calculateCvsSize()}catch(d){throw d}let{width:n,height:i,objectFit:o}=t;(n<=0||i<=0)&&(n=2,i=2);const a=document.createElement("canvas");if(a.width==n&&a.height==i||(a.width=n,a.height=i),a.style.objectFit=o,this._cvsScanRegion)this._cvsScanRegion.after(a);else if(this._cvsOriginalImage)this._cvsOriginalImage.after(a);else if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(a);else{if(!this._videoContainer)throw new Error("Unable to find video element");this._videoContainer.after(a)}return a}_updateDrawingLayersSize(t){let n;try{n=t&&t.width&&t.height&&t.objectFit?{width:t.width,height:t.height,objectFit:t.objectFit}:this._calculateCvsSize()}catch(d){if((d.message||d)==="Invalid content dimensions.")return;throw d}const{width:i,height:o,objectFit:a}=n;this._drawingLayersManager.setDimensions({width:i,height:o},{backstoreOnly:!0}),this._drawingLayersManager.setObjectFit(a)}_createDrawingLayer(t){this._layerBaseCvs||(this._layerBaseCvs=this._createDrawingLayerBaseCvs());const n=this._layerBaseCvs;return this._drawingLayersManager.createDrawingLayer(n,t)}deleteDrawingLayer(t){this._drawingLayersManager.deleteDrawingLayer(t),this._drawingLayersManager.getDrawingLayers().length||this._layerBaseCvs&&(this._layerBaseCvs.remove(),this._layerBaseCvs=null)}createDrawingLayer(){return this._createDrawingLayer()}getDrawingLayer(t){return this._drawingLayersManager.getDrawingLayer(t)||([1,2,3].includes(t)?this._createDrawingLayer(t):null)}getDrawingLayers(){return this._drawingLayersManager.getDrawingLayers().filter(t=>t.getId()>=0)}getSelectedDrawingItems(){return this._drawingLayersManager.getSelectedDrawingItems()}createDrawingStyle(t){return this._drawingLayersManager.createDrawingStyle(t)}getDrawingStyle(t){return this._drawingLayersManager.getDrawingStyle(t)}getDrawingStyles(){return this._drawingLayersManager.getDrawingStyles()}updateDrawingStyle(t,n){return this._drawingLayersManager.updateDrawingStyle(t,n)}clearDrawingLayers(){const t=this.getDrawingLayers();for(let n of t)this.deleteDrawingLayer(n.getId())}showTip(t,n,i,o,a=3e3,d=!0){this._assertOpen(),this._tipArgs.x=t,this._tipArgs.y=n,this._tipArgs.width=i,this._tipArgs.autoShowSuggestedTip=!!d,this._drawingLayerOfTip||(this._drawingLayerOfTip=this._createDrawingLayer(-1)),this._tipStyleId||(this._tipStyleId=this.createDrawingStyle({fillStyle:"#FFFFFF",paintMode:"fill",fontFamily:"Open Sans",fontSize:40})),this._drawingLayerOfTip.clearDrawingItems();const _=new Zf(o||"",t,n,i,this._tipStyleId);_._fabricObject.paddingTop=15,_._fabricObject.calcTextHeight=function(){for(var y=0,w=0,x=this._textLines.length;w<x;w++)y+=this.getHeightOfLine(w);return y+2*this.paddingTop},_._fabricObject._getTopOffset=function(){return-this.height/2+this.getHeightOfLine(0)*(1-1/this.lineHeight)/2+this.paddingTop},_.setAttribute("backgroundColor","rgba(50, 50, 52, .8)"),_.setAttribute("lineHeight",1.3),_.setAttribute("textAlign","center"),this._drawingLayerOfTip.addDrawingItem(_),this._hideTipTimeoutId&&clearTimeout(this._hideTipTimeoutId),this._tipArgs.duration=a===void 0?3e3:a,this._tipArgs.duration>0&&(this._hideTipTimeoutId=setTimeout(()=>{this.isDisposed&&this.disposed||this._hideTip()},this._tipArgs.duration))}_hideTip(){this._drawingLayerOfTip&&(this.deleteDrawingLayer(this._drawingLayerOfTip.getId()),this._drawingLayerOfTip=null,this._hideTipTimeoutId&&clearTimeout(this._hideTipTimeoutId))}hideTip(){this._hideTip(),this._tipArgs.x=null,this._tipArgs.y=null,this._tipArgs.width=null,this._tipArgs.autoShowSuggestedTip=null}updateTipMessage(t){if(!this._drawingLayerOfTip)throw new Error("The Tip is not showing.");this._drawingLayerOfTip.getDrawingItems()[0].setAttribute("text",t),this._drawingLayerOfTip.renderAll(),this._tipArgs.duration>0&&(this._hideTipTimeoutId&&clearTimeout(this._hideTipTimeoutId),this._hideTipTimeoutId=setTimeout(()=>{this.isDisposed&&this.disposed||this._hideTip()},this._tipArgs.duration))}suggestTip(t,n){this._tipArgs.autoShowSuggestedTip&&(this._drawingLayerOfTip?this.updateTipMessage(n):this._tipArgs.x!==void 0&&this.showTip(this._tipArgs.x,this._tipArgs.y,this._tipArgs.width,n,this._tipArgs.duration)),this.onTipSuggested&&setTimeout(()=>{this.isDisposed&&this.disposed||this.onTipSuggested.apply(this,[t,n])},0)}_createControler(){if(this._controler||(this._controler=new R_(this)),this._controler)return this._controler}_destroyControler(){this._controler=null}setOriginalImage(t,n,i){if(!t||!n||!i)throw new Error("Invalid arguments");this._originalImageData={imageData:t,width:n,height:i};let o=this._cvsOriginalImage;o||(o=document.createElement("canvas"),o.style.position="absolute",o.style.width="100%",o.style.height="100%",o.style.left="0",o.style.top="0",o.style.backgroundColor="white",o.style.objectFit="contain",this._cvsOriginalImage=o),o.width===n&&o.height===i||(o.width=n,o.height=i);const a=o.getContext("2d");a.clearRect(0,0,o.width,o.height),t instanceof Uint8Array||t instanceof Uint8ClampedArray?(t instanceof Uint8Array&&(t=new Uint8ClampedArray(t.buffer)),a.putImageData(new ImageData(t,n,i),0,0)):t instanceof HTMLCanvasElement&&a.drawImage(t,0,0),document.body.contains(o)&&o.style.display===""&&this._updateDrawingLayersSize({width:n,height:i,objectFit:"contain"})}getOriginalImage(){return this._originalImageData?Object.assign({},this._originalImageData):null}async deleteOriginalImage(){await this.hideOriginalImage(),this._cvsOriginalImage&&(this._cvsOriginalImage.remove(),this._cvsOriginalImage=null),this._originalImageData=null}_showOriginalImageCvs(){this._cvsOriginalImage&&this._cvsOriginalImage.style.display=="none"&&(this._cvsOriginalImage.style.display="")}_hideOriginalImageCvs(){this._cvsOriginalImage&&(this._cvsOriginalImage.style.display="none")}showOriginalImage(){if(!this._originalImageData)throw new Error("No original image is set.");const t=this._cvsOriginalImage;if(t.style.display===""&&document.body.contains(t))return;const{width:n,height:i}=this._originalImageData;if(this._updateDrawingLayersSize({width:n,height:i,objectFit:"contain"}),this._bOpen&&(this._video&&!this._video.paused&&this._video.pause(),this._bFetchingLoopStarted&&(this.stopFetchingLoop(),this._recordedStates.fetchingLoopStart=!0),this.ifShowScanRegionMask&&this._cvsScanRegion&&(this._cvsScanRegion.style.display="none"),this.ifShowScanRegionLaser&&this._divScanLight&&(this._divScanLight.style.display="none"),this._cvsViewDecorator&&(this._cvsViewDecorator.style.display="none"),this._scanRegionOverlayContainer&&(this._scanRegionOverlayContainer.style.display="none"),this._selCam&&(this._selCam.parentElement.style.display="none")),!document.body.contains(t))if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(t);else{if(!this._videoContainer)throw new Error("Unable to find video element");this._videoContainer.after(t)}this._showOriginalImageCvs()}async _hideOriginalImage(t){this._originalImageData&&this._cvsOriginalImage&&this._cvsOriginalImage.style.display!=="none"&&(this._updateDrawingLayersSize(),this._bOpen&&t&&(this._video&&this._recordedStates.videoPlaying&&await this.play(null,null,null,{notTriggerSingleFrameClick:!0}),this._recordedStates.fetchingLoopStart&&!this.singleFrameMode&&this.startFetchingLoop(),this.ifShowScanRegionMask&&this._cvsScanRegion&&this._recordedStates.maskShow&&this.showScanRegionMask(),this.ifShowScanRegionLaser&&this._divScanLight&&this._recordedStates.laserShow&&this.showScanRegionLaser(),this._cvsViewDecorator&&this._recordedStates.decoratorShow&&this.showViewDecorator(),this._scanRegionOverlayContainer&&this._recordedStates.overlayShow&&this.showScanRegionOverlays()),this._selCam&&(this._selCam.parentElement.style.display=""),this._hideOriginalImageCvs())}async hideOriginalImage(){return this._hideOriginalImage(!0)}transformCoord(t){if(!this.isOpen())throw new Error("Unavailable when the camera is not open.");if(this.singleFrameMode&&!this._cvsSingleFrameMode)throw new Error("No image is selected. ");const n=this._elContainer.getBoundingClientRect();let i,o,a,d,_,y=n.left,w=n.top,x=y+window.scrollX,T=w+window.scrollY;this.singleFrameMode?(i=this._cvsSingleFrameMode.width,o=this._cvsSingleFrameMode.height,a=parseFloat(window.getComputedStyle(this._cvsSingleFrameMode).width),d=parseFloat(window.getComputedStyle(this._cvsSingleFrameMode).height),_="contain"):(i=this.video.videoWidth,o=this.video.videoHeight,a=parseFloat(window.getComputedStyle(this._elContainer).width),d=parseFloat(window.getComputedStyle(this._elContainer).height),_=this.videoFit);const E=a/d,M=i/o;let F,P,B,D,O=1;if(_==="contain")E<M?(O=a/i,F=y+t.x*O,P=w+t.y*O+(d-o*O)/2,B=x+t.x*O,D=T+t.y*O+(d-o*O)/2):(O=d/o,F=y+t.x*O+(a-i*O)/2,P=w+t.y*O,B=x+t.x*O+(a-i*O)/2,D=T+t.y*O);else if(_==="cover")if(E<M){O=d/o;let A=t.x*O-(i*O-a)/2;A=Math.max(A,0),A=Math.min(A,a),F=y+A,P=w+t.y*O,B=x+A,D=T+t.y*O}else{O=a/i;let A=t.y*O-(o*O-d)/2;A=Math.max(A,0),A=Math.min(A,d),F=y+t.x*O,P=w+A,B=x+t.x*O,D=T+A}return{clientX:F,clientY:P,pageX:B,pageY:D}}convertToPageCoordinates(t){const n=this.transformCoord(t);return{x:n.pageX,y:n.pageY}}convertToClientCoordinates(t){const n=this.transformCoord(t);return{x:n.clientX,y:n.clientY}}dispose(t){this.UIElement&&(this._uiOriginalState&&this._uiOriginalState.inDom?this.UIElement.style.display=this._uiOriginalState.display:this.UIElement.style.display="none"),this.clearDrawingLayers(),this.close(),this.forceLoseContext(),this.setViewDecorator(null,null),this._scanRegionOverlayContainer&&this._scanRegionOverlayContainer.remove(),this._arrScanRegionOverlays.length=0,t&&this.UIElement&&this.UIElement.remove(),this.__proto__=null;for(let n in this)delete this[n];Object.defineProperty(this,"isCameraEnhancer",{value:!0}),Object.defineProperty(this,"isDisposed",{value:!0}),Object.defineProperty(this,"disposed",{value:!0})}}xe._jsVersion="3.3.5",xe._jsEditVersion="20230801",xe._version="JS "+xe._jsVersion+"."+xe._jsEditVersion,xe.browserInfo=Ke,xe._hasEngineResourceLoaded=!1,xe._engineResourcePath=I_,xe._defaultUIElementURL="@engineResourcePath/dce.ui.html";const A_={DT_Arc:class extends Tt{constructor(e,t,n,i,o,a){super(new Te.Circle({left:e,top:t,radius:n,startAngle:i,endAngle:o}),a),this._mediaType="arc"}},DT_Polygon:Yu,DT_Rect:class extends Tt{constructor(e,t,n,i,o){super(new Te.Rect({left:e,top:t,width:n,height:i}),o)}},DT_Image:class extends Tt{constructor(e,t,n,i){super(new Te.Image(e,{left:t,top:n}),i),this.image=e}_extendSet(e,t){if(e==="image"){if(t instanceof HTMLImageElement)return this._fabricObject.setElement(t),this.image=t,!0;if(t instanceof HTMLCanvasElement){const n=new Image;return n.src=t.toDataURL(),this._fabricObject.setElement(n),this.image=t,!0}throw new Error("Unsupported value.")}}_extendGet(e){if(e==="image")return this.image}},DT_Text:Zf,DT_Line:class extends Yu{constructor(e,t,n){super([e,t],n),this._mediaType="line"}_extendSet(e,t){if(e==="startPoint"||e==="endPoint"){t=e==="startPoint"?[t,this.get("endPoint")]:[this.get("startPoint"),t];const n=this._fabricObject;if(n.group){const o=n.group;n.points=t.map(a=>({x:a.x-o.left-o.width/2,y:a.y-o.top-o.height/2})),o.addWithUpdate()}else n.points=t;const i=n.points.length-1;return n.controls=n.points.reduce(function(o,a,d){return o["p"+d]=new Te.Control({positionHandler:hl,actionHandler:fl(d>0?d-1:i,dl),actionName:"modifyPolygon",pointIndex:d}),o},{}),n._setPositionDimensions({}),!0}}_extendGet(e){if(e==="startPoint"||e==="endPoint"){const t=[],n=this._fabricObject;if(n.selectable&&!n.group)for(let i in n.oCoords)t.push({x:n.oCoords[i].x,y:n.oCoords[i].y});else for(let i of n.points){let o=i.x-n.pathOffset.x,a=i.y-n.pathOffset.y;const d=Te.util.transformPoint({x:o,y:a},n.calcTransformMatrix());t.push({x:d.x,y:d.y})}return e==="startPoint"?t[0]:t[1]}}},DT_Group:class extends Tt{constructor(e){super(new Te.Group(e.map(t=>t._getFabricObject()))),this._fabricObject.on("selected",()=>{this.styleSelector="selected";const t=this._fabricObject._objects;for(let n of t)setTimeout(()=>{n&&n.fire("selected")},0);setTimeout(()=>{this._fabricObject&&this._fabricObject.canvas&&(this._fabricObject.dirty=!0,this._fabricObject.canvas.renderAll())},0)}),this._fabricObject.on("deselected",()=>{this.styleSelector="default";const t=this._fabricObject._objects;for(let n of t)setTimeout(()=>{n&&n.fire("deselected")},0);setTimeout(()=>{this._fabricObject&&this._fabricObject.canvas&&(this._fabricObject.dirty=!0,this._fabricObject.canvas.renderAll())},0)})}getChildItems(){return this._fabricObject._objects.map(e=>e.getDrawingItem())}addChildItem(e){if(!e||!e.isDrawingItem)throw TypeError("Illegal drawing item.");this._drawingLayer?this._drawingLayer._updateGroupItem(this,e,"add"):this._fabricObject.addWithUpdate(e._getFabricObject())}removeChildItem(e){e&&e.isDrawingItem&&(this._drawingLayer?this._drawingLayer._updateGroupItem(this,e,"remove"):this._fabricObject.removeWithUpdate(e._getFabricObject()))}}};function D_(e,t,n){return(n.x-e.x)*(t.y-e.y)==(t.x-e.x)*(n.y-e.y)&&Math.min(e.x,t.x)<=n.x&&n.x<=Math.max(e.x,t.x)&&Math.min(e.y,t.y)<=n.y&&n.y<=Math.max(e.y,t.y)}function da(e){return Math.abs(e)<1e-6?0:e<0?-1:1}function Co(e,t,n,i){let o=e[0]*(n[1]-t[1])+t[0]*(e[1]-n[1])+n[0]*(t[1]-e[1]),a=e[0]*(i[1]-t[1])+t[0]*(e[1]-i[1])+i[0]*(t[1]-e[1]);return!((o^a)>=0&&o!==0&&a!==0)&&(o=n[0]*(e[1]-i[1])+i[0]*(n[1]-e[1])+e[0]*(i[1]-n[1]),a=n[0]*(t[1]-i[1])+i[0]*(n[1]-t[1])+t[0]*(i[1]-n[1]),!((o^a)>=0&&o!==0&&a!==0))}class on extends W{constructor(){super(),this._barcodeFillStyle="rgba(254,180,32,0.3)",this._barcodeStrokeStyle="rgba(254,180,32,0.9)",this._barcodeLineWidth=1,this._barcodeFillStyleBeforeVerification="rgba(248,252,0,0.2)",this._barcodeStrokeStyleBeforeVerification="transparent",this._barcodeLineWidthBeforeVerification=2,this.bFilterRegionInJs=!0,this._onPlayed=null}static get version(){return this._version+`(DCE ${xe.getVersion()})`}static _fireHTTPSWarnning(){on.onWarning&&location&&location.protocol!=="https:"&&setTimeout(()=>{on.onWarning&&on.onWarning({id:2,message:"Not connected via SSL (HTTPS), the SDK may not work correctly."})},0)}static async testCameraAccess(){return xe.testCameraAccess()}_fireResolutionWarning(){if(!this.singleFrameMode&&this.onWarning&&this.dce.isOpen()){const t=this.dce.getConstraints();t&&t.width<1280&&t.height<720&&setTimeout(()=>{this.onWarning&&this.onWarning({id:3,message:"Camera resolution too low, please use a higher resolution (720P or better)."})},0)}}getUIElement(){return this.dce.getUIElement()}async setUIElement(t){await this.dce.setUIElement(t)}get singleFrameMode(){return this.dce.singleFrameMode}set singleFrameMode(t){this.dce.singleFrameMode=t,t&&(this.dce.ifShowScanRegionLaser=!1,(async()=>{let n=await this.getScanSettings();n.oneDTrustFrameCount=1,await this.updateScanSettings(n)})())}get onUnduplicatedRead(){return this.onUniqueRead}set onUnduplicatedRead(t){this.onUniqueRead=t}get video(){return this.dce&&this.dce.video}set videoSrc(t){this.dce&&(this.dce.videoSrc=t)}get videoSrc(){return this.dce&&this.dce.videoSrc}set onTipSuggested(t){this.dce&&(this.dce.onTipSuggested=t)}get onTipSuggested(){return this.dce&&this.dce.onTipSuggested}_assertOpen(){if(!this.dce.isOpen())throw Error("The scanner is not open.")}set barcodeFillStyle(t){this._barcodeFillStyle=t,this.dce&&this.dce.updateDrawingStyle(3,{fillStyle:t})}get barcodeFillStyle(){return this._barcodeFillStyle}set barcodeStrokeStyle(t){this._barcodeStrokeStyle=t,this.dce&&this.dce.updateDrawingStyle(3,{strokeStyle:t})}get barcodeStrokeStyle(){return this._barcodeStrokeStyle}set barcodeLineWidth(t){this._barcodeLineWidth=t,this.dce&&this.dce.updateDrawingStyle(3,{lineWidth:t})}get barcodeLineWidth(){return this._barcodeLineWidth}set barcodeFillStyleBeforeVerification(t){this._barcodeFillStyleBeforeVerification=t,this._styleIdBeforeVerification&&this.dce.updateDrawingStyle(this._styleIdBeforeVerification,{fillStyle:t})}get barcodeFillStyleBeforeVerification(){return this._barcodeFillStyleBeforeVerification}set barcodeStrokeStyleBeforeVerification(t){this._barcodeStrokeStyleBeforeVerification=t,this._styleIdBeforeVerification&&this.dce.updateDrawingStyle(this._styleIdBeforeVerification,{strokeStyle:t})}get barcodeStrokeStyleBeforeVerification(){return this._barcodeStrokeStyleBeforeVerification}set barcodeLineWidthBeforeVerification(t){this._barcodeLineWidthBeforeVerification=t,this._styleIdBeforeVerification&&this.dce.updateDrawingStyle(this._styleIdBeforeVerification,{lineWidth:t})}get barcodeLineWidthBeforeVerification(){return this._barcodeLineWidthBeforeVerification}set regionMaskFillStyle(t){this.dce.setScanRegionMaskStyle({fillStyle:t})}get regionMaskFillStyle(){return this.dce.regionMaskFillStyle}set regionMaskStrokeStyle(t){this.dce.setScanRegionMaskStyle({strokeStyle:t})}get regionMaskStrokeStyle(){return this.dce.regionMaskStrokeStyle}set regionMaskLineWidth(t){this.dce.setScanRegionMaskStyle({lineWidth:t})}get regionMaskLineWidth(){return this.dce.regionMaskLineWidth}set region(t){this._region=t,this.dce&&(t?t instanceof Array||this.dce.setScanRegion(t):this.dce.setScanRegion(null)),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}get region(){return this._region}set ifSaveOriginalImageInACanvas(t){this._ifSaveOriginalImageInACanvas=t,this.dce.framePixelFormat=t?"rgba":"grey"}get ifSaveOriginalImageInACanvas(){return this._ifSaveOriginalImageInACanvas}async createDCEInstance(){this.dce||(W._onLog&&W._onLog("createDCEInstance()"),xe.defaultUIElementURL=null,this.dce=await xe.createInstance(),this.dce.refreshInterval=200,this.dce.framePixelFormat="grey",this.dce.maxCvsSideLength=this.maxCvsSideLength,this._drawingItemNamespace=A_,["iPhone","iPad","Android","HarmonyOS"].includes(W.browserInfo.OS)||this.dce.setResolution(1920,1080),this._styleIdBeforeVerification=this.dce.createDrawingStyle({fillStyle:"rgba(248,252,0,0.2)",strokeStyle:"transparent",paintMode:"strokeAndFill"}),this.barcodeLineWidth=this._barcodeLineWidth,this.dce.on("cameraChange",()=>{this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}),this.dce.on("resolutionChange",()=>{this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}),this.dce.on("cameraClose",()=>{this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0,this._bPauseScan=!1}),this.dce.on("singleFrameAcquired",async t=>{if(!t||!t.data)return;let n;this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null),this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:t.width,height:t.height,pixelFormat:t.pixelFormat,data:new Uint8Array(t.data),toCanvas:t.toCanvas});const{data:i,sx:o,sy:a,width:d,height:_,stride:y,pixelFormat:w,timeStamp:x,_sWidth:T,_sHeight:E}=t,M={timeStamp:x};if(w==="grey")n=await this._decodeBuffer_Uint8Array(i,d,_,y,Be.IPF_GrayScaled,0,M);else if(w==="rgba")n=await this._decodeBuffer_Uint8Array(i,d,_,y,Be.IPF_ABGR_8888,0,M);else{if(w!=="bgra")throw new Error(`Pixel format '${w}' is not supported.`);n=await this._decodeBuffer_Uint8Array(i,d,_,y,Be.IPF_ARGB_8888,0,M)}if(await this.clearMapDecodeRecord(),W.recalculateResultLocation(n,o,a,T,E,d,_),this._drawResults(n),this.onFrameRead&&this.isOpen()&&!this._bPauseScan){let F=this._cloneDecodeResults(n);this.onFrameRead(F)}if(this.onUniqueRead&&this.isOpen()&&!this._bPauseScan)for(let F of n)this.onUniqueRead(F.barcodeText,this._cloneDecodeResults(F))}))}set maxCvsSideLength(t){this._maxCvsSideLength=t,this.dce.maxCvsSideLength=t}get maxCvsSideLength(){return this._maxCvsSideLength}static async createInstance(t){const n=new on;n._instanceID=await on.createInstanceInWorker(!0),await n.createDCEInstance(),typeof t=="string"&&(t=JSON.parse(t));for(let i in t)n[i]=t[i];return await n.dce.setUIElement(on.defaultUIElementURL),n.singleFrameMode&&console.warn("The `navigator.mediaDevices.getUserMedia` is unavailable. automatically change to `singleFrameMode`."),on._fireHTTPSWarnning(),n.singleFrameMode||await n.updateRuntimeSettings("single"),n}async decodeCurrentFrame(t){this._assertOpen();let n=null;t&&t.region&&(n=t.region);const i=this.dce._getVideoData(null,{region:n});return this._decode_DCEFrame(i)}async updateRuntimeSettings(t){let n;if(typeof t=="string")if(t=="speed"){let i=await this.getRuntimeSettings();await this.resetRuntimeSettings(),n=await this.getRuntimeSettings(),n.barcodeFormatIds=i.barcodeFormatIds,n.barcodeFormatIds_2=i.barcodeFormatIds_2,i.region&&(n.region=i.region),n.expectedBarcodesCount=0,n.localizationModes=[2,0,0,0,0,0,0,0],n.barcodeZoneMinDistanceToImageBorders=9}else if(t=="balance"){let i=await this.getRuntimeSettings();await this.resetRuntimeSettings(),n=await this.getRuntimeSettings(),n.barcodeFormatIds=i.barcodeFormatIds,n.barcodeFormatIds_2=i.barcodeFormatIds_2,i.region&&(n.region=i.region),n.expectedBarcodesCount=512,n.deblurLevel=3,n.localizationModes=[2,16,0,0,0,0,0,0],n.barcodeZoneMinDistanceToImageBorders=9,n.timeout=1e5}else if(t=="coverage"){let i=await this.getRuntimeSettings();await this.resetRuntimeSettings(),n=await this.getRuntimeSettings(),n.barcodeFormatIds=i.barcodeFormatIds,n.barcodeFormatIds_2=i.barcodeFormatIds_2,i.region&&(n.region=i.region),n.expectedBarcodesCount=512,n.deblurLevel=5,n.scaleDownThreshold=1e5,n.localizationModes=[2,16,4,8,0,0,0,0],n.barcodeZoneMinDistanceToImageBorders=9,n.timeout=1e5}else if(t=="single"){let i=await this.getRuntimeSettings();await this.resetRuntimeSettings(),n=await this.getRuntimeSettings(),n.barcodeFormatIds=i.barcodeFormatIds,n.barcodeFormatIds_2=i.barcodeFormatIds_2,i.region&&(n.region=i.region)}else if(t=="dense"){let i=await this.getRuntimeSettings();await this.resetRuntimeSettings(),this.maxCvsSideLength=4096,n=await this.getRuntimeSettings(),n.barcodeFormatIds=i.barcodeFormatIds,n.barcodeFormatIds_2=i.barcodeFormatIds_2,i.region&&(n.region=i.region),n.expectedBarcodesCount=0,n.deblurLevel=7,n.scaleDownThreshold=1e5,n.localizationModes=[2,8,0,0,0,0,0,0],n.minResultConfidence=0,n.barcodeZoneMinDistanceToImageBorders=9,n.timeout=1e5}else if(t=="distance"){let i=await this.getRuntimeSettings();await this.resetRuntimeSettings(),this.maxCvsSideLength=4096,n=await this.getRuntimeSettings(),n.barcodeFormatIds=i.barcodeFormatIds,n.barcodeFormatIds_2=i.barcodeFormatIds_2,i.region&&(n.region=i.region),n.expectedBarcodesCount=0,n.scaleDownThreshold=1e5,n.localizationModes=[2,8,0,0,0,0,0,0],n.barcodeZoneMinDistanceToImageBorders=9,n.timeout=1e5}else n=JSON.parse(t);else{if(typeof t!="object")throw TypeError("'UpdateRuntimeSettings(settings)': Type of 'settings' should be 'string' or 'PlainObject'.");if(n=JSON.parse(JSON.stringify(t)),n.region instanceof Array){let i=t.region;[i.regionLeft,i.regionTop,i.regionLeft,i.regionBottom,i.regionMeasuredByPercentage].some(o=>o!==void 0)&&(n.region={regionLeft:i.regionLeft||0,regionTop:i.regionTop||0,regionRight:i.regionRight||0,regionBottom:i.regionBottom||0,regionMeasuredByPercentage:i.regionMeasuredByPercentage||0})}}if(!W._bUseFullFeature){if(n.barcodeFormatIds&~(bt.BF_ONED|bt.BF_QR_CODE|bt.BF_PDF417|bt.BF_DATAMATRIX)||n.barcodeFormatIds_2!=0)throw Error("Some of the specified barcode formats are not supported in the compact version. Please try the full-featured version.");if(n.intermediateResultTypes!=0)throw Error("Intermediate results is not supported in the compact version. Please try the full-featured version.")}{let i=n.region;if(this.bFilterRegionInJs?this.userDefinedRegion=JSON.parse(JSON.stringify(i)):this.userDefinedRegion=null,i instanceof Array)if(i.length){for(let o=0;o<i.length;++o){let a=i[o];a&&((a.regionLeft||a.regionTop||a.regionRight||a.regionBottom||a.regionMeasuredByPercentage)&&(a.regionLeft||a.regionTop||a.regionRight!=100||a.regionBottom!=100||!a.regionMeasuredByPercentage)||(i[o]=null))}this.region=i}else this.region=null;else i&&(i.regionLeft||i.regionTop||i.regionRight||i.regionBottom||i.regionMeasuredByPercentage)&&(i.regionLeft||i.regionTop||i.regionRight!=100||i.regionBottom!=100||!i.regionMeasuredByPercentage)?this.region=i:this.region=null;this.bFilterRegionInJs&&(n.region={regionLeft:0,regionTop:0,regionRight:0,regionBottom:0,regionMeasuredByPercentage:0})}(this.autoZoom||this.autoFocus)&&(n.intermediateResultTypes|=tr.IRT_TYPED_BARCODE_ZONE),await new Promise((i,o)=>{let a=W._nextTaskID++;W._taskCallbackMap.set(a,d=>{if(d.success){try{this._handleRetJsonString(d.updateReturn)}catch(_){o(_)}return i()}{let _=new Error(d.message);return _.stack=d.stack+`
`+_.stack,o(_)}}),W._dbrWorker.postMessage({type:"updateRuntimeSettings",id:a,instanceID:this._instanceID,body:{settings:JSON.stringify(n)}})}),typeof t=="string"&&["speed","balance","coverage","dense","distance"].includes(t)&&(await this.setModeArgument("BinarizationModes",0,"EnableFillBinaryVacancy","1"),await this.setModeArgument("BinarizationModes",0,"BlockSizeX","0"),await this.setModeArgument("BinarizationModes",0,"BlockSizeY","0"))}_bindUI(){if(!this.getUIElement())throw new Error("Need to define `UIElement` before opening.");if(this.dce._bindUI(),!this.dce.video)throw this._unbindUI(),Error("Can not find the video container element with class 'dce-video-container'")}_unbindUI(){this.dce._unbindUI()}set onPlayed(t){this.dce.off("played",this._onPlayed),this._onPlayed=t,this.dce.on("played",this._onPlayed)}get onPlayed(){return this._onPlayed}async getAllCameras(){return this.dce.getAllCameras()}async getCurrentCamera(){return this.dce.getSelectedCamera()}async setCurrentCamera(t){const n=await this.dce.selectCamera(t);return this._fireResolutionWarning(),n}getResolution(){return this.dce.getResolution()}async setResolution(t,n){const i=await this.dce.setResolution(t,n);return this._fireResolutionWarning(),i}getVideoSettings(){return this.dce.getVideoSettings()}updateVideoSettings(t){return this.dce.updateVideoSettings(t)}isOpen(){return this.dce&&this.dce.isOpen()}setVideoFit(t){return this.dce&&this.dce.setVideoFit(t)}getVideoFit(){return this.dce&&this.dce.getVideoFit()}set ifShowScanRegionMask(t){this.dce&&(this.dce.ifShowScanRegionMask=t)}get ifShowScanRegionMask(){return this.dce&&this.dce.ifShowScanRegionMask}set ifSaveLastUsedCamera(t){this.dce&&(this.dce.ifSaveLastUsedCamera=t)}get ifSaveLastUsedCamera(){return this.dce&&this.dce.ifSaveLastUsedCamera}set ifSkipCameraInspection(t){this.dce&&(this.dce.ifSkipCameraInspection=t)}get ifSkipCameraInspection(){return this.dce&&this.dce.ifSkipCameraInspection}stop(){this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null),this.dce.stop(),this.dce.ifShowScanRegionLaser=!1,this.dce.hideViewDecorator(),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}pause(){this.dce.pause()}async play(t,n,i){this.dce.ifShowScanRegionLaser=!0;const o=await this.dce.play(t,n,i);return this._fireResolutionWarning(),o}pauseScan(t){this._assertOpen(),this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),t&&t.keepResultsHighlighted||this._drawResults(null),this._bPauseScan=!0,this.dce.ifShowScanRegionLaser=!1,this.dce.stopFetchingLoop()}resumeScan(){this._assertOpen(),this._bPauseScan=!1,this.dce.ifShowScanRegionLaser=!0}getCapabilities(){return this.dce.getCapabilities()}getCameraSettings(){return this.dce.getCameraSettings()}getConstraints(){return this.dce.getConstraints()}async applyConstraints(t){return this.dce.applyConstraints(t)}async turnOnTorch(){return this.dce.turnOnTorch()}async turnOffTorch(){return this.dce.turnOffTorch()}async setColorTemperature(t){return this.dce.setColorTemperature(t)}getColorTemperature(){return this.dce.getColorTemperature()}async setExposureCompensation(t){return this.dce.setExposureCompensation(t)}getExposureCompensation(){return this.dce.getExposureCompensation()}async setZoom(t){return this.dce.setZoom(t)}getZoomSettings(){return this.dce.getZoomSettings()}resetZoom(){return this.dce.resetZoom()}async setFrameRate(t){return this.dce.setFrameRate(t)}getFrameRate(){return this.dce.getFrameRate()}async setFocus(t,n){return this.dce.setFocus(t,n)}getFocus(){return this.dce.getFocus()}getFocusSettings(){return this.dce.getFocusSettings()}async _loopReadVideo(){if(this.bDestroyed)return this.dce&&this.dce.stopFetchingLoop(),this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),void this._drawResults(null);if(!this.isOpen())return this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null),void await this.clearMapDecodeRecord();if(!this.dce.video||this.dce.video.paused||this._bPauseScan)return W._onLog&&W._onLog("Video or scan is paused. Ask in 1s."),await this.clearMapDecodeRecord(),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},this._intervalDetectVideoPause));W._onLog&&W._onLog("======= once read ======="),W._onLog&&(this._timeStartDecode=Date.now());const t=this._getVideoFrame();if(!t)return W._onLog&&W._onLog("Get invalid frame."),this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0));(async()=>{t._bUseWebGL||t.pixelFormat!=="grey"||(this.dce.framePixelFormat="rgba");let n=[];this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:t.width,height:t.height,pixelFormat:t.pixelFormat,data:new Uint8Array(t.data),toCanvas:t.toCanvas});const{data:i,sx:o,sy:a,width:d,height:_,stride:y,pixelFormat:w,timeStamp:x,_sWidth:T,_sHeight:E}=t,M={timeStamp:x};if(w==="grey")n=await this._decodeBuffer_Uint8Array(i,d,_,y,Be.IPF_GrayScaled,0,M);else if(w==="rgba")n=await this._decodeBuffer_Uint8Array(i,d,_,y,Be.IPF_ABGR_8888,0,M);else{if(w!=="bgra")throw new Error(`Pixel format '${w}' is not supported.`);n=await this._decodeBuffer_Uint8Array(i,d,_,y,Be.IPF_ARGB_8888,0,M)}if(W.recalculateResultLocation(n,o,a,T,E,d,_),this._resultHighlightingDuration==0?this._drawResults(null):this._drawResults(n),this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._resultHighlightingDuration>0&&(this._clearResultsCanvasTimeoutId=setTimeout(()=>{this.bDestroyed||this._drawResults(null)},this._resultHighlightingDuration)),this.isOpen()&&this.dce.video&&!this.dce.video.paused&&!this._bPauseScan&&(this.autoZoom||this.autoFocus||this.autoSuggestTip))if(n.length)this.autoZoomInFrameArray.length=0,this.autoZoomOutFrameCount=0,this.frameArrayInIdealZoom.length=0,this.suggestTipFrameArray.length=0,this.autoZoom&&this.autoFocus&&(this.nextActionInIdealZoom="focus"),this.autoFocusFrameArray.length=0,this.noIntermediateResultsCount=0;else{const F=await this.getIntermediateResults(),P=(O,A,Y,ne,oe,K,S)=>{let ue=K/ne,le=S/oe;O.x1=O.x1/ue+A,O.x2=O.x2/ue+A,O.x3=O.x3/ue+A,O.x4=O.x4/ue+A,O.y1=O.y1/le+Y,O.y2=O.y2/le+Y,O.y3=O.y3/le+Y,O.y4=O.y4/le+Y},B=O=>{if(!O)return null;const A={};let Y,ne,oe,K,S;{const g=this.video.videoWidth*(1-this.autoZoomDetectionArea)/2,p=this.video.videoWidth*(1+this.autoZoomDetectionArea)/2,v=p,C=g,b=this.video.videoHeight*(1-this.autoZoomDetectionArea)/2,k=b,I=this.video.videoHeight*(1+this.autoZoomDetectionArea)/2;S={x1:g,x2:p,x3:v,x4:C,y1:b,y2:k,y3:I,y4:I}}const ue=(g,p)=>{const v=(b,k)=>{if(!b&&!k)throw new Error("Invalid arguments.");return function(I,R,N){let H=!1;const z=I.length;if(z<=2)return!1;for(let q=0;q<z;q++){const J=I[q],$=I[(q+1)%z];if(D_(J,$,{x:R,y:N}))return!0;da(J.y-N)>0!=da($.y-N)>0&&da(R-(N-J.y)*(J.x-$.x)/(J.y-$.y)-J.x)<0&&(H=!H)}return H}([{x:k.x1,y:k.y1},{x:k.x2,y:k.y2},{x:k.x3,y:k.y3},{x:k.x4,y:k.y4}],b.x,b.y)},C=(b,k)=>!!(Co([b[0],b[1]],[b[2],b[3]],[k.x1,k.y1],[k.x2,k.y2])||Co([b[0],b[1]],[b[2],b[3]],[k.x2,k.y2],[k.x3,k.y3])||Co([b[0],b[1]],[b[2],b[3]],[k.x3,k.y3],[k.x4,k.y4])||Co([b[0],b[1]],[b[2],b[3]],[k.x4,k.y4],[k.x1,k.y1]));return!!(v({x:g.x1,y:g.y1},p)||v({x:g.x2,y:g.y2},p)||v({x:g.x3,y:g.y3},p)||v({x:g.x4,y:g.y4},p))||!!(v({x:p.x1,y:p.y1},g)||v({x:p.x2,y:p.y2},g)||v({x:p.x3,y:p.y3},g)||v({x:p.x4,y:p.y4},g))||!!(C([p.x1,p.y1,p.x2,p.y2],g)||C([p.x2,p.y2,p.x3,p.y3],g)||C([p.x3,p.y3,p.x4,p.y4],g)||C([p.x4,p.y4,p.x1,p.y1],g))},le=[];for(let g of O){if(g.resultType!==tr.IRT_TYPED_BARCODE_ZONE)continue;const p=g.scaleDownRatio;for(let v of g.results){if(!v)continue;const C={x1:v.x1=v.x1*p,x2:v.x2=v.x2*p,x3:v.x3=v.x3*p,x4:v.x4=v.x4*p,y1:v.y1=v.y1*p,y2:v.y2=v.y2*p,y3:v.y4=v.y3*p,y4:v.y4=v.y4*p};P(C,o,a,T,E,d,_),ue(S,C)&&le.push(v)}}const Ce=(g=>{if(!g||!g.length)return null;const p=k=>{const I=(k.x1+k.x2+k.x3+k.x4)/4,R=(k.y1+k.y2+k.y3+k.y4)/4;return(I-d/2)*(I-d/2)+(R-_/2)*(R-_/2)};let v,C=g.filter(k=>k.barcodeFormat==bt.BF_QR_CODE||k.barcodeFormat==bt.BF_DATAMATRIX);if(C.length||(C=g.filter(k=>k.barcodeFormat==bt.BF_ONED),C.length||(C=g)),!C.length)return null;v=C[0];let b=p(v);if(C.length!=1)for(let k=1;k<C.length;k++){const I=p(C[k]);(C[k].confidence>1.1*v.confidence||C[k].confidence>.9*v.confidence&&I<b)&&(v=C[k],b=I)}return v})(le);if(!Ce)return null;const h=Ce.x1,l=Ce.x2,c=Ce.x3,f=Ce.x4,r=Ce.y1,s=Ce.y2,u=Ce.y3,m=Ce.y4;return Y=Math.min(h,l,c,f),ne=Math.max(h,l,c,f),oe=Math.min(r,s,u,m),K=Math.max(r,s,u,m),A.x1=A.x4=Y,A.x2=A.x3=ne,A.y1=A.y2=oe,A.y3=A.y4=K,A.result=Ce,A},D=B(F);if(D&&D.x1){if(this.autoZoomOutFrameCount=0,this.noIntermediateResultsCount=0,this.suggestTipFrameArray.push(!0),this.suggestTipFrameArray.splice(0,this.suggestTipFrameArray.length-this.suggestTipFrameLimit[0]),this.autoSuggestTip&&this.suggestTipFrameArray.filter(O=>O===!0).length>=this.suggestTipFrameLimit[1]){this.suggestTipFrameArray.length=0;const O=D.x3-D.x1,A=D.y3-D.y1;D.result.moduleSize<this.tinyBarcodeTipModuleSizeLimit?this.dce&&this.dce.suggestTip("tiny-barcode","Please zoom in or move closer."):O>A?O>d*this.hugeBarcodeTipLimit?this.dce&&this.dce.suggestTip("huge-barcode","Please zoom out or move farther."):O>.6*d&&Math.max(this.video.videoWidth,this.video.videoHeight)<=1280&&Math.min(this.video.videoWidth,this.video.videoHeight)<=720&&this.dce&&this.dce.suggestTip("low-resolution","Please use a higher resolution."):O<=A&&(A>_*this.hugeBarcodeTipLimit?this.dce&&this.dce.suggestTip("huge-barcode","Please zoom out or move farther."):A>.6*_&&Math.max(this.video.videoWidth,this.video.videoHeight)<=1280&&Math.min(this.video.videoWidth,this.video.videoHeight)<=720&&this.dce&&this.dce.suggestTip("low-resolution","Please use a higher resolution."))}if(this.autoZoom){const O=this.autoZoomIdealArea[1];let A=(1-this.autoZoomTargetBorder)/2;const Y=D.x1/T,ne=(T-D.x3)/T,oe=D.y1/E,K=(E-D.y3)/E;if(Y>O&&ne>O&&oe>O&&K>O&&D.result.moduleSize<this.autoZoomInIdealModuleSize){if(this.autoZoomInFrameArray.push(!0),this.autoZoomInFrameArray.splice(0,this.autoZoomInFrameArray.length-this.autoZoomInFrameLimit[0]),this.frameArrayInIdealZoom.length=0,this.autoFocus&&(this.nextActionInIdealZoom="focus",this.setFocus({mode:"continuous"}).catch(()=>{})),this.autoZoomInFrameArray.filter(S=>S===!0).length>=this.autoZoomInFrameLimit[1]){this.autoZoomInFrameArray.length=0;const S=[(.5-A)/(.5-Y),(.5-A)/(.5-ne),(.5-A)/(.5-oe),(.5-A)/(.5-K)].filter(l=>l>0),ue=Math.min(...S,this.autoZoomInIdealModuleSize/D.result.moduleSize),le=this.dce.getZoomSettings().factor;let Ce=Math.max(Math.pow(le*ue,1/this.autoZoomInMaxTimes),this.autoZoomInMinStep);Ce=Math.min(Ce,ue);const h=le*Ce;await this.setZoom({factor:h}),this.dce.clearFrameBuffer()}}else if(this.autoZoomInFrameArray.length=0,this.frameArrayInIdealZoom.push(!0),this.frameArrayInIdealZoom.splice(0,this.frameArrayInIdealZoom.length-this.frameLimitInIdealZoom[0]),this.frameArrayInIdealZoom.filter(S=>S===!0).length>=this.frameLimitInIdealZoom[1])if(this.frameArrayInIdealZoom.length=0,this.nextActionInIdealZoom==="focus"&&this.autoFocus){P(D,o,a,T,E,d,_);try{await this.setFocus({mode:"manual",area:{centerPoint:{x:(D.x1+D.x3)/2+"px",y:(D.y1+D.y3)/2+"px"},width:D.x3-D.x1+"px",height:D.y3-D.y1+"px"}})}catch{}this.dce.clearFrameBuffer(),this.nextActionInIdealZoom="zoomOut"}else{if(this.nextActionInIdealZoom!=="zoomOut"&&this.autoFocus)throw new Error("Invalid action.");if(this.enableZoomOutInIdealZoom){A=this.autoZoomIdealArea[1]+this.autoZoomOutStepRate_2;const S=[(.5-A)/(.5-Y),(.5-A)/(.5-ne),(.5-A)/(.5-oe),(.5-A)/(.5-K)].filter(le=>le>0);let ue=Math.min(...S)*this.dce.getZoomSettings().factor;await this.setZoom({factor:ue}),this.dce.clearFrameBuffer(),this.autoFocus&&(this.nextActionInIdealZoom="focus",this.setFocus({mode:"continuous"}).catch(le=>{}))}}}else if(this.autoFocus&&(this.autoFocusFrameArray.push(!0),this.autoFocusFrameArray.splice(0,this.autoFocusFrameArray.length-this.autoFocusFrameLimit[0]),this.autoFocusFrameArray.filter(O=>O===!0).length>=this.autoFocusFrameLimit[1])){this.autoFocusFrameArray.length=0;try{P(D,o,a,T,E,d,_),await this.setFocus({mode:"manual",area:{centerPoint:{x:(D.x1+D.x3)/2+"px",y:(D.y1+D.y3)/2+"px"},width:D.x3-D.x1+"px",height:D.y3-D.y1+"px"}})}catch{}this.dce.clearFrameBuffer()}}else if(this.noIntermediateResultsCount++,this.suggestTipFrameArray.push(!1),this.autoZoom){if(this.autoZoomInFrameArray.push(!1),this.autoZoomInFrameArray.splice(0,this.autoZoomInFrameArray.length-this.autoZoomInFrameLimit[0]),this.autoZoomOutFrameCount++,this.frameArrayInIdealZoom.push(!1),this.frameArrayInIdealZoom.splice(0,this.frameArrayInIdealZoom.length-this.frameLimitInIdealZoom[0]),this.autoZoomOutFrameCount>=this.autoZoomOutFrameLimit){this.autoZoomOutFrameCount=0;const O=this.getZoomSettings().factor;if(O>this.autoZoomOutMinValue){const A=Math.max((O-1)*this.autoZoomOutStepRate,this.autoZoomOutMinStep),Y=Math.max(O-A,this.autoZoomOutMinValue);await this.setZoom({factor:Y}),this.dce.clearFrameBuffer()}}this.autoFocus&&(this.nextActionInIdealZoom="focus",this.setFocus({mode:"continuous"}).catch(O=>{}))}else this.autoFocus&&(this.autoFocusFrameArray.length=0,this.setFocus({mode:"continuous"}).catch(O=>{}))}return n})().then(n=>{if(W._onLog&&W._onLog(n),this.captureAndDecodeInParallel){let i=this.array_decodeFrameTimeCost,o=this.array_getFrameTimeCost,a=this._indexCurrentDecodingFrame;const d=()=>{let _=0;if(this.region instanceof Array){let y=0,w=0;y=a+1>=this.region.length?0:a+1,w=y+1>=this.region.length?0:y+1,_=i[y]&&i[y].length&&o[w]&&o[w].length?Math.min(...i[y])-Math.max(...o[w]):0}else if(o&&o.length){let y=Math.min(...i),w=Math.max(...o);y&&w&&(_=y-w)}else _=0;return _>0?_:0};(()=>{if(this.region instanceof Array){for(i[a]&&i[a]instanceof Array||(i[a]=[]);i[a].length>=5;)i[a].shift();i[a].push(this._lastInnerDecodeDuration)}else{for(;i.length>=5;)i.shift();i.push(this._lastInnerDecodeDuration)}})(),this._intervalGetVideoFrame=d()+this.intervalTime,W._onLog&&W._onLog("Next fetching frame loop interval: "+this._intervalGetVideoFrame)}if(this.isOpen()&&this.dce.video&&!this.dce.video.paused&&!this._bPauseScan){if(this.bPlaySoundOnSuccessfulRead&&n.length){let i=!1;this.bPlaySoundOnSuccessfulRead===!0||this.bPlaySoundOnSuccessfulRead==="frame"?i=n.some(o=>o.resultState>=0):this.bPlaySoundOnSuccessfulRead==="unique"&&(i=n.some(o=>o.resultState==0)),i&&this.beepSound&&(this.beepSound.stop(),this.beepSound.play())}if(navigator.vibrate&&this.bVibrateOnSuccessfulRead&&n.length){let i=!1;if(this.bVibrateOnSuccessfulRead===!0||this.bVibrateOnSuccessfulRead==="frame"?i=n.some(o=>o.resultState>=0):this.bVibrateOnSuccessfulRead==="unique"&&(i=n.some(o=>o.resultState==0)),i)try{navigator.vibrate(this.vibrateDuration)}catch(o){console.warn("Vibration not allowed. User interaction required: "+(o.message||o))}}if(this.onFrameRead){n=n.filter(o=>o.resultState>=0);const i=this._cloneDecodeResults(n);this.onFrameRead(i)}if(this.onUniqueRead){n=n.filter(o=>o.resultState==0);const i=this._cloneDecodeResults(n);for(let o of i)this.onUniqueRead(o.barcodeText,o)}}this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this.intervalTime?this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},this.intervalTime):this._loopReadVideo()})}_getVideoFrame(){if(!this.dce)return null;let t;if(this.captureAndDecodeInParallel){W._onLog&&W._onLog("Get frame in parallel.");let n=this.dce.isFetchingLoopStarted();if(this.dce.loopInterval=this._intervalGetVideoFrame,n||this.dce.startFetchingLoop(),!this.dce.numberOfFramesInBuffer)return this.dce.loopInterval=0,null;t=this.dce.getFrameFromBuffer(),(o=>{if(!o)return;let a=o.timeSpent,d=this.array_getFrameTimeCost;for(;d.length>=5;)d.shift();d.push(a)})(t)}else W._onLog&&W._onLog("Get frame in serial."),this.dce.stopFetchingLoop(),t=this.dce.getFrame();return t}async open(){this._bindUI();const t=await this.dce.open();return this._bPauseScan=!1,this.singleFrameMode||(this.dce&&(this.dce.ifShowScanRegionLaser=!0),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0)),this._fireResolutionWarning(),t}async openVideo(){this._bindUI(),this.dce.ifShowScanRegionLaser=!1;const t=await this.dce.open();return this._bPauseScan=!0,this.singleFrameMode||(this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0)),this._fireResolutionWarning(),t}close(){this.dce.close(),this._bPauseScan=!0,this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId)}async show(){this._bindUI();const t=await this.dce.open(!0);return this._bPauseScan=!1,this.singleFrameMode||(this.dce&&(this.dce.ifShowScanRegionLaser=!0),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0)),this._fireResolutionWarning(),t}async showVideo(){this._bindUI(),this.dce.ifShowScanRegionLaser=!1;const t=await this.dce.open(!0);return this._bPauseScan=!0,this.singleFrameMode||(this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0)),this._fireResolutionWarning(),t}hide(){this.dce.close(!0),this._bPauseScan=!0,this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId)}showTip(t,n,i,o,a=3e3,d=!0){this.dce&&this.dce.showTip(t,n,i,o,a,d)}hideTip(){this.dce&&this.dce.hideTip()}updateTipMessage(t){this.dce&&this.dce.updateTipMessage(t)}async enableTapToFocus(){this.dce&&this.dce.enableTapToFocus()}disableTapToFocus(){this.dce&&this.dce.disableTapToFocus()}isTapToFocusEnabled(){return this.dce.isTapToFocusEnabled()}convertToPageCoordinates(t){return this.dce.convertToPageCoordinates(t)}convertToClientCoordinates(t){return this.dce.convertToClientCoordinates(t)}destroyContext(){this.close(),this.dce&&this.dce.dispose(!1),this.bDestroyed||super.destroyContext()}}var $u,Zu,Ku,Ju,Qu,qu,eh,th,nh,ih,rh,oh,sh,ah,lh,ch,uh,hh,dh,fh,gh,ph,mh,_h,vh,yh;(function(e){e[e.BICM_DARK_ON_LIGHT=1]="BICM_DARK_ON_LIGHT",e[e.BICM_LIGHT_ON_DARK=2]="BICM_LIGHT_ON_DARK",e[e.BICM_DARK_ON_DARK=4]="BICM_DARK_ON_DARK",e[e.BICM_LIGHT_ON_LIGHT=8]="BICM_LIGHT_ON_LIGHT",e[e.BICM_DARK_LIGHT_MIXED=16]="BICM_DARK_LIGHT_MIXED",e[e.BICM_DARK_ON_LIGHT_DARK_SURROUNDING=32]="BICM_DARK_ON_LIGHT_DARK_SURROUNDING",e[e.BICM_SKIP=0]="BICM_SKIP",e[e.BICM_REV=2147483648]="BICM_REV"})($u||($u={})),function(e){e[e.BCM_AUTO=1]="BCM_AUTO",e[e.BCM_GENERAL=2]="BCM_GENERAL",e[e.BCM_SKIP=0]="BCM_SKIP",e[e.BCM_REV=2147483648]="BCM_REV"}(Zu||(Zu={})),function(e){e[e.BF2_NULL=0]="BF2_NULL",e[e.BF2_POSTALCODE=32505856]="BF2_POSTALCODE",e[e.BF2_NONSTANDARD_BARCODE=1]="BF2_NONSTANDARD_BARCODE",e[e.BF2_USPSINTELLIGENTMAIL=1048576]="BF2_USPSINTELLIGENTMAIL",e[e.BF2_POSTNET=2097152]="BF2_POSTNET",e[e.BF2_PLANET=4194304]="BF2_PLANET",e[e.BF2_AUSTRALIANPOST=8388608]="BF2_AUSTRALIANPOST",e[e.BF2_RM4SCC=16777216]="BF2_RM4SCC",e[e.BF2_DOTCODE=2]="BF2_DOTCODE",e[e.BF2_PHARMACODE_ONE_TRACK=4]="BF2_PHARMACODE_ONE_TRACK",e[e.BF2_PHARMACODE_TWO_TRACK=8]="BF2_PHARMACODE_TWO_TRACK",e[e.BF2_PHARMACODE=12]="BF2_PHARMACODE",e[e.BF2_ALL=-1]="BF2_ALL"}(Ku||(Ku={})),function(e){e[e.BM_AUTO=1]="BM_AUTO",e[e.BM_LOCAL_BLOCK=2]="BM_LOCAL_BLOCK",e[e.BM_SKIP=0]="BM_SKIP",e[e.BM_THRESHOLD=4]="BM_THRESHOLD",e[e.BM_REV=2147483648]="BM_REV"}(Ju||(Ju={})),function(e){e[e.ECCM_CONTRAST=1]="ECCM_CONTRAST"}(Qu||(Qu={})),function(e){e[e.CFM_GENERAL=1]="CFM_GENERAL"}(qu||(qu={})),function(e){e[e.CCM_AUTO=1]="CCM_AUTO",e[e.CCM_GENERAL_HSV=2]="CCM_GENERAL_HSV",e[e.CCM_SKIP=0]="CCM_SKIP",e[e.CCM_REV=2147483648]="CCM_REV"}(eh||(eh={})),function(e){e[e.CICM_GENERAL=1]="CICM_GENERAL",e[e.CICM_SKIP=0]="CICM_SKIP",e[e.CICM_REV=2147483648]="CICM_REV"}(th||(th={})),function(e){e[e.CM_IGNORE=1]="CM_IGNORE",e[e.CM_OVERWRITE=2]="CM_OVERWRITE"}(nh||(nh={})),function(e){e[e.DM_SKIP=0]="DM_SKIP",e[e.DM_DIRECT_BINARIZATION=1]="DM_DIRECT_BINARIZATION",e[e.DM_THRESHOLD_BINARIZATION=2]="DM_THRESHOLD_BINARIZATION",e[e.DM_GRAY_EQUALIZATION=4]="DM_GRAY_EQUALIZATION",e[e.DM_SMOOTHING=8]="DM_SMOOTHING",e[e.DM_MORPHING=16]="DM_MORPHING",e[e.DM_DEEP_ANALYSIS=32]="DM_DEEP_ANALYSIS",e[e.DM_SHARPENING=64]="DM_SHARPENING",e[e.DM_BASED_ON_LOC_BIN=128]="DM_BASED_ON_LOC_BIN",e[e.DM_SHARPENING_SMOOTHING=256]="DM_SHARPENING_SMOOTHING"}(ih||(ih={})),function(e){e[e.DRM_AUTO=1]="DRM_AUTO",e[e.DRM_GENERAL=2]="DRM_GENERAL",e[e.DRM_BROAD_WARP=4]="DRM_BROAD_WARP",e[e.DRM_LOCAL_REFERENCE=8]="DRM_LOCAL_REFERENCE",e[e.DRM_DEWRINKLE=16]="DRM_DEWRINKLE",e[e.DRM_SKIP=0]="DRM_SKIP",e[e.DRM_REV=2147483648]="DRM_REV"}(rh||(rh={})),function(e){e[e.DPMCRM_AUTO=1]="DPMCRM_AUTO",e[e.DPMCRM_GENERAL=2]="DPMCRM_GENERAL",e[e.DPMCRM_SKIP=0]="DPMCRM_SKIP",e[e.DPMCRM_REV=2147483648]="DPMCRM_REV"}(oh||(oh={})),function(e){e[e.GTM_INVERTED=1]="GTM_INVERTED",e[e.GTM_ORIGINAL=2]="GTM_ORIGINAL",e[e.GTM_SKIP=0]="GTM_SKIP",e[e.GTM_REV=2147483648]="GTM_REV"}(sh||(sh={})),function(e){e[e.IPM_AUTO=1]="IPM_AUTO",e[e.IPM_GENERAL=2]="IPM_GENERAL",e[e.IPM_GRAY_EQUALIZE=4]="IPM_GRAY_EQUALIZE",e[e.IPM_GRAY_SMOOTH=8]="IPM_GRAY_SMOOTH",e[e.IPM_SHARPEN_SMOOTH=16]="IPM_SHARPEN_SMOOTH",e[e.IPM_MORPHOLOGY=32]="IPM_MORPHOLOGY",e[e.IPM_SKIP=0]="IPM_SKIP",e[e.IPM_REV=2147483648]="IPM_REV"}(ah||(ah={})),function(e){e[e.IRSM_MEMORY=1]="IRSM_MEMORY",e[e.IRSM_FILESYSTEM=2]="IRSM_FILESYSTEM",e[e.IRSM_BOTH=4]="IRSM_BOTH"}(lh||(lh={})),function(e){e[e.LM_SKIP=0]="LM_SKIP",e[e.LM_AUTO=1]="LM_AUTO",e[e.LM_CONNECTED_BLOCKS=2]="LM_CONNECTED_BLOCKS",e[e.LM_LINES=8]="LM_LINES",e[e.LM_STATISTICS=4]="LM_STATISTICS",e[e.LM_SCAN_DIRECTLY=16]="LM_SCAN_DIRECTLY",e[e.LM_STATISTICS_MARKS=32]="LM_STATISTICS_MARKS",e[e.LM_STATISTICS_POSTAL_CODE=64]="LM_STATISTICS_POSTAL_CODE",e[e.LM_CENTRE=128]="LM_CENTRE",e[e.LM_ONED_FAST_SCAN=256]="LM_ONED_FAST_SCAN",e[e.LM_REV=2147483648]="LM_REV"}(ch||(ch={})),function(e){e[e.PDFRM_RASTER=1]="PDFRM_RASTER",e[e.PDFRM_AUTO=2]="PDFRM_AUTO",e[e.PDFRM_VECTOR=4]="PDFRM_VECTOR",e[e.PDFRM_REV=2147483648]="PDFRM_REV"}(uh||(uh={})),function(e){e[e.QRECL_ERROR_CORRECTION_H=0]="QRECL_ERROR_CORRECTION_H",e[e.QRECL_ERROR_CORRECTION_L=1]="QRECL_ERROR_CORRECTION_L",e[e.QRECL_ERROR_CORRECTION_M=2]="QRECL_ERROR_CORRECTION_M",e[e.QRECL_ERROR_CORRECTION_Q=3]="QRECL_ERROR_CORRECTION_Q"}(hh||(hh={})),function(e){e[e.RPM_AUTO=1]="RPM_AUTO",e[e.RPM_GENERAL=2]="RPM_GENERAL",e[e.RPM_GENERAL_RGB_CONTRAST=4]="RPM_GENERAL_RGB_CONTRAST",e[e.RPM_GENERAL_GRAY_CONTRAST=8]="RPM_GENERAL_GRAY_CONTRAST",e[e.RPM_GENERAL_HSV_CONTRAST=16]="RPM_GENERAL_HSV_CONTRAST",e[e.RPM_SKIP=0]="RPM_SKIP",e[e.RPM_REV=2147483648]="RPM_REV"}(dh||(dh={})),function(e){e[e.RCT_PIXEL=1]="RCT_PIXEL",e[e.RCT_PERCENTAGE=2]="RCT_PERCENTAGE"}(fh||(fh={})),function(e){e[e.RT_STANDARD_TEXT=0]="RT_STANDARD_TEXT",e[e.RT_RAW_TEXT=1]="RT_RAW_TEXT",e[e.RT_CANDIDATE_TEXT=2]="RT_CANDIDATE_TEXT",e[e.RT_PARTIAL_TEXT=3]="RT_PARTIAL_TEXT"}(gh||(gh={})),function(e){e[e.SUM_AUTO=1]="SUM_AUTO",e[e.SUM_LINEAR_INTERPOLATION=2]="SUM_LINEAR_INTERPOLATION",e[e.SUM_NEAREST_NEIGHBOUR_INTERPOLATION=4]="SUM_NEAREST_NEIGHBOUR_INTERPOLATION",e[e.SUM_SKIP=0]="SUM_SKIP",e[e.SUM_REV=2147483648]="SUM_REV"}(ph||(ph={})),function(e){e[e.TP_REGION_PREDETECTED=1]="TP_REGION_PREDETECTED",e[e.TP_IMAGE_PREPROCESSED=2]="TP_IMAGE_PREPROCESSED",e[e.TP_IMAGE_BINARIZED=4]="TP_IMAGE_BINARIZED",e[e.TP_BARCODE_LOCALIZED=8]="TP_BARCODE_LOCALIZED",e[e.TP_BARCODE_TYPE_DETERMINED=16]="TP_BARCODE_TYPE_DETERMINED",e[e.TP_BARCODE_RECOGNIZED=32]="TP_BARCODE_RECOGNIZED"}(mh||(mh={})),function(e){e[e.TFM_AUTO=1]="TFM_AUTO",e[e.TFM_GENERAL_CONTOUR=2]="TFM_GENERAL_CONTOUR",e[e.TFM_SKIP=0]="TFM_SKIP",e[e.TFM_REV=2147483648]="TFM_REV"}(_h||(_h={})),function(e){e[e.TROM_CONFIDENCE=1]="TROM_CONFIDENCE",e[e.TROM_POSITION=2]="TROM_POSITION",e[e.TROM_FORMAT=4]="TROM_FORMAT",e[e.TROM_SKIP=0]="TROM_SKIP",e[e.TROM_REV=2147483648]="TROM_REV"}(vh||(vh={})),function(e){e[e.TDM_AUTO=1]="TDM_AUTO",e[e.TDM_GENERAL_WIDTH_CONCENTRATION=2]="TDM_GENERAL_WIDTH_CONCENTRATION",e[e.TDM_SKIP=0]="TDM_SKIP",e[e.TDM_REV=2147483648]="TDM_REV"}(yh||(yh={}));W.license="DLS2eyJvcmdhbml6YXRpb25JRCI6IjIwMDAwMSJ9";W.engineResourcePath="https://cdn.jsdelivr.net/npm/dynamsoft-javascript-barcode@9.6.21/dist/";const Kf=!!navigator.onLine,Jf=te.exports.createContext(Kf);function M_({children:e}){const[t,n]=te.exports.useState(Kf),i=async()=>{try{if(!(await fetch(`/barcode-scanner-pwa/favicon.ico?d=${Date.now()}`)).ok)throw new Error("Network response was not ok");console.log("Internet connection available"),n(!0)}catch(a){n(!1),console.log("No Internet connection",a)}};te.exports.useEffect(()=>{setInterval(async()=>{await i()},6e3)},[]);const o=te.exports.useMemo(()=>t,[t]);return ae(Jf.Provider,{value:o,children:e})}function Wn(e){return Wn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wn(e)}function F_(e,t){if(Wn(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t||"default");if(Wn(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function P_(e){var t=F_(e,"string");return Wn(t)==="symbol"?t:String(t)}function Gt(e,t,n){return t=P_(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gl(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function N_(e){if(Array.isArray(e))return gl(e)}function B_(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Qf(e,t){if(e){if(typeof e=="string")return gl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gl(e,t)}}function j_(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function On(e){return N_(e)||B_(e)||Qf(e)||j_()}function V_(e){if(Array.isArray(e))return e}function W_(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var i,o,a,d,_=[],y=!0,w=!1;try{if(a=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;y=!1}else for(;!(y=(i=a.call(n)).done)&&(_.push(i.value),_.length!==t);y=!0);}catch(x){w=!0,o=x}finally{try{if(!y&&n.return!=null&&(d=n.return(),Object(d)!==d))return}finally{if(w)throw o}}return _}}function U_(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Et(e,t){return V_(e)||W_(e,t)||Qf(e,t)||U_()}var qf={exports:{}};(function(e){(function(){var t={}.hasOwnProperty;function n(){for(var i=[],o=0;o<arguments.length;o++){var a=arguments[o];if(a){var d=typeof a;if(d==="string"||d==="number")i.push(a);else if(Array.isArray(a)){if(a.length){var _=n.apply(null,a);_&&i.push(_)}}else if(d==="object"){if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]")){i.push(a.toString());continue}for(var y in a)t.call(a,y)&&a[y]&&i.push(y)}}}return i.join(" ")}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(qf);const Pe=qf.exports;var pl={},G_=function(t){};function H_(e,t){}function z_(e,t){}function Y_(){pl={}}function eg(e,t,n){!t&&!pl[n]&&(e(!1,n),pl[n]=!0)}function Ms(e,t){eg(H_,e,t)}function X_(e,t){eg(z_,e,t)}Ms.preMessage=G_;Ms.resetWarned=Y_;Ms.noteOnce=X_;function $_(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=new Set;function o(a,d){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,y=i.has(a);if(Ms(!y,"Warning: There may be circular references"),y)return!1;if(a===d)return!0;if(n&&_>1)return!1;i.add(a);var w=_+1;if(Array.isArray(a)){if(!Array.isArray(d)||a.length!==d.length)return!1;for(var x=0;x<a.length;x++)if(!o(a[x],d[x],w))return!1;return!0}if(a&&d&&Wn(a)==="object"&&Wn(d)==="object"){var T=Object.keys(a);return T.length!==Object.keys(d).length?!1:T.every(function(E){return o(a[E],d[E],w)})}return!1}return o(e,t)}function Sh(e){var t=te.exports.useRef();t.current=e;var n=te.exports.useCallback(function(){for(var i,o=arguments.length,a=new Array(o),d=0;d<o;d++)a[d]=arguments[d];return(i=t.current)===null||i===void 0?void 0:i.call.apply(i,[t].concat(a))},[]);return n}function Z_(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var wh=Z_()?te.exports.useLayoutEffect:te.exports.useEffect,K_=function(t,n){var i=te.exports.useRef(!0);wh(function(){return t(i.current)},n),wh(function(){return i.current=!1,function(){i.current=!0}},[])},Ch=function(t,n){K_(function(i){if(!i)return t()},n)};function xh(e){var t=te.exports.useRef(!1),n=te.exports.useState(e),i=Et(n,2),o=i[0],a=i[1];te.exports.useEffect(function(){return t.current=!1,function(){t.current=!0}},[]);function d(_,y){y&&t.current||a(_)}return[o,d]}function fa(e){return e!==void 0}function J_(e,t){var n=t||{},i=n.defaultValue,o=n.value,a=n.onChange,d=n.postState,_=xh(function(){return fa(o)?o:fa(i)?typeof i=="function"?i():i:typeof e=="function"?e():e}),y=Et(_,2),w=y[0],x=y[1],T=o!==void 0?o:w,E=d?d(T):T,M=Sh(a),F=xh([T]),P=Et(F,2),B=P[0],D=P[1];Ch(function(){var A=B[0];w!==A&&M(w,A)},[B]),Ch(function(){fa(o)||x(o)},[o]);var O=Sh(function(A,Y){x(A,Y),D([T],Y)});return[E,O]}function ds(){return ds=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ds.apply(this,arguments)}function Q_(e,t){if(e==null)return{};var n={},i=Object.keys(e),o,a;for(a=0;a<i.length;a++)o=i[a],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function tg(e,t){if(e==null)return{};var n=Q_(e,t),i,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)i=a[o],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function bh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,i)}return n}function Kt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bh(Object(n),!0).forEach(function(i){Gt(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bh(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}var we={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,isTextModifyingKeyEvent:function(t){var n=t.keyCode;if(t.altKey&&!t.ctrlKey||t.metaKey||n>=we.F1&&n<=we.F12)return!1;switch(n){case we.ALT:case we.CAPS_LOCK:case we.CONTEXT_MENU:case we.CTRL:case we.DOWN:case we.END:case we.ESC:case we.HOME:case we.INSERT:case we.LEFT:case we.MAC_FF_META:case we.META:case we.NUMLOCK:case we.NUM_CENTER:case we.PAGE_DOWN:case we.PAGE_UP:case we.PAUSE:case we.PRINT_SCREEN:case we.RIGHT:case we.SHIFT:case we.UP:case we.WIN_KEY:case we.WIN_KEY_RIGHT:return!1;default:return!0}},isCharacterKey:function(t){if(t>=we.ZERO&&t<=we.NINE||t>=we.NUM_ZERO&&t<=we.NUM_MULTIPLY||t>=we.A&&t<=we.Z||window.navigator.userAgent.indexOf("WebKit")!==-1&&t===0)return!0;switch(t){case we.SPACE:case we.QUESTION_MARK:case we.NUM_PLUS:case we.NUM_MINUS:case we.NUM_PERIOD:case we.NUM_DIVISION:case we.SEMICOLON:case we.DASH:case we.EQUALS:case we.COMMA:case we.PERIOD:case we.SLASH:case we.APOSTROPHE:case we.SINGLE_QUOTE:case we.OPEN_SQUARE_BRACKET:case we.BACKSLASH:case we.CLOSE_SQUARE_BRACKET:return!0;default:return!1}}},pi=te.exports.createContext({min:0,max:0,direction:"ltr",step:1,includedStart:0,includedEnd:0,tabIndex:0,keyboard:!0});function ml(e,t,n){return(e-t)/(n-t)}function gc(e,t,n,i){var o=ml(t,n,i),a={};switch(e){case"rtl":a.right="".concat(o*100,"%"),a.transform="translateX(50%)";break;case"btt":a.bottom="".concat(o*100,"%"),a.transform="translateY(50%)";break;case"ttb":a.top="".concat(o*100,"%"),a.transform="translateY(-50%)";break;default:a.left="".concat(o*100,"%"),a.transform="translateX(-50%)";break}return a}function Wi(e,t){return Array.isArray(e)?e[t]:e}var q_=["prefixCls","value","valueIndex","onStartMove","style","render","dragging","onOffsetChange"],ev=te.exports.forwardRef(function(e,t){var n,i,o=e.prefixCls,a=e.value,d=e.valueIndex,_=e.onStartMove,y=e.style,w=e.render,x=e.dragging,T=e.onOffsetChange,E=tg(e,q_),M=te.exports.useContext(pi),F=M.min,P=M.max,B=M.direction,D=M.disabled,O=M.keyboard,A=M.range,Y=M.tabIndex,ne=M.ariaLabelForHandle,oe=M.ariaLabelledByForHandle,K=M.ariaValueTextFormatterForHandle,S="".concat(o,"-handle"),ue=function(c){D||_(c,d)},le=function(c){if(!D&&O){var f=null;switch(c.which||c.keyCode){case we.LEFT:f=B==="ltr"||B==="btt"?-1:1;break;case we.RIGHT:f=B==="ltr"||B==="btt"?1:-1;break;case we.UP:f=B!=="ttb"?1:-1;break;case we.DOWN:f=B!=="ttb"?-1:1;break;case we.HOME:f="min";break;case we.END:f="max";break;case we.PAGE_UP:f=2;break;case we.PAGE_DOWN:f=-2;break}f!==null&&(c.preventDefault(),T(f,d))}},Ce=gc(B,a,F,P),h=te.exports.createElement("div",ds({ref:t,className:Pe(S,(n={},Gt(n,"".concat(S,"-").concat(d+1),A),Gt(n,"".concat(S,"-dragging"),x),n)),style:Kt(Kt({},Ce),y),onMouseDown:ue,onTouchStart:ue,onKeyDown:le,tabIndex:D?null:Wi(Y,d),role:"slider","aria-valuemin":F,"aria-valuemax":P,"aria-valuenow":a,"aria-disabled":D,"aria-label":Wi(ne,d),"aria-labelledby":Wi(oe,d),"aria-valuetext":(i=Wi(K,d))===null||i===void 0?void 0:i(a),"aria-orientation":B==="ltr"||B==="rtl"?"horizontal":"vertical"},E));return w&&(h=w(h,{index:d,prefixCls:o,value:a,dragging:x})),h}),tv=["prefixCls","style","onStartMove","onOffsetChange","values","handleRender","draggingIndex"],nv=te.exports.forwardRef(function(e,t){var n=e.prefixCls,i=e.style,o=e.onStartMove,a=e.onOffsetChange,d=e.values,_=e.handleRender,y=e.draggingIndex,w=tg(e,tv),x=te.exports.useRef({});return te.exports.useImperativeHandle(t,function(){return{focus:function(E){var M;(M=x.current[E])===null||M===void 0||M.focus()}}}),te.exports.createElement(te.exports.Fragment,null,d.map(function(T,E){return te.exports.createElement(ev,ds({ref:function(F){F?x.current[E]=F:delete x.current[E]},dragging:y===E,prefixCls:n,style:Wi(i,E),key:E,value:T,valueIndex:E,onStartMove:o,onOffsetChange:a,render:_},w))}))});function Eh(e){var t="touches"in e?e.touches[0]:e;return{pageX:t.pageX,pageY:t.pageY}}function iv(e,t,n,i,o,a,d,_,y){var w=te.exports.useState(null),x=Et(w,2),T=x[0],E=x[1],M=te.exports.useState(-1),F=Et(M,2),P=F[0],B=F[1],D=te.exports.useState(n),O=Et(D,2),A=O[0],Y=O[1],ne=te.exports.useState(n),oe=Et(ne,2),K=oe[0],S=oe[1],ue=te.exports.useRef(null),le=te.exports.useRef(null);te.exports.useEffect(function(){P===-1&&Y(n)},[n,P]),te.exports.useEffect(function(){return function(){document.removeEventListener("mousemove",ue.current),document.removeEventListener("mouseup",le.current),document.removeEventListener("touchmove",ue.current),document.removeEventListener("touchend",le.current)}},[]);var Ce=function(s,u){A.some(function(m,g){return m!==s[g]})&&(u!==void 0&&E(u),Y(s),d(s))},h=function(s,u){if(s===-1){var m=K[0],g=K[K.length-1],p=i-m,v=o-g,C=u*(o-i);C=Math.max(C,p),C=Math.min(C,v);var b=a(m+C);C=b-m;var k=K.map(function(H){return H+C});Ce(k)}else{var I=(o-i)*u,R=On(A);R[s]=K[s];var N=y(R,I,s,"dist");Ce(N.values,N.value)}},l=te.exports.useRef(h);l.current=h;var c=function(s,u){s.stopPropagation();var m=n[u];B(u),E(m),S(n);var g=Eh(s),p=g.pageX,v=g.pageY,C=function(I){I.preventDefault();var R=Eh(I),N=R.pageX,H=R.pageY,z=N-p,q=H-v,J=e.current.getBoundingClientRect(),$=J.width,V=J.height,j;switch(t){case"btt":j=-q/V;break;case"ttb":j=q/V;break;case"rtl":j=-z/$;break;default:j=z/$}l.current(u,j)},b=function k(I){I.preventDefault(),document.removeEventListener("mouseup",k),document.removeEventListener("mousemove",C),document.removeEventListener("touchend",k),document.removeEventListener("touchmove",C),ue.current=null,le.current=null,B(-1),_()};document.addEventListener("mouseup",b),document.addEventListener("mousemove",C),document.addEventListener("touchend",b),document.addEventListener("touchmove",C),ue.current=C,le.current=b},f=te.exports.useMemo(function(){var r=On(n).sort(function(u,m){return u-m}),s=On(A).sort(function(u,m){return u-m});return r.every(function(u,m){return u===s[m]})?A:n},[n,A]);return[P,T,f,c]}function rv(e){var t,n=e.prefixCls,i=e.style,o=e.start,a=e.end,d=e.index,_=e.onStartMove,y=te.exports.useContext(pi),w=y.direction,x=y.min,T=y.max,E=y.disabled,M=y.range,F="".concat(n,"-track"),P=ml(o,x,T),B=ml(a,x,T),D=function(Y){!E&&_&&_(Y,-1)},O={};switch(w){case"rtl":O.right="".concat(P*100,"%"),O.width="".concat(B*100-P*100,"%");break;case"btt":O.bottom="".concat(P*100,"%"),O.height="".concat(B*100-P*100,"%");break;case"ttb":O.top="".concat(P*100,"%"),O.height="".concat(B*100-P*100,"%");break;default:O.left="".concat(P*100,"%"),O.width="".concat(B*100-P*100,"%")}return te.exports.createElement("div",{className:Pe(F,(t={},Gt(t,"".concat(F,"-").concat(d+1),M),Gt(t,"".concat(n,"-track-draggable"),_),t)),style:Kt(Kt({},O),i),onMouseDown:D,onTouchStart:D})}function ov(e){var t=e.prefixCls,n=e.style,i=e.values,o=e.startPoint,a=e.onStartMove,d=te.exports.useContext(pi),_=d.included,y=d.range,w=d.min,x=te.exports.useMemo(function(){if(!y){if(i.length===0)return[];var T=o??w,E=i[0];return[{start:Math.min(T,E),end:Math.max(T,E)}]}for(var M=[],F=0;F<i.length-1;F+=1)M.push({start:i[F],end:i[F+1]});return M},[i,y,o,w]);return _?x.map(function(T,E){var M=T.start,F=T.end;return te.exports.createElement(rv,{index:E,prefixCls:t,style:Wi(n,E),start:M,end:F,key:E,onStartMove:a})}):null}function sv(e){var t=e.prefixCls,n=e.style,i=e.children,o=e.value,a=e.onClick,d=te.exports.useContext(pi),_=d.min,y=d.max,w=d.direction,x=d.includedStart,T=d.includedEnd,E=d.included,M="".concat(t,"-text"),F=gc(w,o,_,y);return te.exports.createElement("span",{className:Pe(M,Gt({},"".concat(M,"-active"),E&&x<=o&&o<=T)),style:Kt(Kt({},F),n),onMouseDown:function(B){B.stopPropagation()},onClick:function(){a(o)}},i)}function av(e){var t=e.prefixCls,n=e.marks,i=e.onClick,o="".concat(t,"-mark");return n.length?te.exports.createElement("div",{className:o},n.map(function(a){var d=a.value,_=a.style,y=a.label;return te.exports.createElement(sv,{key:d,prefixCls:o,style:_,value:d,onClick:i},y)})):null}function lv(e){var t=e.prefixCls,n=e.value,i=e.style,o=e.activeStyle,a=te.exports.useContext(pi),d=a.min,_=a.max,y=a.direction,w=a.included,x=a.includedStart,T=a.includedEnd,E="".concat(t,"-dot"),M=w&&x<=n&&n<=T,F=Kt(Kt({},gc(y,n,d,_)),typeof i=="function"?i(n):i);return M&&(F=Kt(Kt({},F),typeof o=="function"?o(n):o)),te.exports.createElement("span",{className:Pe(E,Gt({},"".concat(E,"-active"),M)),style:F})}function cv(e){var t=e.prefixCls,n=e.marks,i=e.dots,o=e.style,a=e.activeStyle,d=te.exports.useContext(pi),_=d.min,y=d.max,w=d.step,x=te.exports.useMemo(function(){var T=new Set;if(n.forEach(function(M){T.add(M.value)}),i&&w!==null)for(var E=_;E<=y;)T.add(E),E+=w;return Array.from(T)},[_,y,w,i,n]);return te.exports.createElement("div",{className:"".concat(t,"-step")},x.map(function(T){return te.exports.createElement(lv,{prefixCls:t,key:T,value:T,style:o,activeStyle:a})}))}function uv(e,t,n,i,o,a){var d=te.exports.useCallback(function(M){var F=isFinite(M)?M:e;return F=Math.min(t,M),F=Math.max(e,F),F},[e,t]),_=te.exports.useCallback(function(M){if(n!==null){var F=e+Math.round((d(M)-e)/n)*n,P=function(A){return(String(A).split(".")[1]||"").length},B=Math.max(P(n),P(t),P(e)),D=Number(F.toFixed(B));return e<=D&&D<=t?D:null}return null},[n,e,t,d]),y=te.exports.useCallback(function(M){var F=d(M),P=i.map(function(O){return O.value});n!==null&&P.push(_(M)),P.push(e,t);var B=P[0],D=t-e;return P.forEach(function(O){var A=Math.abs(F-O);A<=D&&(B=O,D=A)}),B},[e,t,i,n,d,_]),w=function M(F,P,B){var D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit";if(typeof P=="number"){var O,A=F[B],Y=A+P,ne=[];i.forEach(function(le){ne.push(le.value)}),ne.push(e,t),ne.push(_(A));var oe=P>0?1:-1;D==="unit"?ne.push(_(A+oe*n)):ne.push(_(Y)),ne=ne.filter(function(le){return le!==null}).filter(function(le){return P<0?le<=A:le>=A}),D==="unit"&&(ne=ne.filter(function(le){return le!==A}));var K=D==="unit"?A:Y;O=ne[0];var S=Math.abs(O-K);if(ne.forEach(function(le){var Ce=Math.abs(le-K);Ce<S&&(O=le,S=Ce)}),O===void 0)return P<0?e:t;if(D==="dist")return O;if(Math.abs(P)>1){var ue=On(F);return ue[B]=O,M(ue,P-oe,B,D)}return O}else{if(P==="min")return e;if(P==="max")return t}},x=function(F,P,B){var D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",O=F[B],A=w(F,P,B,D);return{value:A,changed:A!==O}},T=function(F){return a===null&&F===0||typeof a=="number"&&F<a},E=function(F,P,B){var D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",O=F.map(y),A=O[B],Y=w(O,P,B,D);if(O[B]=Y,o===!1){var ne=a||0;B>0&&O[B-1]!==A&&(O[B]=Math.max(O[B],O[B-1]+ne)),B<O.length-1&&O[B+1]!==A&&(O[B]=Math.min(O[B],O[B+1]-ne))}else if(typeof a=="number"||a===null){for(var oe=B+1;oe<O.length;oe+=1)for(var K=!0;T(O[oe]-O[oe-1])&&K;){var S=x(O,1,oe);O[oe]=S.value,K=S.changed}for(var ue=B;ue>0;ue-=1)for(var le=!0;T(O[ue]-O[ue-1])&&le;){var Ce=x(O,-1,ue-1);O[ue-1]=Ce.value,le=Ce.changed}for(var h=O.length-1;h>0;h-=1)for(var l=!0;T(O[h]-O[h-1])&&l;){var c=x(O,-1,h-1);O[h-1]=c.value,l=c.changed}for(var f=0;f<O.length-1;f+=1)for(var r=!0;T(O[f+1]-O[f])&&r;){var s=x(O,1,f+1);O[f+1]=s.value,r=s.changed}}return{value:O[B],values:O}};return[y,E]}var hv=te.exports.forwardRef(function(e,t){var n,i=e.prefixCls,o=i===void 0?"rc-slider":i,a=e.className,d=e.style,_=e.disabled,y=_===void 0?!1:_,w=e.keyboard,x=w===void 0?!0:w,T=e.autoFocus,E=e.onFocus,M=e.onBlur,F=e.min,P=F===void 0?0:F,B=e.max,D=B===void 0?100:B,O=e.step,A=O===void 0?1:O,Y=e.value,ne=e.defaultValue,oe=e.range,K=e.count,S=e.onChange,ue=e.onBeforeChange,le=e.onAfterChange,Ce=e.allowCross,h=Ce===void 0?!0:Ce,l=e.pushable,c=l===void 0?!1:l,f=e.draggableTrack,r=e.reverse,s=e.vertical,u=e.included,m=u===void 0?!0:u,g=e.startPoint,p=e.trackStyle,v=e.handleStyle,C=e.railStyle,b=e.dotStyle,k=e.activeDotStyle,I=e.marks,R=e.dots,N=e.handleRender,H=e.tabIndex,z=H===void 0?0:H,q=e.ariaLabelForHandle,J=e.ariaLabelledByForHandle,$=e.ariaValueTextFormatterForHandle,V=te.exports.useRef(),j=te.exports.useRef(),X=te.exports.useMemo(function(){return s?r?"ttb":"btt":r?"rtl":"ltr"},[r,s]),Q=te.exports.useMemo(function(){return isFinite(P)?P:0},[P]),ie=te.exports.useMemo(function(){return isFinite(D)?D:100},[D]),G=te.exports.useMemo(function(){return A!==null&&A<=0?1:A},[A]),U=te.exports.useMemo(function(){return typeof c=="boolean"?c?G:!1:c>=0?c:!1},[c,G]),Z=te.exports.useMemo(function(){var Xe=Object.keys(I||{});return Xe.map(function(Ae){var Ee=I[Ae],Qe={value:Number(Ae)};return Ee&&Wn(Ee)==="object"&&!te.exports.isValidElement(Ee)&&("label"in Ee||"style"in Ee)?(Qe.style=Ee.style,Qe.label=Ee.label):Qe.label=Ee,Qe}).filter(function(Ae){var Ee=Ae.label;return Ee||typeof Ee=="number"}).sort(function(Ae,Ee){return Ae.value-Ee.value})},[I]),re=uv(Q,ie,G,Z,h,U),ee=Et(re,2),se=ee[0],_e=ee[1],ge=J_(ne,{value:Y}),he=Et(ge,2),fe=he[0],pe=he[1],me=te.exports.useMemo(function(){var Xe=fe==null?[]:Array.isArray(fe)?fe:[fe],Ae=Et(Xe,1),Ee=Ae[0],Qe=Ee===void 0?Q:Ee,He=fe===null?[]:[Qe];if(oe){if(He=On(Xe),K||fe===void 0){var ki=K>=0?K+1:2;for(He=He.slice(0,ki);He.length<ki;){var Jn;He.push((Jn=He[He.length-1])!==null&&Jn!==void 0?Jn:Q)}}He.sort(function(wn,ar){return wn-ar})}return He.forEach(function(wn,ar){He[ar]=se(wn)}),He},[fe,oe,Q,K,se]),ye=te.exports.useRef(me);ye.current=me;var ve=function(Ae){return oe?Ae:Ae[0]},be=function(Ae){var Ee=On(Ae).sort(function(Qe,He){return Qe-He});S&&!$_(Ee,ye.current,!0)&&S(ve(Ee)),pe(Ee)},Oe=function(Ae){if(!y){var Ee=0,Qe=ie-Q;me.forEach(function(ki,Jn){var wn=Math.abs(Ae-ki);wn<=Qe&&(Qe=wn,Ee=Jn)});var He=On(me);He[Ee]=Ae,oe&&!me.length&&K===void 0&&He.push(Ae),ue==null||ue(ve(He)),be(He),le==null||le(ve(He))}},pt=function(Ae){Ae.preventDefault();var Ee=j.current.getBoundingClientRect(),Qe=Ee.width,He=Ee.height,ki=Ee.left,Jn=Ee.top,wn=Ee.bottom,ar=Ee.right,Tc=Ae.clientX,kc=Ae.clientY,lr;switch(X){case"btt":lr=(wn-kc)/He;break;case"ttb":lr=(kc-Jn)/He;break;case"rtl":lr=(ar-Tc)/Qe;break;default:lr=(Tc-ki)/Qe}var Rg=Q+lr*(ie-Q);Oe(se(Rg))},Bt=te.exports.useState(null),tn=Et(Bt,2),Me=tn[0],ut=tn[1],Xn=function(Ae,Ee){if(!y){var Qe=_e(me,Ae,Ee);ue==null||ue(ve(me)),be(Qe.values),le==null||le(ve(Qe.values)),ut(Qe.value)}};te.exports.useEffect(function(){if(Me!==null){var Xe=me.indexOf(Me);Xe>=0&&V.current.focus(Xe)}ut(null)},[Me]);var vn=te.exports.useMemo(function(){return f&&G===null?!1:f},[f,G]),nn=function(){le==null||le(ve(ye.current))},yn=iv(j,X,me,Q,ie,se,be,nn,_e),$n=Et(yn,4),Zn=$n[0],Kn=$n[1],or=$n[2],sr=$n[3],Sn=function(Ae,Ee){sr(Ae,Ee),ue==null||ue(ve(ye.current))},Cc=Zn!==-1;te.exports.useEffect(function(){if(!Cc){var Xe=me.lastIndexOf(Kn);V.current.focus(Xe)}},[Cc]);var Ti=te.exports.useMemo(function(){return On(or).sort(function(Xe,Ae){return Xe-Ae})},[or]),Og=te.exports.useMemo(function(){return oe?[Ti[0],Ti[Ti.length-1]]:[Q,Ti[0]]},[Ti,oe,Q]),xc=Et(Og,2),bc=xc[0],Ec=xc[1];te.exports.useImperativeHandle(t,function(){return{focus:function(){V.current.focus(0)},blur:function(){var Ae=document,Ee=Ae.activeElement;j.current.contains(Ee)&&(Ee==null||Ee.blur())}}}),te.exports.useEffect(function(){T&&V.current.focus(0)},[]);var Lg=te.exports.useMemo(function(){return{min:Q,max:ie,direction:X,disabled:y,keyboard:x,step:G,included:m,includedStart:bc,includedEnd:Ec,range:oe,tabIndex:z,ariaLabelForHandle:q,ariaLabelledByForHandle:J,ariaValueTextFormatterForHandle:$}},[Q,ie,X,y,x,G,m,bc,Ec,oe,z,q,J,$]);return te.exports.createElement(pi.Provider,{value:Lg},te.exports.createElement("div",{ref:j,className:Pe(o,a,(n={},Gt(n,"".concat(o,"-disabled"),y),Gt(n,"".concat(o,"-vertical"),s),Gt(n,"".concat(o,"-horizontal"),!s),Gt(n,"".concat(o,"-with-marks"),Z.length),n)),style:d,onMouseDown:pt},te.exports.createElement("div",{className:"".concat(o,"-rail"),style:C}),te.exports.createElement(ov,{prefixCls:o,style:p,values:Ti,startPoint:g,onStartMove:vn?Sn:null}),te.exports.createElement(cv,{prefixCls:o,marks:Z,dots:R,style:b,activeStyle:k}),te.exports.createElement(nv,{ref:V,prefixCls:o,style:v,values:or,draggingIndex:Zn,onStartMove:Sn,onOffsetChange:Xn,onFocus:E,onBlur:M,handleRender:N}),te.exports.createElement(av,{prefixCls:o,marks:Z,onClick:Oe})))});var dv=te.exports.createContext({color:"currentColor",size:"1em",weight:"regular",mirrored:!1}),qt=function(t,n,i){var o=i.get(t);return o?o(n):(console.error('Unsupported icon weight. Choose from "thin", "light", "regular", "bold", "fill", or "duotone".'),null)};function Th(e,t){if(e==null)return{};var n={},i=Object.keys(e),o,a;for(a=0;a<i.length;a++)o=i[a],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}var ng=te.exports.forwardRef(function(e,t){var n=e.alt,i=e.color,o=e.size,a=e.weight,d=e.mirrored,_=e.children,y=e.renderPath,w=Th(e,["alt","color","size","weight","mirrored","children","renderPath"]),x=te.exports.useContext(dv),T=x.color,E=T===void 0?"currentColor":T,M=x.size,F=x.weight,P=F===void 0?"regular":F,B=x.mirrored,D=B===void 0?!1:B,O=Th(x,["color","size","weight","mirrored"]);return L.createElement("svg",Object.assign({ref:t,xmlns:"http://www.w3.org/2000/svg",width:o??M,height:o??M,fill:i??E,viewBox:"0 0 256 256",transform:d||D?"scale(-1, 1)":void 0},O,w),!!n&&L.createElement("title",null,n),_,L.createElement("rect",{width:"256",height:"256",fill:"none"}),y(a??P,i??E))});ng.displayName="IconBase";const en=ng;var mi=new Map;mi.set("bold",function(e){return L.createElement(L.Fragment,null,L.createElement("polyline",{points:"180 52 220 52 220 92",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("polyline",{points:"76 204 36 204 36 164",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("polyline",{points:"220 164 220 204 180 204",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("polyline",{points:"36 92 36 52 76 52",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("line",{x1:"88",y1:"92",x2:"88",y2:"164",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("line",{x1:"168",y1:"92",x2:"168",y2:"164",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("line",{x1:"128",y1:"92",x2:"128",y2:"164",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}))});mi.set("duotone",function(e){return L.createElement(L.Fragment,null,L.createElement("polyline",{points:"184 48 224 48 224 88",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("polyline",{points:"72 208 32 208 32 168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("polyline",{points:"224 168 224 208 184 208",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("polyline",{points:"32 88 32 48 72 48",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"80",y1:"88",x2:"80",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"176",y1:"88",x2:"176",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"144",y1:"88",x2:"144",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"112",y1:"88",x2:"112",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});mi.set("fill",function(){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M224,40H184a8,8,0,0,0,0,16h32V88a8,8,0,0,0,16,0V48A8,8,0,0,0,224,40Z"}),L.createElement("path",{d:"M72,200H40V168a8,8,0,0,0-16,0v40a8,8,0,0,0,8,8H72a8,8,0,0,0,0-16Z"}),L.createElement("path",{d:"M224,160a8,8,0,0,0-8,8v32H184a8,8,0,0,0,0,16h40a8,8,0,0,0,8-8V168A8,8,0,0,0,224,160Z"}),L.createElement("path",{d:"M32,96a8,8,0,0,0,8-8V56H72a8,8,0,0,0,0-16H32a8,8,0,0,0-8,8V88A8,8,0,0,0,32,96Z"}),L.createElement("path",{d:"M80,80a8,8,0,0,0-8,8v80a8,8,0,0,0,16,0V88A8,8,0,0,0,80,80Z"}),L.createElement("path",{d:"M184,168V88a8,8,0,0,0-16,0v80a8,8,0,0,0,16,0Z"}),L.createElement("path",{d:"M144,80a8,8,0,0,0-8,8v80a8,8,0,0,0,16,0V88A8,8,0,0,0,144,80Z"}),L.createElement("path",{d:"M112,80a8,8,0,0,0-8,8v80a8,8,0,0,0,16,0V88A8,8,0,0,0,112,80Z"}))});mi.set("light",function(e){return L.createElement(L.Fragment,null,L.createElement("polyline",{points:"184 48 224 48 224 88",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("polyline",{points:"72 208 32 208 32 168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("polyline",{points:"224 168 224 208 184 208",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("polyline",{points:"32 88 32 48 72 48",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"80",y1:"88",x2:"80",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"176",y1:"88",x2:"176",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"144",y1:"88",x2:"144",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"112",y1:"88",x2:"112",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}))});mi.set("thin",function(e){return L.createElement(L.Fragment,null,L.createElement("polyline",{points:"184 48 224 48 224 88",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("polyline",{points:"72 208 32 208 32 168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("polyline",{points:"224 168 224 208 184 208",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("polyline",{points:"32 88 32 48 72 48",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"80",y1:"88",x2:"80",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"176",y1:"88",x2:"176",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"144",y1:"88",x2:"144",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"112",y1:"88",x2:"112",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}))});mi.set("regular",function(e){return L.createElement(L.Fragment,null,L.createElement("polyline",{points:"184 48 224 48 224 88",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("polyline",{points:"72 208 32 208 32 168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("polyline",{points:"224 168 224 208 184 208",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("polyline",{points:"32 88 32 48 72 48",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"80",y1:"88",x2:"80",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"176",y1:"88",x2:"176",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"144",y1:"88",x2:"144",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"112",y1:"88",x2:"112",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});var fv=function(t,n){return qt(t,n,mi)},ig=te.exports.forwardRef(function(e,t){return L.createElement(en,Object.assign({ref:t},e,{renderPath:fv}))});ig.displayName="Barcode";const kh=ig;var _i=new Map;_i.set("bold",function(e){return L.createElement(L.Fragment,null,L.createElement("polyline",{points:"160 208 80 128 160 48",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}))});_i.set("duotone",function(e){return L.createElement(L.Fragment,null,L.createElement("polygon",{points:"160 208 80 128 160 48 160 208",opacity:"0.2"}),L.createElement("polygon",{points:"160 208 80 128 160 48 160 208",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});_i.set("fill",function(){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M163.1,40.6a8.4,8.4,0,0,0-8.8,1.7l-80,80a8.1,8.1,0,0,0,0,11.4l80,80A8.3,8.3,0,0,0,160,216a8.5,8.5,0,0,0,3.1-.6A8,8,0,0,0,168,208V48A8,8,0,0,0,163.1,40.6Z"}))});_i.set("light",function(e){return L.createElement(L.Fragment,null,L.createElement("polyline",{points:"160 208 80 128 160 48",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}))});_i.set("thin",function(e){return L.createElement(L.Fragment,null,L.createElement("polyline",{points:"160 208 80 128 160 48",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}))});_i.set("regular",function(e){return L.createElement(L.Fragment,null,L.createElement("polyline",{points:"160 208 80 128 160 48",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});var gv=function(t,n){return qt(t,n,_i)},rg=te.exports.forwardRef(function(e,t){return L.createElement(en,Object.assign({ref:t},e,{renderPath:gv}))});rg.displayName="CaretLeft";const pv=rg;var vi=new Map;vi.set("bold",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M152,224l-44.7-67a3.9,3.9,0,0,0-6.6,0L79.8,188.4a4,4,0,0,1-6.7-.1l-9.7-15.1a4.1,4.1,0,0,0-6.8,0L24,224Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("polyline",{points:"148 32 148 92 208 92",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("path",{d:"M196,224h4a8,8,0,0,0,8-8V88L152,32H56a8,8,0,0,0-8,8v88",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}))});vi.set("duotone",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M152,224l-44.7-67a3.9,3.9,0,0,0-6.6,0L79.8,188.4a4,4,0,0,1-6.7-.1l-9.7-15.1a4.1,4.1,0,0,0-6.8,0L24,224Z",opacity:"0.2"}),L.createElement("polygon",{points:"152 32 152 88 208 88 152 32",opacity:"0.2"}),L.createElement("path",{d:"M152,224l-44.7-67a3.9,3.9,0,0,0-6.6,0L79.8,188.4a4,4,0,0,1-6.7-.1l-9.7-15.1a4.1,4.1,0,0,0-6.8,0L24,224Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("polyline",{points:"152 32 152 88 208 88",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("path",{d:"M192,224h8a8,8,0,0,0,8-8V88L152,32H56a8,8,0,0,0-8,8v96",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});vi.set("fill",function(){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M213.7,82.3l-56-56A8.1,8.1,0,0,0,152,24H56A16,16,0,0,0,40,40v96a8,8,0,0,0,16,0V40h88V88a8,8,0,0,0,8,8h48V216h-8a8,8,0,0,0,0,16h8a16,16,0,0,0,16-16V88A8.1,8.1,0,0,0,213.7,82.3ZM160,80V51.3L188.7,80Zm-1.3,139.6a8.3,8.3,0,0,1,.4,8.2A8,8,0,0,1,152,232H24a8,8,0,0,1-7-4.2,7.9,7.9,0,0,1,.3-8.1l32.6-50.8a12,12,0,0,1,20.2,0l6.4,10L94,152.6a12,12,0,0,1,20,0Z"}))});vi.set("light",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M152,224l-44.7-67a3.9,3.9,0,0,0-6.6,0L79.8,188.4a4,4,0,0,1-6.7-.1l-9.7-15.1a4.1,4.1,0,0,0-6.8,0L24,224Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("polyline",{points:"152 32 152 88 208 88",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("path",{d:"M192,224h8a8,8,0,0,0,8-8V88L152,32H56a8,8,0,0,0-8,8v96",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}))});vi.set("thin",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M152,224l-44.7-67a3.9,3.9,0,0,0-6.6,0L79.8,188.4a4,4,0,0,1-6.7-.1l-9.7-15.1a4.1,4.1,0,0,0-6.8,0L24,224Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("polyline",{points:"152 32 152 88 208 88",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("path",{d:"M192,224h8a8,8,0,0,0,8-8V88L152,32H56a8,8,0,0,0-8,8v96",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}))});vi.set("regular",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M152,224l-44.7-67a3.9,3.9,0,0,0-6.6,0L79.8,188.4a4,4,0,0,1-6.7-.1l-9.7-15.1a4.1,4.1,0,0,0-6.8,0L24,224Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("polyline",{points:"152 32 152 88 208 88",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("path",{d:"M192,224h8a8,8,0,0,0,8-8V88L152,32H56a8,8,0,0,0-8,8v96",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});var mv=function(t,n){return qt(t,n,vi)},og=te.exports.forwardRef(function(e,t){return L.createElement(en,Object.assign({ref:t},e,{renderPath:mv}))});og.displayName="FileImage";const _v=og;var yi=new Map;yi.set("bold",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M72,24H184a8,8,0,0,1,8,8V77.3a8.1,8.1,0,0,1-1.6,4.8l-20.8,27.8a8.1,8.1,0,0,0-1.6,4.8V224a8,8,0,0,1-8,8H96a8,8,0,0,1-8-8V114.7a8.1,8.1,0,0,0-1.6-4.8L65.6,82.1A8.1,8.1,0,0,1,64,77.3V32A8,8,0,0,1,72,24Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("line",{x1:"128",y1:"120",x2:"128",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("line",{x1:"64",y1:"64",x2:"192",y2:"64",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}))});yi.set("duotone",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M192,77.3a8.1,8.1,0,0,1-1.6,4.8l-20.8,27.8a8.1,8.1,0,0,0-1.6,4.8V224a8,8,0,0,1-8,8H96a8,8,0,0,1-8-8V114.7a8.1,8.1,0,0,0-1.6-4.8L65.6,82.1A8.1,8.1,0,0,1,64,77.3V64H192Z",opacity:"0.2"}),L.createElement("path",{d:"M72,24H184a8,8,0,0,1,8,8V77.3a8.1,8.1,0,0,1-1.6,4.8l-20.8,27.8a8.1,8.1,0,0,0-1.6,4.8V224a8,8,0,0,1-8,8H96a8,8,0,0,1-8-8V114.7a8.1,8.1,0,0,0-1.6-4.8L65.6,82.1A8.1,8.1,0,0,1,64,77.3V32A8,8,0,0,1,72,24Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"128",y1:"120",x2:"128",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"64",y1:"64",x2:"192",y2:"64",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});yi.set("fill",function(){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M184,16H72A16,16,0,0,0,56,32V77.3a15.6,15.6,0,0,0,3.2,9.6L80,114.7V224a16,16,0,0,0,16,16h64a16,16,0,0,0,16-16V114.7l20.8-27.8a15.6,15.6,0,0,0,3.2-9.6V32A16,16,0,0,0,184,16ZM136,152a8,8,0,0,1-16,0V120a8,8,0,0,1,16,0ZM72,56V32H184V56Z"}))});yi.set("light",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M72,24H184a8,8,0,0,1,8,8V77.3a8.1,8.1,0,0,1-1.6,4.8l-20.8,27.8a8.1,8.1,0,0,0-1.6,4.8V224a8,8,0,0,1-8,8H96a8,8,0,0,1-8-8V114.7a8.1,8.1,0,0,0-1.6-4.8L65.6,82.1A8.1,8.1,0,0,1,64,77.3V32A8,8,0,0,1,72,24Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"128",y1:"120",x2:"128",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"64",y1:"64",x2:"192",y2:"64",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}))});yi.set("thin",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M72,24H184a8,8,0,0,1,8,8V77.3a8.1,8.1,0,0,1-1.6,4.8l-20.8,27.8a8.1,8.1,0,0,0-1.6,4.8V224a8,8,0,0,1-8,8H96a8,8,0,0,1-8-8V114.7a8.1,8.1,0,0,0-1.6-4.8L65.6,82.1A8.1,8.1,0,0,1,64,77.3V32A8,8,0,0,1,72,24Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"128",y1:"120",x2:"128",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"64",y1:"64",x2:"192",y2:"64",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}))});yi.set("regular",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M72,24H184a8,8,0,0,1,8,8V77.3a8.1,8.1,0,0,1-1.6,4.8l-20.8,27.8a8.1,8.1,0,0,0-1.6,4.8V224a8,8,0,0,1-8,8H96a8,8,0,0,1-8-8V114.7a8.1,8.1,0,0,0-1.6-4.8L65.6,82.1A8.1,8.1,0,0,1,64,77.3V32A8,8,0,0,1,72,24Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"128",y1:"120",x2:"128",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"64",y1:"64",x2:"192",y2:"64",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});var vv=function(t,n){return qt(t,n,yi)},sg=te.exports.forwardRef(function(e,t){return L.createElement(en,Object.assign({ref:t},e,{renderPath:vv}))});sg.displayName="Flashlight";const yv=sg;var Si=new Map;Si.set("bold",function(e){return L.createElement(L.Fragment,null,L.createElement("circle",{cx:"128",cy:"128",r:"44",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("path",{d:"M183.7,65.1q3.8,3.5,7.2,7.2l27.3,3.9a103.2,103.2,0,0,1,10.2,24.6l-16.6,22.1s.3,6.8,0,10.2l16.6,22.1a102.2,102.2,0,0,1-10.2,24.6l-27.3,3.9s-4.7,4.9-7.2,7.2l-3.9,27.3a103.2,103.2,0,0,1-24.6,10.2l-22.1-16.6a57.9,57.9,0,0,1-10.2,0l-22.1,16.6a102.2,102.2,0,0,1-24.6-10.2l-3.9-27.3q-3.7-3.5-7.2-7.2l-27.3-3.9a103.2,103.2,0,0,1-10.2-24.6l16.6-22.1s-.2-6.8,0-10.2L27.6,100.8A102.2,102.2,0,0,1,37.8,76.2l27.3-3.9q3.5-3.7,7.2-7.2l3.9-27.3a103.2,103.2,0,0,1,24.6-10.2l22.1,16.6a57.9,57.9,0,0,1,10.2,0l22.1-16.6a102.2,102.2,0,0,1,24.6,10.2Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}))});Si.set("duotone",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M211.8,133.1c.3-3.4,0-10.2,0-10.2l16.6-22.1a103.2,103.2,0,0,0-10.2-24.6l-27.3-3.9q-3.5-3.7-7.2-7.2l-3.9-27.3a102.2,102.2,0,0,0-24.6-10.2L133.1,44.2a57.9,57.9,0,0,0-10.2,0L100.8,27.6A103.2,103.2,0,0,0,76.2,37.8L72.3,65.1q-3.7,3.5-7.2,7.2L37.8,76.2a102.2,102.2,0,0,0-10.2,24.6l16.6,22.1c-.2,3.4,0,10.2,0,10.2L27.6,155.2a103.2,103.2,0,0,0,10.2,24.6l27.3,3.9q3.5,3.8,7.2,7.2l3.9,27.3a102.2,102.2,0,0,0,24.6,10.2l22.1-16.6a57.9,57.9,0,0,0,10.2,0l22.1,16.6a103.2,103.2,0,0,0,24.6-10.2l3.9-27.3c2.5-2.3,7.2-7.2,7.2-7.2l27.3-3.9a102.2,102.2,0,0,0,10.2-24.6ZM128,176a48,48,0,1,1,48-48A48,48,0,0,1,128,176Z",opacity:"0.2"}),L.createElement("circle",{cx:"128",cy:"128",r:"48",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("path",{d:"M183.7,65.1q3.8,3.5,7.2,7.2l27.3,3.9a103.2,103.2,0,0,1,10.2,24.6l-16.6,22.1s.3,6.8,0,10.2l16.6,22.1a102.2,102.2,0,0,1-10.2,24.6l-27.3,3.9s-4.7,4.9-7.2,7.2l-3.9,27.3a103.2,103.2,0,0,1-24.6,10.2l-22.1-16.6a57.9,57.9,0,0,1-10.2,0l-22.1,16.6a102.2,102.2,0,0,1-24.6-10.2l-3.9-27.3q-3.7-3.5-7.2-7.2l-27.3-3.9a103.2,103.2,0,0,1-10.2-24.6l16.6-22.1s-.2-6.8,0-10.2L27.6,100.8A102.2,102.2,0,0,1,37.8,76.2l27.3-3.9q3.5-3.7,7.2-7.2l3.9-27.3a103.2,103.2,0,0,1,24.6-10.2l22.1,16.6a57.9,57.9,0,0,1,10.2,0l22.1-16.6a102.2,102.2,0,0,1,24.6,10.2Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});Si.set("fill",function(){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M234.8,150.4l-14.9-19.8c.1-1.8,0-3.7,0-5.1l14.9-19.9a7.8,7.8,0,0,0,1.3-6.9,114.8,114.8,0,0,0-10.9-26.4,8.2,8.2,0,0,0-5.8-4l-24.5-3.5-3.7-3.7-3.5-24.5a8.4,8.4,0,0,0-3.9-5.8,117.5,117.5,0,0,0-26.5-10.9,7.8,7.8,0,0,0-6.9,1.3L130.6,36h-5.2L105.6,21.2a7.8,7.8,0,0,0-6.9-1.3A114.8,114.8,0,0,0,72.3,30.8a8.2,8.2,0,0,0-4,5.8L64.8,61.1l-3.7,3.7L36.6,68.3a8.2,8.2,0,0,0-5.8,4A114.8,114.8,0,0,0,19.9,98.7a7.8,7.8,0,0,0,1.3,6.9l14.9,19.8v5.1L21.2,150.4a7.8,7.8,0,0,0-1.3,6.9,114.8,114.8,0,0,0,10.9,26.4,8.2,8.2,0,0,0,5.8,4l24.5,3.5,3.7,3.7,3.5,24.5a8.2,8.2,0,0,0,4,5.8,114.8,114.8,0,0,0,26.4,10.9,7.6,7.6,0,0,0,2.1.3,7.7,7.7,0,0,0,4.8-1.6L125.4,220h5.2l19.8,14.8a7.8,7.8,0,0,0,6.9,1.3,113,113,0,0,0,26.4-10.9,8.2,8.2,0,0,0,4-5.8l3.5-24.6c1.2-1.2,2.6-2.5,3.6-3.6l24.6-3.5a8.2,8.2,0,0,0,5.8-4,114.8,114.8,0,0,0,10.9-26.4A7.8,7.8,0,0,0,234.8,150.4ZM128,172a44,44,0,1,1,44-44A44,44,0,0,1,128,172Z"}))});Si.set("light",function(e){return L.createElement(L.Fragment,null,L.createElement("circle",{cx:"128",cy:"128",r:"48",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("path",{d:"M183.7,65.1q3.8,3.5,7.2,7.2l27.3,3.9a103.2,103.2,0,0,1,10.2,24.6l-16.6,22.1s.3,6.8,0,10.2l16.6,22.1a102.2,102.2,0,0,1-10.2,24.6l-27.3,3.9s-4.7,4.9-7.2,7.2l-3.9,27.3a103.2,103.2,0,0,1-24.6,10.2l-22.1-16.6a57.9,57.9,0,0,1-10.2,0l-22.1,16.6a102.2,102.2,0,0,1-24.6-10.2l-3.9-27.3q-3.7-3.5-7.2-7.2l-27.3-3.9a103.2,103.2,0,0,1-10.2-24.6l16.6-22.1s-.3-6.8,0-10.2L27.6,100.8A102.2,102.2,0,0,1,37.8,76.2l27.3-3.9q3.5-3.7,7.2-7.2l3.9-27.3a103.2,103.2,0,0,1,24.6-10.2l22.1,16.6a57.9,57.9,0,0,1,10.2,0l22.1-16.6a102.2,102.2,0,0,1,24.6,10.2Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}))});Si.set("thin",function(e){return L.createElement(L.Fragment,null,L.createElement("circle",{cx:"128",cy:"128",r:"48",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("path",{d:"M183.7,65.1q3.8,3.5,7.2,7.2l27.3,3.9a103.2,103.2,0,0,1,10.2,24.6l-16.6,22.1s.3,6.8,0,10.2l16.6,22.1a102.2,102.2,0,0,1-10.2,24.6l-27.3,3.9s-4.7,4.9-7.2,7.2l-3.9,27.3a103.2,103.2,0,0,1-24.6,10.2l-22.1-16.6a57.9,57.9,0,0,1-10.2,0l-22.1,16.6a102.2,102.2,0,0,1-24.6-10.2l-3.9-27.3q-3.7-3.5-7.2-7.2l-27.3-3.9a103.2,103.2,0,0,1-10.2-24.6l16.6-22.1s-.3-6.8,0-10.2L27.6,100.8A102.2,102.2,0,0,1,37.8,76.2l27.3-3.9q3.5-3.7,7.2-7.2l3.9-27.3a103.2,103.2,0,0,1,24.6-10.2l22.1,16.6a57.9,57.9,0,0,1,10.2,0l22.1-16.6a102.2,102.2,0,0,1,24.6,10.2Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}))});Si.set("regular",function(e){return L.createElement(L.Fragment,null,L.createElement("circle",{cx:"128",cy:"128",r:"48",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("path",{d:"M183.7,65.1q3.8,3.5,7.2,7.2l27.3,3.9a103.2,103.2,0,0,1,10.2,24.6l-16.6,22.1s.3,6.8,0,10.2l16.6,22.1a102.2,102.2,0,0,1-10.2,24.6l-27.3,3.9s-4.7,4.9-7.2,7.2l-3.9,27.3a103.2,103.2,0,0,1-24.6,10.2l-22.1-16.6a57.9,57.9,0,0,1-10.2,0l-22.1,16.6a102.2,102.2,0,0,1-24.6-10.2l-3.9-27.3q-3.7-3.5-7.2-7.2l-27.3-3.9a103.2,103.2,0,0,1-10.2-24.6l16.6-22.1s-.3-6.8,0-10.2L27.6,100.8A102.2,102.2,0,0,1,37.8,76.2l27.3-3.9q3.5-3.7,7.2-7.2l3.9-27.3a103.2,103.2,0,0,1,24.6-10.2l22.1,16.6a57.9,57.9,0,0,1,10.2,0l22.1-16.6a102.2,102.2,0,0,1,24.6,10.2Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});var Sv=function(t,n){return qt(t,n,Si)},ag=te.exports.forwardRef(function(e,t){return L.createElement(en,Object.assign({ref:t},e,{renderPath:Sv}))});ag.displayName="Gear";const wv=ag;var wi=new Map;wi.set("bold",function(e){return L.createElement(L.Fragment,null,L.createElement("line",{x1:"144",y1:"40",x2:"112",y2:"40",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("line",{x1:"112",y1:"216",x2:"144",y2:"216",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("path",{d:"M184,40h24a8,8,0,0,1,8,8V72",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("line",{x1:"216",y1:"144",x2:"216",y2:"112",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("line",{x1:"40",y1:"112",x2:"40",y2:"144",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("path",{d:"M72,216H48a8,8,0,0,1-8-8V184",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("line",{x1:"48",y1:"40",x2:"208",y2:"216",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}))});wi.set("duotone",function(e){return L.createElement(L.Fragment,null,L.createElement("line",{x1:"144",y1:"40",x2:"112",y2:"40",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"112",y1:"216",x2:"144",y2:"216",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("path",{d:"M184,40h24a8,8,0,0,1,8,8V72",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"216",y1:"144",x2:"216",y2:"112",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"40",y1:"112",x2:"40",y2:"144",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("path",{d:"M72,216H48a8,8,0,0,1-8-8V184",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"48",y1:"40",x2:"208",y2:"216",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});wi.set("fill",function(){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M104,40a8,8,0,0,1,8-8h32a8,8,0,0,1,0,16H112A8,8,0,0,1,104,40Zm40,168H112a8,8,0,0,0,0,16h32a8,8,0,0,0,0-16ZM208,32H184a8,8,0,0,0,0,16h24V72a8,8,0,0,0,16,0V48A16,16,0,0,0,208,32Zm8,72a8,8,0,0,0-8,8v32a8,8,0,0,0,16,0V112A8,8,0,0,0,216,104ZM40,152a8,8,0,0,0,8-8V112a8,8,0,0,0-16,0v32A8,8,0,0,0,40,152Zm32,56H48V184a8,8,0,0,0-16,0v24a16,16,0,0,0,16,16H72a8,8,0,0,0,0-16ZM53.9,34.6A8,8,0,0,0,42.1,45.4l160,176A8,8,0,0,0,208,224a8.2,8.2,0,0,0,5.4-2.1,7.9,7.9,0,0,0,.5-11.3Z"}))});wi.set("light",function(e){return L.createElement(L.Fragment,null,L.createElement("line",{x1:"144",y1:"40",x2:"112",y2:"40",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"112",y1:"216",x2:"144",y2:"216",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("path",{d:"M184,40h24a8,8,0,0,1,8,8V72",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"216",y1:"144",x2:"216",y2:"112",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"40",y1:"112",x2:"40",y2:"144",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("path",{d:"M72,216H48a8,8,0,0,1-8-8V184",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"48",y1:"40",x2:"208",y2:"216",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}))});wi.set("thin",function(e){return L.createElement(L.Fragment,null,L.createElement("line",{x1:"144",y1:"40",x2:"112",y2:"40",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"112",y1:"216",x2:"144",y2:"216",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("path",{d:"M184,40h24a8,8,0,0,1,8,8V72",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"216",y1:"144",x2:"216",y2:"112",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"40",y1:"112",x2:"40",y2:"144",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("path",{d:"M72,216H48a8,8,0,0,1-8-8V184",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"48",y1:"40",x2:"208",y2:"216",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}))});wi.set("regular",function(e){return L.createElement(L.Fragment,null,L.createElement("line",{x1:"144",y1:"40",x2:"112",y2:"40",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"112",y1:"216",x2:"144",y2:"216",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("path",{d:"M184,40h24a8,8,0,0,1,8,8V72",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"216",y1:"144",x2:"216",y2:"112",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"40",y1:"112",x2:"40",y2:"144",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("path",{d:"M72,216H48a8,8,0,0,1-8-8V184",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"48",y1:"40",x2:"208",y2:"216",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});var Cv=function(t,n){return qt(t,n,wi)},lg=te.exports.forwardRef(function(e,t){return L.createElement(en,Object.assign({ref:t},e,{renderPath:Cv}))});lg.displayName="SelectionSlash";const xv=lg;var Ci=new Map;Ci.set("bold",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M80,168H32a8,8,0,0,1-8-8V96a8,8,0,0,1,8-8H80l72-56V224Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("line",{x1:"192",y1:"104",x2:"192",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("line",{x1:"228",y1:"88",x2:"228",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}))});Ci.set("duotone",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M80,168H32a8,8,0,0,1-8-8V96a8,8,0,0,1,8-8H80l72-56V224Z",opacity:"0.2"}),L.createElement("path",{d:"M80,168H32a8,8,0,0,1-8-8V96a8,8,0,0,1,8-8H80l72-56V224Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"192",y1:"104",x2:"192",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"224",y1:"88",x2:"224",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});Ci.set("fill",function(){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M155.5,24.8a8,8,0,0,0-8.4.9L77.2,80H32A16,16,0,0,0,16,96v64a16,16,0,0,0,16,16H77.2l69.9,54.3A7.9,7.9,0,0,0,152,232a8.5,8.5,0,0,0,3.5-.8A8,8,0,0,0,160,224V32A8,8,0,0,0,155.5,24.8Z"}),L.createElement("path",{d:"M192,96a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V104A8,8,0,0,0,192,96Z"}),L.createElement("path",{d:"M224,80a8,8,0,0,0-8,8v80a8,8,0,0,0,16,0V88A8,8,0,0,0,224,80Z"}))});Ci.set("light",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M80,168H32a8,8,0,0,1-8-8V96a8,8,0,0,1,8-8H80l72-56V224Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"192",y1:"104",x2:"192",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"224",y1:"88",x2:"224",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}))});Ci.set("thin",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M80,168H32a8,8,0,0,1-8-8V96a8,8,0,0,1,8-8H80l72-56V224Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"192",y1:"104",x2:"192",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"224",y1:"88",x2:"224",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}))});Ci.set("regular",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M80,168H32a8,8,0,0,1-8-8V96a8,8,0,0,1,8-8H80l72-56V224Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"192",y1:"104",x2:"192",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"224",y1:"88",x2:"224",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});var bv=function(t,n){return qt(t,n,Ci)},cg=te.exports.forwardRef(function(e,t){return L.createElement(en,Object.assign({ref:t},e,{renderPath:bv}))});cg.displayName="SpeakerSimpleHigh";const Ev=cg;var xi=new Map;xi.set("bold",function(e){return L.createElement(L.Fragment,null,L.createElement("line",{x1:"228",y1:"88",x2:"228",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("line",{x1:"48",y1:"40",x2:"208",y2:"216",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("path",{d:"M152,154.4V224L80,168H32a8,8,0,0,1-8-8V96a8,8,0,0,1,8-8H91.6",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("polyline",{points:"118.5 58.1 152 32 152 94.9",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("line",{x1:"192",y1:"104",x2:"192",y2:"138.9",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}))});xi.set("duotone",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M80,168H32a8,8,0,0,1-8-8V96a8,8,0,0,1,8-8H80l72-56V224Z",opacity:"0.2"}),L.createElement("line",{x1:"192",y1:"104",x2:"192",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"224",y1:"88",x2:"224",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"48",y1:"40",x2:"208",y2:"216",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("polyline",{points:"112.2 63 152 32 152 106.8",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("path",{d:"M152,154.4V224L80,168H32a8,8,0,0,1-8-8V96a8,8,0,0,1,8-8H91.6",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});xi.set("fill",function(){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M192,160a8,8,0,0,0,8-8V104a8,8,0,0,0-16,0v48A8,8,0,0,0,192,160Z"}),L.createElement("path",{d:"M224,80a8,8,0,0,0-8,8v80a8,8,0,0,0,16,0V88A8,8,0,0,0,224,80Z"}),L.createElement("path",{d:"M53.9,34.6A8,8,0,0,0,42.1,45.4L73.6,80H32A16,16,0,0,0,16,96v64a16,16,0,0,0,16,16H77.3l69.8,54.3A8.1,8.1,0,0,0,152,232a8.5,8.5,0,0,0,3.5-.8A8,8,0,0,0,160,224V175.1l42.1,46.3A8,8,0,0,0,208,224a8.2,8.2,0,0,0,5.4-2.1,7.9,7.9,0,0,0,.5-11.3Z"}),L.createElement("path",{d:"M146.1,112.2a7.9,7.9,0,0,0,5.9,2.6,7.4,7.4,0,0,0,2.9-.5,8,8,0,0,0,5.1-7.5V32a8,8,0,0,0-12.9-6.3l-39.9,31a8.1,8.1,0,0,0-1,11.7Z"}))});xi.set("light",function(e){return L.createElement(L.Fragment,null,L.createElement("line",{x1:"192",y1:"104",x2:"192",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"224",y1:"88",x2:"224",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"48",y1:"40",x2:"208",y2:"216",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("polyline",{points:"112.2 63 152 32 152 106.8",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("path",{d:"M152,154.4V224L80,168H32a8,8,0,0,1-8-8V96a8,8,0,0,1,8-8H91.6",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}))});xi.set("thin",function(e){return L.createElement(L.Fragment,null,L.createElement("line",{x1:"192",y1:"104",x2:"192",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"224",y1:"88",x2:"224",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"48",y1:"40",x2:"208",y2:"216",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("polyline",{points:"112.2 63 152 32 152 106.8",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("path",{d:"M152,154.4V224L80,168H32a8,8,0,0,1-8-8V96a8,8,0,0,1,8-8H91.6",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}))});xi.set("regular",function(e){return L.createElement(L.Fragment,null,L.createElement("line",{x1:"192",y1:"104",x2:"192",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"224",y1:"88",x2:"224",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"48",y1:"40",x2:"208",y2:"216",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("polyline",{points:"112.2 63 152 32 152 106.8",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("path",{d:"M152,154.4V224L80,168H32a8,8,0,0,1-8-8V96a8,8,0,0,1,8-8H91.6",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});var Tv=function(t,n){return qt(t,n,xi)},ug=te.exports.forwardRef(function(e,t){return L.createElement(en,Object.assign({ref:t},e,{renderPath:Tv}))});ug.displayName="SpeakerSimpleSlash";const kv=ug;var bi=new Map;bi.set("bold",function(e){return L.createElement(L.Fragment,null,L.createElement("rect",{x:"40",y:"76",width:"176",height:"104",rx:"16",transform:"translate(256) rotate(90)",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("line",{x1:"220",y1:"100",x2:"220",y2:"156",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("line",{x1:"36",y1:"100",x2:"36",y2:"156",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}))});bi.set("duotone",function(e){return L.createElement(L.Fragment,null,L.createElement("rect",{x:"40",y:"80",width:"176",height:"96",rx:"16",transform:"translate(256) rotate(90)",opacity:"0.2"}),L.createElement("rect",{x:"40",y:"80",width:"176",height:"96",rx:"16",transform:"translate(256) rotate(90)",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"208",y1:"88",x2:"208",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"240",y1:"104",x2:"240",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"48",y1:"88",x2:"48",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"16",y1:"104",x2:"16",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});bi.set("fill",function(){return L.createElement(L.Fragment,null,L.createElement("rect",{x:"72",y:"32",width:"112",height:"192",rx:"24"}),L.createElement("path",{d:"M208,80a8,8,0,0,0-8,8v80a8,8,0,0,0,16,0V88A8,8,0,0,0,208,80Z"}),L.createElement("path",{d:"M240,96a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V104A8,8,0,0,0,240,96Z"}),L.createElement("path",{d:"M48,80a8,8,0,0,0-8,8v80a8,8,0,0,0,16,0V88A8,8,0,0,0,48,80Z"}),L.createElement("path",{d:"M16,96a8,8,0,0,0-8,8v48a8,8,0,0,0,16,0V104A8,8,0,0,0,16,96Z"}))});bi.set("light",function(e){return L.createElement(L.Fragment,null,L.createElement("rect",{x:"40",y:"80",width:"176",height:"96",rx:"16",transform:"translate(256) rotate(90)",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"208",y1:"88",x2:"208",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"240",y1:"104",x2:"240",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"48",y1:"88",x2:"48",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("line",{x1:"16",y1:"104",x2:"16",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}))});bi.set("thin",function(e){return L.createElement(L.Fragment,null,L.createElement("rect",{x:"40",y:"80",width:"176",height:"96",rx:"16",transform:"translate(256) rotate(90)",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"208",y1:"88",x2:"208",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"240",y1:"104",x2:"240",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"48",y1:"88",x2:"48",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("line",{x1:"16",y1:"104",x2:"16",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}))});bi.set("regular",function(e){return L.createElement(L.Fragment,null,L.createElement("rect",{x:"40",y:"80",width:"176",height:"96",rx:"16",transform:"translate(256) rotate(90)",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"208",y1:"88",x2:"208",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"240",y1:"104",x2:"240",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"48",y1:"88",x2:"48",y2:"168",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("line",{x1:"16",y1:"104",x2:"16",y2:"152",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});var Iv=function(t,n){return qt(t,n,bi)},hg=te.exports.forwardRef(function(e,t){return L.createElement(en,Object.assign({ref:t},e,{renderPath:Iv}))});hg.displayName="Vibrate";const Ov=hg;var Ei=new Map;Ei.set("bold",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M24,60H152a32,32,0,0,1,32,32v96a8,8,0,0,1-8,8H48a32,32,0,0,1-32-32V68A8,8,0,0,1,24,60Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}),L.createElement("polyline",{points:"184 112 240 80 240 176 184 144",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"24"}))});Ei.set("duotone",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M24,60H152a32,32,0,0,1,32,32v96a8,8,0,0,1-8,8H48a32,32,0,0,1-32-32V68A8,8,0,0,1,24,60Z",opacity:"0.2"}),L.createElement("path",{d:"M24,60H152a32,32,0,0,1,32,32v96a8,8,0,0,1-8,8H48a32,32,0,0,1-32-32V68A8,8,0,0,1,24,60Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("polyline",{points:"184 112 240 80 240 176 184 144",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});Ei.set("fill",function(){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M176,92v96a16,16,0,0,1-16,16H48A40,40,0,0,1,8,164V68A16,16,0,0,1,24,52H136A40,40,0,0,1,176,92Zm68-18.9a7.7,7.7,0,0,0-8,0L196,95.9a8,8,0,0,0-4,7v50.2a8,8,0,0,0,4,7l40,22.8a8.3,8.3,0,0,0,4,1.1,8,8,0,0,0,4-1.1,7.8,7.8,0,0,0,4-6.9V80A7.8,7.8,0,0,0,244,73.1Z"}))});Ei.set("light",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M24,60H152a32,32,0,0,1,32,32v96a8,8,0,0,1-8,8H48a32,32,0,0,1-32-32V68A8,8,0,0,1,24,60Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}),L.createElement("polyline",{points:"184 112 240 80 240 176 184 144",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"12"}))});Ei.set("thin",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M24,60H152a32,32,0,0,1,32,32v96a8,8,0,0,1-8,8H48a32,32,0,0,1-32-32V68A8,8,0,0,1,24,60Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}),L.createElement("polyline",{points:"184 112 240 80 240 176 184 144",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"8"}))});Ei.set("regular",function(e){return L.createElement(L.Fragment,null,L.createElement("path",{d:"M24,60H152a32,32,0,0,1,32,32v96a8,8,0,0,1-8,8H48a32,32,0,0,1-32-32V68A8,8,0,0,1,24,60Z",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}),L.createElement("polyline",{points:"184 112 240 80 240 176 184 144",fill:"none",stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"16"}))});var Lv=function(t,n){return qt(t,n,Ei)},dg=te.exports.forwardRef(function(e,t){return L.createElement(en,Object.assign({ref:t},e,{renderPath:Lv}))});dg.displayName="VideoCamera";const Rv=dg;function Av({cameraSettingValues:e,setCameraSettingValues:t}){const n=(i,o)=>{t(d=>({...d,[i]:o}));const a={...e,[i]:o};localStorage.setItem("settingValues",JSON.stringify(a))};return ae("div",{role:"button","aria-hidden":"true",className:"settings-container d-flex justify-content-start align-items-start",onClick:i=>i.stopPropagation(),children:Le("div",{className:"settings-card d-flex flex-column justify-content-center align-items-center",children:[ae("h1",{className:"d-flex justify-content-center align-items-center",children:"Scan Settings"}),Le("div",{className:"settings-content-wrapper d-flex flex-column justify-content-center gap-3",children:[ae("p",{children:"Scan Mode"}),Le("div",{className:"settings-mode-wrapper d-flex justify-content-between align-items-center gap-2",children:[ae("button",{type:"button",onClick:()=>n("scanMode","speed"),className:`settings-btn ${e.scanMode==="speed"?"settings-yellow-btn":null}`,children:"Best Speed"}),ae("button",{type:"button",onClick:()=>n("scanMode","balance"),className:`settings-btn ${e.scanMode==="balance"?"settings-yellow-btn":null}`,children:"Balance"}),ae("button",{type:"button",onClick:()=>n("scanMode","coverage"),className:`settings-btn ${(e==null?void 0:e.scanMode)==="coverage"?"settings-yellow-btn":null}`,children:"Best Coverage"})]})]}),Le("div",{className:"settings-content-wrapper d-flex flex-column justify-content-center gap-3",children:[ae("p",{children:"Barcode Color Option"}),Le("div",{className:"settings-color-wrapper d-flex justify-content-between align-items-center gap-4",children:[Le("button",{type:"button",onClick:()=>n("grayscaleTransformationModes",[2,0,0,0,0,0,0,0]),className:`color-option-btn d-flex align-items-center ${(e==null?void 0:e.grayscaleTransformationModes[0])===2?"settings-yellow-btn":null}`,children:[ae("p",{className:"color-option-text d-flex justify-content-center align-items-center",children:"Normal"}),ae(kh,{weight:"thin",className:"normal-barcode"})]}),Le("button",{type:"button",onClick:()=>n("grayscaleTransformationModes",[1,0,0,0,0,0,0,0]),className:`color-option-btn d-flex align-items-center ${(e==null?void 0:e.grayscaleTransformationModes[0])===1?"settings-yellow-btn":null}`,children:[ae("p",{className:"color-option-text d-flex justify-content-center align-items-center",children:"Inverted"}),ae(kh,{weight:"fill",className:"inverted-barcode"})]})]})]}),Le("div",{className:"settings-content-wrapper d-flex justify-content-between align-items-center",children:[ae("p",{children:"Vibrate on Scan"}),ae("button",{type:"button",onClick:()=>{const i=(e==null?void 0:e.vibrate)==="unique"?"never":"unique";n("vibrate",i)},className:"vibrate",children:(e==null?void 0:e.vibrate)==="unique"?ae(Ov,{size:36,className:"vibration-on"}):ae(xv,{size:36,className:"vibration-off"})})]}),Le("div",{className:"settings-content-wrapper d-flex justify-content-between align-items-center",children:[ae("p",{children:"Sound on Scan"}),ae("button",{type:"button",onClick:()=>{const i=(e==null?void 0:e.sound)==="unique"?"never":"unique";n("sound",i)},className:"scan-sound",children:(e==null?void 0:e.sound)==="unique"?ae(Ev,{size:36,weight:"bold",className:"scan-sound-on"}):ae(kv,{size:36,weight:"bold",className:"scan-sound-off"})})]}),Le("div",{className:"focus-zoom-wrapper d-flex flex-column justify-content-between align-items-center",children:[Le("div",{className:"focus-wrapper d-flex justify-content-between align-items-center",children:[ae("p",{children:"Auto Focus"}),ae("button",{type:"button",onClick:()=>n("autoFocus",!(e!=null&&e.autoFocus)),className:`off-on-animation ${e!=null&&e.autoFocus?"auto-on":"auto-off"}`,children:ae("span",{})})]}),Le("div",{className:"zoom-wrapper d-flex justify-content-between align-items-center",children:[ae("p",{children:"Auto Zoom"}),ae("button",{type:"button",onClick:()=>n("autoZoom",!(e!=null&&e.autoZoom)),className:`off-on-animation ${e!=null&&e.autoZoom?"auto-on":"auto-off"}`,children:ae("span",{})})]})]})]})})}const Dv={isTorchSupported:!1,autoFocus:!0,autoZoom:!1,zoomFactor:1,vibrate:"unique",sound:"unique",scanMode:"balance",grayscaleTransformationModes:[2,0,0,0,0,0,0,0],resolutionCapability:{maxHeight:0,maxWidth:0}},Mv=()=>{const e=localStorage.getItem("settingValues");return e?JSON.parse(e):Dv};function Fv({barcode:e,setBarcode:t}){const[n,i]=te.exports.useState(!1),[o,a]=te.exports.useState(!1),[d,_]=te.exports.useState(!1),[y,w]=te.exports.useState("134vh"),[x,T]=te.exports.useState(Mv()),{isTorchSupported:E,autoFocus:M,autoZoom:F,zoomFactor:P,grayscaleTransformationModes:B,scanMode:D,sound:O,vibrate:A,resolutionCapability:Y}=x,{maxHeight:ne,maxWidth:oe}=Y,K=B[0],S=te.exports.useRef();let ue=null;const le=async()=>{var l,c;try{const f=await(ue=on.createInstance());if(f.isContextDestroyed())return;if(!S.current)throw Error("elRef is not assigned");if(await f.setUIElement(S.current),f.isContextDestroyed())return;if(f.onFrameRead=r=>{for(const s of r)t({keyDownValue:"",focusNextInput:!1,inputValue:s.barcodeText,barcodeValue:s.barcodeText,showScanner:!1})},o)f.close(),f.singleFrameMode=!0,await f.show();else try{const{OS:r,browser:s}=await W.detectEnvironment(),u=r==="Windows"&&(s==="Chrome"||s==="Edge")||r==="Android"&&(s==="Chrome"||s==="Edge");T(C=>({...C,isTorchSupported:u})),localStorage.setItem("settingValues",JSON.stringify({...x,isTorchSupported:u}));const m=await(f==null?void 0:f.getRuntimeSettings());m.region={regionMeasuredByPercentage:1,regionLeft:20,regionTop:38,regionRight:80,regionBottom:62},m.furtherModes.grayscaleTransformationModes=B;const g=await f.getScanSettings();if(g.intervalTime=100,g.autoFocus=M,g.autoZoom=F,g.autoSuggestTip=!0,g.whenToVibrateforSuccessfulRead=A,g.whenToPlaySoundforSuccessfulRead=O,g.duplicateForgetTime=3e3,ne&&oe&&await f.setResolution(oe,ne),f.ifSaveLastUsedCamera=!0,await f.updateRuntimeSettings(D),await f.updateRuntimeSettings(m),await f.updateScanSettings(g),await f.open(),!ne||!oe){const C=f.getCapabilities(),b=((l=C==null?void 0:C.height)==null?void 0:l.max)||1080,k=((c=C==null?void 0:C.width)==null?void 0:c.max)||1920;T(I=>({...I,resolutionCapability:{maxHeight:b,maxWidth:k}})),localStorage.setItem("settingValues",JSON.stringify({...x,resolutionCapability:{maxHeight:b,maxWidth:k}}))}const[p,v]=f.getResolution();w(`${Math.ceil(p*100/v)}vh`),await f.setZoom(P),await f.enableTapToFocus(),E&&(n?await f.turnOnTorch():await f.turnOffTorch())}catch(r){console.log(r)}}catch(f){alert(f),console.log(f)}};te.exports.useEffect(()=>(le(),()=>{(async()=>{const c=await ue;c&&c.destroyContext()})()}),[n,o,E,M,F,P,D,O,A,ne,oe,K]);const Ce=te.exports.useCallback(l=>{T(c=>({...c,zoomFactor:l})),localStorage.setItem("settingValues",JSON.stringify({...x,zoomFactor:l}))},[]),h=l=>{const c=l.target.value,[f,r]=c.split("x").map(Number);w(`${Math.ceil(f*100/r)}vh`)};return e.showScanner?Le("div",{ref:S,role:"button","aria-hidden":"true",className:"video-container d-flex flex-column justify-content-center align-items-center",onClick:()=>_(!1),children:[d?ae(Av,{cameraSettingValues:x,setCameraSettingValues:T}):null,Le("div",{className:"div-ui-container",style:{width:y,height:"100vh"},children:[ae("svg",{className:"dce-bg-loading",viewBox:"0 0 1792 1792",children:ae("path",{d:"M1760 896q0 176-68.5 336t-184 275.5-275.5 184-336 68.5-336-68.5-275.5-184-184-275.5-68.5-336q0-213 97-398.5t265-305.5 374-151v228q-221 45-366.5 221t-145.5 406q0 130 51 248.5t136.5 204 204 136.5 248.5 51 248.5-51 204-136.5 136.5-204 51-248.5q0-230-145.5-406t-366.5-221v-228q206 31 374 151t265 305.5 97 398.5z"})}),Le("div",{className:"video-navbar d-flex justify-content-between align-items-center",children:[Le("div",{className:"d-flex justify-content-between align-items-center gap-2",children:[Le("button",{type:"button","aria-label":"navigate-back",onClick:()=>t({keyDownValue:"",focusNextInput:!1,inputValue:"",barcodeValue:"",showScanner:!1}),"data-testid":"back-btn",className:"back-btn d-flex justify-content-center align-items-center mx-2",children:[ae(pv,{size:28,color:"#0a1c59",weight:"bold"}),ae("span",{children:"Back"})," "]}),ae("button",{type:"button",onClick:()=>a(!o),"data-testid":"take-picture-btn",id:"btn-single-frame-mode",className:"video-btn d-flex justify-content-center align-items-center",children:o?ae(Rv,{size:28,weight:"bold"}):ae(_v,{size:28,weight:"bold"})}),ae("button",{type:"button",onClick:l=>{l.stopPropagation(),_(!0)},onMouseEnter:l=>{l.stopPropagation(),_(!0)},onTouchStart:l=>{l.stopPropagation(),_(!0)},"data-testid":"scan-setting-btn",className:"video-btn d-flex justify-content-center align-items-center",children:ae(wv,{size:28,weight:"bold"})}),E?ae("button",{type:"button","aria-label":"turn on or off torch",onClick:()=>i(!n),"data-testid":"torch-btn",id:"btn-torch",className:"video-btn d-flex justify-content-center align-items-center",children:ae(yv,{size:28,weight:"bold"})}):null]}),Le("div",{className:"div-select-container d-flex flex-column align-items-end",children:[ae("select",{className:"dce-sel-camera"}),Le("select",{className:"dce-sel-resolution",onChange:h,children:[ae("option",{className:"dce-opt-gotResolution",value:"got"}),oe&&ne&&ne!==1080&&ne!==720&&ne!==480?Le("option",{"data-width":`${oe}`,"data-height":`${ne}`,children:[oe,"x",ne]}):null,ae("option",{"data-width":"1920","data-height":"1080",children:"1920x1080"}),ae("option",{"data-width":"1280","data-height":"720",children:"1280x720"}),ae("option",{"data-width":"640","data-height":"480",children:"640x480"})]})]})," ",F?null:ae("div",{className:"zoom-slider-wrapper d-flex justify-content-center align-items-center",children:ae("div",{className:"zoom-slider d-flex justify-content-center align-items-center",children:ae(hv,{min:1,max:10,step:1,value:P,className:"slider",onChange:Ce,trackStyle:{height:8,marginLeft:-2,marginBottom:2},handleStyle:{height:48,width:48}})})})]}),ae("div",{className:"dce-video-container"})]})]}):null}const Pv=["as","disabled"];function Nv(e,t){if(e==null)return{};var n={},i=Object.keys(e),o,a;for(a=0;a<i.length;a++)o=i[a],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function Bv(e){return!e||e.trim()==="#"}function fg({tagName:e,disabled:t,href:n,target:i,rel:o,role:a,onClick:d,tabIndex:_=0,type:y}){e||(n!=null||i!=null||o!=null?e="a":e="button");const w={tagName:e};if(e==="button")return[{type:y||"button",disabled:t},w];const x=E=>{if((t||e==="a"&&Bv(n))&&E.preventDefault(),t){E.stopPropagation();return}d==null||d(E)},T=E=>{E.key===" "&&(E.preventDefault(),x(E))};return e==="a"&&(n||(n="#"),t&&(n=void 0)),[{role:a??"button",disabled:void 0,tabIndex:t?void 0:_,href:n,target:e==="a"?i:void 0,"aria-disabled":t||void 0,rel:e==="a"?o:void 0,onClick:x,onKeyDown:T},w]}const jv=te.exports.forwardRef((e,t)=>{let{as:n,disabled:i}=e,o=Nv(e,Pv);const[a,{tagName:d}]=fg(Object.assign({tagName:n,disabled:i},o));return ae(d,Object.assign({},o,a,{ref:t}))});jv.displayName="Button";const Vv=["xxl","xl","lg","md","sm","xs"],Wv="xs",pc=te.exports.createContext({prefixes:{},breakpoints:Vv,minBreakpoint:Wv});function tt(e,t){const{prefixes:n}=te.exports.useContext(pc);return e||n[t]||t}function Uv(){const{breakpoints:e}=te.exports.useContext(pc);return e}function Gv(){const{minBreakpoint:e}=te.exports.useContext(pc);return e}const Hv={variant:"primary",active:!1,disabled:!1},Kr=te.exports.forwardRef(({as:e,bsPrefix:t,variant:n,size:i,active:o,className:a,...d},_)=>{const y=tt(t,"btn"),[w,{tagName:x}]=fg({tagName:e,...d});return ae(x,{...w,...d,ref:_,className:Pe(a,y,o&&"active",n&&`${y}-${n}`,i&&`${y}-${i}`,d.href&&d.disabled&&"disabled")})});Kr.displayName="Button";Kr.defaultProps=Hv;var ai={exports:{}},zv="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Yv=zv,Xv=Yv;function gg(){}function pg(){}pg.resetWarningCache=gg;var $v=function(){function e(i,o,a,d,_,y){if(y!==Xv){var w=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw w.name="Invariant Violation",w}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:pg,resetWarningCache:gg};return n.PropTypes=n,n};ai.exports=$v();const Zv={type:ai.exports.string,tooltip:ai.exports.bool,as:ai.exports.elementType},Fs=te.exports.forwardRef(({as:e="div",className:t,type:n="valid",tooltip:i=!1,...o},a)=>ae(e,{...o,ref:a,className:Pe(t,`${n}-${i?"tooltip":"feedback"}`)}));Fs.displayName="Feedback";Fs.propTypes=Zv;const mn=te.exports.createContext({}),mc=te.exports.forwardRef(({id:e,bsPrefix:t,className:n,type:i="checkbox",isValid:o=!1,isInvalid:a=!1,as:d="input",..._},y)=>{const{controlId:w}=te.exports.useContext(mn);return t=tt(t,"form-check-input"),ae(d,{..._,ref:y,type:i,id:e||w,className:Pe(n,t,o&&"is-valid",a&&"is-invalid")})});mc.displayName="FormCheckInput";const fs=te.exports.forwardRef(({bsPrefix:e,className:t,htmlFor:n,...i},o)=>{const{controlId:a}=te.exports.useContext(mn);return e=tt(e,"form-check-label"),ae("label",{...i,ref:o,htmlFor:n||a,className:Pe(t,e)})});fs.displayName="FormCheckLabel";function Kv(e,t){return te.exports.Children.toArray(e).some(n=>te.exports.isValidElement(n)&&n.type===t)}const mg=te.exports.forwardRef(({id:e,bsPrefix:t,bsSwitchPrefix:n,inline:i=!1,reverse:o=!1,disabled:a=!1,isValid:d=!1,isInvalid:_=!1,feedbackTooltip:y=!1,feedback:w,feedbackType:x,className:T,style:E,title:M="",type:F="checkbox",label:P,children:B,as:D="input",...O},A)=>{t=tt(t,"form-check"),n=tt(n,"form-switch");const{controlId:Y}=te.exports.useContext(mn),ne=te.exports.useMemo(()=>({controlId:e||Y}),[Y,e]),oe=!B&&P!=null&&P!==!1||Kv(B,fs),K=ae(mc,{...O,type:F==="switch"?"checkbox":F,ref:A,isValid:d,isInvalid:_,disabled:a,as:D});return ae(mn.Provider,{value:ne,children:ae("div",{style:E,className:Pe(T,oe&&t,i&&`${t}-inline`,o&&`${t}-reverse`,F==="switch"&&n),children:B||Le(Ph,{children:[K,oe&&ae(fs,{title:M,children:P}),w&&ae(Fs,{type:x,tooltip:y,children:w})]})})})});mg.displayName="FormCheck";const gs=Object.assign(mg,{Input:mc,Label:fs}),_g=te.exports.forwardRef(({bsPrefix:e,type:t,size:n,htmlSize:i,id:o,className:a,isValid:d=!1,isInvalid:_=!1,plaintext:y,readOnly:w,as:x="input",...T},E)=>{const{controlId:M}=te.exports.useContext(mn);e=tt(e,"form-control");let F;return y?F={[`${e}-plaintext`]:!0}:F={[e]:!0,[`${e}-${n}`]:n},ae(x,{...T,type:t,size:i,ref:E,readOnly:w,id:o||M,className:Pe(a,F,d&&"is-valid",_&&"is-invalid",t==="color"&&`${e}-color`)})});_g.displayName="FormControl";const Jv=Object.assign(_g,{Feedback:Fs});var Qv=/-(.)/g;function qv(e){return e.replace(Qv,function(t,n){return n.toUpperCase()})}const e0=e=>e[0].toUpperCase()+qv(e).slice(1);function Yn(e,{displayName:t=e0(e),Component:n,defaultProps:i}={}){const o=te.exports.forwardRef(({className:a,bsPrefix:d,as:_=n||"div",...y},w)=>{const x=tt(d,e);return ae(_,{ref:w,className:Pe(a,x),...y})});return o.defaultProps=i,o.displayName=t,o}const t0=Yn("form-floating"),_c=te.exports.forwardRef(({controlId:e,as:t="div",...n},i)=>{const o=te.exports.useMemo(()=>({controlId:e}),[e]);return ae(mn.Provider,{value:o,children:ae(t,{...n,ref:i})})});_c.displayName="FormGroup";function n0({as:e,bsPrefix:t,className:n,...i}){t=tt(t,"col");const o=Uv(),a=Gv(),d=[],_=[];return o.forEach(y=>{const w=i[y];delete i[y];let x,T,E;typeof w=="object"&&w!=null?{span:x,offset:T,order:E}=w:x=w;const M=y!==a?`-${y}`:"";x&&d.push(x===!0?`${t}${M}`:`${t}${M}-${x}`),E!=null&&_.push(`order${M}-${E}`),T!=null&&_.push(`offset${M}-${T}`)}),[{...i,className:Pe(n,...d,..._)},{as:e,bsPrefix:t,spans:d}]}const vg=te.exports.forwardRef((e,t)=>{const[{className:n,...i},{as:o="div",bsPrefix:a,spans:d}]=n0(e);return ae(o,{...i,ref:t,className:Pe(n,!d.length&&a)})});vg.displayName="Col";const i0={column:!1,visuallyHidden:!1},vc=te.exports.forwardRef(({as:e="label",bsPrefix:t,column:n,visuallyHidden:i,className:o,htmlFor:a,...d},_)=>{const{controlId:y}=te.exports.useContext(mn);t=tt(t,"form-label");let w="col-form-label";typeof n=="string"&&(w=`${w} ${w}-${n}`);const x=Pe(o,t,i&&"visually-hidden",n&&w);return a=a||y,n?ae(vg,{ref:_,as:"label",className:x,htmlFor:a,...d}):ae(e,{ref:_,className:x,htmlFor:a,...d})});vc.displayName="FormLabel";vc.defaultProps=i0;const yg=te.exports.forwardRef(({bsPrefix:e,className:t,id:n,...i},o)=>{const{controlId:a}=te.exports.useContext(mn);return e=tt(e,"form-range"),ae("input",{...i,type:"range",ref:o,className:Pe(t,e),id:n||a})});yg.displayName="FormRange";const Sg=te.exports.forwardRef(({bsPrefix:e,size:t,htmlSize:n,className:i,isValid:o=!1,isInvalid:a=!1,id:d,..._},y)=>{const{controlId:w}=te.exports.useContext(mn);return e=tt(e,"form-select"),ae("select",{..._,size:n,ref:y,className:Pe(i,e,t&&`${e}-${t}`,o&&"is-valid",a&&"is-invalid"),id:d||w})});Sg.displayName="FormSelect";const wg=te.exports.forwardRef(({bsPrefix:e,className:t,as:n="small",muted:i,...o},a)=>(e=tt(e,"form-text"),ae(n,{...o,ref:a,className:Pe(t,e,i&&"text-muted")})));wg.displayName="FormText";const Cg=te.exports.forwardRef((e,t)=>ae(gs,{...e,ref:t,type:"switch"}));Cg.displayName="Switch";const r0=Object.assign(Cg,{Input:gs.Input,Label:gs.Label}),xg=te.exports.forwardRef(({bsPrefix:e,className:t,children:n,controlId:i,label:o,...a},d)=>(e=tt(e,"form-floating"),Le(_c,{ref:d,className:Pe(t,e),controlId:i,...a,children:[n,ae("label",{htmlFor:i,children:o})]})));xg.displayName="FloatingLabel";const o0={_ref:ai.exports.any,validated:ai.exports.bool,as:ai.exports.elementType},yc=te.exports.forwardRef(({className:e,validated:t,as:n="form",...i},o)=>ae(n,{...i,ref:o,className:Pe(e,t&&"was-validated")}));yc.displayName="Form";yc.propTypes=o0;const Po=Object.assign(yc,{Group:_c,Control:Jv,Floating:t0,Check:gs,Switch:r0,Label:vc,Text:wg,Range:yg,Select:Sg,FloatingLabel:xg}),s0="/barcode-scanner-pwa/images/camera.png";function ga({barcode:e,setBarcode:t,ID:n,placeholder:i}){const o=te.exports.useContext(Jf),a=y=>{t(y.target.value)},d=()=>{t({barcodeValue:"",showScanner:!0})},_=()=>{t({barcodeValue:"",showScanner:!1})};return te.exports.useEffect(()=>{(async()=>{try{await W.loadWasm()}catch(y){let w;y.message.includes("network connection error")?w="Failed to connect to Dynamsoft License Server: network connection error. Check your Internet connection or contact Dynamsoft Support (support@dynamsoft.com) to acquire an offline license.":w=y.message||y,console.error(w),alert(w)}})()},[]),Le(Ph,{children:[Le(Po.Group,{children:[ae(Po.Label,{style:{fontWeight:"600",fontSize:"14px",lineHeight:"21px"},children:n}),Le("div",{className:"d-flex gap-2 justify-content-center align-items-center my-1",children:[ae(Po.Control,{className:"d-flex justify-content-center align-items-center p-2",type:"text",value:e.barcodeValue,onChange:a,placeholder:i,required:!0}),e.barcodeValue?ae(Kr,{onClick:_,variant:"danger",className:"d-flex justify-content-center align-items-center px-3 py-2",children:ae("span",{children:"X"})}):Le(Kr,{disabled:!o,onClick:d,className:"d-flex justify-content-center align-items-center",children:[" ",ae("img",{alt:"logo",src:s0,width:"20",height:"20",className:"m-1"})]})]})]}),e.showScanner?ae(Fv,{barcode:e,setBarcode:t}):null]})}const bg=e=>te.exports.forwardRef((t,n)=>ae("div",{...t,ref:n,className:Pe(t.className,e)})),Eg=te.exports.forwardRef(({bsPrefix:e,className:t,variant:n,as:i="img",...o},a)=>{const d=tt(e,"card-img");return ae(i,{ref:a,className:Pe(n?`${d}-${n}`:d,t),...o})});Eg.displayName="CardImg";const Tg=te.exports.createContext(null);Tg.displayName="CardHeaderContext";const kg=te.exports.forwardRef(({bsPrefix:e,className:t,as:n="div",...i},o)=>{const a=tt(e,"card-header"),d=te.exports.useMemo(()=>({cardHeaderBsPrefix:a}),[a]);return ae(Tg.Provider,{value:d,children:ae(n,{ref:o,...i,className:Pe(t,a)})})});kg.displayName="CardHeader";const a0=bg("h5"),l0=bg("h6"),Ig=Yn("card-body"),c0=Yn("card-title",{Component:a0}),u0=Yn("card-subtitle",{Component:l0}),h0=Yn("card-link",{Component:"a"}),d0=Yn("card-text",{Component:"p"}),f0=Yn("card-footer"),g0=Yn("card-img-overlay"),p0={body:!1},Sc=te.exports.forwardRef(({bsPrefix:e,className:t,bg:n,text:i,border:o,body:a,children:d,as:_="div",...y},w)=>{const x=tt(e,"card");return ae(_,{ref:w,...y,className:Pe(t,x,n&&`bg-${n}`,i&&`text-${i}`,o&&`border-${o}`),children:a?ae(Ig,{children:d}):d})});Sc.displayName="Card";Sc.defaultProps=p0;const ps=Object.assign(Sc,{Img:Eg,Title:c0,Subtitle:u0,Body:Ig,Link:h0,Text:d0,Header:kg,Footer:f0,ImgOverlay:g0});function m0(){const[e,t]=te.exports.useState(!0),{roomID:n,assetID:i,tagID:o,setRoomID:a,setAssetID:d,setTagID:_}=te.exports.useContext(Uf),y=w=>{w.preventDefault(),n&&i&&o?(Vu("01",{roomID:n,assetID:i,tagID:o}),a({barcodeValue:"",showScanner:!1}),d({barcodeValue:"",showScanner:!1}),_({barcodeValue:"",showScanner:!1})):(Vu("01",{assetID:i,tagID:o}),a({barcodeValue:"",showScanner:!1}),d({barcodeValue:"",showScanner:!1}),_({barcodeValue:"",showScanner:!1}))};return te.exports.useEffect(()=>{t(!(i&&o))},[i,o]),ae(ps,{className:"border-0 shadow-none rounded-0",style:{width:"350px"},children:ae(ps.Body,{children:Le(Po,{action:"/",noValidate:!0,onSubmit:y,children:[ae(ga,{barcode:n,setBarcode:a,ID:"Room-ID",placeholder:"4302 (Option)"}),ae(ga,{barcode:i,setBarcode:d,ID:"Asset-ID",placeholder:"999 87456317AD"}),ae(ga,{barcode:o,setBarcode:_,ID:"Tag-ID",placeholder:"999 87456317"}),ae(Kr,{type:"submit",disabled:e&&!0,className:"mt-3 p-2",style:{width:"100%"},children:"Tag Asset"})]})})})}const _0={fluid:!1},wc=te.exports.forwardRef(({bsPrefix:e,fluid:t,as:n="div",className:i,...o},a)=>{const d=tt(e,"container"),_=typeof t=="string"?`-${t}`:"-fluid";return ae(n,{ref:a,...o,className:Pe(i,t?`${d}${_}`:d)})});wc.displayName="Container";wc.defaultProps=_0;const v0=te.exports.forwardRef(({bsPrefix:e,className:t,striped:n,bordered:i,borderless:o,hover:a,size:d,variant:_,responsive:y,...w},x)=>{const T=tt(e,"table"),E=Pe(t,T,_&&`${T}-${_}`,d&&`${T}-${d}`,n&&`${T}-${typeof n=="string"?`striped-${n}`:"striped"}`,i&&`${T}-bordered`,o&&`${T}-borderless`,a&&`${T}-hover`),M=ae("table",{...w,className:E,ref:x});if(y){let F=`${T}-responsive`;return typeof y=="string"&&(F=`${F}-${y}`),ae("div",{className:F,children:M})}return M}),y0="/barcode-scanner-pwa/images/searchTag.png",S0=()=>{const[e,t]=te.exports.useState([]),n=async()=>{(await dc).getAll("taggedList").then(o=>{t(o)})},i=()=>{f_("01")};return te.exports.useEffect(()=>{n()},[e]),ae(ps,{className:"border-0 rounded-3 shadow m-2",style:{width:"350px",height:"228px"},children:ae(ps.Body,{children:e.length?ae("div",{className:"d-flex justify-content-center align-items-center",children:Le(v0,{className:"d-flex flex-column mx-3 table-sm",style:{fontSize:"12px",lineHeight:"18px"},children:[ae("thead",{style:{width:"292px",fontWeight:"700"},children:Le("tr",{className:"d-flex justify-content-between align-items-center px-1",children:[ae("th",{children:"Asset ID"}),ae("th",{children:"Tag ID"}),ae("th",{children:"Synced"})]})}),ae("tbody",{className:"border-0 rounded-3 shadow",style:{width:"292px",minHeight:"78px",fontWeight:"400",backgroundColor:"#E8ECFC"},children:e.map((o,a)=>Le("tr",{className:"d-flex justify-content-between align-items-center p-1",children:[ae("td",{children:o.assetID}),ae("td",{children:o.tagID}),Le("td",{children:[" ",ae("span",{className:"btn btn-default btn-custom",style:{fontSize:"12px",lineHeight:"18px",fontWeight:"400"},onClick:i,children:"Yes"})]})]},a))})]})}):Le("div",{className:"d-flex flex-column justify-content-center align-items-center",children:[ae("img",{alt:"search tag",src:y0,width:"36.7",height:"37.7",className:"my-4 mx-auto"}),ae("p",{className:"text-center",style:{width:"161px",fontSize:"12px",lineHeight:"18px"},children:"Scan an asset to begin popuplating this list."})]})})})};function w0(){return Le(wc,{style:{maxWidth:"390px",waxheight:"844px"},className:"d-flex flex-column justify-content-center align-items-center",children:[ae(S0,{}),ae(m0,{})]})}function C0(){return ae(M_,{children:ae(g_,{children:ae(w0,{})})})}pa.createRoot(document.getElementById("root")).render(ae(L.StrictMode,{children:ae(C0,{})}));
